{
  "question": {
    "tags": [
      "java",
      "java-8",
      "java-stream"
    ],
    "owner": {
      "account_id": 116234,
      "reputation": 8493,
      "user_id": 304874,
      "user_type": "registered",
      "accept_rate": 84,
      "profile_image": "https://www.gravatar.com/avatar/747fc0ce46f05418e2c1c5ce724fd0f9?s=256&d=identicon&r=PG",
      "display_name": "Graeme Moss",
      "link": "https://stackoverflow.com/users/304874/graeme-moss"
    },
    "is_answered": true,
    "view_count": 490683,
    "protected_date": 1541496054,
    "accepted_answer_id": 18552071,
    "answer_count": 28,
    "score": 550,
    "last_activity_date": 1742575360,
    "creation_date": 1377977469,
    "last_edit_date": 1508168705,
    "question_id": 18552005,
    "content_license": "CC BY-SA 3.0",
    "link": "https://stackoverflow.com/questions/18552005/is-there-a-concise-way-to-iterate-over-a-stream-with-indices-in-java-8",
    "title": "Is there a concise way to iterate over a stream with indices in Java 8?",
    "body": "<p>Is there a concise way to iterate over a stream whilst having access to the index in the stream?</p>\n\n<pre><code>String[] names = {\"Sam\",\"Pamela\", \"Dave\", \"Pascal\", \"Erik\"};\n\nList&lt;String&gt; nameList;\nStream&lt;Integer&gt; indices = intRange(1, names.length).boxed();\nnameList = zip(indices, stream(names), SimpleEntry::new)\n        .filter(e -&gt; e.getValue().length() &lt;= e.getKey())\n        .map(Entry::getValue)\n        .collect(toList());\n</code></pre>\n\n<p>which seems rather disappointing compared to the LINQ example given there</p>\n\n<pre><code>string[] names = { \"Sam\", \"Pamela\", \"Dave\", \"Pascal\", \"Erik\" };\nvar nameList = names.Where((c, index) =&gt; c.Length &lt;= index + 1).ToList();\n</code></pre>\n\n<p>Is there a more concise way?</p>\n\n<p>Further it seems the zip has either moved or been removed...</p>\n"
  },
  "answers": [
    {
      "owner": {
        "account_id": 1119690,
        "reputation": 23249,
        "user_id": 1108305,
        "user_type": "registered",
        "accept_rate": 47,
        "profile_image": "https://www.gravatar.com/avatar/4c16849c5f9444a685f62cdc2a15c3ac?s=256&d=identicon&r=PG",
        "display_name": "M. Justin",
        "link": "https://stackoverflow.com/users/1108305/m-justin"
      },
      "is_accepted": false,
      "score": 6,
      "last_activity_date": 1742575360,
      "last_edit_date": 1742575360,
      "creation_date": 1704323228,
      "answer_id": 77755077,
      "question_id": 18552005,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>Here is a solution that uses a custom gatherer, using the <a href=\"https://openjdk.org/jeps/485\" rel=\"nofollow noreferrer\">JEP 485: Stream Gatherers</a> Java 24 language feature (available as a preview language feature since Java 22):</p>\n<pre class=\"lang-java prettyprint-override\"><code>void main() {\n    Stream&lt;String&gt; stream = Stream.of(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;);\n\n    // [[A: 0], [B: 1], [C: 2], [D: 3], [E: 4]]\n    System.out.println(stream.gather(withIndex()).toList());\n}\n\nstatic &lt;T&gt; Gatherer&lt;T, ?, IndexedElement&lt;T&gt;&gt; withIndex() {\n    class Index {\n        int index = 0;\n    }\n\n    return Gatherer.ofSequential(\n            Index::new,\n            Gatherer.Integrator.ofGreedy((state, element, downstream) -&gt;\n                    downstream.push(new IndexedElement&lt;&gt;(element, state.index++)))\n    );\n}\n\nrecord IndexedElement&lt;E&gt;(E value, int index) {\n    @Override\n    public String toString() {\n        return &quot;[%s: %s]&quot;.formatted(value, index);\n    }\n}\n</code></pre>\n<p>This custom gatherer keeps track of the current index, and maps each element to a custom <code>IndexedElement</code> type containing the element and the index.</p>\n<h1>Javadocs</h1>\n<p><a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Gatherer.html\" rel=\"nofollow noreferrer\"><code>Gatherer</code></a>:</p>\n<blockquote>\n<p>An intermediate operation that transforms a stream of input elements into a stream of output elements, optionally applying a final action when the end of the upstream is reached. […]</p>\n<p>[…]</p>\n<p>There are many examples of gathering operations, including but not limited to: grouping elements into batches (windowing functions); de-duplicating consecutively similar elements; incremental accumulation functions (prefix scan); incremental reordering functions, etc. The class <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Gatherers.html\" rel=\"nofollow noreferrer\"><code>Gatherers</code></a> provides implementations of common gathering operations.</p>\n<p><strong>API Note:</strong></p>\n<p>A <code>Gatherer</code> is specified by four functions that work together to process input elements, optionally using intermediate state, and optionally perform a final action at the end of input. They are:</p>\n<ul>\n<li>creating a new, potentially mutable, state (<a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Gatherer.html#initializer()\" rel=\"nofollow noreferrer\"><code>initializer()</code></a>)</li>\n<li>integrating a new input element (<a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Gatherer.html#integrator()\" rel=\"nofollow noreferrer\"><code>integrator()</code></a>)</li>\n<li>combining two states into one (<a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Gatherer.html#combiner()\" rel=\"nofollow noreferrer\"><code>combiner()</code></a>)</li>\n<li>performing an optional final action (<a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Gatherer.html#finisher()\" rel=\"nofollow noreferrer\"><code>finisher()</code></a>)</li>\n</ul>\n</blockquote>\n<p><a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Stream.html#gather(java.util.stream.Gatherer)\" rel=\"nofollow noreferrer\"><code>Stream.gather(Gatherer&lt;? super T,?,R&gt; gatherer)</code></a>:</p>\n<blockquote>\n<p>Returns a stream consisting of the results of applying the given gatherer to the elements of this stream.</p>\n</blockquote>\n<p><a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/util/stream/Gatherer.html#ofSequential(java.util.function.Supplier,java.util.stream.Gatherer.Integrator)\" rel=\"nofollow noreferrer\"><code>Gatherer.ofSequential(initializer, integrator)</code></a></p>\n<blockquote>\n<p>Returns a new, sequential, <code>Gatherer</code> described by the given <code>initializer</code> and <code>integrator</code>.</p>\n</blockquote>\n"
    },
    {
      "owner": {
        "account_id": 4243811,
        "reputation": 4320,
        "user_id": 3473046,
        "user_type": "registered",
        "accept_rate": 20,
        "profile_image": "https://www.gravatar.com/avatar/ec5f7f91c4ea26caecca55d0ba5a818c?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name": "num&#233;ro6",
        "link": "https://stackoverflow.com/users/3473046/num%c3%a9ro6"
      },
      "is_accepted": false,
      "score": 87,
      "last_activity_date": 1722416249,
      "last_edit_date": 1722416249,
      "creation_date": 1488982974,
      "answer_id": 42673873,
      "question_id": 18552005,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>Since guava 21, you can use</p>\n<pre><code>Streams.mapWithIndex()\n</code></pre>\n<p>Example (from <a href=\"https://guava.dev/releases/21.0/api/docs/com/google/common/collect/Streams.html#mapWithIndex-java.util.stream.Stream-com.google.common.collect.Streams.FunctionWithIndex-\" rel=\"noreferrer\">official doc</a>):</p>\n<pre><code>Streams.mapWithIndex(\n    Stream.of(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;),\n    (str, index) -&gt; str + &quot;:&quot; + index)\n) // will return Stream.of(&quot;a:0&quot;, &quot;b:1&quot;, &quot;c:2&quot;)\n</code></pre>\n"
    },
    {
      "owner": {
        "account_id": 440158,
        "reputation": 330040,
        "user_id": 829571,
        "user_type": "registered",
        "accept_rate": 94,
        "profile_image": "https://i.sstatic.net/zflGZ.png?s=256",
        "display_name": "assylias",
        "link": "https://stackoverflow.com/users/829571/assylias"
      },
      "is_accepted": true,
      "score": 603,
      "last_activity_date": 1722416202,
      "last_edit_date": 1722416202,
      "creation_date": 1377977921,
      "answer_id": 18552071,
      "question_id": 18552005,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>The cleanest way is to start from a stream of indices:</p>\n<pre><code>String[] names = {&quot;Sam&quot;, &quot;Pamela&quot;, &quot;Dave&quot;, &quot;Pascal&quot;, &quot;Erik&quot;};\nIntStream.range(0, names.length)\n         .filter(i -&gt; names[i].length() &lt;= i)\n         .mapToObj(i -&gt; names[i])\n         .collect(Collectors.toList());\n</code></pre>\n<p>The resulting list contains &quot;Erik&quot; only.</p>\n<hr />\n<p>One alternative which looks more familiar when you are used to for loops would be to maintain an ad hoc counter using a mutable object, for example an <code>AtomicInteger</code>:</p>\n<pre><code>String[] names = {&quot;Sam&quot;, &quot;Pamela&quot;, &quot;Dave&quot;, &quot;Pascal&quot;, &quot;Erik&quot;};\nAtomicInteger index = new AtomicInteger();\nList&lt;String&gt; list = Arrays.stream(names)\n                          .filter(n -&gt; n.length() &lt;= index.incrementAndGet())\n                          .collect(Collectors.toList());\n</code></pre>\n<p>Note that <em><strong>using the latter method on a parallel stream could break as the items would not necessarily be processed &quot;in order&quot;</strong></em>.</p>\n"
    },
    {
      "owner": {
        "account_id": 465839,
        "reputation": 6815,
        "user_id": 870207,
        "user_type": "registered",
        "accept_rate": 0,
        "profile_image": "https://www.gravatar.com/avatar/50fa4a2d71492f94030da21388aecd54?s=256&d=identicon&r=PG",
        "display_name": "teknopaul",
        "link": "https://stackoverflow.com/users/870207/teknopaul"
      },
      "is_accepted": false,
      "score": 0,
      "last_activity_date": 1713670357,
      "creation_date": 1713670357,
      "answer_id": 78360309,
      "question_id": 18552005,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>Without a library dependency you can write such an iterator</p>\n<pre><code>public &lt;T&gt; void iterate(List&lt;T&gt; l, BiConsumer&lt;Integer, T&gt; f) {\n    for (int i = 0; i &lt; l.size(); i++) f.accept(i, l.get(i));\n}\n</code></pre>\n<p>Used like this</p>\n<pre><code>iterate(asList(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;), (i, s) -&gt; out.println(i + &quot;: &quot; + s));\n</code></pre>\n"
    }
  ],
  "question_comments": [
    {
      "owner": {
        "account_id": 1719863,
        "reputation": 107,
        "user_id": 1576070,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/7fa57864def20aad1d86f27fdc7f48f1?s=256&d=identicon&r=PG",
        "display_name": "schrepfler",
        "link": "https://stackoverflow.com/users/1576070/schrepfler"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1708614519,
      "post_id": 18552005,
      "comment_id": 137582902,
      "content_license": "CC BY-SA 4.0"
    },
    {
      "owner": {
        "account_id": 156734,
        "reputation": 28057,
        "user_id": 374198,
        "user_type": "registered",
        "accept_rate": 62,
        "profile_image": "https://www.gravatar.com/avatar/29e153bde51f31946ca8c37b5a2bb385?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name": "Josh M.",
        "link": "https://stackoverflow.com/users/374198/josh-m"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1642170179,
      "post_id": 18552005,
      "comment_id": 125006419,
      "content_license": "CC BY-SA 4.0"
    },
    {
      "owner": {
        "account_id": 8488598,
        "reputation": 2514,
        "user_id": 7313872,
        "user_type": "registered",
        "accept_rate": 0,
        "profile_image": "https://i.sstatic.net/SfDZL.jpg?s=256",
        "display_name": "Liam Kernighan",
        "link": "https://stackoverflow.com/users/7313872/liam-kernighan"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1567521063,
      "post_id": 18552005,
      "comment_id": 101982730,
      "content_license": "CC BY-SA 4.0"
    }
  ],
  "answer_comments": {
    "77755077": [],
    "42673873": [
      {
        "owner": {
          "account_id": 3809070,
          "reputation": 18663,
          "user_id": 3160597,
          "user_type": "registered",
          "accept_rate": 47,
          "profile_image": "https://i.sstatic.net/EicHh.jpg?s=256",
          "display_name": "azerafati",
          "link": "https://stackoverflow.com/users/3160597/azerafati"
        },
        "edited": false,
        "score": 1,
        "creation_date": 1715589584,
        "post_id": 42673873,
        "comment_id": 138341140,
        "content_license": "CC BY-SA 4.0"
      }
    ],
    "18552071": [
      {
        "owner": {
          "account_id": 1632921,
          "reputation": 4530,
          "user_id": 1507124,
          "user_type": "registered",
          "profile_image": "https://i.sstatic.net/uX1jp.jpg?s=256",
          "display_name": "CervEd",
          "link": "https://stackoverflow.com/users/1507124/cerved"
        },
        "edited": false,
        "score": 2,
        "creation_date": 1694767514,
        "post_id": 18552071,
        "comment_id": 135937361,
        "content_license": "CC BY-SA 4.0"
      }
    ],
    "78360309": []
  }
}