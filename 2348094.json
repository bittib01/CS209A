{
  "question": {
    "tags": [
      "java",
      "php",
      "sql",
      "mysql",
      "solr"
    ],
    "owner": {
      "user_type": "does_not_exist",
      "display_name": "user188962"
    },
    "is_answered": true,
    "view_count": 32295,
    "accepted_answer_id": 2349744,
    "answer_count": 5,
    "score": 6,
    "last_activity_date": 1764933956,
    "creation_date": 1267288995,
    "last_edit_date": 1267289202,
    "question_id": 2348094,
    "content_license": "CC BY-SA 2.5",
    "link": "https://stackoverflow.com/questions/2348094/how-to-manage-paging-with-solr",
    "title": "How to manage &quot;paging&quot; with Solr?",
    "body": "<p>I have a classifieds website...\nI have Solr doing the searching of the classifieds, and then return ID:nrs which I then use to put into an array. Then I use this array to find any classifieds in a MySql db where the ID:s match the ID:s in the array returned by Solr.</p>\n\n<p>Now, because this array can be very very big (100thousand records or more) then I would need to \"page\" the results so that maybe 100 where returned at a time. And then use those 100 ID:s in MySql to find the classifieds.</p>\n\n<p>So, is it possible to page with SOLR?</p>\n\n<p>And if so, how? I need example code... And what the results would be please.</p>\n\n<p>Mostly I need a thorough example!</p>\n\n<p>Thanks</p>\n"
  },
  "answers": [
    {
      "owner": {
        "account_id": 1685278,
        "reputation": 4113,
        "user_id": 1548719,
        "user_type": "registered",
        "accept_rate": 75,
        "profile_image": "https://www.gravatar.com/avatar/1813d21a5c1bb810e9931dc2b55c15e6?s=256&d=identicon&r=PG",
        "display_name": "Paul T. Rawkeen",
        "link": "https://stackoverflow.com/users/1548719/paul-t-rawkeen"
      },
      "is_accepted": false,
      "score": 13,
      "last_activity_date": 1764933956,
      "last_edit_date": 1764933956,
      "creation_date": 1429876692,
      "answer_id": 29846970,
      "question_id": 2348094,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>There are a lot of helpful answers and recommendations, but I'll try to summarize the results and describe solution for paginating large data sets using <strong>cursor</strong>, because I faced this issue recently.</p>\n<p>As <a href=\"https://stackoverflow.com/questions/2348094/how-to-manage-paging-with-solr/21368980#21368980\">mentioned by Yonik</a> the problem of usual <code>start</code>/<code>rows</code> is that when we have large dataset and <code>start</code> is a bit further (<em>much more further</em>) than zero we have nice overhead in terms of efficiency and memory. It is because fetching of <strong>20</strong> documents from the &quot;middle&quot; of <strong>500K</strong> records + using sorting, at least requires sorting of all dataset (<em>sorting of internal unique's</em>). Moreover, if search is distributed it will be even more resource consuming, because dataset (<em>of 500 020 rows</em>) from each shard should be returned to the aggregator node to be merged, to find out applicable 20 rows.</p>\n<blockquote>\n<p>Solr can't compute which matching document is the 999001st result in sorted order, without first determining what the first 999000 matching sorted results are.</p>\n</blockquote>\n<hr />\n<p>The solution here is to use Solr <a href=\"https://cwiki.apache.org/confluence/display/solr/Pagination+of+Results\" rel=\"nofollow noreferrer\"><code>cursorMark</code></a>.</p>\n<p>On the first query you are announcing that the <code>&amp;cursorMark=*</code>. It means next:</p>\n<blockquote>\n<p>You can think of this being analogous to <code>start=0</code> as a way to tell Solr &quot;<em>start at the beginning of my sorted results</em>&quot; except that it also informs Solr that you want to use a Cursor.</p>\n</blockquote>\n<p><kbd>!</kbd> One &quot;caveat&quot; here is that your <code>sort</code> clauses <strong>must include the uniqueKey</strong> field. It can be <code>id</code> field if it's unique.</p>\n<p>A part of first query will look like this:</p>\n<pre><code>?sort=price desc,id asc&amp;start=0&amp;cursorMark=* ...\n</code></pre>\n<p>As the result you will receive next structure</p>\n<pre><code>{\n    &quot;response&quot;:{&quot;numFound&quot;:20,&quot;start&quot;:0,&quot;docs&quot;:[ /* docs here */ ]},\n    &quot;nextCursorMark&quot;:&quot;AoIIRPoAAFBX&quot; // Here is cursor mark for next &quot;page&quot;\n}\n</code></pre>\n<p>To retrieve the next page, the next query will look next:</p>\n<pre><code>?sort=price desc,id asc&amp;start=0&amp;cursorMark=AoIIRPoAAFBX ...\n</code></pre>\n<p>Notice the <code>cursorMark</code> from previous response. And as the result you will get next page of results (<em>same structure as the first response, but with another <code>nextCursorMarker</code> value</em>). And so on ...</p>\n<p>This approach ideally fits to infinite scroll pagination, but to use it within classic pagination there are some things to think about.</p>\n<p>Here are some reference materials I found solving this problem:</p>\n<ul>\n<li><a href=\"https://cwiki.apache.org/confluence/display/solr/Pagination+of+Results\" rel=\"nofollow noreferrer\">Pagination of results</a></li>\n<li><a href=\"http://yonik.com/solr/paging-and-deep-paging/\" rel=\"nofollow noreferrer\">Sorting, Paging, and Deep Paging in Solr</a> (the <a href=\"https://stackoverflow.com/users/654209/yonik\"><strong>Yonik</strong>'s</a> material) (<em>Thanks a lot!</em>)</li>\n<li><a href=\"https://lucidworks.com/blog/coming-soon-to-solr-efficient-cursor-based-iteration-of-large-result-sets/\" rel=\"nofollow noreferrer\">Efficient Cursor Based Iteration of Large Result Sets</a></li>\n</ul>\n"
    }
  ],
  "question_comments": [],
  "answer_comments": {
    "29846970": [
      {
        "owner": {
          "account_id": 1685278,
          "reputation": 4113,
          "user_id": 1548719,
          "user_type": "registered",
          "accept_rate": 75,
          "profile_image": "https://www.gravatar.com/avatar/1813d21a5c1bb810e9931dc2b55c15e6?s=256&d=identicon&r=PG",
          "display_name": "Paul T. Rawkeen",
          "link": "https://stackoverflow.com/users/1548719/paul-t-rawkeen"
        },
        "reply_to_user": {
          "account_id": 1918972,
          "reputation": 1254,
          "user_id": 1730904,
          "user_type": "registered",
          "profile_image": "https://www.gravatar.com/avatar/3ef7b0963b0f73a3259f402492ef203e?s=256&d=identicon&r=PG",
          "display_name": "yallam",
          "link": "https://stackoverflow.com/users/1730904/yallam"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1534927993,
        "post_id": 29846970,
        "comment_id": 90876362,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 1918972,
          "reputation": 1254,
          "user_id": 1730904,
          "user_type": "registered",
          "profile_image": "https://www.gravatar.com/avatar/3ef7b0963b0f73a3259f402492ef203e?s=256&d=identicon&r=PG",
          "display_name": "yallam",
          "link": "https://stackoverflow.com/users/1730904/yallam"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1534776956,
        "post_id": 29846970,
        "comment_id": 90816864,
        "content_license": "CC BY-SA 4.0"
      }
    ]
  }
}