{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-el"
    ],
    "owner": {
      "account_id": 35375431,
      "reputation": 43,
      "user_id": 27167673,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/de31a37798720c4fc1698e886a943496?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Manas Ranjan Das",
      "link": "https://stackoverflow.com/users/27167673/manas-ranjan-das"
    },
    "is_answered": true,
    "view_count": 94,
    "accepted_answer_id": 79830533,
    "answer_count": 1,
    "score": 2,
    "last_activity_date": 1764237438,
    "creation_date": 1764142761,
    "last_edit_date": 1764237438,
    "question_id": 79830440,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79830440/force-full-expression-evaluation-or-disable-short-circuiting-logic-in-spel-expre",
    "title": "Force full expression evaluation or disable short-circuiting logic in SpEL expressions",
    "body": "<p>I am working on an application where it dynamically generates and executes some Spring Expression Language (SpEL) expressions.</p>\n<p>I am facing a few performance issues, and after tracking it down a bit, I found out it was happening because the SpEL compiler refuses to compile an expression if the whole thing hasn't been run normally (this part is expected). In my case this was happening because of a logical operator.</p>\n<p>I noticed that in case of logical or <code>( || )</code></p>\n<ol>\n<li>when you use a logical <code>( || )</code> operator separating two expressions in SpEL.</li>\n<li>The first half of the expression is true most of the time; the second half doesn't execute.</li>\n<li>This leads to the compiler not having enough info about the second half of the expression to compile it.</li>\n</ol>\n<p>Similarly for logical <code>( &amp;&amp; )</code> if the first half is <code>false</code>.</p>\n<p>I have a minimal example of this behavior.</p>\n<pre class=\"lang-java prettyprint-override\"><code>package org.example;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.expression.Expression;\nimport org.springframework.expression.ExpressionParser;\nimport org.springframework.expression.spel.SpelCompilerMode;\nimport org.springframework.expression.spel.SpelParserConfiguration;\nimport org.springframework.expression.spel.standard.SpelExpressionParser;\nimport org.springframework.expression.spel.support.StandardEvaluationContext;\nimport org.springframework.scheduling.annotation.EnableAsync;\n\n\n@EnableAsync\n@Configuration\n@SpringBootApplication\npublic class Main {\n    public static void main(String[] args) {\n        SpringApplication.run(Main.class, args);\n        ExpressionParser parser = new SpelExpressionParser(\n                new SpelParserConfiguration(SpelCompilerMode.IMMEDIATE, Main.class.getClassLoader())\n        );\n\n        Expression expression = parser.parseExpression(&quot;(#var1) || (#var2)&quot;);\n\n        StandardEvaluationContext context = new StandardEvaluationContext();\n\n\n        for (int i = 0; i &lt; 10000; i++) {\n            context.setVariable(&quot;var1&quot;, true);\n            context.setVariable(&quot;var2&quot;, false);\n            expression.getValue(context, Object.class);\n        }\n\n        System.out.println(&quot;End&quot;);\n    }\n}\n</code></pre>\n<p>If you have</p>\n<pre class=\"lang-ini prettyprint-override\"><code>logging.level.org.springframework.expression=TRACE\n</code></pre>\n<p>You will see the logs say</p>\n<pre class=\"lang-none prettyprint-override\"><code>2025-11-26T12:58:18.891+05:30 DEBUG 20156 --- [           main] o.s.e.spel.standard.SpelCompiler         : SpEL: unable to compile (#var1 or #var2)\n2025-11-26T12:58:18.891+05:30 DEBUG 20156 --- [           main] o.s.e.spel.standard.SpelCompiler         : SpEL: unable to compile (#var1 or #var2)\n2025-11-26T12:58:18.891+05:30 DEBUG 20156 --- [           main] o.s.e.spel.standard.SpelCompiler         : SpEL: unable to compile (#var1 or #var2)\n2025-11-26T12:58:18.891+05:30 DEBUG 20156 --- [           main] o.s.e.spel.standard.SpelCompiler         : SpEL: unable to compile (#var1 or #var2)\n2025-11-26T12:58:18.891+05:30 DEBUG 20156 --- [           main] o.s.e.spel.standard.SpelCompiler         : SpEL: unable to compile (#var1 or #var2)\n2025-11-26T12:58:18.891+05:30 DEBUG 20156 --- [           main] o.s.e.spel.standard.SpelCompiler         : SpEL: unable to compile (#var1 or #var2)\n2025-11-26T12:58:18.891+05:30 DEBUG 20156 --- [           main] o.s.e.spel.standard.SpelCompiler         : SpEL: unable to compile (#var1 or #var2)\nEnd\n</code></pre>\n<p>But if <code>var1</code> is <code>false</code> or sometimes <code>false</code>, the expression gets compiled.</p>\n<p>Are there ways to write the expressions so that both halves are computed and thus the expression gets compiled? Or any other workarounds?</p>\n"
  },
  "answers": [
    {
      "owner": {
        "account_id": 5569841,
        "reputation": 8664,
        "user_id": 4415625,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/0ea1713807527aa1cf52e40579e35ec4?s=256&d=identicon&r=PG",
        "display_name": "dani-vta",
        "link": "https://stackoverflow.com/users/4415625/dani-vta"
      },
      "is_accepted": true,
      "score": 1,
      "last_activity_date": 1764150626,
      "creation_date": 1764150626,
      "answer_id": 79830533,
      "question_id": 79830440,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>Unfortunately, SpEL does not provide a way to disable short-circuit evaluation for logical operators. This behavior is built into the SpEL implementation and cannot be altered through configuration or parser options.</p>\n<p>However, if you need both expressions to always be evaluated, you could define a service class <code>MyExprEvaluator</code>, and pass the expressions to a method so they can be evaluated individually. SpEL can then call that method instead of evaluating a logical expression, externalizing the short-circuiting logic outside the language.</p>\n<p>Your code would be something like</p>\n<pre class=\"lang-java prettyprint-override\"><code>parser.parseExpression(&quot;'myExprEvaluator.evaluate('expr1', 'expr2')&quot;)\n</code></pre>\n"
    }
  ],
  "question_comments": [
    {
      "owner": {
        "account_id": 213468,
        "reputation": 110279,
        "user_id": 466862,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=256&d=identicon&r=PG",
        "display_name": "Mark Rotteveel",
        "link": "https://stackoverflow.com/users/466862/mark-rotteveel"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1764237285,
      "post_id": 79830440,
      "comment_id": 140875879,
      "content_license": "CC BY-SA 4.0"
    },
    {
      "owner": {
        "account_id": 5569841,
        "reputation": 8664,
        "user_id": 4415625,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/0ea1713807527aa1cf52e40579e35ec4?s=256&d=identicon&r=PG",
        "display_name": "dani-vta",
        "link": "https://stackoverflow.com/users/4415625/dani-vta"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1764149598,
      "post_id": 79830440,
      "comment_id": 140873838,
      "content_license": "CC BY-SA 4.0"
    },
    {
      "owner": {
        "account_id": 35375431,
        "reputation": 43,
        "user_id": 27167673,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/de31a37798720c4fc1698e886a943496?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name": "Manas Ranjan Das",
        "link": "https://stackoverflow.com/users/27167673/manas-ranjan-das"
      },
      "reply_to_user": {
        "account_id": 5569841,
        "reputation": 8664,
        "user_id": 4415625,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/0ea1713807527aa1cf52e40579e35ec4?s=256&d=identicon&r=PG",
        "display_name": "dani-vta",
        "link": "https://stackoverflow.com/users/4415625/dani-vta"
      },
      "edited": false,
      "score": 1,
      "creation_date": 1764148745,
      "post_id": 79830440,
      "comment_id": 140873816,
      "content_license": "CC BY-SA 4.0"
    },
    {
      "owner": {
        "account_id": 5569841,
        "reputation": 8664,
        "user_id": 4415625,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/0ea1713807527aa1cf52e40579e35ec4?s=256&d=identicon&r=PG",
        "display_name": "dani-vta",
        "link": "https://stackoverflow.com/users/4415625/dani-vta"
      },
      "edited": false,
      "score": 1,
      "creation_date": 1764144909,
      "post_id": 79830440,
      "comment_id": 140873704,
      "content_license": "CC BY-SA 4.0"
    },
    {
      "owner": {
        "account_id": 5569841,
        "reputation": 8664,
        "user_id": 4415625,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/0ea1713807527aa1cf52e40579e35ec4?s=256&d=identicon&r=PG",
        "display_name": "dani-vta",
        "link": "https://stackoverflow.com/users/4415625/dani-vta"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1764144330,
      "post_id": 79830440,
      "comment_id": 140873692,
      "content_license": "CC BY-SA 4.0"
    }
  ],
  "answer_comments": {
    "79830533": []
  }
}