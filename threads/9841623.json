{
  "question": {
    "tags": [
      "java",
      "unit-testing",
      "junit",
      "mockito"
    ],
    "owner": {
      "account_id": 285919,
      "reputation": 44364,
      "user_id": 584862,
      "user_type": "registered",
      "accept_rate": 93,
      "profile_image": "https://www.gravatar.com/avatar/d718e680424ef02162271a6d825f252b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "mre",
      "link": "https://stackoverflow.com/users/584862/mre"
    },
    "is_answered": true,
    "view_count": 1040617,
    "accepted_answer_id": 9841929,
    "answer_count": 9,
    "score": 510,
    "last_activity_date": 1732903441,
    "creation_date": 1332515371,
    "question_id": 9841623,
    "content_license": "CC BY-SA 3.0",
    "link": "https://stackoverflow.com/questions/9841623/mockito-how-to-verify-method-was-called-on-an-object-created-within-a-method",
    "title": "Mockito : how to verify method was called on an object created within a method?",
    "body": "<p>I am new to Mockito.</p>\n\n<p>Given the class below, how can I use Mockito to verify that <code>someMethod</code> was invoked exactly once after <code>foo</code> was invoked?</p>\n\n<pre><code>public class Foo\n{\n    public void foo(){\n        Bar bar = new Bar();\n        bar.someMethod();\n    }\n}\n</code></pre>\n\n<p>I would like to make the following verification call,</p>\n\n<pre><code>verify(bar, times(1)).someMethod();\n</code></pre>\n\n<p>where <code>bar</code> is a mocked instance of <code>Bar</code>.</p>\n"
  },
  "answers": [
    {
      "owner": {
        "account_id": 19413575,
        "reputation": 542,
        "user_id": 14197561,
        "user_type": "registered",
        "profile_image": "https://lh5.googleusercontent.com/-69PiJhJuoDM/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclsLkB8pJ87JwfIxWuTRFCwiqpN8w/s256-rj/photo.jpg",
        "display_name": "Aleksandr Baklanov",
        "link": "https://stackoverflow.com/users/14197561/aleksandr-baklanov"
      },
      "is_accepted": false,
      "score": 0,
      "last_activity_date": 1732903441,
      "last_edit_date": 1732903441,
      "creation_date": 1732288687,
      "answer_id": 79215572,
      "question_id": 9841623,
      "content_license": "CC BY-SA 4.0",
      "body": "<p><a href=\"https://javadoc.io/static/org.mockito/mockito-core/5.14.2/org/mockito/Mockito.html#49\" rel=\"nofollow noreferrer\">Mocking object construction</a> with Mockito is possible since the version 3.5.0.<br />\nA test example for classes from the question:</p>\n<pre class=\"lang-none prettyprint-override\"><code>@Test\npublic void barTest() {\n    try (MockedConstruction&lt;Bar&gt; barConstructionMock = mockConstruction(Bar.class)) {\n        new Foo().foo();\n\n        List&lt;Bar&gt; constructedBars = barConstructionMock.constructed();\n        assertEquals(1, constructedBars.size());\n        Bar barMock = constructedBars.get(0);\n        verify(barMock, times(1)).someMethod();\n    }\n}\n</code></pre>\n"
    },
    {
      "owner": {
        "account_id": 1518433,
        "reputation": 1037,
        "user_id": 1418838,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/bc5bc9be4830587c86f502a37d85d67a?s=256&d=identicon&r=PG",
        "display_name": "Haakon L&#248;tveit",
        "link": "https://stackoverflow.com/users/1418838/haakon-l%c3%b8tveit"
      },
      "is_accepted": false,
      "score": 5,
      "last_activity_date": 1703832536,
      "last_edit_date": 1703832536,
      "creation_date": 1646904899,
      "answer_id": 71421838,
      "question_id": 9841623,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>I had this very issue today, and I didn't want to use PowerMock or other stuff. I just wanted to make a test that made sure a certain method was called. I found this post and I saw that nobody had mentioned this approach.</p>\n<p>One way of achieving this without adding in more dependencies or similar is pretty low tech, but it works:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Test\npublic void testSomeMethodIsCalledOnce() throws Exception {\n    final AtomicInteger counter = new AtomicInteger(0);\n    Mockito.when(someObject.theMethodIWant(anyString()))\n        .then((Answer&lt;ReturnValue&gt;) __ -&gt; {\n            counter.incrementAndGet();\n            return theExpectedAnswer;\n        });\n    theObjectUnderTest.theMethod(someTestValue);\n\n    assertEquals(1, counter.get());\n}\n</code></pre>\n<p>This is pretty simple, and it's easy to see what's going on. When the method I want is called (it's mocked here), do this stuff. Amongst the stuff is a call to incrementAndGet for the AtomicInteger. You <em>could</em> use an int[] here, but that's not as clear in my opinion. We're just using something that's final, which we can increment. That's a limitation of the lambda we're using.</p>\n<p>It's a bit crude, but it gets the job done in a simple and straightforward matter. At least if you know your lambdas and Mockito.</p>\n"
    }
  ],
  "question_comments": [
    {
      "owner": {
        "account_id": 19413575,
        "reputation": 542,
        "user_id": 14197561,
        "user_type": "registered",
        "profile_image": "https://lh5.googleusercontent.com/-69PiJhJuoDM/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclsLkB8pJ87JwfIxWuTRFCwiqpN8w/s256-rj/photo.jpg",
        "display_name": "Aleksandr Baklanov",
        "link": "https://stackoverflow.com/users/14197561/aleksandr-baklanov"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1732900637,
      "post_id": 9841623,
      "comment_id": 139726735,
      "content_license": "CC BY-SA 4.0"
    },
    {
      "owner": {
        "account_id": 5605957,
        "reputation": 939,
        "user_id": 4440561,
        "user_type": "registered",
        "profile_image": "https://i.sstatic.net/okLyu.jpg?s=256",
        "display_name": "ShAkKiR",
        "link": "https://stackoverflow.com/users/4440561/shakkir"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1534428248,
      "post_id": 9841623,
      "comment_id": 90709276,
      "content_license": "CC BY-SA 4.0"
    }
  ],
  "answer_comments": {
    "79215572": [],
    "71421838": []
  }
}