{
  "question": {
    "tags": [
      "java",
      "spring-mvc",
      "orm",
      "jackson",
      "circular-reference"
    ],
    "owner": {
      "account_id": 99208,
      "reputation": 9813,
      "user_id": 268098,
      "user_type": "registered",
      "accept_rate": 86,
      "profile_image": "https://www.gravatar.com/avatar/f35bbcfb7af6ab5f7c24499f70c8e7d3?s=256&d=identicon&r=PG",
      "display_name": "Ta Sas",
      "link": "https://stackoverflow.com/users/268098/ta-sas"
    },
    "is_answered": true,
    "view_count": 471917,
    "protected_date": 1718464348,
    "accepted_answer_id": 3329629,
    "answer_count": 30,
    "score": 561,
    "last_activity_date": 1751230497,
    "creation_date": 1279980035,
    "last_edit_date": 1730886703,
    "question_id": 3325387,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/3325387/infinite-recursion-with-jackson-json-and-hibernate-jpa-issue",
    "title": "Infinite Recursion with Jackson JSON and Hibernate JPA issue",
    "body": "<p>When trying to convert a JPA object that has a bi-directional association into JSON, I keep getting</p>\n<pre><code>org.codehaus.jackson.map.JsonMappingException: Infinite recursion (StackOverflowError)\n</code></pre>\n<p>All I found is <a href=\"http://forum.springsource.org/showthread.php?t=88803\" rel=\"noreferrer\">this thread</a> which basically concludes with recommending to avoid bi-directional associations. Does anyone have an idea for  a workaround for this spring bug?</p>\n<p>------ EDIT 2010-07-24 16:26:22 -------</p>\n<p>Codesnippets:</p>\n<p>Business Object 1:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Entity\n@Table(name = &quot;ta_trainee&quot;, uniqueConstraints = {@UniqueConstraint(columnNames = {&quot;id&quot;})})\npublic class Trainee extends BusinessObject {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.TABLE)\n    @Column(name = &quot;id&quot;, nullable = false)\n    private Integer id;\n\n    @Column(name = &quot;name&quot;, nullable = true)\n    private String name;\n\n    @Column(name = &quot;surname&quot;, nullable = true)\n    private String surname;\n\n    @OneToMany(mappedBy = &quot;trainee&quot;, fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    @Column(nullable = true)\n    private Set&lt;BodyStat&gt; bodyStats;\n\n    @OneToMany(mappedBy = &quot;trainee&quot;, fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    @Column(nullable = true)\n    private Set&lt;Training&gt; trainings;\n\n    @OneToMany(mappedBy = &quot;trainee&quot;, fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    @Column(nullable = true)\n    private Set&lt;ExerciseType&gt; exerciseTypes;\n\n    public Trainee() {\n        super();\n    }\n\n    //... getters/setters ...\n}\n</code></pre>\n<p>Business Object 2:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import javax.persistence.*;\nimport java.util.Date;\n\n@Entity\n@Table(name = &quot;ta_bodystat&quot;, uniqueConstraints = {@UniqueConstraint(columnNames = {&quot;id&quot;})})\npublic class BodyStat extends BusinessObject {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.TABLE)\n    @Column(name = &quot;id&quot;, nullable = false)\n    private Integer id;\n\n    @Column(name = &quot;height&quot;, nullable = true)\n    private Float height;\n\n    @Column(name = &quot;measuretime&quot;, nullable = false)\n    @Temporal(TemporalType.TIMESTAMP)\n    private Date measureTime;\n\n    @ManyToOne(fetch = FetchType.EAGER, cascade = CascadeType.ALL)\n    @JoinColumn(name=&quot;trainee_fk&quot;)\n    private Trainee trainee;\n}\n</code></pre>\n<p>Controller:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.ui.Model;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RequestMethod;\nimport org.springframework.web.bind.annotation.ResponseBody;\n\nimport javax.servlet.http.HttpServletResponse;\nimport javax.validation.ConstraintViolation;\nimport java.util.*;\nimport java.util.concurrent.ConcurrentHashMap;\n\n@Controller\n@RequestMapping(value = &quot;/trainees&quot;)\npublic class TraineesController {\n\n    final Logger logger = LoggerFactory.getLogger(TraineesController.class);\n\n    private Map&lt;Long, Trainee&gt; trainees = new ConcurrentHashMap&lt;Long, Trainee&gt;();\n\n    @Autowired\n    private ITraineeDAO traineeDAO;\n     \n    /**\n     * Return json repres. of all trainees\n     */\n    @RequestMapping(value = &quot;/getAllTrainees&quot;, method = RequestMethod.GET)\n    @ResponseBody        \n    public Collection getAllTrainees() {\n        Collection allTrainees = this.traineeDAO.getAll();\n\n        this.logger.debug(&quot;A total of &quot; + allTrainees.size() + &quot;  trainees was read from db&quot;);\n\n        return allTrainees;\n    }    \n}\n</code></pre>\n<p>JPA-implementation of the trainee DAO:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Repository\n@Transactional\npublic class TraineeDAO implements ITraineeDAO {\n\n    @PersistenceContext\n    private EntityManager em;\n\n    @Transactional\n    public Trainee save(Trainee trainee) {\n        em.persist(trainee);\n        return trainee;\n    }\n\n    @Transactional(readOnly = true)\n    public Collection getAll() {\n        return (Collection) em.createQuery(&quot;SELECT t FROM Trainee t&quot;).getResultList();\n    }\n}\n</code></pre>\n<p>persistence.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;persistence xmlns=&quot;http://java.sun.com/xml/ns/persistence&quot;\n             xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n             xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd&quot;\n             version=&quot;1.0&quot;&gt;\n    &lt;persistence-unit name=&quot;RDBMS&quot; transaction-type=&quot;RESOURCE_LOCAL&quot;&gt;\n        &lt;exclude-unlisted-classes&gt;false&lt;/exclude-unlisted-classes&gt;\n        &lt;properties&gt;\n            &lt;property name=&quot;hibernate.hbm2ddl.auto&quot; value=&quot;validate&quot;/&gt;\n            &lt;property name=&quot;hibernate.archive.autodetection&quot; value=&quot;class&quot;/&gt;\n            &lt;property name=&quot;dialect&quot; value=&quot;org.hibernate.dialect.MySQL5InnoDBDialect&quot;/&gt;\n            &lt;!-- &lt;property name=&quot;dialect&quot; value=&quot;org.hibernate.dialect.HSQLDialect&quot;/&gt;         --&gt;\n        &lt;/properties&gt;\n    &lt;/persistence-unit&gt;\n&lt;/persistence&gt;\n</code></pre>\n"
  },
  "answers": [
    {
      "owner": {
        "account_id": 1201625,
        "reputation": 6905,
        "user_id": 1172174,
        "user_type": "registered",
        "accept_rate": 80,
        "profile_image": "https://i.sstatic.net/5vijs.jpg?s=256",
        "display_name": "Gus",
        "link": "https://stackoverflow.com/users/1172174/gus"
      },
      "is_accepted": false,
      "score": 0,
      "last_activity_date": 1751230497,
      "creation_date": 1751230497,
      "answer_id": 79684049,
      "question_id": 3325387,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>It seems a shame nobody has mentioned <a href=\"https://github.com/jsog/jsog-jackson\" rel=\"nofollow noreferrer\">https://github.com/jsog/jsog-jackson</a> yet. It implements JSON Object Graph format aka <a href=\"https://github.com/jsog/jsog\" rel=\"nofollow noreferrer\">JSOG</a>. JSOG handles arbitrary graphs including circular references of any length (subject to Jackson's object <a href=\"https://github.com/FasterXML/jackson-core/blob/2.x/src/main/java/com/fasterxml/jackson/core/StreamWriteConstraints.java#L29\" rel=\"nofollow noreferrer\">nesting depth</a> of course)</p>\n"
    }
  ],
  "question_comments": [
    {
      "owner": {
        "account_id": 15539213,
        "reputation": 366,
        "user_id": 11210547,
        "user_type": "registered",
        "profile_image": "https://lh4.googleusercontent.com/-BLMqcVJ2f-0/AAAAAAAAAAI/AAAAAAAAABA/zLeb2d-HCkE/s256-rj/photo.jpg",
        "display_name": "P&#233;ter Bar&#225;th",
        "link": "https://stackoverflow.com/users/11210547/p%c3%a9ter-bar%c3%a1th"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1651587696,
      "post_id": 3325387,
      "comment_id": 127395401,
      "content_license": "CC BY-SA 4.0"
    },
    {
      "owner": {
        "account_id": 4802848,
        "reputation": 2704,
        "user_id": 3878948,
        "user_type": "registered",
        "accept_rate": 86,
        "profile_image": "https://i.sstatic.net/PnwCL.jpg?s=256",
        "display_name": "Rishabh Agarwal",
        "link": "https://stackoverflow.com/users/3878948/rishabh-agarwal"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1541185593,
      "post_id": 3325387,
      "comment_id": 93143680,
      "content_license": "CC BY-SA 4.0"
    }
  ],
  "answer_comments": {
    "79684049": [
      {
        "owner": {
          "account_id": 1201625,
          "reputation": 6905,
          "user_id": 1172174,
          "user_type": "registered",
          "accept_rate": 80,
          "profile_image": "https://i.sstatic.net/5vijs.jpg?s=256",
          "display_name": "Gus",
          "link": "https://stackoverflow.com/users/1172174/gus"
        },
        "reply_to_user": {
          "account_id": 31180,
          "reputation": 29752,
          "user_id": 85421,
          "user_type": "registered",
          "profile_image": "https://i.sstatic.net/kKvXH.gif?s=256",
          "display_name": "user85421",
          "link": "https://stackoverflow.com/users/85421/user85421"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1762956988,
        "post_id": 79684049,
        "comment_id": 140850571,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 31180,
          "reputation": 29752,
          "user_id": 85421,
          "user_type": "registered",
          "profile_image": "https://i.sstatic.net/kKvXH.gif?s=256",
          "display_name": "user85421",
          "link": "https://stackoverflow.com/users/85421/user85421"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1758132620,
        "post_id": 79684049,
        "comment_id": 140743118,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 1201625,
          "reputation": 6905,
          "user_id": 1172174,
          "user_type": "registered",
          "accept_rate": 80,
          "profile_image": "https://i.sstatic.net/5vijs.jpg?s=256",
          "display_name": "Gus",
          "link": "https://stackoverflow.com/users/1172174/gus"
        },
        "reply_to_user": {
          "account_id": 31180,
          "reputation": 29752,
          "user_id": 85421,
          "user_type": "registered",
          "profile_image": "https://i.sstatic.net/kKvXH.gif?s=256",
          "display_name": "user85421",
          "link": "https://stackoverflow.com/users/85421/user85421"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1758129173,
        "post_id": 79684049,
        "comment_id": 140742983,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 31180,
          "reputation": 29752,
          "user_id": 85421,
          "user_type": "registered",
          "profile_image": "https://i.sstatic.net/kKvXH.gif?s=256",
          "display_name": "user85421",
          "link": "https://stackoverflow.com/users/85421/user85421"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1751266176,
        "post_id": 79684049,
        "comment_id": 140552272,
        "content_license": "CC BY-SA 4.0"
      }
    ]
  }
}