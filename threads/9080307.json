{
  "question": {
    "tags": [
      "java",
      "android",
      "design-patterns"
    ],
    "owner": {
      "account_id": 91576,
      "reputation": 2158,
      "user_id": 251369,
      "user_type": "registered",
      "accept_rate": 56,
      "profile_image": "https://www.gravatar.com/avatar/5e85d79c4d7bbe9f7e51305b100351cf?s=256&d=identicon&r=PG",
      "display_name": "k_shil",
      "link": "https://stackoverflow.com/users/251369/k-shil"
    },
    "is_answered": false,
    "view_count": 315,
    "answer_count": 0,
    "score": 1,
    "last_activity_date": 1764531972,
    "creation_date": 1328016463,
    "last_edit_date": 1764531972,
    "question_id": 9080307,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/9080307/design-pattern-for-activity-state-controll",
    "title": "Design pattern for activity state controll",
    "body": "<p>I have an activity which contain several fragments and views. When I started working on my app the activity had several states which I changed throw click listeners in fragments and views.</p>\n<p>Currently the code grew up to &gt;1.5k lines and I realize that I need to introduce some pattern to make it maintainable.\nThe problem is that when I change my activity's property I need to change layout in several fragments or views.</p>\n<p>For example I have a handler which listens to network response:</p>\n<pre class=\"lang-java prettyprint-override\"><code>    //Handler to process messages from VendorCache\n        private Handler vendorCacheHandler = new Handler(){\n            @Override\n              public void handleMessage(Message msg) {\n                if(msg.what == VendorCache.RECEIVED_OPTIONS){\n                    \n                    String id = (String)msg.obj;\n                    \n                    vendorOptionsManager = new VendorOptionsManager(id);\n                    \n                    detailsPagerAdapter.updateOptions(vendorOptionsManager.isPickupTime(), vendorOptionsManager.hasOptions());\n                    \n                    //Update Optional/Required labels\n                    updateDestinationReqs();\n                    \n                    //Enable/disable quote button depending on the pickupSite and booking options\n                    checkQuoteStateAndUpdate();\n                    \n                    if(pendingOrderOptions != null &amp;&amp; pendingOrderOptions.size() &gt; 0 &amp;&amp; vendorOptionsManager != null){                      \n                        //Spinner is hidden and options are populated with new values\n                        detailsPagerAdapter.updateOptionsView(VendorUtils.getReadableString(pendingOrderOptions,vendorOptionsManager.getAllOptions()), getResources().getColor(R.color.default_color_main));\n                    }\n                    \n                }\n                else if(msg.what == VendorCache.MALFORMED_ID || msg.what == VendorCache.REQUEST_FAILED){\n                    vendorOptionsManager = null;\n                    \n                    //Update Optional/Required labels\n                    updateDestinationReqs();\n\n\n                    \n                    //Enable quote button\n                    taskBar.setQuoteEnabled(true);\n                    \n                    //Disable any options\n                    detailsPagerAdapter.updateOptions(false, false);\n                }\n                \n            }\n        };\n</code></pre>\n<p>As you can see methods in handler change layout in views or fragment. Drawback is that I need to call the same methods with different params depending on the response. Similar situation occurs for other activity properties.</p>\n<p>I am not saying that my activity is overloaded with views. I am saying that I have several properties that are interconnected. For example if property A=true and B= true then C=&quot;required&quot; or if A=true and B = false then C = &quot;optional&quot; etc. Because of that I have a lot of calls to similar methods.</p>\n<p>I am thinking of introducing <code>ActivityStateController</code> class which will implement Observer pattern. This will allow me to hide state management inside views and fragments. But I still doubt about that(e.g. what to do to show progress in views?)</p>\n<p>What are the ways to manage complex activity state? Is there something similar to key value coding in Android or Java?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}