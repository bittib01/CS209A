{
  "question": {
    "tags": [
      "java",
      "multithreading",
      "atomicreference"
    ],
    "owner": {
      "account_id": 660315,
      "reputation": 4723,
      "user_id": 479889,
      "user_type": "unregistered",
      "profile_image": "https://www.gravatar.com/avatar/5db66e8d9fc1dcf4fa8371229a812fa6?s=256&d=identicon&r=PG",
      "display_name": "Chintu",
      "link": "https://stackoverflow.com/users/479889/chintu"
    },
    "is_answered": true,
    "view_count": 344663,
    "accepted_answer_id": 3964249,
    "answer_count": 7,
    "score": 472,
    "last_activity_date": 1691675539,
    "creation_date": 1287443724,
    "last_edit_date": 1620834896,
    "question_id": 3964211,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/3964211/when-to-use-atomicreference-in-java",
    "title": "When to use AtomicReference in Java?",
    "body": "<p>When do we use <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/concurrent/atomic/AtomicReference.html\" rel=\"noreferrer\"><code>AtomicReference</code></a>?</p>\n\n<p>Is it needed to create objects in all multithreaded programs?</p>\n\n<p>Provide a simple example where AtomicReference should be used.</p>\n"
  },
  "answers": [
    {
      "owner": {
        "account_id": 30659,
        "reputation": 23062,
        "user_id": 83695,
        "user_type": "registered",
        "accept_rate": 86,
        "profile_image": "https://www.gravatar.com/avatar/e785c64da9b13708acdff0642db273f2?s=256&d=identicon&r=PG",
        "display_name": "andersoj",
        "link": "https://stackoverflow.com/users/83695/andersoj"
      },
      "is_accepted": true,
      "score": 310,
      "last_activity_date": 1691675539,
      "last_edit_date": 1691675539,
      "creation_date": 1287444168,
      "answer_id": 3964249,
      "question_id": 3964211,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>Atomic reference should be used in a setting where you need to do simple <em>atomic</em> (i.e. <a href=\"https://en.wikipedia.org/wiki/Thread_safety\" rel=\"noreferrer\"><em>thread-safe</em></a>, non-trivial) operations on a reference, for which monitor-based synchronization is not appropriate. Suppose you want to set a specific field only if the state of the object has changed during processing:</p>\n<pre><code>AtomicReference&lt;Object&gt; cache = new AtomicReference&lt;Object&gt;();\n\nObject cachedValue = new Object();\ncache.set(cachedValue);\n\n//... time passes ...\nObject cachedValueToUpdate = cache.get();\n//... do some work to transform cachedValueToUpdate into a new version\nObject newValue = someFunctionOfOld(cachedValueToUpdate);\nboolean success = cache.compareAndSet(cachedValue,newValue);\n</code></pre>\n<p>Because of the atomic reference semantics, you can do this even if the <code>cache</code> object is shared amongst threads, without using <code>synchronized</code>. In general, you're better off using synchronizers or the <code>java.util.concurrent</code> framework rather than bare <code>Atomic*</code> unless you know what you're doing.</p>\n<p>Two excellent dead-tree references which will introduce you to this topic:</p>\n<ul>\n<li><a href=\"https://rads.stackoverflow.com/amzn/click/com/0123705916\" rel=\"noreferrer\" rel=\"nofollow noreferrer\">Herlihy's excellent <em>Art of Multiprocessor Programming</em></a></li>\n<li><a href=\"http://www.javaconcurrencyinpractice.com/\" rel=\"noreferrer\"><em>Java Concurrency in Practice</em></a></li>\n</ul>\n<p>Note that (I don't know if this has always been true) <em>reference</em> assignment (i.e. <code>=</code>) is itself atomic (updating <em>primitive</em> 64-bit types like <code>long</code> or <code>double</code> may not be atomic; but updating a <em>reference</em> is always atomic, even if it's 64 bit) without explicitly using an <code>Atomic*</code>.<br />\nSee the <a href=\"https://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.7\" rel=\"noreferrer\">Java Language Specification 3ed, <strong>Section 17.7</strong></a>.</p>\n"
    }
  ],
  "question_comments": [],
  "answer_comments": {
    "3964249": [
      {
        "owner": {
          "account_id": 10074708,
          "reputation": 1922,
          "user_id": 7447228,
          "user_type": "registered",
          "accept_rate": 0,
          "profile_image": "https://www.gravatar.com/avatar/0379f816b8e55e6498b7611dbfb4bab9?s=256&d=identicon&r=PG&f=y&so-version=2",
          "display_name": "Ekaterina",
          "link": "https://stackoverflow.com/users/7447228/ekaterina"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1636802543,
        "post_id": 3964249,
        "comment_id": 123657606,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 952653,
          "reputation": 9305,
          "user_id": 978502,
          "user_type": "registered",
          "accept_rate": 67,
          "profile_image": "https://i.sstatic.net/ljiCK.png?s=256",
          "display_name": "yair",
          "link": "https://stackoverflow.com/users/978502/yair"
        },
        "edited": false,
        "score": 3,
        "creation_date": 1629930543,
        "post_id": 3964249,
        "comment_id": 121820839,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 345216,
          "reputation": 474,
          "user_id": 677989,
          "user_type": "registered",
          "accept_rate": 67,
          "profile_image": "https://i.sstatic.net/mYReX.jpg?s=256",
          "display_name": "haikalpribadi",
          "link": "https://stackoverflow.com/users/677989/haikalpribadi"
        },
        "reply_to_user": {
          "account_id": 20241962,
          "reputation": 61,
          "user_id": 15168851,
          "user_type": "registered",
          "profile_image": "https://lh3.googleusercontent.com/-syX52gstiX8/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmCCWsyDsuvLKSFWDi56M_LC9yObQ/s96-c/s256-rj/photo.jpg",
          "display_name": "Mark",
          "link": "https://stackoverflow.com/users/15168851/mark"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1625772542,
        "post_id": 3964249,
        "comment_id": 120723774,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 345216,
          "reputation": 474,
          "user_id": 677989,
          "user_type": "registered",
          "accept_rate": 67,
          "profile_image": "https://i.sstatic.net/mYReX.jpg?s=256",
          "display_name": "haikalpribadi",
          "link": "https://stackoverflow.com/users/677989/haikalpribadi"
        },
        "reply_to_user": {
          "account_id": 1267900,
          "reputation": 687,
          "user_id": 1224794,
          "user_type": "registered",
          "accept_rate": 91,
          "profile_image": "https://www.gravatar.com/avatar/bdb0b43b7601147d811f8271c592f03a?s=256&d=identicon&r=PG",
          "display_name": "jbolt",
          "link": "https://stackoverflow.com/users/1224794/jbolt"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1625772413,
        "post_id": 3964249,
        "comment_id": 120723732,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 20241962,
          "reputation": 61,
          "user_id": 15168851,
          "user_type": "registered",
          "profile_image": "https://lh3.googleusercontent.com/-syX52gstiX8/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmCCWsyDsuvLKSFWDi56M_LC9yObQ/s96-c/s256-rj/photo.jpg",
          "display_name": "Mark",
          "link": "https://stackoverflow.com/users/15168851/mark"
        },
        "reply_to_user": {
          "account_id": 345216,
          "reputation": 474,
          "user_id": 677989,
          "user_type": "registered",
          "accept_rate": 67,
          "profile_image": "https://i.sstatic.net/mYReX.jpg?s=256",
          "display_name": "haikalpribadi",
          "link": "https://stackoverflow.com/users/677989/haikalpribadi"
        },
        "edited": false,
        "score": 3,
        "creation_date": 1625735605,
        "post_id": 3964249,
        "comment_id": 120707791,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "user_type": "does_not_exist",
          "display_name": "user11814208"
        },
        "edited": false,
        "score": 2,
        "creation_date": 1615033029,
        "post_id": 3964249,
        "comment_id": 117569434,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 1267900,
          "reputation": 687,
          "user_id": 1224794,
          "user_type": "registered",
          "accept_rate": 91,
          "profile_image": "https://www.gravatar.com/avatar/bdb0b43b7601147d811f8271c592f03a?s=256&d=identicon&r=PG",
          "display_name": "jbolt",
          "link": "https://stackoverflow.com/users/1224794/jbolt"
        },
        "reply_to_user": {
          "account_id": 345216,
          "reputation": 474,
          "user_id": 677989,
          "user_type": "registered",
          "accept_rate": 67,
          "profile_image": "https://i.sstatic.net/mYReX.jpg?s=256",
          "display_name": "haikalpribadi",
          "link": "https://stackoverflow.com/users/677989/haikalpribadi"
        },
        "edited": false,
        "score": 0,
        "creation_date": 1604081733,
        "post_id": 3964249,
        "comment_id": 114248413,
        "content_license": "CC BY-SA 4.0"
      },
      {
        "owner": {
          "account_id": 345216,
          "reputation": 474,
          "user_id": 677989,
          "user_type": "registered",
          "accept_rate": 67,
          "profile_image": "https://i.sstatic.net/mYReX.jpg?s=256",
          "display_name": "haikalpribadi",
          "link": "https://stackoverflow.com/users/677989/haikalpribadi"
        },
        "edited": false,
        "score": 6,
        "creation_date": 1600959144,
        "post_id": 3964249,
        "comment_id": 113259686,
        "content_license": "CC BY-SA 4.0"
      }
    ]
  }
}