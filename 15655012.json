{
  "question": {
    "tags": [
      "java",
      "final"
    ],
    "owner": {
      "account_id": 2492505,
      "reputation": 10991,
      "user_id": 2169693,
      "user_type": "registered",
      "accept_rate": 74,
      "profile_image": "https://i.sstatic.net/oeKsU.jpg?s=256",
      "display_name": "G.S",
      "link": "https://stackoverflow.com/users/2169693/g-s"
    },
    "is_answered": true,
    "view_count": 604841,
    "protected_date": 1399102869,
    "accepted_answer_id": 15655032,
    "answer_count": 20,
    "score": 584,
    "last_activity_date": 1728657018,
    "creation_date": 1364374938,
    "last_edit_date": 1515445753,
    "question_id": 15655012,
    "content_license": "CC BY-SA 3.0",
    "link": "https://stackoverflow.com/questions/15655012/how-does-the-final-keyword-in-java-work-i-can-still-modify-an-object",
    "title": "How does the &quot;final&quot; keyword in Java work? (I can still modify an object.)",
    "body": "<p>In Java we use <code>final</code> keyword with variables to specify its values are not to be changed.\nBut I see that you can change the value in the constructor / methods of the class. Again, if the variable is <code>static</code> then it is a compilation error.</p>\n\n<p>Here is the code: </p>\n\n<pre><code>import java.util.ArrayList;\nimport java.util.List;\n\nclass Test {\n  private final List foo;\n\n  public Test()\n  {\n      foo = new ArrayList();\n      foo.add(\"foo\"); // Modification-1\n  }\n  public static void main(String[] args) \n  {\n      Test t = new Test();\n      t.foo.add(\"bar\"); // Modification-2\n      System.out.println(\"print - \" + t.foo);\n  }\n}\n</code></pre>\n\n<p>Above code works fine and no errors.</p>\n\n<p>Now change the variable as <code>static</code>:</p>\n\n<pre><code>private static final List foo;\n</code></pre>\n\n<p>Now it is a compilation error. How does this <code>final</code> really work?</p>\n"
  },
  "answers": [
    {
      "owner": {
        "account_id": 1129088,
        "reputation": 10623,
        "user_id": 1115584,
        "user_type": "registered",
        "accept_rate": 71,
        "profile_image": "https://i.sstatic.net/4MMh7.jpg?s=256",
        "display_name": "AmitG",
        "link": "https://stackoverflow.com/users/1115584/amitg"
      },
      "is_accepted": false,
      "score": 667,
      "last_activity_date": 1728657018,
      "last_edit_date": 1728657018,
      "creation_date": 1364378892,
      "answer_id": 15656208,
      "question_id": 15655012,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>This is a <strong>favorite interview question</strong>. With this questions, the interviewer tries to find out how well you understand the behavior of objects with respect to constructors, methods, class variables (static variables) and instance variables.<br>\nNow a days interviewers are asking another favorite question <strong>what is effectively final</strong> from java 1.8.<br> I will explain in the end about this <code>effectively final</code> in java 1.8.</p>\n<pre><code>import java.util.ArrayList;\nimport java.util.List;\n\nclass Test {\n    private final List foo; // comment-1    \n    public Test() {\n        foo = new ArrayList(); // comment-2\n        foo.add(&quot;foo&quot;); // Modification-1   comment-3\n    }\n\n    public void setFoo(List foo) {\n       //this.foo = foo; Results in compile time error.\n    }\n}\n</code></pre>\n<p>In the above case, we have defined a constructor for 'Test' and gave it a 'setFoo' method. <br></p>\n<p><strong>About constructor:</strong>  Constructor can be invoked only <strong>one</strong> time per object creation by using the <code>new</code> keyword. You cannot invoke constructor multiple times, because constructor are not designed to do so. <br></p>\n<p><strong>About method:</strong> A method can be invoked as many times as you want (Even never) and the compiler knows it. <br></p>\n<p><strong>Scenario 1</strong><br></p>\n<pre><code>private final List foo;  // 1\n</code></pre>\n<p><code>foo</code> is an <strong>instance</strong> variable. When we create <code>Test</code> class object then the instance variable <code>foo</code>, will be copied inside the object of <code>Test</code> class. If we assign final <code>foo</code> inside the constructor, then the compiler knows that the constructor will be invoked only once, so there is no problem assigning it inside the constructor.\n<br><br>\nIf we assign final <code>foo</code> inside a method, the compiler knows that a method can be called multiple times, which means the value will have to be changed multiple times, which is not allowed for a <code>final</code> variable. So the compiler decides constructor is good choice! <strong>You can assign a value to a final variable only one time.</strong></p>\n<p><strong>Scenario 2</strong></p>\n<pre><code>private static final List foo = new ArrayList();\n</code></pre>\n<p><code>foo</code> is now a <strong>static</strong> variable. When we create an instance of <code>Test</code> class, <code>foo</code> will not be copied to the object because <code>foo</code> is static. Now <code>foo</code> is not an independent property of each object. This is a property of <code>Test</code> class. But <code>foo</code> can be seen by multiple objects and if every object of Test which is created by using the <code>new</code> keyword which will ultimately invoke the <code>Test</code> constructor which changes the value of final static variable at the time of multiple object creation (Remember <code>static foo</code> is not copied in every object, but is shared between multiple objects.). To stop this, compiler knows final static cannot be initialized inside constructor and also cannot provide method to assign object to it. So we have to declare and define final List object at the same place at comment-1 in above program. <br></p>\n<p><strong>Scenario 3</strong> <br></p>\n<pre><code>t.foo.add(&quot;bar&quot;); // Modification-2\n</code></pre>\n<p>Above <code>Modification-2</code> is from your question. In the above case, you are not changing the first referenced object, but you are adding content inside <code>foo</code> which is allowed. Compiler complains if you try to assign a <code>new ArrayList()</code> to the <code>foo</code> reference variable.<br>\n<strong>Rule</strong> If you have initialized a <code>final</code> variable, then you cannot change it to refer to a different object. (In this case <code>ArrayList</code>)</p>\n<p><strong>final</strong> classes cannot be subclassed<br>\n<strong>final</strong> methods cannot be overridden. (This method is in superclass)<br>\n<strong>final</strong> methods can override. (Read this in grammatical way. This method is in a subclass)</p>\n<p>Now let's see <strong>what is effectively final in java 1.8?</strong></p>\n<pre><code>public class EffectivelyFinalDemo { //compile code with java 1.8\n    public void process() {\n        int thisValueIsFinalWithoutFinalKeyword = 10; //variable is effectively final\n        \n        //to work without final keyword you should not reassign value to above variable like given below \n        thisValueIsFinalWithoutFinalKeyword = getNewValue(); // delete this line when I tell you.\n        \n        class MethodLocalClass {\n            public void innerMethod() {\n                //below line is now showing compiler error like give below\n                //Local variable thisValueIsFinalWithoutFinalKeyword defined in an enclosing scope must be final or effectively final\n                System.out.println(thisValueIsFinalWithoutFinalKeyword); //on this line only final variables are allowed because this is method local class\n                // if you want to test effectively final is working without final keyword then delete line which I told you to delete in above program.  \n            }\n        }\n    }\n\n    private int getNewValue() {\n        return 0;\n    }\n}\n</code></pre>\n<p>Above program will throw error in java 1.7 or &lt;1.8 if you do not use final keyword. Effectively final is a part of Method Local Inner classes. I know you would rarely use such effectively final in method local classes, but for interview we have to be prepared.</p>\n"
    }
  ],
  "question_comments": [],
  "answer_comments": {
    "15656208": []
  }
}