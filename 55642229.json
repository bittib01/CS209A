{
  "question": {
    "tags": [
      "java",
      "jquery",
      "spring-boot",
      "datatables",
      "thymeleaf"
    ],
    "owner": {
      "account_id": 14971476,
      "reputation": 192,
      "user_id": 10808216,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/fcee4f246607cf3c59c94b8554f5c112?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Miss Kitty",
      "link": "https://stackoverflow.com/users/10808216/miss-kitty"
    },
    "is_answered": true,
    "view_count": 21679,
    "accepted_answer_id": 55695719,
    "answer_count": 3,
    "score": 6,
    "last_activity_date": 1764698129,
    "creation_date": 1555022930,
    "last_edit_date": 1555026645,
    "question_id": 55642229,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/55642229/jquery-datatables-with-serverside-processing-in-spring-with-java-and-thymeleaf",
    "title": "JQuery DataTables with ServerSide Processing in Spring (with Java and Thymeleaf)",
    "body": "<p>I have a Spring Boot application using Java and Thymeleaf. In it, I have a page with a JQuery DataTable. This table has thousands of rows in it, and so while I currently just put it all on the page and let JQuery handle it entirely, I want to switch to using ServerSide processing for the paging, sorting, etc.</p>\n\n<p>I am set up to do this on the back-end, where I can pass a start and end row number and sort information dynamically to my SQL query. However, my issue is that I just can't figure out exactly how DataTables is trying to notify me via controller when the user clicks the 'next page' button, or a sort button. <strong>Where/how can my controller pick up this information, so that I can plug it into my SQL query and return what is necessary?</strong></p>\n\n<p>So, lets say I have an example <strong>object</strong>, like a \"Person\".</p>\n\n<pre><code>public class Person {\n\n    private static String PERSON_IMAGE = \"&lt;img th:src=\\\"@{/images/personimage.png}\\\" alt=\\\"icon\\\"/&gt;\";\n    private static String PERSON_IMAGE_2 = \"&lt;img th:src=\\\"@{/images/personimage2.png}\\\" alt=\\\"icon\\\"/&gt;\";\n\n    private String name;\n    private String socialSecurity;\n    private String birthdate;\n    private String gender;\n    private String personImage;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public String getSocialSecurity() {\n        return socialSecurity;\n    }\n\n    public void setSocialSecurity(String socialSecurity) {\n        this.socialSecurity = socialSecurity;\n    }\n\n    public String getBirthdate() {\n        return birthdate;\n    }\n\n    public void setBirthdate(String birthdate) {\n        this.birthdate = birthdate;\n    }\n\n    public String getGender() {\n        return gender;\n    }\n\n    public void setGender(String gender) {\n        this.gender = gender;\n    }\n\n    public String getPersonImage() {\n        if(null != birthdate) {\n            return PERSON_IMAGE;\n        } else {\n            return PERSON_IMAGE_2;\n        }\n\n    }\n}\n</code></pre>\n\n<p>So, on my Thymeleaf <strong>HTML</strong> page, I used to have the following: <strong>(Version 1)</strong></p>\n\n<pre><code>&lt;table id=\"myDataTable\" class=\"dataTable display compact\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th&gt;Name&lt;/th&gt;\n            &lt;th&gt;Social Security&lt;/th&gt;                                        \n            &lt;th&gt;Birthdate&lt;/th&gt;\n            &lt;th&gt;Gender&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n    &lt;tbody&gt;\n        &lt;tr th:each=\"person : ${peopleList}\"&gt;\n            &lt;td th:attr=\"data-order=${person.name}\"&gt;&lt;a th:href=\"|javascript:openPersonDetail('${person.socialSecurity}');|\"&gt;&lt;span th:text=\"${person.name}\"&gt;name&lt;/span&gt;&lt;/a&gt;&lt;/td&gt;\n            &lt;td th:text=\"${person.socialSecurity}\"&gt;socialSecurity&lt;/td&gt;                      \n            &lt;td class=\"dt-body-center\" th:text=\"${person.birthdate}\"&gt;birthdate&lt;/td&gt;\n            &lt;td class=\"dt-body-center\" th:text=\"${person.gender}\"&gt;gender&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>My page <strong>controller</strong> was very simple, and just passed in a full list of people, as follows: <strong>(Version 1)</strong></p>\n\n<pre><code>@GetMapping(\"/ApplicationName/MyDataTablePage\")\npublic String myDataTablePage(Model model) {\n\n    SearchCriteria searchCriteria = new SearchCriteria();\n    searchCriteria.setOrderByString(\"name\");\n    searchCriteria.setUsePaging(false);\n    searchCriteria.setFIRST_NUMBER(null);\n    searchCriteria.setLAST_NUMBER(null);\n\n    model.addAttribute(\"peopleList\", myMapperService.getPeople(searchCriteria)); //returns an ArrayList&lt;Person&gt;\n\n    return \"/pages/MyDataTablePage\";\n}\n</code></pre>\n\n<p>And finally, my Javascript used to have the following: <strong>(Version 1)</strong></p>\n\n<pre><code>$(document).ready(function() {\n    $('#myDataTable').DataTable({\n        \"destroy\" : true,\n        \"scrollY\" : 300,\n        \"scrollCollapse\" : true,\n        \"paging\" : true,\n        \"autoWidth\" : true,\n        \"ordering\" : true,\n        \"searching\" : false,\n        \"order\" : [ [ 0, 'asc' ] ],\n        \"pageLength\" : 20,\n        \"lengthChange\" : false,\n        \"pagingType\" : \"full_numbers\",\n        \"dom\" : '&lt;\"top\"ip&gt;rt&lt;\"bottom\"fl&gt;&lt;\"clear\"&gt;'\n    });\n});\n</code></pre>\n\n<p>This worked, but I wanted to switch the DataTable to use serverside processing, and so the first step was to (1) change the main page controller to stop appending the list of People to the model, (2) to create a new controller which would return my ArrayList as JSON for the DataTable to call by itself, (3) to change the html of the main page to no longer provide any <em>tbody</em> tag to the DataTable, and (4) to change the javascript where the table is created to put the data in by itself.</p>\n\n<p>=============================================================</p>\n\n<p>That led me to <strong>version 2</strong> of the following elements.</p>\n\n<p>My changed Thymeleaf <strong>HTML</strong> page: <strong>(Version 2)</strong></p>\n\n<pre><code>&lt;table id=\"myDataTable\" class=\"dataTable display compact\"&gt;\n    &lt;thead&gt;\n        &lt;tr&gt;\n            &lt;th&gt;Name&lt;/th&gt;\n            &lt;th&gt;Social Security&lt;/th&gt;                                        \n            &lt;th&gt;Birthdate&lt;/th&gt;\n            &lt;th&gt;Gender&lt;/th&gt;\n        &lt;/tr&gt;\n    &lt;/thead&gt;\n&lt;/table&gt;\n</code></pre>\n\n<p>My changed page <strong>controller</strong>: <strong>(Version 2)</strong></p>\n\n<pre><code>@GetMapping(\"/ApplicationName/MyDataTablePage\")\npublic String myDataTablePage(Model model) {\n\n    return \"/pages/MyDataTablePage\";\n}\n</code></pre>\n\n<p>My new DataTables <strong>controller</strong>:</p>\n\n<pre><code>@RequestMapping(path = \"/ApplicationName/Data/Person\", method = RequestMethod.GET, produces = \"application/json\")\n@ResponseBody\npublic List&lt;Person&gt; getPersonData() {\n    System.out.println(\"I was called!\");\n\n    SearchCriteria searchCriteria = new SearchCriteria();\n    searchCriteria.setOrderByString(\"name\");\n    searchCriteria.setUsePaging(false);\n    searchCriteria.setFIRST_NUMBER(null);\n    searchCriteria.setLAST_NUMBER(null);\n\n    return myMapperService.getPeople(searchCriteria); //returns an ArrayList&lt;Person&gt;\n}\n</code></pre>\n\n<p>My changed (much more complicated) Javascript: <strong>(Version 2)</strong></p>\n\n<pre><code>$(document).ready(function () {\n     $('#myDataTable').DataTable({ \n         'destroy' : true,\n         'serverSide' : true,\n         'sAjaxSource': '/ApplicationName/Data/Person',\n         'sAjaxDataProp': '',\n         'order': [ [ 0, 'asc' ] ],\n         'columns': \n         [ \n            {  'data': 'name',\n                'render': function(data, type, row, meta){ \n                    if(type === 'display'){ \n                        data = '&lt;a href=\"javascript:openPersonDetail(&amp;apos;'+ row.socialSecurity +'&amp;apos;);\"&gt;' + data + '&lt;/a&gt;' \n                    }  \n                    return data; \n                } \n            } ,\n            { 'data': 'socialSecurity'} ,\n            { 'data': 'birthdate'} ,\n            { 'data': 'gender'} \n         ],\n         'scrollY' : 300,\n         'scrollCollapse' : true,\n         'paging' : true,\n         'autoWidth' : true,\n         'ordering' : true,\n         'searching' : false,\n         'pageLength' : 20,\n         'lengthChange' : false,\n         'pagingType' : 'full_numbers',\n         'dom' : '&lt;\"top\"ip&gt;rt&lt;\"bottom\"fl&gt;&lt;\"clear\"&gt;' \n     }); \n });\n</code></pre>\n\n<p>=============================================================</p>\n\n<p>And that works, too. Especially if I remove the \"'serverSide' : true,\" configuration - the DataTable works exactly like it used to before I made the above changes, but now it calls my new Data JSON controller instead of using a model attribute. </p>\n\n<p><strong>Problem:</strong></p>\n\n<p>However, with the \"'serverSide' : true,\" configuration added to the DataTable, each time I go to a new 'page' of the table, it just recalls my \"/Clinic/Detail/Data/Patient\" controller each time. </p>\n\n<p>But, I need DataTables to pass my controller information about what page the user has selected, or what column the user tried to sort on. I also need to pass the table (dynamically) the total number of rows there are (count) so that DataTables can properly set up the page numbers for the user. </p>\n\n<p>Is DataTables sending some additional parameters to my controller that I can pick up? Something like a @PathVariable(\"whatever\")?</p>\n\n<p>I feel like I am so close to getting this working, but I'm stuck at this point.</p>\n\n<p>I would really appreciate any help!</p>\n"
  },
  "answers": [
    {
      "owner": {
        "account_id": 11653885,
        "reputation": 3342,
        "user_id": 8534285,
        "user_type": "registered",
        "profile_image": "https://i.sstatic.net/K2AXH.jpg?s=256",
        "display_name": "Ajay Kumar",
        "link": "https://stackoverflow.com/users/8534285/ajay-kumar"
      },
      "is_accepted": false,
      "score": 0,
      "last_activity_date": 1764698129,
      "creation_date": 1764698129,
      "answer_id": 79836202,
      "question_id": 55642229,
      "content_license": "CC BY-SA 4.0",
      "body": "<p>I introduced this class inspired from a different SO thread. A full example is here:</p>\n<pre><code>https://github.com/ajkr195/SpringBootJPADatatable/\n</code></pre>\n<pre><code>@Getter\n@Setter\npublic class DataTable&lt;T&gt; {\n    \n    private int draw;\n    private int start;\n    private long recordsTotal;\n    private long recordsFiltered;\n    private List&lt;T&gt; data;\n\n}\n</code></pre>\n<p>My RestController</p>\n<pre class=\"lang-java prettyprint-override\"><code>    @GetMapping(&quot;/usersrestlisttwo&quot;)\n        public ResponseEntity listAllTable(@RequestParam(&quot;draw&quot;) int draw,        @RequestParam(&quot;start&quot;) int start,\n            @RequestParam(&quot;length&quot;) int length, @RequestParam(&quot;search[value]&quot;) String searchValue) {\n\n        int page = start / length; // Calculate page number\n\n        // Create a specification for the global search\n        Specification&lt;User&gt; spec = buildSearchSpecification(searchValue);\n\n        Pageable pageable = PageRequest.of(page, length);\n\n        Page&lt;User&gt; responseData = userRepository2.findAll(spec, pageable);\n\n        DataTable dataTable = new DataTable();\n\n        dataTable.setData(responseData.getContent());\n        dataTable.setRecordsTotal(responseData.getTotalElements());\n        dataTable.setRecordsFiltered(responseData.getTotalElements());\n\n        dataTable.setDraw(draw);\n        dataTable.setStart(start);\n\n        return ResponseEntity.ok(dataTable);\n\n    }\n\n    private Specification&lt;User&gt; buildSearchSpecification(String searchValue) {\n            if (searchValue == null || searchValue.isEmpty()) {\n                return Specification.where(null);\n            }\n            return (root, query, criteriaBuilder) -&gt; criteriaBuilder.or(\n                criteriaBuilder.like(root.get(&quot;firstName&quot;), &quot;%&quot; + searchValue + &quot;%&quot;),\n                criteriaBuilder.like(root.get(&quot;lastName&quot;), &quot;%&quot; + searchValue + &quot;%&quot;),\n                criteriaBuilder.like(root.get(&quot;email&quot;), &quot;%&quot; + searchValue + &quot;%&quot;),\n                criteriaBuilder.like(root.get(&quot;username&quot;), &quot;%&quot; + searchValue + &quot;%&quot;)\n            );\n        }\n</code></pre>\n<p>And finally JQuery + DataTable:</p>\n<pre><code>    &lt;script&gt;\n        $('#exampleDT').DataTable({\n            'destroy': true,\n            &quot;processing&quot;: true,\n            &quot;serverSide&quot;: true,\n            &quot;pageLength&quot;: 10,\n            &quot;searching&quot;: true,\n            &quot;info&quot;: true,\n            &quot;ajax&quot;: {\n                &quot;url&quot;: &quot;http://localhost:8080/api/usersrestlisttwo&quot;,\n                &quot;method&quot;: &quot;get&quot;,\n                &quot;dataSrc&quot;: function (response) {\n\n                    var data = response.data; // your data list\n\n                    var all = [];\n\n                    for (var i = 0; i &lt; data.length; i++) {\n\n                        var row = {\n                            rows: response.start + i + 1,\n                            userId: data[i].userId,\n                            firstName: data[i].firstName,\n                            lastName: data[i].lastName,\n                            username: data[i].username,\n                            email: data[i].email,\n                            status: data[i].status,\n\n                        };\n                        all.push(row);\n                    }\n                    return all;\n                }\n\n            },\n            columns: [\n                {data: 'userId'},\n                {data: 'firstName'},\n                {data: 'lastName'},\n                {data: 'username', render: (data) =&gt; `&lt;span class=&quot;shadow-sm px-2 py-1 rounded-3 bg-dark text-light&quot;&gt;${data}&lt;/span&gt;`},\n                {\n                    data: 'email',\n                    render: (data) =&gt; `&lt;a href=&quot;mailto: ${data}&quot;  target=&quot;_blank&quot;&gt;${data}&lt;/a&gt;`\n                },\n                {\n                    data: 'status',\n                    render: (data) =&gt; `&lt;span class=&quot;badge bg-${data ? 'success' : 'warning'}&quot;&gt;${data ? 'active' : 'inactive'}&lt;/span&gt;`\n                },\n            ],\n            //'scrollY': 300,\n            'scrollCollapse': true,\n            'autoWidth': true,\n            'ordering': true,\n        });\n    &lt;/script&gt;\n</code></pre>\n"
    }
  ],
  "question_comments": [],
  "answer_comments": {
    "79836202": []
  }
}