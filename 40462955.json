{
  "question": {
    "tags": [
      "java",
      "android",
      "serversocket"
    ],
    "owner": {
      "account_id": 1861178,
      "reputation": 2058,
      "user_id": 1685748,
      "user_type": "registered",
      "accept_rate": 79,
      "profile_image": "https://www.gravatar.com/avatar/e020f5dc48f2cd9f6b17412b36265a6d?s=256&d=identicon&r=PG",
      "display_name": "Lonergan6275",
      "link": "https://stackoverflow.com/users/1685748/lonergan6275"
    },
    "is_answered": false,
    "view_count": 8648,
    "answer_count": 1,
    "score": 14,
    "last_activity_date": 1764946810,
    "creation_date": 1478514517,
    "last_edit_date": 1478516336,
    "question_id": 40462955,
    "content_license": "CC BY-SA 3.0",
    "link": "https://stackoverflow.com/questions/40462955/android-machine-is-not-on-the-network",
    "title": "Android Machine is not on the network",
    "body": "<p>I am having a problem Running a network service when my app connects to a WiFi network.\nI am getting a the following exception, </p>\n\n<p><code>java.net.SocketException: socket failed: ENONET (Machine is not on the network)</code> in the openPort() method bellow</p>\n\n<p><strong>BroadcastReceiver</strong></p>\n\n<pre><code>@Override\npublic void onReceive(Context context, Intent intent) {\n\n    String action = intent.getAction();\n\n    if (WifiManager.NETWORK_STATE_CHANGED_ACTION.equals(action)) {\n\n        NetworkInfo networkInfo = intent.getParcelableExtra(WifiManager.EXTRA_NETWORK_INFO);\n\n        if (networkInfo.getState() == NetworkInfo.State.CONNECTED) {\n            welcomeService = new BroadcastService(context, \"Welcome\");\n            Log.i(TAG, \"onReceive: SUPPLICANT-STATE ---&gt; Connected\");\n            //do something\n            if (!serviceRegistered) {\n                welcomeService.registerService();\n                serviceRegistered = true;\n            }\n        }\n\n        if (networkInfo.getState() == NetworkInfo.State.DISCONNECTED) {\n            Log.i(TAG, \"onReceive: SUPPLICANT-STATE ---&gt; Disconnected\");\n            //do something\n            unRegisterService();\n        }\n    }\n\n}\n\npublic void unRegisterService() {\n    if (serviceRegistered &amp;&amp; welcomeService != null) {\n        welcomeService.unregisterService();\n        serviceRegistered = false;\n\n    }\n}\n</code></pre>\n\n<p><strong>BroadcastService</strong></p>\n\n<pre><code>public void registerService() {\n    NsdServiceInfo serviceInfo  = new NsdServiceInfo();\n    serviceInfo.setServiceName(mServiceName);\n    serviceInfo.setServiceType(\"_http._tcp.\");\n    serviceInfo.setPort(openPort());\n\n    mNsdManager = (NsdManager) mContext.getSystemService(Context.NSD_SERVICE);\n\n    mNsdManager.registerService(serviceInfo, NsdManager.PROTOCOL_DNS_SD, mRegistrationListener);\n}\n\nprivate int openPort() {\n    try{\n        // Line that throws the exception\n        return  new ServerSocket(0).getLocalPort();\n    }catch (IOException ioe){\n        Crashlytics.logException(ioe);\n        ioe.printStackTrace();\n        return 0;\n    }\n}\n</code></pre>\n\n<p>This the Broadcast Receiver only runs on when the main activity is showing. and it works fine on the first run but when I change the WiFi network this happens. Help world be greatly appreciated.</p>\n"
  },
  "answers": [],
  "question_comments": [
    {
      "owner": {
        "account_id": 4782020,
        "reputation": 227,
        "user_id": 3863488,
        "user_type": "registered",
        "accept_rate": 0,
        "profile_image": "https://www.gravatar.com/avatar/f02e232eb4142c8108992de42c7561d3?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name": "user3863488",
        "link": "https://stackoverflow.com/users/3863488/user3863488"
      },
      "reply_to_user": {
        "account_id": 6146084,
        "reputation": 755,
        "user_id": 4792027,
        "user_type": "registered",
        "profile_image": "https://www.gravatar.com/avatar/701cae4a519c8039938058d812b05ecd?s=256&d=identicon&r=PG&f=y&so-version=2",
        "display_name": "Ninad Kambli",
        "link": "https://stackoverflow.com/users/4792027/ninad-kambli"
      },
      "edited": false,
      "score": 0,
      "creation_date": 1643647676,
      "post_id": 40462955,
      "comment_id": 125390112,
      "content_license": "CC BY-SA 4.0"
    }
  ],
  "answer_comments": {}
}