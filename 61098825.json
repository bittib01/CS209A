{
  "question": {
    "tags": [
      "java",
      "android",
      "webview"
    ],
    "owner": {
      "account_id": 18141432,
      "reputation": 11,
      "user_id": 13195255,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/090e6f613beb4746889336a150cde697?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Christos Boutsikas",
      "link": "https://stackoverflow.com/users/13195255/christos-boutsikas"
    },
    "is_answered": true,
    "view_count": 5594,
    "answer_count": 2,
    "score": -1,
    "last_activity_date": 1764696133,
    "creation_date": 1586342643,
    "last_edit_date": 1586768724,
    "question_id": 61098825,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/61098825/android-download-file-octet-stream-web-view",
    "title": "Android: Download file octet-stream web view",
    "body": "<p>I want to be able to download a file through Android's webview but I cannot do it.</p>\n\n<p>The url I have to download from is in this format: </p>\n\n<pre><code>http://{server_path}/Download?mimetype=application/octet-stream\n</code></pre>\n\n<p>I am using this code: </p>\n\n<pre><code>myWebView.setDownloadListener(new DownloadListener() {\n  public void onDownloadStart(String url, String userAgent,\n                              String contentDisposition, String mimetype,\n                              long contentLength) {\n    DownloadManager.Request request = new DownloadManager.Request(Uri.parse(url));\n\n    request.setMimeType(mimetype);\n    //------------------------COOKIE!!------------------------\n    String cookies = CookieManager.getInstance().getCookie(url);\n    request.addRequestHeader(\"cookie\", cookies);\n    //------------------------COOKIE!!------------------------\n    request.addRequestHeader(\"User-Agent\", userAgent);\n    request.setDescription(\"Downloading file...\");\n    request.setTitle(URLUtil.guessFileName(url, contentDisposition, mimetype));\n    request.allowScanningByMediaScanner();\n    request.setNotificationVisibility(DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);\n    request.setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS, URLUtil.guessFileName(url, contentDisposition, mimetype));\n    DownloadManager dm = (DownloadManager) getSystemService(DOWNLOAD_SERVICE);\n    long donwloadedFileId = dm.enqueue(request);\n    String downloadedMimeType = dm.getMimeTypeForDownloadedFile(donwloadedFileId)\n    Toast.makeText(getApplicationContext(), \"Downloading File\", Toast.LENGTH_LONG).show();\n  }\n});\n</code></pre>\n\n<p><br/>\nWhen I try to download  all I get is a \"download.bin\" file.</p>\n\n<p>As I check the function <code>URLUtil.guessFileName(url, contentDisposition, mimetype)</code> returns this as a file name. </p>\n\n<p>Could you help me?</p>\n\n<p><strong>EDIT</strong> <br/></p>\n\n<p>If I rename the downloaded file from Android File manager app, it opens succefully. \nSo maybe the answer is how can I set the correctly mimeType of the downloaded file? </p>\n\n<p><strong>EDIT 2 (13/4/20)</strong> <br/></p>\n\n<p>Also I forgot to mention that in the above code mimeType is \"application/octet-stream\" </p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}