{
  "question": {
    "tags": [
      "java",
      "android",
      "in-app-purchase",
      "in-app-billing"
    ],
    "owner": {
      "account_id": 13732063,
      "reputation": 4809,
      "user_id": 9909365,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/AtshS.png?s=256",
      "display_name": "Ashvin solanki",
      "link": "https://stackoverflow.com/users/9909365/ashvin-solanki"
    },
    "is_answered": false,
    "view_count": 133,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1726812779,
    "creation_date": 1709640776,
    "last_edit_date": 1726812779,
    "question_id": 78107649,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78107649/in-app-purchase-subscription-offer-code-not-working-android",
    "title": "In-App Purchase Subscription Offer Code Not Working Android",
    "body": "<p>I am having issue with the subscription offer, other things works fine.</p>\n<p>Code for loading products / query products.</p>\n<pre><code>ImmutableList&lt;QueryProductDetailsParams.Product&gt; productList = ImmutableList.of(\n        //Product 1\n        QueryProductDetailsParams.Product.newBuilder()\n                .setProductId(BaseActivity.ONE_MONTH)\n                .setProductType(BillingClient.ProductType.SUBS)\n                .build(),\n        //Product 2\n        QueryProductDetailsParams.Product.newBuilder()\n                .setProductId(BaseActivity.ONE_YEAR)\n                .setProductType(BillingClient.ProductType.SUBS)\n                .build()\n);\nQueryProductDetailsParams queryProductDetailsParams = QueryProductDetailsParams.newBuilder()\n        .setProductList(productList)\n        .build();\n\n    billingClient.queryProductDetailsAsync(queryProductDetailsParams, new ProductDetailsResponseListener() {\n        @Override\n        public void onProductDetailsResponse(@NonNull BillingResult billingResult, @NonNull List&lt;ProductDetails&gt; list) {\n          this.productDetailsList = list\n        }\n    });\n</code></pre>\n<p>Launch Flow</p>\n<pre><code>    ImmutableList&lt;BillingFlowParams.ProductDetailsParams&gt; productDetailsParamsList =\n            ImmutableList.of(\n                    BillingFlowParams.ProductDetailsParams.newBuilder()\n                            .setProductDetails(productDetails)\n                            .setOfferToken(productDetails.getSubscriptionOfferDetails().get(0).getOfferToken())\n                            .build()\n            );\n    BillingFlowParams billingFlowParams = BillingFlowParams.newBuilder()\n            .setProductDetailsParamsList(productDetailsParamsList)\n            .build();\n\n    billingClient.launchBillingFlow(this, billingFlowParams);\n</code></pre>\n<p>Image : <a href=\"https://i.sstatic.net/NaFEx.png\" rel=\"nofollow noreferrer\">Playstore Subscription Offer</a></p>\n<p>Image : <a href=\"https://pastebin.com/FsT0ikRS\" rel=\"nofollow noreferrer\">ProductJSON Response in logs</a></p>\n<p>But when press executing launch flow, i mean try to purchase that product / subscription.\nIt should display the discounted price or discount details, not able to understand how its working, i am matching Crite area for offer, new user and never purchased this subscription.</p>\n<p><a href=\"https://i.sstatic.net/A90B0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/A90B0.png\" alt=\"enter image description here\" /></a></p>\n<pre><code>**Edit 2 20/09/2024**\n</code></pre>\n<p>The offers are not working in the license testing, however when i tested as real user from the store, the offers are showing and working  very well, based on my understanding its a bug in the system.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}