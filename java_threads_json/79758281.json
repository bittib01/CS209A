{
  "question": {
    "tags": [
      "java",
      "appium-android"
    ],
    "owner": {
      "account_id": 26378587,
      "reputation": 41,
      "user_id": 20032192,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/eabe79a41dc6821c3c535839f357a582?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Fakhriyya",
      "link": "https://stackoverflow.com/users/20032192/fakhriyya"
    },
    "is_answered": false,
    "view_count": 44,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1757291798,
    "creation_date": 1757268867,
    "question_id": 79758281,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79758281/how-to-check-if-the-message-was-sent-successfully-in-appium",
    "title": "How to check if the message was sent successfully in Appium?",
    "body": "<p>This task is given to me by my boss. I have no knowledge of Appium and today is the first day I've installed it. I wrote simple test where I sent message from real device to short number. I have to check if the message was sent successfully. When it is not successfully sent, I can see this message below the text bubble:\n!Not sent. Check options\nThis is the code I wrote so far:</p>\n<pre><code>import io.appium.java_client.android.AndroidDriver;\nimport org.openqa.selenium.By;\nimport org.openqa.selenium.remote.DesiredCapabilities;\nimport org.testng.annotations.AfterTest;\nimport org.testng.annotations.BeforeTest;\nimport org.testng.annotations.Test;\n\nimport java.net.MalformedURLException;\nimport java.net.URL;\nimport java.time.Duration;\n\npublic class SendMessage {\n\n    private AndroidDriver driver;\n    private static final String APPIUM_SERVER_URL = &quot;http://127.0.0.1:4723&quot;;\n\n    @BeforeTest\n    public void setup() throws MalformedURLException {\n\n        DesiredCapabilities dc = new DesiredCapabilities();\n        dc.setCapability(&quot;platformName&quot;,&quot;Android&quot;);\n        dc.setCapability(&quot;appium:automationName&quot;,&quot;uiautomator2&quot;);\n        dc.setCapability(&quot;appium:appium:deviceName&quot;,&quot;redmi_note_13&quot;);\n        dc.setCapability(&quot;appium:platformVersion&quot;,&quot;13&quot;);\n        dc.setCapability(&quot;appium:appPackage&quot;,&quot;com.google.android.apps.messaging&quot;);\n        dc.setCapability(&quot;appium:appActivity&quot;,&quot;com.google.android.apps.messaging.ui.ConversationListActivity&quot;);\n        dc.setCapability(&quot;appium:noReset&quot;, true);\n\n        driver = new AndroidDriver(new URL(APPIUM_SERVER_URL),dc);\n\n    }\n\n    @Test\n    public void sendMessage() {\n        String[] shortNumbers={&quot;9008&quot;};\n\n        driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));\n        driver.findElement(By.xpath(&quot;//android.widget.Button[@content-desc='Start chat']&quot;)).click();\n        driver.findElement(By.xpath(&quot;//android.widget.EditText[@resource-id='ContactSearchField']&quot;)).sendKeys(shortNumbers[0]);\n        driver.findElement(By.xpath(&quot;//android.view.View[@resource-id='ContactSuggestionList']/android.view.View&quot;)).click();\n        driver.findElement(By.xpath(&quot;//android.widget.EditText[@resource-id='com.google.android.apps.messaging:id/compose_message_text']&quot;)).sendKeys(&quot;Test&quot;);\n        driver.findElement(By.xpath(&quot;//android.view.View[@resource-id='Compose:Draft:Send']/android.widget.Button&quot;)).click();\n    }\n\n    @AfterTest\n    public void close(){\n        driver.quit();\n    }\n}\n</code></pre>\n<p>I tried to get xpath of the Not Sent text. It was something like this:\n//android.view.View[@resource-id=&quot;message_list&quot;]/android.view.View[1] and it doesn't have any text I can validate against. I tried to solve the problem with ChatGPT. Last time, this code was generated and didn't work</p>\n<p>This code is supposedly check the message's content because I couldn't make it work with !Not sent. Check options. text</p>\n<pre><code>WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(15));\n\n// Get the last message bubble in the list\nWebElement lastMessage = wait.until(driver -&gt;\n        driver.findElement(By.xpath(&quot;//android.view.View[@resource-id='message_list']/android.view.View[last()]&quot;))\n);\n\n// Look for the &quot;failed&quot; indicator inside the last message\nList&lt;WebElement&gt; failedIndicator = lastMessage.findElements(By.xpath(&quot;.//android.view.View[contains(@content-desc, 'Failed')]&quot;));\n\nif (!failedIndicator.isEmpty()) {\n    System.out.println(&quot;Message failed to send!&quot;);\n    Assert.fail(&quot;Short number &quot; + shortNumbers[0] + &quot; failed: 'Failed' indicator appeared.&quot;);\n} else {\n    System.out.println(&quot;Message sent successfully to short number: &quot; + shortNumbers[0]);\n    Assert.assertTrue(true);\n}\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}