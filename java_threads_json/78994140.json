{
  "question": {
    "tags": [
      "java",
      "intellij-idea",
      "junit",
      "code-coverage",
      "lombok"
    ],
    "owner": {
      "account_id": 357783,
      "reputation": 5386,
      "user_id": 698168,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/b81aac86149a52c3ebed2aa59e98d4b7?s=256&d=identicon&r=PG",
      "display_name": "Julien Kronegg",
      "link": "https://stackoverflow.com/users/698168/julien-kronegg"
    },
    "is_answered": false,
    "view_count": 225,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1727074487,
    "creation_date": 1726577444,
    "last_edit_date": 1727074487,
    "question_id": 78994140,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78994140/test-coverage-is-lower-when-using-lombok-builder",
    "title": "Test coverage is lower when using Lombok @Builder",
    "body": "<p>I have an issue with the test coverage with the Lombok's <code>@Builder</code> annotation.</p>\n<p>I have a Java class annotated with Lombok's <code>@Data</code>, <code>@AllArgsConstructor</code> and <code>@NoArgsConstructor</code>:</p>\n<pre><code>import lombok.Data;\nimport lombok.AllArgsConstructor;\nimport lombok.NoArgsConstructor;\n\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\npublic class User {\n    private int id;\n    private String name;\n}\n</code></pre>\n<p>and a JUnit test-case:</p>\n<pre><code>import org.junit.jupiter.api.Test;\n\nimport static org.junit.jupiter.api.Assertions.*;\n\nclass UserTest {\n    @Test\n    void test() {\n        assertNotNull(new User());\n    }\n\n}\n</code></pre>\n<p>My <code>lombok.config</code> is configured so that test coverage is ignored on generated code:</p>\n<pre><code>config.stopBubbling = true\nlombok.addLombokGeneratedAnnotation=true\n</code></pre>\n<p>IntelliJ shows a class test coverage of &quot;100% (0/0)&quot;. That's expected as all code generated by Lombok is ignored from coverage.\n<a href=\"https://i.sstatic.net/QbXfXinZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/QbXfXinZ.png\" alt=\"enter image description here\" /></a></p>\n<p>When I add a <code>@Builder</code> annotation on class <code>User</code>, the coverage report shows &quot;0% (0/1)&quot;:</p>\n<pre><code>import lombok.Data;\nimport lombok.AllArgsConstructor;\nimport lombok.NoArgsConstructor;\nimport lombok.Builder;\n\n@Data\n@AllArgsConstructor\n@NoArgsConstructor\n@Builder\npublic class User {\n    private int id;\n    private String name;\n}\n</code></pre>\n<p><a href=\"https://i.sstatic.net/mdn49cyD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/mdn49cyD.png\" alt=\"enter image description here\" /></a></p>\n<p>Testing the builder with <code>assertNotNull(User.builder().build())</code> does not change the test coverage.</p>\n<p>The IDE indicates that the line with the <code>@Builder</code> is not covered by tests:\n<a href=\"https://i.sstatic.net/3GV53hel.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/3GV53hel.png\" alt=\"enter image description here\" /></a></p>\n<p>The <code>lombok.Generated</code> annotation has been properly generated:</p>\n<pre><code>import lombok.Generated;\n\npublic class UserDelombok {\n    private int id;\n    private String name;\n\n    @Generated\n    public static UserBuilder builder() {\n        return new UserBuilder();\n    }\n\n    @Generated\n    public int getId() {\n        return this.id;\n    }\n\n    @Generated\n    public String getName() {\n        return this.name;\n    }\n\n    @Generated\n    public void setId(int id) {\n        this.id = id;\n    }\n\n    @Generated\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    @Generated\n    public boolean equals(Object o) {\n        if (o == this) {\n            return true;\n        } else if (!(o instanceof User)) {\n            return false;\n        } else {\n            User other = (User)o;\n            if (!other.canEqual(this)) {\n                return false;\n            } else if (this.getId() != other.getId()) {\n                return false;\n            } else {\n                Object this$name = this.getName();\n                Object other$name = other.getName();\n                if (this$name == null) {\n                    if (other$name != null) {\n                        return false;\n                    }\n                } else if (!this$name.equals(other$name)) {\n                    return false;\n                }\n\n                return true;\n            }\n        }\n    }\n\n    @Generated\n    protected boolean canEqual(Object other) {\n        return other instanceof User;\n    }\n\n    @Generated\n    public int hashCode() {\n        int result = 1;\n        result = result * 59 + this.getId();\n        Object $name = this.getName();\n        result = result * 59 + ($name == null ? 43 : $name.hashCode());\n        return result;\n    }\n\n    @Generated\n    public String toString() {\n        int var10000 = this.getId();\n        return &quot;User(id=&quot; + var10000 + &quot;, name=&quot; + this.getName() + &quot;)&quot;;\n    }\n\n    @Generated\n    public UserDelombok(int id, String name) {\n        this.id = id;\n        this.name = name;\n    }\n\n    @Generated\n    public UserDelombok() {\n    }\n\n    @Generated\n    public static class UserBuilder {\n        @Generated\n        private int id;\n        @Generated\n        private String name;\n\n        @Generated\n        UserBuilder() { // not covered\n        }\n\n        @Generated\n        public UserBuilder id(int id) { // not covered\n            this.id = id;\n            return this;\n        }\n\n        @Generated\n        public UserBuilder name(String name) { // not covered\n            this.name = name;\n            return this;\n        }\n\n        @Generated\n        public User build() { // not covered\n            return new User(this.id, this.name);\n        }\n\n        @Generated\n        public String toString() { // not covered\n            return &quot;User.UserBuilder(id=&quot; + this.id + &quot;, name=&quot; + this.name + &quot;)&quot;;\n        }\n    }\n}\n</code></pre>\n<p>I'm using the following config:</p>\n<ul>\n<li>Lombok 1.18.34</li>\n<li>Junit Jupiter 5.10.3</li>\n<li>IntelliJ IDEA Ultimate 2024.2.2</li>\n</ul>\n<p>Why does does the coverage change when adding a new lombok annotation ?</p>\n<p>How to get &quot;100% (0/0)&quot; coverage with <code>@Builder</code> ?</p>\n<p>The full project to reproduce the issue:\n<a href=\"https://github.com/jkronegg/lombok-builder-coverage\" rel=\"nofollow noreferrer\">https://github.com/jkronegg/lombok-builder-coverage</a></p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}