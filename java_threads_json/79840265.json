{
  "question": {
    "tags": [
      "java",
      "jwt"
    ],
    "owner": {
      "account_id": 44936070,
      "reputation": 1,
      "user_id": 32013251,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/5b73d98938d052938a0e7c9b567195db?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Dave Montesa",
      "link": "https://stackoverflow.com/users/32013251/dave-montesa"
    },
    "is_answered": true,
    "view_count": 77,
    "closed_date": 1766093259,
    "answer_count": 1,
    "score": -1,
    "last_activity_date": 1765118733,
    "creation_date": 1765114999,
    "last_edit_date": 1765115508,
    "question_id": 79840265,
    "link": "https://stackoverflow.com/questions/79840265/validating-json-web-tokens-in-java",
    "closed_reason": "Not suitable for this site",
    "title": "Validating JSON Web Tokens in Java",
    "body": "<p>Does anyone knows why this occurs working with JWTs ?</p>\n<p><strong>Here's the logic behind token creation:</strong></p>\n<pre><code>public String makeToken(String username) {\n\n        long calc = 24 * 60 * 60 * 1000L; // 1 day expiration\n        long date = (System.currentTimeMillis() + calc) / 1000;\n    \n        var token = Jwts.builder()\n                .subject(username)\n                .issuedAt(new Date())\n                .expiration(new Date(date * 1000L))\n                .signWith(supersecretkey)\n                .compact();\n    \n        log.debug(&quot;A cute token has spawned: {}&quot;, token);\n        return token;\n    }\n</code></pre>\n<p><strong>And heres for validating the token:</strong></p>\n<pre class=\"lang-java prettyprint-override\"><code>public Boolean validateToken(String token) {\n        try {\n            Jwts.parser()\n                    .verifyWith(supersecretkey)\n                    .build()\n                    .parseSignedClaims(token);\n        } catch (JwtException e) {\n            log.error(&quot;Invalid JWT token: {}&quot;, token);\n        }\n        return true;\n    }\n</code></pre>\n<p>Now the problem is whenever i call the validateToken method and passing the token explicitly  generated by the makeToken as string it throws the catch error</p>\n<p>like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>var tk = token.makeToken(&quot;Kushane&quot;);\n        var result = token.validateToken(tk);\n\n        log.info(&quot;Token: {}&quot;, tk);\n        log.info(&quot;Result: {}&quot;, result);\n</code></pre>\n<p><strong>Output: token string, true</strong></p>\n<p>but this doesnt work:</p>\n<pre class=\"lang-java prettyprint-override\"><code>var tk = &quot;eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJLdXNoYW5lIiwiaWF0IjoxNzY1MTAwNTcwLCJleHAiOjE3NjUxODY5NzB9.npZp5gTPC-3mjqlLoQVVO2cmSsRfkzOeRZylKOqPf-4&quot;; // same one generated by makeToken earlier\n        var result = token.validateToken(tk);\n\n        log.info(&quot;Token: {}&quot;, tk);\n        log.info(&quot;Result: {}&quot;, result);\n</code></pre>\n<p><strong>Output: Invalid JWT Token</strong></p>\n<p>Does validating JWT's require different data type?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}