{
  "question": {
    "tags": [
      "java",
      "jenkins"
    ],
    "owner": {
      "account_id": 2094826,
      "reputation": 465,
      "user_id": 1863849,
      "user_type": "registered",
      "accept_rate": 75,
      "profile_image": "https://i.sstatic.net/SwKYW.jpg?s=256",
      "display_name": "Merlyn007",
      "link": "https://stackoverflow.com/users/1863849/merlyn007"
    },
    "is_answered": false,
    "view_count": 89,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1736759873,
    "creation_date": 1731104974,
    "last_edit_date": 1731119539,
    "question_id": 79171746,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79171746/persistent-malformedinputexception-after-java-update-in-jenkins-windows-setup",
    "title": "Persistent MalformedInputException After Java Update in Jenkins - Windows Setup",
    "body": "<p>I'm facing a <code>MalformedInputException: Input length = 4</code> error after updating both my Jenkins master and agent nodes to Java 21 on Windows. This only happens in production; our staging environment, running an identical pipeline, works fine with Java 21.</p>\n<h3>Current Setup:</h3>\n<ul>\n<li><strong>OS</strong>: Windows on both master and agent nodes.</li>\n<li><strong>Java Version</strong>: Recently updated to <strong>Java 21</strong>.</li>\n<li><strong>Error</strong>: <code>MalformedInputException: Input length = 4</code>, triggered during a specific stage of the build.</li>\n<li><strong>Agent Version</strong>: Running the latest <code>agent.jar</code>.</li>\n</ul>\n<h3>Troubleshooting So Far:</h3>\n<ul>\n<li><p>Ensured <code>agent.jar</code> on both nodes is using Java 21.</p>\n</li>\n<li><p>Followed <a href=\"https://support.snyk.io/hc/en-us/articles/9889983968925-Snyk-test-on-Jenkins-plugin-fails-with-MalformedInputException-Input-length-1-in-debug-log\" rel=\"nofollow noreferrer\">Snykâ€™s solution</a> to set encoding, but no luck. Added <code>-Dfile.encoding=UTF-8</code> to the environmental parameters in Windows, both on master and agents.</p>\n</li>\n<li><p>Restarted services.</p>\n</li>\n</ul>\n<h3>Additional Questions:</h3>\n<ul>\n<li>Are there any known compatibility issues with Java 21 and Jenkins on Windows?</li>\n<li>Could there be specific encoding configurations in <code>agent.jar</code> or Jenkins that need adjusting after the update?</li>\n</ul>\n<p>Any advice would be greatly appreciated! Thank you in advance for your help.</p>\n<pre><code>[re20-server-tag-release] $ cmd.exe /C &quot; &quot;C:\\Program Files (x86)\\Microsoft Visual Studio\\VB98\\vb6.exe&quot; /make /outdir C:\\jenkins-agent\\workspace\\re20-server-tag-release /d UsarQueSocket=1:ConUpTime=1:AntiExternos=0:Lac=1:DEBUGGING=0:PYMMO=1:UNLOCK_CPU=1 /out C:\\jenkins-agent\\workspace\\re20-server-tag-release\\vb6build12712032603954651177.log C:\\jenkins-agent\\workspace\\re20-server-tag-release\\Server.VBP &quot; &amp;&amp; exit %%ERRORLEVEL%%\nFATAL: Input length = 4\nAlso:   hudson.remoting.Channel$CallSiteStackTrace: Remote call to ao20-produccion\n        at hudson.remoting.Channel.attachCallSiteStackTrace(Channel.java:1923)\n        at hudson.remoting.UserRequest$ExceptionResponse.retrieve(UserRequest.java:384)\n        at hudson.remoting.Channel.call(Channel.java:1112)\n        at hudson.FilePath.act(FilePath.java:1228)\n        at hudson.FilePath.act(FilePath.java:1217)\n        at hudson.FilePath.readToString(FilePath.java:2482)\n        at PluginClassLoader for visual-basic-6//org.jenkinsci.plugins.vb6.VB6Builder.perform(VB6Builder.java:119)\n        at jenkins.tasks.SimpleBuildStep.perform(SimpleBuildStep.java:123)\n        at hudson.tasks.BuildStepCompatibilityLayer.perform(BuildStepCompatibilityLayer.java:80)\n        at hudson.tasks.BuildStepMonitor$1.perform(BuildStepMonitor.java:20)\n        at hudson.model.AbstractBuild$AbstractBuildExecution.perform(AbstractBuild.java:818)\n        at hudson.model.Build$BuildExecution.build(Build.java:199)\n        at hudson.model.Build$BuildExecution.doRun(Build.java:164)\n        at hudson.model.AbstractBuild$AbstractBuildExecution.run(AbstractBuild.java:527)\n        at hudson.model.Run.execute(Run.java:1831)\n        at hudson.model.FreeStyleBuild.run(FreeStyleBuild.java:44)\n        at hudson.model.ResourceController.execute(ResourceController.java:101)\n        at hudson.model.Executor.run(Executor.java:445)\njava.nio.charset.MalformedInputException: Input length = 4\n    at java.base/java.lang.String.throwMalformed(String.java:1279)\n    at java.base/java.lang.String.decodeUTF8_UTF16(String.java:1205)\n    at java.base/java.lang.String.newStringUTF8NoRepl(String.java:759)\n    at java.base/java.lang.String.newStringNoRepl1(String.java:790)\n    at java.base/java.lang.String.newStringNoRepl(String.java:772)\n    at java.base/java.lang.System$2.newStringNoRepl(System.java:2480)\n    at java.base/java.nio.file.Files.readString(Files.java:3349)\n    at Jenkins v2.479.1//hudson.FilePath$ReadToString.invoke(FilePath.java:2490)\n    at Jenkins v2.479.1//hudson.FilePath$ReadToString.invoke(FilePath.java:2485)\n    at Jenkins v2.479.1//hudson.FilePath$FileCallableWrapper.call(FilePath.java:3614)\n    at hudson.remoting.UserRequest.perform(UserRequest.java:225)\n    at hudson.remoting.UserRequest.perform(UserRequest.java:50)\n    at hudson.remoting.Request$2.run(Request.java:391)\n    at hudson.remoting.InterceptingExecutorService.lambda$wrap$0(InterceptingExecutorService.java:81)\n    at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)\n    at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)\n    at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)\n    at hudson.remoting.Engine$1.lambda$newThread$0(Engine.java:140)\n    at java.base/java.lang.Thread.run(Thread.java:1583)\nSending notification to Discord.\nFinished: FAILURE\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}