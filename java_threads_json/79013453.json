{
  "question": {
    "tags": [
      "java",
      "spring",
      "multithreading",
      "spring-batch",
      "virtual-threads"
    ],
    "owner": {
      "account_id": 260014,
      "reputation": 812,
      "user_id": 543320,
      "user_type": "registered",
      "accept_rate": 69,
      "profile_image": "https://www.gravatar.com/avatar/fd8fa620f858931b0c098a5887124c2e?s=256&d=identicon&r=PG",
      "display_name": "yaki_nuka",
      "link": "https://stackoverflow.com/users/543320/yaki-nuka"
    },
    "is_answered": true,
    "view_count": 8946,
    "answer_count": 5,
    "score": 4,
    "last_activity_date": 1727794213,
    "creation_date": 1727074160,
    "question_id": 79013453,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79013453/spring-and-virtual-threads",
    "title": "Spring and virtual threads",
    "body": "<p>I'm starting with JDK21 and virtual threads.\nI'm using Spring Framework 6.1.12  with Spring Batch 5.1.2</p>\n<p>I was using successfully a simple task executor like this:</p>\n<pre><code>&lt;bean id=&quot;taskExecutor&quot; class=&quot;org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor&quot;&gt;\n    &lt;property name=&quot;corePoolSize&quot;   value=&quot;10&quot; /&gt;\n    &lt;property name=&quot;maxPoolSize&quot;    value=&quot;20&quot; /&gt;\n    &lt;property name=&quot;waitForTasksToCompleteOnShutdown&quot; value=&quot;true&quot; /&gt;\n&lt;/bean&gt;\n</code></pre>\n<p>To test virtual threads and JDK21, I changed to this:</p>\n<pre><code>&lt;bean id=&quot;taskExecutor&quot; class=&quot;org.springframework.core.task.VirtualThreadTaskExecutor&quot;&gt;\n    &lt;constructor-arg name=&quot;threadNamePrefix&quot; value=&quot;VIRTUAL-thread&quot; /&gt;\n&lt;/bean&gt;\n</code></pre>\n<p>So, I have some questions about it:</p>\n<ol>\n<li>Is this &quot;migration&quot; right?</li>\n<li>Can I be sure it's using virtual threads? If I open VirtualThreadTaskExecutor, inside there is a VirtualThreadDelegate, in which all the methods raise exceptions.</li>\n<li>Is there any &quot;virtual threads pool&quot; in Spring? Or, is it possible or it makes sense there are 20 virtual thread pools concurrently? I think virtual threads are designed not to be pooled, but this is a great change for me and I want to be pretty sure I'm doing in the right way.</li>\n</ol>\n<p>So, in short, I have read wonderful things about virtual threads and performance, and I want to execute virtual threads in Spring and Spring Batch to test the performance in my software. If you have some guidelines, tips, etc. to migrate from platform threads to virtual threads, any help is very appreciated.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}