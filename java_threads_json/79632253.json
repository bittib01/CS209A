{
  "question": {
    "tags": [
      "java",
      "security",
      "resteasy",
      "dwr"
    ],
    "owner": {
      "account_id": 1964182,
      "reputation": 167,
      "user_id": 1764850,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/WJ58o.jpg?s=256",
      "display_name": "Linidu Praneeth Gunathilaka",
      "link": "https://stackoverflow.com/users/1764850/linidu-praneeth-gunathilaka"
    },
    "is_answered": false,
    "view_count": 157,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1747925437,
    "creation_date": 1747839357,
    "last_edit_date": 1747910745,
    "question_id": 79632253,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79632253/cross-site-request-forgery-vulnerability-for-dwr-request-calls",
    "title": "Cross-Site Request Forgery Vulnerability for DWR request calls",
    "body": "<p>I have a java application running on wildfly 10 and using java 8.\nThe requests are sending as DWR requests and using the method as POST.</p>\n<p>We have contrast agent for security running over the application and it detect Cross-Site Request Forgery for the dwr calls. example savings, deleting.\nex : /DWR/call/plaincall/ABCService.saveConfig.dwr</p>\n<p>For a fix for this, I used following approach.</p>\n<ol>\n<li>Generate CSRF token before start the requests and save the token in the session.</li>\n<li>Get the token from the session before initiate the dwr request call.</li>\n<li>Then add the token as a request parameter to the request.</li>\n<li>Then read the token from the back and validate it against the token which is saved in the session and perform the action only it validated.</li>\n<li>But still the contrast agent detect vulnerability for the requests.</li>\n</ol>\n<p>How I fix this problem?\nDoes the contrast agent is compatible with the DWR calls and checking vulnerabilities on such requests?</p>\n<p>AbcService.saveConfiguration = function(csrfToken, configuration, callback) {\ndwr.engine._execute(AbcService._path, 'AbcService', 'saveConfiguration', csrfToken.token, configuration, callback);\n}</p>\n<p>And validate it in the backend like this</p>\n<pre><code>if (!CsrfTokenUtil.isValidCsrfToken(csrfToken,rquest.getSession()){\n   return;\n}\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}