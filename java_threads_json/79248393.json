{
  "question": {
    "tags": [
      "java",
      "angular",
      "spring",
      "spring-boot",
      "websocket"
    ],
    "owner": {
      "account_id": 21932768,
      "reputation": 1,
      "user_id": 16214494,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/BF26C.png?s=256",
      "display_name": "Wojciech",
      "link": "https://stackoverflow.com/users/16214494/wojciech"
    },
    "is_answered": false,
    "view_count": 157,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1744501136,
    "creation_date": 1733242572,
    "question_id": 79248393,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79248393/a-websocket-frame-was-sent-with-an-unrecognised-opcode-of-7-angular-spring",
    "title": "A WebSocket frame was sent with an unrecognised opCode of [7]] Angular | Spring boot",
    "body": "<h1>WebSocket Frame with Unrecognised opCode of [7] When Connecting from Angular to Spring Boot WebSocket Server</h1>\n<p>I'm trying to connect an Angular application to a Spring Boot WebSocket server, but I am encountering an error with the following message:</p>\n<pre><code>A WebSocket frame was sent with an unrecognised opCode of [7]\n</code></pre>\n<p>Here is the Spring Boot WebSocket configuration I'm using:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\n@EnableWebSocketMessageBroker\npublic class WebsocketConfig implements WebSocketMessageBrokerConfigurer {\n\n    @Override\n    public void configureMessageBroker(MessageBrokerRegistry config) {\n        config.enableSimpleBroker(&quot;/topic&quot;);\n        config.setApplicationDestinationPrefixes(&quot;/app&quot;);\n    }\n\n    @Override\n    public void registerStompEndpoints(StompEndpointRegistry registry) {\n        registry.addEndpoint(&quot;/chess-websocket&quot;).setAllowedOrigins(&quot;http://localhost:4200&quot;).withSockJS();\n    }\n\n}\n</code></pre>\n<p>And this is the Angular code Iâ€™m using to connect to the WebSocket:</p>\n<pre class=\"lang-js prettyprint-override\"><code>import { Component, OnInit } from '@angular/core';\nimport { RouterOutlet } from '@angular/router';\nimport { Client } from '@stomp/stompjs';\nimport SockJS from 'sockjs-client';\n\n@Component({\n  selector: 'app-root',\n  standalone: true,\n  imports: [RouterOutlet],\n  templateUrl: './app.component.html',\n  styleUrl: './app.component.css',\n})\nexport class AppComponent implements OnInit {\n  title = 'client';\n  \n  ngOnInit(): void {\n    const socket = new SockJS('http://localhost:8080/chess-websocket');\n    const stompClient = new Client({\n      webSocketFactory: () =&gt; socket,\n      debug: (msg) =&gt; console.log(msg),\n      onConnect: () =&gt; console.log('Connected'),\n      onStompError: (frame) =&gt; console.error('STOMP Error:', frame),\n    });\n    stompClient.activate();\n  }\n}\n</code></pre>\n<h3>Dependencies in <code>package.json</code>:</h3>\n<pre class=\"lang-json prettyprint-override\"><code>&quot;dependencies&quot;: {\n  &quot;@angular/animations&quot;: &quot;^18.2.0&quot;,\n  &quot;@angular/common&quot;: &quot;^18.2.0&quot;,\n  &quot;@angular/compiler&quot;: &quot;^18.2.0&quot;,\n  &quot;@angular/core&quot;: &quot;^18.2.0&quot;,\n  &quot;@angular/forms&quot;: &quot;^18.2.0&quot;,\n  &quot;@angular/platform-browser&quot;: &quot;^18.2.0&quot;,\n  &quot;@angular/platform-browser-dynamic&quot;: &quot;^18.2.0&quot;,\n  &quot;@angular/router&quot;: &quot;^18.2.0&quot;,\n  &quot;@stomp/stompjs&quot;: &quot;^7.0.0&quot;,\n  &quot;rxjs&quot;: &quot;~7.8.0&quot;,\n  &quot;sockjs-client&quot;: &quot;^1.6.1&quot;,\n  &quot;tslib&quot;: &quot;^2.3.0&quot;,\n  &quot;zone.js&quot;: &quot;~0.14.10&quot;\n}\n\n</code></pre>\n<h3>Dependencies in <code>pom.xml</code>:</h3>\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-websocket&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n</code></pre>\n<p>This seems to be related to the WebSocket frame sent from the client-side. I have tried using <code>SockJS</code> with the <code>@stomp/stompjs</code> library, but the error persists.</p>\n<p>Has anyone encountered this issue or knows how to fix this error? Any help would be greatly appreciated!</p>\n<h3>Steps I've tried so far:</h3>\n<ol>\n<li>Verified the WebSocket server endpoint <code>/chess-websocket</code> is correctly configured and accessible on <code>http://localhost:8080</code>, Postman is able to connect.</li>\n<li>Checked CORS settings.</li>\n<li>Updated all relevant dependencies, including <code>@stomp/stompjs</code> and <code>sockjs-client</code>.</li>\n</ol>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}