{
  "question": {
    "tags": [
      "java",
      "httpclient",
      "micronaut",
      "micronaut-rest"
    ],
    "owner": {
      "account_id": 38396543,
      "reputation": 11,
      "user_id": 28753467,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/e760aa3a68418d922074c7fa3f10981d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "holeInWater",
      "link": "https://stackoverflow.com/users/28753467/holeinwater"
    },
    "is_answered": true,
    "view_count": 369,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1741633166,
    "creation_date": 1734015082,
    "last_edit_date": 1734942747,
    "question_id": 79275552,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79275552/micronaut-post-call-not-accepting-body-getting-body-as-optional-empty",
    "title": "Micronaut POST call not accepting body. Getting body as Optional.empty",
    "body": "<p>I am trying to build a POST call using Micronaut. Whenever I hit the API from POSTMAN, I always get body as &quot;Optional.empty&quot; in the server.</p>\n<p><strong>Controller :-</strong></p>\n<pre><code>import io.micronaut.core.annotation.NonNull;\nimport io.micronaut.http.HttpHeaders;\nimport io.micronaut.http.HttpRequest;\nimport io.micronaut.http.MediaType;\nimport io.micronaut.http.annotation.*;\nimport jakarta.inject.Inject;\nimport lombok.extern.log4j.Log4j2;\n\nimport java.util.Objects;\n\n@Controller(&quot;/abc/v1&quot;)\n@Log4j2\npublic class AbcController {\n      @Post(&quot;/get-new-user-referral-code&quot;)\n      @Produces(MediaType.APPLICATION_JSON)\n      @Consumes(MediaType.TEXT_PLAIN)\n      @WithSpan\n      public GetReferralCodeResponse getNewUserReferralCode(HttpRequest&lt;?&gt; request) {\n        String body = request.getBody().toString();\n        HttpHeaders headers = request.getHeaders();\n\n        log.info(&quot;Body = {}&quot;, body);\n\n    return apiResponse;\n  }\n}\n</code></pre>\n<p><strong>build.gradle :-</strong></p>\n<pre><code>import com.github.jengelman.gradle.plugins.shadow.tasks.ShadowJar\nplugins {\n    id(&quot;com.github.johnrengelman.shadow&quot;) version &quot;8.1.1&quot;\n    id(&quot;io.micronaut.application&quot;) version &quot;4.4.0&quot;\n    id(&quot;io.micronaut.aot&quot;) version &quot;4.4.0&quot;\n    id(&quot;groovy&quot;)\n    id(&quot;jacoco&quot;)\n}\n\nversion = &quot;0.1&quot;\ngroup = &quot;com.abc&quot;\n\nrepositories {\n    mavenCentral()\n}\n\ndependencies {\n    annotationProcessor(&quot;io.micronaut:micronaut-http-validation&quot;)\n    annotationProcessor(&quot;io.micronaut.serde:micronaut-serde-processor&quot;)\n    implementation(&quot;io.micronaut.serde:micronaut-serde-jackson&quot;)\n    implementation(&quot;io.micronaut:micronaut-management&quot;)\n    implementation(&quot;io.micronaut:micronaut-http-client&quot;)\n\n\n    implementation 'jakarta.annotation:jakarta.annotation-api:2.1.1'\n    implementation 'jakarta.xml.bind:jakarta.xml.bind-api:4.0.0'\n\n    compileOnly 'org.projectlombok:lombok:1.18.30'\n    annotationProcessor 'org.projectlombok:lombok:1.18.30'\n    testCompileOnly 'org.projectlombok:lombok:1.18.30'\n\n    implementation 'software.amazon.awssdk:bom'\n    implementation 'software.amazon.awssdk:appconfigdata'\n    implementation 'software.amazon.awssdk:sts'\n    implementation 'software.amazon.awssdk:netty-nio-client:2.24.3'\n    implementation 'io.netty:netty-codec-http:4.1.108.Final'\n    implementation 'com.github.luben:zstd-jni:1.5.6-6'\n    implementation 'software.amazon.awssdk:apache-client:2.20.69'\n    implementation(&quot;software.amazon.awssdk:url-connection-client:2.17+&quot;)\n\n    implementation 'com.amazonaws:aws-lambda-java-core:1.2.3'\n    implementation 'software.amazon.awssdk:lambda:2.17.206'\n\n    implementation 'software.amazon.awssdk:dynamodb'\n    implementation 'software.amazon.awssdk:dynamodb-enhanced'\n\n    implementation 'software.amazon.awssdk:sns'\n    implementation 'software.amazon.awssdk:sqs'\n\n    implementation 'org.apache.logging.log4j:log4j-api:2.20.0'\n    implementation 'org.apache.logging.log4j:log4j-core:2.20.0'\n\n    implementation 'org.json:json:20231013'\n    implementation 'org.jsonschema2pojo:jsonschema2pojo-core:1.2.1'\n\n    // opentelemetry\n    implementation(&quot;io.opentelemetry:opentelemetry-exporter-otlp&quot;)\n    implementation('io.opentelemetry.instrumentation:opentelemetry-instrumentation-annotations:2.3.0')\n    implementation(&quot;io.opentelemetry:opentelemetry-exporter-logging&quot;)\n    implementation(&quot;io.opentelemetry:opentelemetry-sdk&quot;)\n    implementation(&quot;io.reactivex.rxjava2:rxjava:2.2.21&quot;)\n\n\n    testAnnotationProcessor 'io.micronaut:micronaut-inject-java'\n\n    implementation(&quot;io.micronaut.kafka:micronaut-kafka&quot;)\n\n    developmentOnly(&quot;io.micronaut.controlpanel:micronaut-control-panel-ui&quot;)\n    developmentOnly(&quot;io.micronaut.controlpanel:micronaut-control-panel-management&quot;)\n\n    implementation(&quot;io.micronaut.objectstorage:micronaut-object-storage-aws&quot;)\n\n    testImplementation 'org.mockito:mockito-core:3.12.4'\n\n}\n\n\napplication {\n    mainClass = &quot;com.abc.Application&quot;\n}\njava {\n    sourceCompatibility = JavaVersion.toVersion(&quot;21&quot;)\n    targetCompatibility = JavaVersion.toVersion(&quot;21&quot;)\n}\n\n\ngraalvmNative.toolchainDetection = false\nmicronaut {\n    runtime(&quot;netty&quot;)\n    testRuntime(&quot;junit5&quot;)\n    processing {\n        incremental(true)\n        annotations(&quot;com.abc.*&quot;)\n    }\n    aot {\n        // Please review carefully the optimizations enabled below\n        // Check https://micronaut-projects.github.io/micronaut-aot/latest/guide/ for more details\n        optimizeServiceLoading = false\n        convertYamlToJava = false\n        precomputeOperations = true\n        cacheEnvironment = true\n        optimizeClassLoading = true\n        deduceEnvironment = true\n        optimizeNetty = true\n        replaceLogbackXml = true\n    }\n}\n\n\ntasks.named(&quot;dockerfileNative&quot;) {\n    jdkVersion = &quot;21.0.4&quot;\n}\n\n</code></pre>\n<p><strong>Logs</strong></p>\n<pre><code>&quot;Unrecognized token 'Optional': was expecting (JSON String, Number, Array, Object or token 'null', 'true' or 'false')\\n at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled)\n</code></pre>\n<p><strong>Curl Request :-</strong></p>\n<pre><code>curl --location 'http://localhost:8080/abc/v1/get-new-user-referral-code' \\\n--header 'Content-Length: 1000' \\\n--header 'Content-Type: text/plain' \\\n--data 'abc'\n</code></pre>\n<p>I have tried multiple changes from documentations available but no luck.\nCan someone please help me understand why I am receiving empty body in the request.</p>\n<p>GET requests are working fine.\nI am also able to receive all the headers in the api.\nOnly issue is with body</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}