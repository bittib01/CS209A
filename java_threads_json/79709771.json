{
  "question": {
    "tags": [
      "java",
      "jvm",
      "garbage-collection",
      "out-of-memory",
      "metaspace"
    ],
    "owner": {
      "account_id": 6749614,
      "reputation": 788,
      "user_id": 5200064,
      "user_type": "registered",
      "accept_rate": 80,
      "profile_image": "https://www.gravatar.com/avatar/79b695a0b6482c768728b8b1a2c8b089?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "lmk",
      "link": "https://stackoverflow.com/users/5200064/lmk"
    },
    "is_answered": true,
    "view_count": 157,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1753301887,
    "creation_date": 1753146240,
    "last_edit_date": 1753166652,
    "question_id": 79709771,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79709771/java-17-metaspace-data-allocation-failure-in-gc-log-without-a-java-lang-outof",
    "title": "Java 17: Metaspace (data) allocation failure in GC log without a java.lang.OutOfMemoryError: Metaspace",
    "body": "<p>I am seeing the below in the GC log before the JVM pauses for several minutes after which it gets restarted externally.</p>\n<pre class=\"lang-none prettyprint-override\"><code>[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] Metaspace (data) allocation failed for size 1075\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] Usage:\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]   Non-class:    168.00 MB used.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]       Class:     19.79 MB used.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]        Both:    187.79 MB used.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] Virtual space:\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]   Non-class space:      192.00 MB reserved,     170.06 MB ( 89%) committed,  3 nodes.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]       Class space:       96.00 MB reserved,      21.94 MB ( 23%) committed,  1 nodes.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]              Both:      288.00 MB reserved,     192.00 MB ( 67%) committed.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] Chunk freelists:\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]    Non-Class:  6.83 MB\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]        Class:  10.47 MB\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]         Both:  17.30 MB\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] MaxMetaspaceSize: 192.00 MB\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] CompressedClassSpaceSize: 96.00 MB\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] Initial GC threshold: 21.00 MB\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] Current GC threshold: 192.00 MB\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] CDS: off\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] MetaspaceReclaimPolicy: balanced\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]  - commit_granule_bytes: 65536.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]  - commit_granule_words: 8192.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]  - virtual_space_node_default_size: 8388608.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]  - enlarge_chunks_in_place: 1.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]  - new_chunks_are_fully_committed: 0.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]  - uncommit_free_chunks: 1.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]  - use_allocation_guard: 0.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]  - handle_deallocations: 1.\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] Internal statistics:\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom]\n[2025-07-18T18:08:42.605-0600][info][gc,metaspace,freelist,oom] num_allocs_failed_limit: 717.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_arena_births: 71282.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_arena_deaths: 63782.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_vsnodes_births: 4.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_vsnodes_deaths: 0.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_space_committed: 3072.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_space_uncommitted: 1.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_chunks_returned_to_freelist: 95133.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_chunks_taken_from_freelist: 114240.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_chunk_merges: 22894.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_chunk_splits: 33864.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_chunks_enlarged: 6650.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom] num_inconsistent_stats: 0.\n[2025-07-18T18:08:42.606-0600][info][gc,metaspace,freelist,oom]\n</code></pre>\n<p>Looking at this log, it seems to point an imminent Metaspace OOM however I am not sure if its indeed the case given the log seems to indicate only an allocation failure &amp; there was no <code>java.lang.OutOfMemoryError: Metaspace</code> getting thrown afterwards just a very long pause.</p>\n<p>Is my understanding correct that the above implies an imminent Metaspace OOM?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}