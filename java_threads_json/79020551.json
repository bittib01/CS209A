{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "open-telemetry",
      "micrometer-tracing",
      "open-telemetry-java"
    ],
    "owner": {
      "account_id": 18044566,
      "reputation": 323,
      "user_id": 13115896,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/6d35ea24f31161f110fed75caf9d2d04?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "sg2000",
      "link": "https://stackoverflow.com/users/13115896/sg2000"
    },
    "is_answered": false,
    "view_count": 506,
    "answer_count": 0,
    "score": 2,
    "last_activity_date": 1763414185,
    "creation_date": 1727216537,
    "last_edit_date": 1763414185,
    "question_id": 79020551,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79020551/springboot-3-micrometer-tracing-issue",
    "title": "Springboot 3 Micrometer tracing Issue",
    "body": "<p>We are using Springboot 3.1.4 and i have been trying to leverage the Micrometer based approach for distrubted tracing of the application. I have included the right build.gradle dependencies but the traces are only working for the health checkpoints and nothing else. Looking deeper I noticed a strange behavior. There are 2 flows i tested:</p>\n<p>Flow 1 -&gt; REST call to service 1 -&gt; JMS Publish to service 2 method</p>\n<p>Flow 2 -&gt; REST call to service 2 method</p>\n<p>In both cases, the incoming service received a <strong>PropagatedSpan with traceFlags=00</strong>. In this case <strong>no traces/spans got captured/sent</strong>.</p>\n<p>({opentelemetry-trace-span-key=<strong>PropagatedSpan</strong>{ImmutableSpanContext{traceId=a2ea0716a45d02a490d7cef097acdb9a, spanId=adb8f982d4294b13, <strong>traceFlags=00</strong>, traceState=ArrayBasedTraceState{entries=[]}, remote=false, valid=true}}, opentelemetry-baggage-key={}, otelTraceContext=ImmutableSpanContext{traceId=a2ea0716a45d02a490d7cef097acdb9a, spanId=adb8f982d4294b13, traceFlags=00, traceState=ArrayBasedTraceState{entries=[]}, remote=false, valid=true}})</p>\n<p>However, when the service 2 received the request from service 1 in Flow 1, it received the span as a <strong>SDKSpan with traceFlags=01</strong>. When this happens, i see <strong>the traces/spans captured</strong> for the service 2 (not service 1).</p>\n<p>({opentelemetry-baggage-key={}, opentelemetry-trace-span-key=<strong>SdkSpan</strong>{traceId=c92ee058c19d5288d6cc72d2bb9c2a3b, spanId=5797df5b5620f02d, parentSpanContext=ImmutableSpanContext{traceId=00000000000000000000000000000000, spanId=0000000000000000, traceFlags=00, traceState=ArrayBasedTraceState{entries=[]}, remote=false, valid=false}, name=, kind=SERVER, attributes=null, status=ImmutableStatusData{statusCode=UNSET, description=}, totalRecordedEvents=0, totalRecordedLinks=0, startEpochNanos=1727214899985765169, endEpochNanos=0}, otelTraceContext=ImmutableSpanContext{traceId=c92ee058c19d5288d6cc72d2bb9c2a3b, spanId=5797df5b5620f02d, <strong>traceFlags=01</strong>, traceState=ArrayBasedTraceState{entries=[]}, remote=false, valid=true}}</p>\n<p>Is there a way I can make the incoming trace/span to leverage SDKSpan instead of PropagatedSpan, which seems to block even the custom spans I created?</p>\n<p>Any other way to address this issue? Thank you in advance!</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}