{
  "question": {
    "tags": [
      "java",
      "google-oauth",
      "spring-webflux"
    ],
    "owner": {
      "account_id": 15630656,
      "reputation": 13,
      "user_id": 11387135,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/d19c1cb635a9d7452b191754873fadd3?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Seema",
      "link": "https://stackoverflow.com/users/11387135/seema"
    },
    "is_answered": false,
    "view_count": 106,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1759185763,
    "creation_date": 1755774409,
    "last_edit_date": 1759185763,
    "question_id": 79742193,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79742193/spring-webflux-authenticationsuccesshandler-not-invoked-in-oauth2-login-flow",
    "title": "Spring Webflux, authenticationSuccessHandler not invoked in oAuth2 login flow",
    "body": "<p>I am still a beginner in Webflux. I want to get the user logged in using google and once the user is authenticated, I want to create my custom JWT (which has some role info specific to my app) and return in the response header. I am doing this in a class <code>class JwtAuthenticationSuccessHandler implements ServerAuthenticationSuccessHandler</code></p>\n<p>I also want to intercept any incoming request and check if the jwt is valid or not for that I have customised AuthenticationWebFilter which I am registering as below;</p>\n<p><code>.addFilterAt(authenticationWebFilter, SecurityWebFiltersOrder.AUTHENTICATION)</code></p>\n<p>My security config looks like below:</p>\n<pre><code> return http\n                .securityContextRepository(NoOpServerSecurityContextRepository.getInstance()) // ðŸš€ disables WebSession\n                .authorizeExchange(exchanges -&gt; exchanges                      \n                        .pathMatchers(&quot;**/vendor/**&quot;).hasRole(Role.VENDOR.name())\n                        .pathMatchers(&quot;**/customer/**&quot;).hasRole(Role.CUSTOMER.name())\n                        .anyExchange().authenticated()\n                )\n                .addFilterAt(authenticationWebFilter, SecurityWebFiltersOrder.AUTHENTICATION)\n//.addFilterAfter(jwtHeaderFilter, SecurityWebFiltersOrder.AUTHENTICATION) // commented as no error but no output\n                .httpBasic(ServerHttpSecurity.HttpBasicSpec::disable)\n                .formLogin(ServerHttpSecurity.FormLoginSpec::disable)\n                .csrf(ServerHttpSecurity.CsrfSpec::disable)\n                .oauth2Login(oauth2 -&gt; oauth2\n                        .authenticationSuccessHandler(jwtAuthenticationSuccessHandler))\n                .build();\n</code></pre>\n<p>jwtAuthenticationSuccessHandler never gets invoked and if I try to achieve same using filter class jwtHeaderFilter AFTER SecurityWebFiltersOrder.AUTHENTICATION) then filter gets invoked,but jwt token in response header is missing, however no error in log.</p>\n<p>Note: When I test login flow, I get the user info in browser response body but no jwt token in header.</p>\n<p>I am stuck here and searched a lot but could not find any example code for Webflux + OAuth2 + Jwt.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}