{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "docker",
      "spring-bean",
      "docker-api"
    ],
    "owner": {
      "account_id": 19767114,
      "reputation": 51,
      "user_id": 14474860,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GgTrb04ca8CwETwya3lTr7PSdVE67X6j4NMgwtL=k-s256",
      "display_name": "macgood",
      "link": "https://stackoverflow.com/users/14474860/macgood"
    },
    "is_answered": true,
    "view_count": 1276,
    "accepted_answer_id": 77941745,
    "answer_count": 2,
    "score": 1,
    "last_activity_date": 1739217591,
    "creation_date": 1707142061,
    "last_edit_date": 1707144171,
    "question_id": 77941532,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/77941532/use-docker-api-with-spring-boot",
    "title": "Use docker api with Spring Boot",
    "body": "<p>Basically, I have a task, I want to create a Docker container when running a Spring Boot application using Docker Java API and then use that container in various controllers. When I create Bean with docker client, I get an error.</p>\n<p>Code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\npublic class DockerConfiguration {\n    @Bean\n    DockerClient dockerClient() {\n        return DockerClientBuilder.getInstance().build();\n    }\n}\n</code></pre>\n<p>Error:</p>\n<pre><code>Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.\n2024-02-05T17:42:07.481+03:00 ERROR 18580 --- [           main] o.s.boot.SpringApplication               : Application run failed\n\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dockerClient' defined in class path resource [it/macgood/docker/DockerConfiguration.class]: Failed to instantiate [com.github.dockerjava.api.DockerClient]: Factory method 'dockerClient' threw exception with message: javax/ws/rs/core/Configuration\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:485) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1334) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1164) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:561) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:959) ~[spring-context-6.1.3.jar:6.1.3]\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624) ~[spring-context-6.1.3.jar:6.1.3]\n    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:334) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343) ~[spring-boot-3.2.2.jar:3.2.2]\n    at it.macgood.docker.DockerApplication.main(DockerApplication.java:52) ~[classes/:na]\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.github.dockerjava.api.DockerClient]: Factory method 'dockerClient' threw exception with message: javax/ws/rs/core/Configuration\n    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:177) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:647) ~[spring-beans-6.1.3.jar:6.1.3]\n    ... 19 common frames omitted\nCaused by: java.lang.NoClassDefFoundError: javax/ws/rs/core/Configuration\n    at com.github.dockerjava.jaxrs.JerseyDockerHttpClient$Builder.build(JerseyDockerHttpClient.java:124) ~[docker-java-transport-jersey-3.3.4.jar:na]\n    at com.github.dockerjava.core.DockerClientBuilder.build(DockerClientBuilder.java:106) ~[docker-java-3.3.4.jar:na]\n    at it.macgood.docker.DockerConfiguration.dockerClient(DockerConfiguration.java:25) ~[classes/:na]\n    at it.macgood.docker.DockerConfiguration$$SpringCGLIB$$0.CGLIB$dockerClient$0(&lt;generated&gt;) ~[classes/:na]\n    at it.macgood.docker.DockerConfiguration$$SpringCGLIB$$FastClass$$1.invoke(&lt;generated&gt;) ~[classes/:na]\n    at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:258) ~[spring-core-6.1.3.jar:6.1.3]\n    at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:331) ~[spring-context-6.1.3.jar:6.1.3]\n    at it.macgood.docker.DockerConfiguration$$SpringCGLIB$$0.dockerClient(&lt;generated&gt;) ~[classes/:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\n    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:140) ~[spring-beans-6.1.3.jar:6.1.3]\n    ... 20 common frames omitted\nCaused by: java.lang.ClassNotFoundException: javax.ws.rs.core.Configuration\n    at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:641) ~[na:na]\n    at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:188) ~[na:na]\n    at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:520) ~[na:na]\n    ... 33 common frames omitted\n</code></pre>\n<p>After that, I added <code>javax.ws.rs-api</code> dependency</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;javax.ws.rs&lt;/groupId&gt;\n    &lt;artifactId&gt;javax.ws.rs-api&lt;/artifactId&gt;\n    &lt;version&gt;2.0.1&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>And got another error:</p>\n<pre><code>Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.\n2024-02-05T16:59:23.158+03:00 ERROR 14156 --- [           main] o.s.boot.SpringApplication               : Application run failed\n\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'dockerClient' defined in class path resource [it/macgood/docker/DockerConfiguration.class]: Failed to instantiate [com.github.dockerjava.api.DockerClient]: Factory method 'dockerClient' threw exception with message: ClassCastException: attempting to castjar:file:/C:/Users/Home/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar!/javax/ws/rs/client/ClientBuilder.class to jar:file:/C:/Users/Home/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar!/javax/ws/rs/client/ClientBuilder.class\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:651) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:485) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1334) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1164) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:561) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:521) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:325) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:323) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:975) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:959) ~[spring-context-6.1.3.jar:6.1.3]\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624) ~[spring-context-6.1.3.jar:6.1.3]\n    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:334) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354) ~[spring-boot-3.2.2.jar:3.2.2]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343) ~[spring-boot-3.2.2.jar:3.2.2]\n    at it.macgood.docker.DockerApplication.main(DockerApplication.java:10) ~[classes/:na]\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.github.dockerjava.api.DockerClient]: Factory method 'dockerClient' threw exception with message: ClassCastException: attempting to castjar:file:/C:/Users/Home/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar!/javax/ws/rs/client/ClientBuilder.class to jar:file:/C:/Users/Home/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar!/javax/ws/rs/client/ClientBuilder.class\n    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:177) ~[spring-beans-6.1.3.jar:6.1.3]\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:647) ~[spring-beans-6.1.3.jar:6.1.3]\n    ... 19 common frames omitted\nCaused by: java.lang.LinkageError: ClassCastException: attempting to castjar:file:/C:/Users/Home/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar!/javax/ws/rs/client/ClientBuilder.class to jar:file:/C:/Users/Home/.m2/repository/javax/ws/rs/javax.ws.rs-api/2.0.1/javax.ws.rs-api-2.0.1.jar!/javax/ws/rs/client/ClientBuilder.class\n    at javax.ws.rs.client.ClientBuilder.newBuilder(ClientBuilder.java:97) ~[javax.ws.rs-api-2.0.1.jar:2.0.1]\n    at com.github.dockerjava.jaxrs.JerseyDockerCmdExecFactory.init(JerseyDockerCmdExecFactory.java:184) ~[docker-java-transport-jersey-3.2.1.jar:na]\n    at com.github.dockerjava.core.DockerClientImpl.withDockerCmdExecFactory(DockerClientImpl.java:203) ~[docker-java-core-3.2.1.jar:na]\n    at com.github.dockerjava.core.DockerClientBuilder.build(DockerClientBuilder.java:47) ~[docker-java-3.2.1.jar:na]\n    at it.macgood.docker.DockerConfiguration.dockerClient(DockerConfiguration.java:12) ~[classes/:na]\n    at it.macgood.docker.DockerConfiguration$$SpringCGLIB$$0.CGLIB$dockerClient$0(&lt;generated&gt;) ~[classes/:na]\n    at it.macgood.docker.DockerConfiguration$$SpringCGLIB$$FastClass$$1.invoke(&lt;generated&gt;) ~[classes/:na]\n    at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:258) ~[spring-core-6.1.3.jar:6.1.3]\n    at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:331) ~[spring-context-6.1.3.jar:6.1.3]\n    at it.macgood.docker.DockerConfiguration$$SpringCGLIB$$0.dockerClient(&lt;generated&gt;) ~[classes/:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:na]\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77) ~[na:na]\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:na]\n    at java.base/java.lang.reflect.Method.invoke(Method.java:568) ~[na:na]\n    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:140) ~[spring-beans-6.1.3.jar:6.1.3]\n    ... 20 common frames omitted\n</code></pre>\n<p>And I don't understand that I need to do to fix it?</p>\n<p>What I need to do to create DockerClient, Docker Container and etc.?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}