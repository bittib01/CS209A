{
  "question": {
    "tags": [
      "javascript",
      "java",
      "checkmarx"
    ],
    "owner": {
      "account_id": 34742008,
      "reputation": 1,
      "user_id": 26746450,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/988720a4d2bd1366488637514e1b9069?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Chanky",
      "link": "https://stackoverflow.com/users/26746450/chanky"
    },
    "is_answered": false,
    "view_count": 348,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1725301335,
    "creation_date": 1723393083,
    "question_id": 78858792,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78858792/checkmarx-issue-client-dom-stored-xss",
    "title": "Checkmarx issue : Client DOM Stored XSS",
    "body": "<p>I am facing a Client DOM Stored XSS issue with below code where on ajax success I am getting data as a return value :</p>\n<pre><code>function getGridData(sURL, sData, sErrorMsg){\n                showElement($('#loadingBG')); \n                $.ajax({\n                          type: &quot;POST&quot;,\n                          url: sURL,\n                          data:sData, //Data sent to controller//\n                          dataType:&quot;json&quot;,             \n                          cache: false,\n                          async:false,\n                          loadtext: &quot;Loading...&quot;, \n                          on403: function(t) {\n                                location.href= contextPath+'/sequencedWP';\n                              },\n                          error: function(data, err){\n                          //alert(&quot;AJAX Error: &quot;+err);\n                                  if(data.status==403){\n                                        location.href= contextPath+'/sequencedWP';\n                                    }else{\n                                         alert(&quot;AJAX Error: &quot;+JSON.stringify(data));\n                                    }\n                          },            \n                          success: function(data){\n                              isLocked = false;\n                              if(sURL.indexOf(&quot;exportToExcel&quot;)== -1){\n                                  $(&quot;#sequencedWPSummaryTbl&quot;).jqGrid('GridUnload'); //Unload Old Grid//\n                                    $(&quot;#sequencedWPTbl&quot;).jqGrid('GridUnload'); //Unload Old Grid//\n                                    $(&quot;#sequencedWPSummaryTbl1&quot;).jqGrid('GridUnload');\n                                  //  $(&quot;.ui-pg-input&quot;).val(data.filterBean.currentPage);\n                                     sortOrder = data.filterBean.orderByDirection;\n                                     searchParam = data.filterBean.filterParam;\n                                     sortColumnName = data.filterBean.columnName;\n                                     successMsg = data.successMsg;\n                                     searchJsonData = data.filterBean.searchData;\n                                     idsOfSelectedRows = new Array();\n                                     containerList= data.containerList;\n                                     shipWithId = new Array();\n                                     pickWaveId = new Array();\n                                     pickWaveIdAll = new Array();\n                                     wpTypes = new Array();\n                                     statusIds = new Array();\n                                     pickSeqArray = new Array();\n                                     filterData='';\n                                     if (typeof searchJsonData != 'undefined' &amp;&amp; ''!=searchJsonData)\n                                        {\n                                             filterData =  JSON.parse(searchJsonData);\n\n\n\nThe checmarx scanner shows error as : \nThe method generateGrid embeds untrusted data in generated output with $, at line 3 of sequencedWorkPackage.js file. This untrusted data is embedded into the output without proper sanitization or encoding, enabling an attacker to inject malicious code into the generated web-page.\n</code></pre>\n<p>Line number code :</p>\n<pre><code>1 function generateGrid(workPackage){   \n2       var fscList = '{';\n3           $(containerList).each(function() {\n4               fscList += this.containerId + ':&quot;' + this.containerTypeCode + '&quot;,';\n5           });\n6           fscList += '}';\n        \n</code></pre>\n<p>The response coming from ajax call is sent using :</p>\n<pre><code>model.addAttribute(&quot;jsonData&quot;,gridData.getJSONString());\n\nresponse.getWriter().write(gridData.getJSONString());   \n</code></pre>\n<p>Tried using jQuery instead of $ at line 3 in above . Didn't work.\nCan you please help with this issue.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}