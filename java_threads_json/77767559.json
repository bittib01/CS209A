{
  "question": {
    "tags": [
      "java",
      "multithreading"
    ],
    "owner": {
      "account_id": 6099767,
      "reputation": 5261,
      "user_id": 4759176,
      "user_type": "registered",
      "accept_rate": 74,
      "profile_image": "https://i.sstatic.net/0U1e5.jpg?s=256",
      "display_name": "parsecer",
      "link": "https://stackoverflow.com/users/4759176/parsecer"
    },
    "is_answered": true,
    "view_count": 283,
    "accepted_answer_id": 77767586,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1722625211,
    "creation_date": 1704495117,
    "question_id": 77767559,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/77767559/java-executorservice-newvirtualthreadpertaskexecutor-the-thread-exits-before-g",
    "title": "Java ExecutorService, newVirtualThreadPerTaskExecutor: the thread exits before getting input from scanner",
    "body": "<p>I have this simple code for getting a name from the user in the first thread, adding it to the queue, and printing the names using the second thread:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import java.util.Scanner;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.LinkedBlockingQueue;\n\npublic class TestThreads {\n    private static final Scanner scanner = new Scanner(System.in);\n    private static ExecutorService executor = Executors.newVirtualThreadPerTaskExecutor();\n    private static LinkedBlockingQueue&lt;String&gt; names = new LinkedBlockingQueue&lt;&gt;();\n    \n    public static void main(String[] args) {\n        executor.submit(() -&gt; {\n            try {\n                while (true) {\n                    String name = getName();\n                    names.add(name);\n                }\n            } catch (Exception e)  {\n                e.printStackTrace();\n            }\n        });\n\n        executor.submit(() -&gt; {\n            try {\n                while (true) {\n                    if (!names.isEmpty())  {\n                        String name = names.poll();\n                        System.out.println(&quot;\\n**** The name is &quot; + name + &quot; ****\\n&quot;);\n                    }\n                }\n            } catch (Exception e)  {\n                e.printStackTrace();\n            }\n        });\n    }\n    \n    private static String getName()  {\n        System.out.print(&quot;Enter a name: &quot;);\n        return scanner.nextLine();\n    }\n}\n</code></pre>\n<p>However the output is</p>\n<pre><code>Enter a name: \nProcess finished with exit code 0\n</code></pre>\n<p>The program exits before the user has a chance to enter any name, despite the infinite <code>while</code> loops. What am I doing wrong?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}