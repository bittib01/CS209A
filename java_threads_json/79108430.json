{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-boot",
      "active-directory",
      "ldap"
    ],
    "owner": {
      "account_id": 11691005,
      "reputation": 139,
      "user_id": 8559309,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/d1a2669404853281e43ac93c82cdc8e8?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Praguru 14",
      "link": "https://stackoverflow.com/users/8559309/praguru-14"
    },
    "is_answered": false,
    "view_count": 172,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1729803636,
    "creation_date": 1729479022,
    "question_id": 79108430,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79108430/active-directory-in-springboot-3",
    "title": "Active Directory in Springboot 3",
    "body": "<p>I am trying to migrate an old code based on Springboot 2.1 to Spring 3.0.8.</p>\n<p>This includes AD integration in it. Now the AD code in Springboot 2.1 was working fine, but as soon as I migrated to Springboot 3, it stopped working and started showing</p>\n<p><code>org.springframework.ldap.InvalidNameException: [LDAP: error code 34 - invalid DN]</code></p>\n<p>even though I haven't made any changes to the AD side.</p>\n<p>Here is my old code -</p>\n<pre><code>    @Autowired\n    public void configure(AuthenticationManagerBuilder auth) throws Exception {\n\n        ActiveDirectoryLdapAuthenticationProvider adProvider = new ActiveDirectoryLdapAuthenticationProvider(domain,\n                ldapUrls, ldapBaseDn);\n        adProvider.setConvertSubErrorCodesToExceptions(true);\n        adProvider.setUseAuthenticationRequestCredentials(true);\n\n        if (ldapUserDnPattern != null &amp;&amp; ldapUserDnPattern.trim().length() &gt; 0) {\n            adProvider.setSearchFilter(&quot;(&amp;(objectClass=user)(sAMAccountName={1}))&quot;);\n            // adProvider.setSearchFilter(ldapUserDnPattern);\n        }\n\n        auth.authenticationProvider(adProvider);\n        auth.eraseCredentials(false);\n\n    }\n</code></pre>\n<p>My new code doesnt have much changes , as suggested by various documents.</p>\n<pre><code>    @Bean\n    public AuthenticationManager authManager(HttpSecurity http) throws Exception {\n        ActiveDirectoryLdapAuthenticationProvider adProvider =\n                new ActiveDirectoryLdapAuthenticationProvider(domain, ldapUrls,ldapBaseDn);\n        \n \n        adProvider.setConvertSubErrorCodesToExceptions(true);\n        adProvider.setUseAuthenticationRequestCredentials(true);\n        adProvider.setSearchFilter(&quot;(&amp;(objectClass=user)(sAMAccountName={1}))&quot;);\n\n        AuthenticationManagerBuilder authenticationManagerBuilder =\n                http.getSharedObject(AuthenticationManagerBuilder.class);\n        authenticationManagerBuilder.authenticationProvider(adProvider);\n        return authenticationManagerBuilder.build();\n</code></pre>\n<p>I tried to implement various strategies and implementations but it didn't work.</p>\n<p>I cannot share my domain, ldapUrls and ldapBaseDn due to company policy but they have been the same throughout the process and i checked using Apache Directory Studio my code configurations are correct.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}