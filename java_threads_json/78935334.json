{
  "question": {
    "tags": [
      "java",
      "maven",
      "plugins",
      "minecraft",
      "spigot"
    ],
    "owner": {
      "account_id": 28182748,
      "reputation": 1,
      "user_id": 21539496,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/uprek.jpg?s=256",
      "display_name": "HC12",
      "link": "https://stackoverflow.com/users/21539496/hc12"
    },
    "is_answered": false,
    "view_count": 379,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1733208626,
    "creation_date": 1725113297,
    "last_edit_date": 1733208626,
    "question_id": 78935334,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78935334/vault-doesnt-load-correctly-paperspigot-1-21-1",
    "title": "Vault doesn&#39;t load correctly. [PaperSpigot 1.21.1]",
    "body": "<p>So I'm writing a minecraft plugin for Paper 1.21.1. The concept is a PaySign, so you're able to place a special sign that when you right click it, it sends Money to another player.</p>\n<p>I added dependencies for VaultAPI and <code>depend: Vault</code> into my plugin.yml file but it still doesnt work.</p>\n<p>Other plugins:</p>\n<ul>\n<li>AuthMe-5.6.0</li>\n<li>EssentialsX-2.21.0-dev</li>\n<li>LogBlock-1.19.0.0</li>\n<li>SkinsRestorer latest</li>\n<li>Vault 1.17.3</li>\n</ul>\n<p>Resulting Stacktrace after starting the Server:</p>\n<pre><code>java.lang.NoClassDefFoundError: net/milkbowl/vault/economy/Economy\n        at paysignssr-1.0-SNAPSHOT.jar/com.github.hc12.paysignssr.PaySignSSR.setupEconomy(PaySignSSR.java:27) ~[paysignssr-1.0-SNAPSHOT.jar:?]\n        at paysignssr-1.0-SNAPSHOT.jar/com.github.hc12.paysignssr.PaySignSSR.onEnable(PaySignSSR.java:18) ~[paysignssr-1.0-SNAPSHOT.jar:?]\n        at org.bukkit.plugin.java.JavaPlugin.setEnabled(JavaPlugin.java:288) ~[paper-mojangapi-1.21.1-R0.1-SNAPSHOT.jar:?]\n        at io.papermc.paper.plugin.manager.PaperPluginInstanceManager.enablePlugin(PaperPluginInstanceManager.java:202) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at io.papermc.paper.plugin.manager.PaperPluginManagerImpl.enablePlugin(PaperPluginManagerImpl.java:109) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at org.bukkit.plugin.SimplePluginManager.enablePlugin(SimplePluginManager.java:520) ~[paper-mojangapi-1.21.1-R0.1-SNAPSHOT.jar:?]\n        at org.bukkit.craftbukkit.CraftServer.enablePlugin(CraftServer.java:640) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at org.bukkit.craftbukkit.CraftServer.enablePlugins(CraftServer.java:589) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at net.minecraft.server.MinecraftServer.loadWorld0(MinecraftServer.java:754) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at net.minecraft.server.MinecraftServer.loadLevel(MinecraftServer.java:516) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at net.minecraft.server.dedicated.DedicatedServer.initServer(DedicatedServer.java:329) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at net.minecraft.server.MinecraftServer.runServer(MinecraftServer.java:1215) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at net.minecraft.server.MinecraftServer.lambda$spin$0(MinecraftServer.java:330) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at java.base/java.lang.Thread.run(Thread.java:1583) ~[?:?]\nCaused by: java.lang.ClassNotFoundException: net.milkbowl.vault.economy.Economy\n        at io.papermc.paper.plugin.entrypoint.classloader.PaperPluginClassLoader.loadClass(PaperPluginClassLoader.java:146) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at io.papermc.paper.plugin.entrypoint.classloader.PaperPluginClassLoader.loadClass(PaperPluginClassLoader.java:107) ~[paper-1.21.1.jar:1.21.1-52-e08e667]\n        at java.base/java.lang.ClassLoader.loadClass(ClassLoader.java:526) ~[?:?]\n        ... 14 more\n</code></pre>\n<h2>Codebase</h2>\n<p>PaySignSSR.java</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.github.hc12.paysignssr;\n\nimport net.milkbowl.vault.economy.Economy;\nimport org.bukkit.plugin.RegisteredServiceProvider;\nimport org.bukkit.plugin.java.JavaPlugin;\n\npublic final class PaySignSSR extends JavaPlugin {\n\n    // Declare the econ variable here\n    private static Economy econ = null;\n\n    @Override\n    public void onEnable() {\n        getServer().getPluginManager().registerEvents(new SignHandler(), this);\n        getServer().getPluginManager().registerEvents(new SignClickEvent(), this);\n        getServer().broadcastMessage(&quot;PaySign Loaded&quot;);\n\n        if (!setupEconomy()) {\n            getLogger().severe(&quot;Vault dependency not found or no economy plugin available! Disabling plugin.&quot;);\n            getServer().getPluginManager().disablePlugin(this);\n            return;\n        }\n    }\n\n    @Override\n    public void onDisable() {\n        // Plugin shutdown logic\n    }\n\n    private boolean setupEconomy() {\n        if (getServer().getPluginManager().getPlugin(&quot;Vault&quot;) == null) {\n            return false;\n        }\n        RegisteredServiceProvider&lt;Economy&gt; rsp = getServer().getServicesManager().getRegistration(Economy.class);\n        if (rsp == null) {\n            return false;\n        }\n        econ = rsp.getProvider();\n        return econ != null;\n    }\n\n    public static Economy getEconomy() {\n        return econ;\n    }\n}\n</code></pre>\n<p>SignHandler.java</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.github.hc12.paysignssr;\n\nimport net.milkbowl.vault.economy.Economy;\nimport org.bukkit.ChatColor;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.block.SignChangeEvent;\nimport org.jetbrains.annotations.NotNull;\n\n\npublic class SignHandler implements Listener {\n\n    @EventHandler\n    public void onSignChange(SignChangeEvent event) {\n        String firstLine = event.getLine(0);\n        String secondLine = event.getLine(1);\n        String thirdLine = event.getLine(2);\n        String fourthLine = event.getLine(3);\n\n        if (firstLine.equalsIgnoreCase(&quot;[PaySign]&quot;) &amp;&amp; secondLine != null &amp;&amp; thirdLine != null) {\n            event.setLine(0, &quot;§2[PaySign]&quot;);\n            String target = secondLine;\n            Integer amount = Integer.parseInt(thirdLine);\n        }\n    }\n}\n</code></pre>\n<p>SignClickEvent.java</p>\n<pre class=\"lang-java prettyprint-override\"><code>package com.github.hc12.paysignssr;\n\nimport net.md_5.bungee.api.ChatColor;\nimport net.milkbowl.vault.economy.Economy;\nimport org.bukkit.Bukkit;\nimport org.bukkit.Material;\nimport org.bukkit.block.Block;\nimport org.bukkit.block.Sign;\nimport org.bukkit.entity.Player;\nimport org.bukkit.event.EventHandler;\nimport org.bukkit.event.Listener;\nimport org.bukkit.event.block.Action;\nimport org.bukkit.event.player.PlayerInteractEvent;\n\npublic class SignClickEvent implements Listener {\n    @EventHandler\n    public void OnPlayerInteract(PlayerInteractEvent event) {\n        if (event.getAction() == Action.RIGHT_CLICK_BLOCK) {\n            Block clickedBlock = event.getClickedBlock();\n            if (clickedBlock != null &amp;&amp; (clickedBlock.getType() == Material.OAK_SIGN ||\n                    clickedBlock.getType() == Material.OAK_WALL_SIGN ||\n                    clickedBlock.getType() == Material.BIRCH_SIGN ||\n                    clickedBlock.getType() == Material.BIRCH_WALL_SIGN ||\n                    clickedBlock.getType() == Material.SPRUCE_SIGN ||\n                    clickedBlock.getType() == Material.SPRUCE_WALL_SIGN ||\n                    clickedBlock.getType() == Material.JUNGLE_SIGN ||\n                    clickedBlock.getType() == Material.JUNGLE_WALL_SIGN ||\n                    clickedBlock.getType() == Material.ACACIA_SIGN ||\n                    clickedBlock.getType() == Material.ACACIA_WALL_SIGN ||\n                    clickedBlock.getType() == Material.DARK_OAK_SIGN ||\n                    clickedBlock.getType() == Material.DARK_OAK_WALL_SIGN ||\n                    clickedBlock.getType() == Material.CRIMSON_SIGN ||\n                    clickedBlock.getType() == Material.CRIMSON_WALL_SIGN ||\n                    clickedBlock.getType() == Material.WARPED_SIGN ||\n                    clickedBlock.getType() == Material.WARPED_WALL_SIGN ||\n                    clickedBlock.getType() == Material.MANGROVE_SIGN ||\n                    clickedBlock.getType() == Material.MANGROVE_WALL_SIGN)) {\n                Sign sign = (Sign) clickedBlock.getState();\n                String[] lines = sign.getLines();\n                if (lines[0] == &quot;§2[PaySign]&quot; &amp;&amp; lines[1] != null &amp;&amp; lines[2] != null) {\n                    Player player = event.getPlayer();\n                    Player target = Bukkit.getPlayer(lines[1]);\n                    Double amount = Double.parseDouble(lines[2]);\n                    Integer time = Integer.parseInt(lines[3]);\n                    if (time == null) {\n                        time = 1000;\n                    } else {\n                        time = time * 1000;\n                    }\n                    Economy econ = PaySignSSR.getEconomy();\n                    if (econ.getBalance(player) &lt; amount) {\n                        player.sendMessage(&quot;§cJesteś za biedny!&quot;);\n                    } else {\n                        econ.withdrawPlayer(player, amount);\n                        econ.depositPlayer(target, amount);\n                        player.sendMessage(&quot;§aZapłaciłeś &quot; + ChatColor.GOLD + amount + &quot;§agraczowi &quot; + ChatColor.WHITE + target);\n\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n<p>pom.xml</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.github.hc12&lt;/groupId&gt;\n    &lt;artifactId&gt;paysignssr&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;name&gt;paysignssr&lt;/name&gt;\n\n    &lt;properties&gt;\n        &lt;java.version&gt;21&lt;/java.version&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.13.0&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;${java.version}&lt;/source&gt;\n                    &lt;target&gt;${java.version}&lt;/target&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.5.3&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;phase&gt;package&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;shade&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n        &lt;resources&gt;\n            &lt;resource&gt;\n                &lt;directory&gt;src/main/resources&lt;/directory&gt;\n                &lt;filtering&gt;true&lt;/filtering&gt;\n            &lt;/resource&gt;\n        &lt;/resources&gt;\n    &lt;/build&gt;\n\n    &lt;repositories&gt;\n        &lt;repository&gt;\n            &lt;id&gt;papermc-repo&lt;/id&gt;\n            &lt;url&gt;https://repo.papermc.io/repository/maven-public/&lt;/url&gt;\n        &lt;/repository&gt;\n        &lt;repository&gt;\n            &lt;id&gt;sonatype&lt;/id&gt;\n            &lt;url&gt;https://oss.sonatype.org/content/groups/public/&lt;/url&gt;\n        &lt;/repository&gt;\n        &lt;repository&gt;\n            &lt;id&gt;jitpack.io&lt;/id&gt;\n            &lt;url&gt;https://jitpack.io&lt;/url&gt;\n        &lt;/repository&gt;\n    &lt;/repositories&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;io.papermc.paper&lt;/groupId&gt;\n            &lt;artifactId&gt;paper-api&lt;/artifactId&gt;\n            &lt;version&gt;1.21.1-R0.1-SNAPSHOT&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.github.MilkBowl&lt;/groupId&gt;\n            &lt;artifactId&gt;VaultAPI&lt;/artifactId&gt;\n            &lt;version&gt;1.7&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/project&gt;\n</code></pre>\n<p>plugin.yml</p>\n<pre class=\"lang-yaml prettyprint-override\"><code>name: paysignssr\nversion: '1.0-SNAPSHOT'\nmain: com.github.hc12.paysignssr.PaySignSSR\napi-version: '1.21'\ndepend: Vault\n</code></pre>\n<p>I have tried reinstalling Vault and checked out some other things but nothing worked :/</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}