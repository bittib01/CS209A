{
  "question": {
    "tags": [
      "java",
      "apache-flink",
      "pojo"
    ],
    "owner": {
      "account_id": 4750876,
      "reputation": 1433,
      "user_id": 3840940,
      "user_type": "registered",
      "accept_rate": 87,
      "profile_image": "https://www.gravatar.com/avatar/7e5771bd6b1b6e5786cfabde2b242ea5?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Joseph Hwang",
      "link": "https://stackoverflow.com/users/3840940/joseph-hwang"
    },
    "is_answered": true,
    "view_count": 2197,
    "accepted_answer_id": 78188438,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1715643227,
    "creation_date": 1710844410,
    "last_edit_date": 1715643227,
    "question_id": 78185904,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78185904/java-lang-reflect-inaccessibleobjectexception-unable-to-make-field-private-fina",
    "title": "java.lang.reflect.InaccessibleObjectException: Unable to make field private final java.lang.Object[] java.util.Arrays$ArrayList.a accessible",
    "body": "<p>I cannot make access to Java POJO in Visual Studio Code with Maven.</p>\n<pre><code>OS : Windows 11\nJDK : open-jdk 17.0.2\nmaven : apache-maven 3.9.6\napache flink : 1.18.1 (installed on WSL 2 ubuntu)\nvisual studio code : x64 1.87.2\n</code></pre>\n<p>Below are the simple Flink MongoDB sink codes.</p>\n<p><strong>== Car.java (POJO class)</strong></p>\n<pre><code>import lombok.AllArgsConstructor;\nimport lombok.Data;\n \n@Data\n@AllArgsConstructor\npublic class Car{\n \n    private String brand;\n    private int price;\n}\n</code></pre>\n<p><strong>== Flink MongoDB Sink codes</strong></p>\n<pre><code>StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\nenv.setParallelism(1);\n\nList&lt;Car&gt; cars = new ArrayList&lt;&gt;();\ncars.add(new Car(&quot;BMW&quot;, 500));\ncars.add(new Car(&quot;Kia&quot;, 300));\ncars.add(new Car(&quot;Ford&quot;, 600));\n\nDataStream&lt;Car&gt; stream = env.fromCollection(cars);\n\nMongoSink&lt;Car&gt; sink = MongoSink.&lt;Car&gt;builder()\n            .setUri(&quot;mongodb://127.0.0.1:27017&quot;)\n            .setDatabase(&quot;class_db&quot;)\n            .setCollection(&quot;class_coll&quot;)\n            .setBatchSize(1000)\n            .setBatchIntervalMs(1000)\n            .setMaxRetries(3)\n            .setDeliveryGuarantee(DeliveryGuarantee.AT_LEAST_ONCE)\n            .setSerializationSchema(\n                    (input, context) \n                        -&gt; {\n                            Document doc = new Document(input.getBrand(), input.getPrice());\n                            System.out.println(doc);\n                            return new InsertOneModel&lt;&gt;(BsonDocument.parse(doc.toJson()));\n                        })\n            .build();\n\nstream.sinkTo(sink);\n\nenv.execute(&quot;MongoDB POJO Test&quot;);\nenv.close();\n</code></pre>\n<p>The above codes contain no bugs except this exception,</p>\n<pre><code>Exception in thread &quot;main&quot; java.io.UncheckedIOException: java.io.IOException: Serializing the source elements failed: java.lang.reflect.InaccessibleObjectException: Unable to make field private final java.lang.Object[] java.util.Arrays$ArrayList.a accessible: module java.base does not &quot;opens java.util&quot; to unnamed module @2a32de6c\n        at org.apache.flink.streaming.api.functions.source.FromElementsFunction.setOutputType(FromElementsFunction.java:162)  \n        at org.apache.flink.streaming.util.functions.StreamingFunctionUtils.trySetOutputType(StreamingFunctionUtils.java:84)  \n        at org.apache.flink.streaming.util.functions.StreamingFunctionUtils.setOutputType(StreamingFunctionUtils.java:60)     \n        at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.setOutputType(AbstractUdfStreamOperator.java:146)\n        at org.apache.flink.streaming.api.operators.SimpleOperatorFactory.setOutputType(SimpleOperatorFactory.java:118)       \n        at org.apache.flink.streaming.api.graph.StreamGraph.addOperator(StreamGraph.java:434)\n        at org.apache.flink.streaming.api.graph.StreamGraph.addOperator(StreamGraph.java:402)\n        at org.apache.flink.streaming.api.graph.StreamGraph.addLegacySource(StreamGraph.java:356)\n        at org.apache.flink.streaming.runtime.translators.LegacySourceTransformationTranslator.translateInternal(LegacySourceTransformationTranslator.java:66)\n        at org.apache.flink.streaming.runtime.translators.LegacySourceTransformationTranslator.translateForStreamingInternal(LegacySourceTransformationTranslator.java:53)\n        at org.apache.flink.streaming.runtime.translators.LegacySourceTransformationTranslator.translateForStreamingInternal(LegacySourceTransformationTranslator.java:40)\n        at org.apache.flink.streaming.api.graph.SimpleTransformationTranslator.translateForStreaming(SimpleTransformationTranslator.java:62)\n        at org.apache.flink.streaming.api.graph.StreamGraphGenerator.translate(StreamGraphGenerator.java:860)\n        at org.apache.flink.streaming.api.graph.StreamGraphGenerator.transform(StreamGraphGenerator.java:590)\n        at org.apache.flink.streaming.api.graph.StreamGraphGenerator.getParentInputIds(StreamGraphGenerator.java:881)\n        at org.apache.flink.streaming.api.graph.StreamGraphGenerator.translate(StreamGraphGenerator.java:839)\n        at org.apache.flink.streaming.api.graph.StreamGraphGenerator.transform(StreamGraphGenerator.java:590)\n        at org.apache.flink.streaming.api.graph.StreamGraphGenerator.generate(StreamGraphGenerator.java:328)\n        at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:2289)\n        at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:2280)\n        at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:2266)\n        at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.execute(StreamExecutionEnvironment.java:2093)\n        at com.aaa.test.FlinkMongoClassTest.main(FlinkMongoClassTest.java:49)\nCaused by: java.io.IOException: Serializing the source elements failed: java.lang.reflect.InaccessibleObjectException: Unable to make field private final java.lang.Object[] java.util.Arrays$ArrayList.a accessible: module java.base does not &quot;opens java.util&quot; to unnamed module @2a32de6c\n        at org.apache.flink.streaming.api.functions.source.FromElementsFunction.serializeElements(FromElementsFunction.java:139)\n        at org.apache.flink.streaming.api.functions.source.FromElementsFunction.setOutputType(FromElementsFunction.java:160)  \n        ... 22 more\nCaused by: java.lang.RuntimeException: java.lang.reflect.InaccessibleObjectException: Unable to make field private final java.lang.Object[] java.util.Arrays$ArrayList.a accessible: module java.base does not &quot;opens java.util&quot; to unnamed module @2a32de6c\n        at com.twitter.chill.java.ArraysAsListSerializer.&lt;init&gt;(ArraysAsListSerializer.java:69)\n        at org.apache.flink.api.java.typeutils.runtime.kryo.FlinkChillPackageRegistrar.registerSerializers(FlinkChillPackageRegistrar.java:67)\n        at org.apache.flink.api.java.typeutils.runtime.kryo.KryoSerializer.getKryoInstance(KryoSerializer.java:513)\n        at org.apache.flink.api.java.typeutils.runtime.kryo.KryoSerializer.checkKryoInitialized(KryoSerializer.java:522)      \n        at org.apache.flink.api.java.typeutils.runtime.kryo.KryoSerializer.serialize(KryoSerializer.java:348)\n        at org.apache.flink.streaming.api.functions.source.FromElementsFunction.serializeElements(FromElementsFunction.java:136)\n        ... 23 more\nCaused by: java.lang.reflect.InaccessibleObjectException: Unable to make field private final java.lang.Object[] java.util.Arrays$ArrayList.a accessible: module java.base does not &quot;opens java.util&quot; to unnamed module @2a32de6c\n        at java.base/java.lang.reflect.AccessibleObject.checkCanSetAccessible(AccessibleObject.java:354)\n        at java.base/java.lang.reflect.AccessibleObject.checkCanSetAccessible(AccessibleObject.java:297)\n</code></pre>\n<p>So I change the class of input stream to Tuple2 from Car class like below</p>\n<pre><code>List&lt;Tuple2&lt;String, Integer&gt;&gt; cars = new ArrayList&lt;&gt;();\ncars.add(new Tuple2&lt;&gt;(&quot;BMW&quot;, 500));\ncars.add(new Tuple2&lt;&gt;(&quot;Kia&quot;, 300));\ncars.add(new Tuple2&lt;&gt;(&quot;Ford&quot;, 600));\n\nDataStream&lt;Tuple2&lt;String, Integer&gt;&gt; stream = env.fromCollection(cars);\n</code></pre>\n<p>Then everything goes right without any errors. It seems that the main java codes can not make access to Car POJO class.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}