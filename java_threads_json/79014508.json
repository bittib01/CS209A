{
  "question": {
    "tags": [
      "java",
      "annotations",
      "pom.xml",
      "java-17"
    ],
    "owner": {
      "account_id": 20336430,
      "reputation": 43,
      "user_id": 14917012,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GjjHgyDZdK63zKZSkAk6VhMr0fYx1FIKkTz4p-2=k-s256",
      "display_name": "Cristian Jacob Jimenez",
      "link": "https://stackoverflow.com/users/14917012/cristian-jacob-jimenez"
    },
    "is_answered": false,
    "view_count": 264,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1727093516,
    "creation_date": 1727092878,
    "last_edit_date": 1727093516,
    "question_id": 79014508,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79014508/why-is-procnone-processing-the-custom-annotations",
    "title": "Why is -proc:none processing the custom annotations?",
    "body": "<p>I am configuring a <code>CustomAnnotationProcessor</code> in <strong>Java 17</strong> in compile time. I found that a way to achieve this is adding an <code>&lt;execution&gt;</code> block  to the pom.xml. The solution shows the usage of</p>\n<pre><code>&lt;compilerArgument&gt;-proc:only&lt;/compilerArgument&gt; \n</code></pre>\n<p>As the right way to run the annotation procesors.</p>\n<p>The problem is that when I set the <code>-proc:only </code> I get this error:</p>\n<pre><code>[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.13.0:compile (default-compile) on project entity-validator-api-archetype: Compilation failure\n[ERROR] Bad service configuration file, or exception thrown while constructing Processor object: javax.annotation.processing.Processor: Provider com.eva.CustomAnnotationProcessor not found\n</code></pre>\n<p>But if use the <code>-proc:none</code></p>\n<pre><code>&lt;compilerArgument&gt;-proc:none&lt;/compilerArgument&gt;\n</code></pre>\n<p>The annotations are processed.</p>\n<pre><code>...\nProcessing test...\nProcessing test...\n[INFO] Processing: DemoApplication with value: Demo Value\n...\n\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  2.356 s\n[INFO] Finished at: 2024-09-23T06:56:05-05:00\n[INFO] ------------------------------------------------------------------------\n</code></pre>\n<p>What I read is the following:</p>\n<p><code>-proc:none:</code> Disables all annotation processing.</p>\n<p><code>-proc:only:</code> Intended to run only the annotation processors.</p>\n<p>Can you explain why it is working like as an inverted way?</p>\n<p>Some Java behavior that is not easy to explain.</p>\n<p>Files:</p>\n<p>CustomAnnotation.java</p>\n<pre><code>package com.eva;\n\nimport java.lang.annotation.ElementType;\nimport java.lang.annotation.Target;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;\n\n@Target(ElementType.TYPE) // Use on classes\n@Retention(RetentionPolicy.SOURCE) // Processed at the source level\npublic @interface CustomAnnotation {\n    String value();\n}\n</code></pre>\n<p>CustomAnnotationProcessor.java</p>\n<pre><code>package com.eva;\n\n\nimport javax.annotation.processing.AbstractProcessor;\nimport javax.annotation.processing.Processor;\nimport javax.annotation.processing.RoundEnvironment;\nimport javax.annotation.processing.SupportedAnnotationTypes;\nimport javax.annotation.processing.SupportedSourceVersion;\nimport javax.lang.model.SourceVersion;\nimport javax.lang.model.element.TypeElement;\nimport javax.lang.model.element.Element;\nimport javax.tools.Diagnostic;\nimport java.util.Set;\n\n@SupportedAnnotationTypes(&quot;com.eva.CustomAnnotation&quot;) // Annotation to process\n@SupportedSourceVersion(SourceVersion.RELEASE_17) // Java version\npublic class CustomAnnotationProcessor extends AbstractProcessor {\n\n    @Override\n    public boolean process(Set&lt;? extends TypeElement&gt; annotations, RoundEnvironment roundEnv) {\n        System.out.println(&quot;Processing test...&quot;);\n        for (Element element : roundEnv.getElementsAnnotatedWith(CustomAnnotation.class)) {\n            CustomAnnotation annotation = element.getAnnotation(CustomAnnotation.class);\n\n            // Print a message (could be for code generation, validation, etc.)\n            processingEnv.getMessager().printMessage(Diagnostic.Kind.NOTE,\n                    &quot;Processing: &quot; + element.getSimpleName() + &quot; with value: &quot; + annotation.value());\n\n            // You can also generate code or files here using Filer or Trees API\n        }\n        return true;\n    }\n}\n</code></pre>\n<p>DemoApplication.java</p>\n<pre><code>package com.eva;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\n@CustomAnnotation(&quot;Demo Value&quot;)\npublic class DemoApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(DemoApplication.class, args);\n    }\n}\n</code></pre>\n<p>I added the <code>com.eva.CustomAnnotationProcessor</code> to the <code>javax.annotation.processing.Processor</code></p>\n<p>pom.xml</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;com.eva&lt;/groupId&gt;\n    &lt;artifactId&gt;entity-validator-api-archetype&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.3.2&lt;/version&gt;\n        &lt;relativePath/&gt;\n    &lt;/parent&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt;\n            &lt;version&gt;10.0.0&lt;/version&gt;\n            &lt;scope&gt;provided&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;mysql&lt;/groupId&gt;\n            &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n            &lt;version&gt;8.0.33&lt;/version&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;\n            &lt;artifactId&gt;bcprov-jdk15on&lt;/artifactId&gt;\n            &lt;version&gt;1.70&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-freemarker&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;jakarta.persistence&lt;/groupId&gt;\n            &lt;artifactId&gt;jakarta.persistence-api&lt;/artifactId&gt;\n            &lt;version&gt;3.1.0&lt;/version&gt; &lt;!-- Adjust to the correct version --&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.hibernate.orm&lt;/groupId&gt;\n            &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt;\n            &lt;version&gt;6.3.0.Final&lt;/version&gt; &lt;!-- Use a compatible version --&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-context&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.reflections&lt;/groupId&gt;\n            &lt;artifactId&gt;reflections&lt;/artifactId&gt;\n            &lt;version&gt;0.10.2&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n    &lt;build&gt;\n        &lt;resources&gt;\n            &lt;resource&gt;\n                &lt;directory&gt;src/main/resources&lt;/directory&gt;\n            &lt;/resource&gt;\n        &lt;/resources&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.13.0&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;default-compile&lt;/id&gt;\n                        &lt;configuration&gt;\n                            &lt;compilerArgument&gt;-proc:none&lt;/compilerArgument&gt;\n                            &lt;includes&gt;\n                                &lt;include&gt;com/eva/CustomAnnotationProcessor.java&lt;/include&gt;\n                                &lt;!--include dependencies required for LogMeCustomAnnotationProcessor --&gt;\n                            &lt;/includes&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;compile-project&lt;/id&gt;\n                        &lt;phase&gt;compile&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;compile&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;17&lt;/source&gt;\n                    &lt;target&gt;17&lt;/target&gt;\n\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}