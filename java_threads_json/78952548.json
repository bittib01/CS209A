{
  "question": {
    "tags": [
      "java",
      "android",
      "react-native",
      "flag-secure"
    ],
    "owner": {
      "account_id": 19370044,
      "reputation": 33,
      "user_id": 14163530,
      "user_type": "registered",
      "profile_image": "https://lh4.googleusercontent.com/-CzqAxB42w5k/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckSCGvh9y63MMyKU5cefCz4IIdWuA/s256-rj/photo.jpg",
      "display_name": "SY L",
      "link": "https://stackoverflow.com/users/14163530/sy-l"
    },
    "is_answered": true,
    "view_count": 606,
    "accepted_answer_id": 79502516,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1741746452,
    "creation_date": 1725532057,
    "last_edit_date": 1725584432,
    "question_id": 78952548,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78952548/how-to-block-app-screen-in-the-android-app-switcher-without-disabling-screenshot",
    "title": "How to block app screen in the Android app switcher without disabling screenshots and screen recordings in the foreground?",
    "body": "<p>I'm working on an Android app where I need to block the app screen from being visible when the user switches to the app switcher (recent apps view) but still allow the user to take screenshots and record the screen when the app is in the foreground. The goal is to secure the app's content from being seen by third parties when the app is in the background or when it's being viewed in the app switcher.</p>\n<h3>Requirement:</h3>\n<ul>\n<li><strong>When the app is in the foreground</strong>, the user should be able to take screenshots and record the screen without any restrictions.</li>\n<li><strong>When the app is moved to the background</strong> or viewed in the app switcher, the screen should be blocked to prevent third parties from viewing sensitive content.</li>\n</ul>\n<h3>What I've Tried:</h3>\n<ol>\n<li><strong>Using <code>FLAG_SECURE</code> in <code>onPause()</code> and <code>onResume()</code></strong>:</li>\n</ol>\n<ul>\n<li>I tried turning on <code>FLAG_SECURE</code> in the <code>onPause()</code> method and turning it off in <code>onResume()</code>. This approach works like 2 times out of 5, but occasionally, the flag doesn't block the content when the app is switched to the background quickly. This results in the app's content being visible in the app switcher for a brief moment.</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>@Override\nprotected void onPause() {\n    super.onPause();\n    getWindow().setFlags(WindowManager.LayoutParams.FLAG_SECURE,\n                         WindowManager.LayoutParams.FLAG_SECURE);\n}\n@Override\nprotected void onResume() {\n    super.onResume();\n    getWindow().clearFlags(WindowManager.LayoutParams.FLAG_SECURE);\n}\n</code></pre>\n<p>This approach blocks the screen from being visible in the app switcher in many cases but is inconsistent. Sometimes, it fails to block the screen from showing in the app switcher, especially when switching quickly between apps.</p>\n<ol start=\"2\">\n<li><strong>Setting <code>FLAG_SECURE</code> in <code>onCreate()</code></strong>:</li>\n</ol>\n<ul>\n<li>I also tried setting <code>FLAG_SECURE</code> in <code>onCreate()</code>, which effectively blocks the content from being visible in the app switcher. However, this approach also blocks screenshots and screen recordings entirely, which is not acceptable for my use case. I want the user to still be able to take screenshots or record the screen when the app is in the foreground.</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>@Override\nprotected void onCreate(Bundle savedInstanceState) {\n    super.onCreate(savedInstanceState);\n    getWindow().setFlags(WindowManager.LayoutParams.FLAG_SECURE,\n                         WindowManager.LayoutParams.FLAG_SECURE);\n}\n</code></pre>\n<ol start=\"3\">\n<li><strong>Using React Native and App State</strong>:</li>\n</ol>\n<ul>\n<li>I also tried implementing this in React Native by checking the app state and rendering a blank screen (or a blur screen) when the app goes to the background. I used AppState to track the app lifecycle and show a view on top of the current screen when the app moves to the background.\nHowever, this approach results in a flickering effect — the view briefly shows up but quickly dismisses, making it unreliable when the app is sent to the background.</li>\n</ul>\n<pre><code>import React, { useEffect, useState } from 'react';\nimport { AppState, View, Text, StyleSheet } from 'react-native';\nconst App = () =&gt; {\n   const [appState, setAppState] = useState(AppState.currentState);\n   const [isBlurred, setIsBlurred] = useState(false);\n   useEffect(() =&gt; {\n       const handleAppStateChange = (nextAppState) =&gt; {\n           if (nextAppState === 'background' || nextAppState === 'inactive') {\n               setIsBlurred(true);  // Show blur when app is in background\n           } else {\n               setIsBlurred(false); // Remove blur when app returns to foreground\n           }\n       };\n       const subscription = AppState.addEventListener('change', handleAppStateChange);\n       return () =&gt; subscription.remove();\n   }, []);\n   return (\n&lt;View style={{ flex: 1 }}&gt;\n           {/* Main app content */}\n&lt;Text&gt;Your App Content&lt;/Text&gt;\n           {/* Conditional Blur View */}\n           {isBlurred &amp;&amp; (\n&lt;View style={[StyleSheet.absoluteFill, { backgroundColor: 'white' }]}&gt;\n&lt;Text style={{ color: 'black', textAlign: 'center', marginTop: '50%' }}&gt;\n                       App in Background\n&lt;/Text&gt;\n&lt;/View&gt;\n           )}\n&lt;/View&gt;\n   );\n};\nexport default App;\n</code></pre>\n<p>Unfortunately, this approach only works for a brief moment and flickers before dismissing the view, so it’s not consistent when switching to the app switcher.</p>\n<h3>Question:</h3>\n<p>Is there a reliable way to block the app screen from being visible in the Android app switcher without using <code>FLAG_SECURE</code> to disable screenshots and screen recordings while the app is in the foreground? I've seen apps like WhatsApp achieve this behavior, where they block content in the app switcher but still allow screenshots and recordings in the foreground when users turn on the App lock feature.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}