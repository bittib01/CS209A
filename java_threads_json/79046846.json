{
  "question": {
    "tags": [
      "java",
      "kubernetes",
      "virtual-threads"
    ],
    "owner": {
      "account_id": 7968884,
      "reputation": 215,
      "user_id": 6014278,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/fb8581d3832aff2cf12684f18fa1bbd1?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Balazs",
      "link": "https://stackoverflow.com/users/6014278/balazs"
    },
    "is_answered": false,
    "view_count": 582,
    "answer_count": 0,
    "score": 1,
    "last_activity_date": 1742801267,
    "creation_date": 1727873918,
    "last_edit_date": 1727938167,
    "question_id": 79046846,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79046846/ideal-carrier-thread-count-using-java-virtual-threads-in-kubernetes",
    "title": "Ideal Carrier Thread count using Java Virtual Threads in Kubernetes",
    "body": "<p>I think I have a pretty good understanding of how Java's Virtual Threads are being scheduled by the Carrier Threads (CT) and that by default the number of CTs is matched with the number of CPU cores.</p>\n<p>Now let's assume I deploy my service to Kubernetes and it has a CPU request of 1 core. For the sake of this example let's also assume that the node it's being scheduled on has 8 cores. Because how Kubernetes allocates CPU my service will get 1/8 of the time of each CPU cores.</p>\n<p>So here comes the question: <strong>how many CT should the service have for best utilization?</strong></p>\n<ul>\n<li>If the CPU limit of the pod is defined as 1 core it would automatically have 1 CT assigned to it which doesn't seem ideal as it will have 8 cores to run threads on</li>\n<li>If it doesn't have a CPU limit set it would take the number of cores on the Node resulting 8 CTs.</li>\n<li>as an intermediate solution I can remove CPU limit and define the visible CPU count which then gives a better control on the number of CTs.</li>\n</ul>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}