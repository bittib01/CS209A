{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "aop",
      "aspectj",
      "picocli"
    ],
    "owner": {
      "account_id": 2022186,
      "reputation": 3235,
      "user_id": 1808082,
      "user_type": "registered",
      "accept_rate": 57,
      "profile_image": "https://i.sstatic.net/PhHO2.jpg?s=256",
      "display_name": "Jo&#227;o Menighin",
      "link": "https://stackoverflow.com/users/1808082/jo%c3%a3o-menighin"
    },
    "is_answered": true,
    "view_count": 70,
    "accepted_answer_id": 78626187,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1721548610,
    "creation_date": 1718292254,
    "question_id": 78618777,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78618777/aspectj-and-picocli-does-not-populate-properties-as-expected",
    "title": "AspectJ and PicoCLI does not populate properties as expected",
    "body": "<p>I'm creating an annotation to attach an Aspect that would take care of authenticating an user before running a CLI command in my Spring Boot app.</p>\n<p>Here are the components:</p>\n<pre class=\"lang-java prettyprint-override\"><code>// The annotation\n@Retention(RetentionPolicy.RUNTIME)\n@Target({ElementType.METHOD, ElementType.TYPE})\npublic @interface Authenticated {}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>// The aspec\n@Aspect\n@Component\n@Order(Ordered.LOWEST_PRECEDENCE)\nclass AuthenticatedAspect {\n\n    @Around(&quot;@annotation(com.menighin.picoclijava.annotation.Authenticated)&quot;)\n    public Object doAuthentication(ProceedingJoinPoint joinPoint) throws Throwable {\n        return joinPoint.proceed();\n    }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>// The PicoCLI command\n@Component\n@Command(name = &quot;testing&quot;, description = &quot;Testing command&quot;)\npublic class TestingCommandJava implements Runnable {\n\n    @Option(\n        names = {&quot;-ci&quot;, &quot;--creator-initials&quot;},\n        description = &quot;The initials of the creator&quot;,\n        required = true\n    )\n    private String creatorInitials;\n\n    // setters and getters\n\n    @Override\n    @Authenticated\n    public void run() {\n        System.out.println(&quot;hi!&quot;);\n    }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>// The boot app\n@SpringBootApplication\npublic class PicoclijavaApplication implements CommandLineRunner {\n\n    @Autowired\n    private TestingCommandJava testingCommand;\n\n    public static void main(String[] args) {\n        SpringApplication.run(PicoclijavaApplication.class, args);\n    }\n\n    @Override\n    public void run(String... args) throws Exception {\n        var cmd = new CommandLine(testingCommand);\n        cmd.execute(args);\n    }\n}\n</code></pre>\n<p>Before going further into the implementation itself Im already facing the issue where the <code>creatorInitials</code> are not set when I have the aspect run.</p>\n<p>Checking <a href=\"https://stackoverflow.com/questions/56614354/why-does-self-invocation-not-work-for-spring-proxies-e-g-with-aop/56616248#56616248\">this</a> and <a href=\"https://stackoverflow.com/questions/77134178/why-are-field-values-null-when-calling-final-methods-on-a-proxy-instance/77146932#77146932\">this</a> answers by @kriegaex my understanding is this happens because:</p>\n<ul>\n<li>The aspect creates a CGLIB proxy of my <code>TestingCommand</code> (I can verify this debugging)</li>\n<li>PicoCLI then populates by reflection those parameters <em>onto the proxy</em> instead of the underlaying object (I can actually see the property set on the proxy instance)</li>\n<li>When I finally get to my method, those fields are not set</li>\n</ul>\n<p>So my questions are:</p>\n<ul>\n<li>Is my understanding correct?</li>\n<li>Is there anything I can do (besides changing PicoCLI code and opening a PR) to get those fields populated into my underlaying object rather than the proxy?</li>\n</ul>\n<p>Thanks!</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}