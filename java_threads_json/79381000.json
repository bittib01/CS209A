{
  "question": {
    "tags": [
      "java",
      "image",
      "game-development",
      "graphics2d"
    ],
    "owner": {
      "account_id": 30569854,
      "reputation": 11,
      "user_id": 23431541,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocJcJZLCUoybsfhMo48jeFdQGdN3Vynm5IB_UBRPiCNt=k-s256",
      "display_name": "TJ Hartnett",
      "link": "https://stackoverflow.com/users/23431541/tj-hartnett"
    },
    "is_answered": false,
    "view_count": 46,
    "answer_count": 0,
    "score": 1,
    "last_activity_date": 1737634813,
    "creation_date": 1737634813,
    "question_id": 79381000,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79381000/textures-for-animation-class-cause-errors",
    "title": "Textures for Animation class cause errors",
    "body": "<p>I am creating a platformer game and currently working on the map area (where the player selects a level). While this code does work in eclipse, it does not work when exported to a .jar file. Yes, Furbee's files are in the right place. Some of the code was generated by ChatGPT so it may not be accurate. If you need any more information, let me know.</p>\n<p>TextureLibrary.java:</p>\n<pre><code>package com.catastrophe.graphics;\n\nimport java.awt.image.BufferedImage;\nimport java.io.File;\nimport java.io.IOException;\nimport java.util.HashMap;\nimport java.util.Map;\n\nimport javax.imageio.ImageIO;\n\npublic class TextureLibrary {\n\n    // Texture IDs\n    public static final int GRASS = 0;\n    public static final int COIN = 1; // Animation\n    public static final int WALL = 2;\n    public static final int SEMISOLID = 3;\n    public static final int NIGHT_DIRT = 4;\n    public static final int NIGHT_GRASS = 5;\n    public static final int BEACH_GRASS = 6;\n    public static final int SAND = 7;\n    public static final int SNOWY_GRASS = 8;\n    public static final int SNOWY_DIRT = 9;\n    public static final int GREEN_COIN = 10;\n    public static final int LEVEL_GRASS = 11;\n    public static final int MAP_PATH = 12;\n    public static final int MAP_GRASS = 13;\n    public static final int MAP_WATER = 14;\n    public static final int FURBEE_LEFT = 15;\n    public static final int FURBEE_RIGHT = 16;\n    public static final int FURBEE_DOWN = 17;\n    public static final int FURBEE_UP = 18;\n\n    // Path Mapping\n    private static final Map&lt;Integer, String&gt; texturePaths = new HashMap&lt;&gt;();\n    private static final Map&lt;Integer, Boolean&gt; isAnimation = new HashMap&lt;&gt;();\n\n\n    static {\n        // Map texture IDs to file paths or folders\n        texturePaths.put(GRASS, &quot;assets/textures/blocks/grass.png&quot;);\n        texturePaths.put(COIN, &quot;assets/textures/blocks/coin&quot;); // Animation folder\n        texturePaths.put(GREEN_COIN, &quot;assets/textures/blocks/greencoin&quot;);\n        texturePaths.put(WALL, &quot;assets/textures/blocks/wall.png&quot;);\n        texturePaths.put(SEMISOLID, &quot;assets/textures/blocks/semisolid.png&quot;);\n        texturePaths.put(NIGHT_DIRT, &quot;assets/textures/blocks/night_dirt.png&quot;);\n        texturePaths.put(NIGHT_GRASS, &quot;assets/textures/blocks/night_grass.png&quot;);\n        texturePaths.put(BEACH_GRASS, &quot;assets/textures/blocks/beach_grass.png&quot;);\n        texturePaths.put(SAND, &quot;assets/textures/blocks/sand.png&quot;);\n        texturePaths.put(SNOWY_GRASS, &quot;assets/textures/blocks/snowy_grass.png&quot;);\n        texturePaths.put(SNOWY_DIRT, &quot;assets/textures/blocks/snowy_dirt.png&quot;);\n        texturePaths.put(MAP_PATH, &quot;assets/textures/map/map_path.PNG&quot;);\n        texturePaths.put(LEVEL_GRASS, &quot;assets/textures/map/level_grass.jpeg&quot;);\n        texturePaths.put(MAP_GRASS, &quot;assets/textures/map/map_grass.jpeg&quot;);\n        texturePaths.put(MAP_WATER, &quot;assets/textures/map/map_water.jpeg&quot;);\n        texturePaths.put(FURBEE_DOWN, &quot;assets/textures/map/player/furbee/down&quot;);\n        texturePaths.put(FURBEE_RIGHT, &quot;assets/textures/map/player/furbee/right&quot;);\n        texturePaths.put(FURBEE_LEFT, &quot;assets/textures/map/player/furbee/left&quot;);\n        texturePaths.put(FURBEE_UP, &quot;assets/textures/map/player/furbee/up&quot;);\n        \n        // Indicate whether a texture ID corresponds to an animation\n        isAnimation.put(GRASS, false);\n        isAnimation.put(COIN, true); // Animation\n        isAnimation.put(GREEN_COIN, true); // Animation\n        isAnimation.put(WALL, false);\n        isAnimation.put(SEMISOLID, false);\n        isAnimation.put(NIGHT_DIRT, false);\n        isAnimation.put(NIGHT_GRASS, false);\n        isAnimation.put(BEACH_GRASS, false);\n        isAnimation.put(SAND, false);\n        isAnimation.put(SNOWY_GRASS, false);\n        isAnimation.put(SNOWY_DIRT, false);\n        isAnimation.put(LEVEL_GRASS, false);\n        isAnimation.put(MAP_PATH, false);\n        isAnimation.put(MAP_GRASS, false);\n        isAnimation.put(MAP_WATER, false);\n        isAnimation.put(FURBEE_DOWN, true);\n        isAnimation.put(FURBEE_RIGHT, true);\n        isAnimation.put(FURBEE_LEFT, true);\n        isAnimation.put(FURBEE_UP, true);\n\n    }\n\n    /**\n     * Get a single static texture by its ID.\n     */\n    public static BufferedImage getTexture(int id) {\n        if (isAnimation.getOrDefault(id, false)) {\n            throw new IllegalArgumentException(&quot;Use getAnimation for animated textures.&quot;);\n        }\n\n        String path = texturePaths.get(id);\n        if (path == null) {\n            throw new IllegalArgumentException(&quot;Invalid texture ID: &quot; + id);\n        }\n\n        try {\n            return ImageIO.read(TextureLibrary.class.getClassLoader().getResourceAsStream(path));\n        } catch (IOException | IllegalArgumentException e) {\n            e.printStackTrace();\n            return null; // Optionally return a fallback texture\n        }\n    }\n\n    /**\n     * Get an animation by its ID.\n     */\n    public static Animation getAnimation(int id, int frameTime) {\n        if (!isAnimation.getOrDefault(id, false)) {\n            throw new IllegalArgumentException(&quot;The texture ID does not correspond to an animation.&quot;);\n        }\n\n        String folderPath = texturePaths.get(id);\n        if (folderPath == null) {\n            throw new IllegalArgumentException(&quot;Invalid texture ID: &quot; + id);\n        }\n\n        try {\n            File folder = new File(TextureLibrary.class.getClassLoader().getResource(folderPath).getFile());\n            File[] files = folder.listFiles((dir, name) -&gt; name.endsWith(&quot;.png&quot;));\n\n            if (files != null) {\n                java.util.Arrays.sort(files); // Ensure correct frame order\n                BufferedImage[] frames = new BufferedImage[files.length];\n\n                for (int i = 0; i &lt; files.length; i++) {\n                    frames[i] = ImageIO.read(files[i]);\n                }\n\n                return new Animation(frames, frameTime);\n            } else {\n                throw new IOException(&quot;Failed to list files in animation folder: &quot; + folderPath);\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n            return null;\n        }\n    }\n}\n</code></pre>\n<p>Animation.java:</p>\n<pre><code> package com.catastrophe.graphics;\n\nimport java.awt.Graphics2D;\nimport java.awt.Image;\nimport java.awt.image.BufferedImage;\n\npublic class Animation {\n\n    private BufferedImage[] frames;\n    private int imageIndex;\n    private int frameTimer;\n    private int defaultTime;\n    private float x, y;\n    private int width, height;\n    private boolean paused;\n\n    public Animation(BufferedImage[] frames, int defaultTime) {\n        this.frames = frames;\n        this.defaultTime = defaultTime;\n        this.frameTimer = defaultTime;\n        this.imageIndex = 0;\n    }\n\n    public void tick() {\n        if(paused) return;\n        if (frameTimer &lt;= 0) {\n            imageIndex = (imageIndex + 1) % frames.length; // Loop back to the first frame\n            frameTimer = defaultTime;\n        } else {\n            frameTimer--;\n        }\n    }\n\n    public void render(Graphics2D g) {\n        g.drawImage(getCurrentFrame(), (int) x, (int) y, width, height, null);\n    }\n\n    public BufferedImage getCurrentFrame() {\n        return frames[imageIndex];\n    }\n\n    public void setPosition(float x, float y) {\n        this.x = x;\n        this.y = y;\n    }\n\n    public void setDimension(int width, int height) {\n        this.width = width;\n        this.height = height;\n\n        // Resize each frame to the new dimensions\n        BufferedImage[] resizedFrames = new BufferedImage[frames.length];\n        for (int i = 0; i &lt; frames.length; i++) {\n            resizedFrames[i] = resizeImage(frames[i], width, height);\n        }\n        this.frames = resizedFrames;\n    }\n\n    public int getFrameCount() {\n        return frames.length;\n    }\n\n    /**\n     * Helper method to resize a BufferedImage.\n     */\n    private BufferedImage resizeImage(BufferedImage originalImage, int width, int height) {\n        Image temp = originalImage.getScaledInstance(width, height, Image.SCALE_SMOOTH);\n        BufferedImage resizedImage = new BufferedImage(width, height, BufferedImage.TYPE_INT_ARGB);\n\n        Graphics2D g2d = resizedImage.createGraphics();\n        g2d.drawImage(temp, 0, 0, null);\n        g2d.dispose();\n\n        return resizedImage;\n    }\n    public void pause() {\n        paused = true;\n    }\n    public void unpause() {\n        paused = false;\n    }\n}\n</code></pre>\n<p>What I got:</p>\n<pre><code> java -jar catastrophe.jar\njava.io.IOException: Failed to list files in animation folder: assets/textures/map/player/furbee/up\n        at com.catastrophe.graphics.TextureLibrary.getAnimation(TextureLibrary.java:132)\n        at com.catastrophe.map.player.MapPlayer.&lt;init&gt;(MapPlayer.java:29)\n        at com.catastrophe.Catastrophe.&lt;init&gt;(Catastrophe.java:94)\n        at com.catastrophe.Catastrophe.main(Catastrophe.java:222)\njava.io.IOException: Failed to list files in animation folder: assets/textures/map/player/furbee/down\n        at com.catastrophe.graphics.TextureLibrary.getAnimation(TextureLibrary.java:132)\n        at com.catastrophe.map.player.MapPlayer.&lt;init&gt;(MapPlayer.java:30)\n        at com.catastrophe.Catastrophe.&lt;init&gt;(Catastrophe.java:94)\n        at com.catastrophe.Catastrophe.main(Catastrophe.java:222)\njava.io.IOException: Failed to list files in animation folder: assets/textures/map/player/furbee/left\n        at com.catastrophe.graphics.TextureLibrary.getAnimation(TextureLibrary.java:132)\n        at com.catastrophe.map.player.MapPlayer.&lt;init&gt;(MapPlayer.java:31)\n        at com.catastrophe.Catastrophe.&lt;init&gt;(Catastrophe.java:94)\n        at com.catastrophe.Catastrophe.main(Catastrophe.java:222)\njava.io.IOException: Failed to list files in animation folder: assets/textures/map/player/furbee/right\n        at com.catastrophe.graphics.TextureLibrary.getAnimation(TextureLibrary.java:132)\n        at com.catastrophe.map.player.MapPlayer.&lt;init&gt;(MapPlayer.java:32)\n        at com.catastrophe.Catastrophe.&lt;init&gt;(Catastrophe.java:94)\n        at com.catastrophe.Catastrophe.main(Catastrophe.java:222)\nException in thread &quot;Thread-0&quot; java.lang.NullPointerException: Cannot invoke &quot;com.catastrophe.graphics.Animation.pause()&quot; because &quot;this.current&quot; is null\n        at com.catastrophe.map.player.MapPlayer.render(MapPlayer.java:71)\n        at com.catastrophe.Catastrophe.render(Catastrophe.java:209)\n        at com.catastrophe.Catastrophe.run(Catastrophe.java:132)\n        at java.base/java.lang.Thread.run(Thread.java:1570)\n</code></pre>\n<p>I have tried renaming the files of Furbee's sprites, and I tried change .jar to .zip, and looking at the contents of the jar, but to no avail.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}