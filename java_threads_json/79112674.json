{
  "question": {
    "tags": [
      "java",
      "node.js",
      "kotlin",
      "socket.io"
    ],
    "owner": {
      "account_id": 27861410,
      "reputation": 11,
      "user_id": 21273880,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/AGNmyxbaUn9YnO0jna6KZOGxjCqJzVEt56wBUk7rrDc1=k-s256",
      "display_name": "diego alvarez",
      "link": "https://stackoverflow.com/users/21273880/diego-alvarez"
    },
    "is_answered": false,
    "view_count": 41,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1729672606,
    "creation_date": 1729578007,
    "question_id": 79112674,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79112674/fail-to-connect-a-kotlin-socket-io-client-to-a-node-js-socket-io-server",
    "title": "Fail to connect a kotlin socket.io client to a node.js socket.io server",
    "body": "<p>This is my server code</p>\n<pre><code>const express = require('express');\nconst {createServer} = require('node:http')\nconst {Server}= require('socket.io');\nconst {join} = require('node:path');\nvar PORT = process.env.PORT || 3000;\n\nfunction main (){\n\nconst app = express();    \nconst server = createServer(app);\nconst io = new Server(server);\n\napp.get('/', (req, res)=&gt;{\n    res.sendFile(join(__dirname, 'index.html'));\n});\n\nio.on('connection', (socket)=&gt;{\n    console.log(socket.id);\n});\n\nserver.listen(PORT, ()=&gt;{\n    console.log('server running at port '+PORT);\n});\n\n}\n\nmain();\n</code></pre>\n<p>and this is my client's code</p>\n<pre><code>class Client{\n   private lateinit var socket: Socket\n    @Synchronized\n    fun setSocket(){\n        try {\n            val option = IO.Options();\n            option.transports = arrayOf(&quot;websocket&quot;);\n            socket = IO.socket(&quot;http://127.0.0.1:3000&quot;, option)\n        }catch (e: URISyntaxException){\n            println(&quot;error when creating socket&quot;)\n        }\n    }\n    @Synchronized\n    fun getSocket(): Socket {\n        return socket\n    }\n\n    @Synchronized\n    fun establishConnection(){\n        try{\n            socket.connect()\n        }catch (e:Exception){}\n\n    }\n\n    @Synchronized\n    fun closeConnection(){\n        try {\n            socket.disconnect()\n        }catch (e:Exception){\n        }\n    }\n\n}\n\nfun main() {\n    val client = Client()\n    client.setSocket()\n    client.establishConnection()\n}\n</code></pre>\n<p>when running the main function i get these exception</p>\n<pre><code>GRAVE: Task threw exception java.lang.RuntimeException: Stub! at org.json.JSONObject.&lt;init&gt;(JSONObject.java:115) at io.socket.engineio.client.HandshakeData.&lt;init&gt;(HandshakeData.java:16) at io.socket.engineio.client.Socket.onPacket(Socket.java:541) at io.socket.engineio.client.Socket.access$1000(Socket.java:36) at io.socket.engineio.client.Socket$5.call(Socket.java:337) at io.socket.emitter.Emitter.emit(Emitter.java:117) at io.socket.engineio.client.Transport.onPacket(Transport.java:124) at io.socket.engineio.client.Transport.onData(Transport.java:116) at io.socket.engineio.client.transports.WebSocket.access$100(WebSocket.java:23) at io.socket.engineio.client.transports.WebSocket$1$2.run(WebSocket.java:73) at io.socket.thread.EventThread$2.run(EventThread.java:80) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) at java.base/java.lang.Thread.run(Thread.java:840)\n\nException in thread &quot;EventThread&quot; java.lang.RuntimeException: Stub! at org.json.JSONObject.&lt;init&gt;(JSONObject.java:115) at io.socket.engineio.client.HandshakeData.&lt;init&gt;(HandshakeData.java:16) at io.socket.engineio.client.Socket.onPacket(Socket.java:541) at io.socket.engineio.client.Socket.access$1000(Socket.java:36) at io.socket.engineio.client.Socket$5.call(Socket.java:337) at io.socket.emitter.Emitter.emit(Emitter.java:117) at io.socket.engineio.client.Transport.onPacket(Transport.java:124) at io.socket.engineio.client.Transport.onData(Transport.java:116) at io.socket.engineio.client.transports.WebSocket.access$100(WebSocket.java:23) at io.socket.engineio.client.transports.WebSocket$1$2.run(WebSocket.java:73) at io.socket.thread.EventThread$2.run(EventThread.java:80) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) at java.base/java.lang.Thread.run(Thread.java:840)\n</code></pre>\n<p>Thank u in advance, i would be grateful for any help</p>\n<p>i have connected to the server from a web client through an html file and everything is ok, the problem happens when trying to conect to the server from a kotlin client. I use the ip addres for localhost (&quot;127.0.0.1:3000&quot;) when creating the socket object and then i establish the connection but it seems not to work</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}