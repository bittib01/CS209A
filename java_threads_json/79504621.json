{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-batch"
    ],
    "owner": {
      "account_id": 4374245,
      "reputation": 907,
      "user_id": 3567672,
      "user_type": "registered",
      "accept_rate": 75,
      "profile_image": "https://i.sstatic.net/Bdz6j.png?s=256",
      "display_name": "edwise",
      "link": "https://stackoverflow.com/users/3567672/edwise"
    },
    "is_answered": false,
    "view_count": 64,
    "answer_count": 1,
    "score": 2,
    "last_activity_date": 1747988307,
    "creation_date": 1741805518,
    "question_id": 79504621,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79504621/do-something-for-every-file-read-in-spring-batch-with-multiresourceitemreader",
    "title": "Do something for every file read in Spring Batch with MultiResourceItemReader",
    "body": "<p>I have a SpringBatch project with Spring Boot. Is a job that reads csv files from a folder. This is part of the job config:</p>\n<pre><code>    @Bean\n    public FlatFileItemReader&lt;Workout&gt; reader() {\n        return new FlatFileItemReaderBuilder&lt;Workout&gt;()\n                .name(&quot;workoutReader&quot;)\n                .fieldSetMapper(new BeanWrapperFieldSetMapper&lt;&gt;() {{\n                    setTargetType(Workout.class);\n                    setCustomEditors(Collections.singletonMap(\n                            LocalDateTime.class,\n                            new LocalDateTimeEditor()\n                    ));\n                }})\n                .linesToSkip(1)\n                .delimited()\n                .names(Workout.FIELDS)\n                .build();\n    }\n\n    @Bean\n    public MultiResourceItemReader&lt;Workout&gt; multiResourceReader(FlatFileItemReader&lt;Workout&gt; reader) {\n        return new MultiResourceItemReaderBuilder&lt;Workout&gt;()\n                .name(&quot;multiWorkoutReader&quot;)\n                .resources(loadWorkoutFiles())\n                .delegate(reader)\n                .build();\n    }\n\n    private Resource[] loadWorkoutFiles() {\n        try {\n            return new PathMatchingResourcePatternResolver()\n                    .getResources(&quot;classpath:&quot; + workoutFileNamePattern);\n        } catch (IOException e) {\n            throw new RuntimeException(&quot;Error loading CSV files&quot;, e);\n        }\n    }\n</code></pre>\n<p>I need to do a query to a mongo db before every file is read. How can I do it? I tried with and StepListener but it doesnt work for the files, it work for the steps.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}