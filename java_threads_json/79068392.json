{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "unit-testing",
      "spring-boot-test",
      "rest-client"
    ],
    "owner": {
      "account_id": 36369368,
      "reputation": 11,
      "user_id": 27703629,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/508cba715990cdcf46afb7ffa37cafbb?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Vitor Coelho",
      "link": "https://stackoverflow.com/users/27703629/vitor-coelho"
    },
    "is_answered": false,
    "view_count": 424,
    "answer_count": 0,
    "score": 1,
    "last_activity_date": 1733422729,
    "creation_date": 1728444350,
    "last_edit_date": 1728445202,
    "question_id": 79068392,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79068392/unable-to-use-auto-configured-mockrestserviceserver-since-mockserverrestclientcu",
    "title": "Unable to use auto-configured MockRestServiceServer since MockServerRestClientCustomizer has been bound to more than one RestClient | two Beans",
    "body": "<p>I created a <code>TestRestClient</code> and it worked perfectly, but if I inject another <code>RestClient</code> bean into my <code>RestClientConfiguration</code> class, it works, but in the tests, it gives the following error: Unable to use auto-configured <code>MockRestServiceServer</code> since <code>MockServerRestClientCustomizer</code> has been bound to more than one <code>RestClient</code>.</p>\n<p>Error message: Unable to use auto-configured <code>MockRestServiceServer</code> since <code>MockServerRestClientCustomizer</code> has been bound to more than one <code>RestClient</code></p>\n<p><a href=\"https://i.sstatic.net/UmD2piBE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/UmD2piBE.png\" alt=\"enter image description here\" /></a></p>\n<p>my code: <a href=\"https://github.com/vitheka/doubt-test-restclient-with-two-beans\" rel=\"nofollow noreferrer\">https://github.com/vitheka/doubt-test-restclient-with-two-beans</a></p>\n<pre class=\"lang-java prettyprint-override\"><code>@RestClientTest({\n        ViaCepApiService.class,\n        RestClientConfiguration.class\n})\nclass ViaCepApiServiceTest {\n\n    @Autowired\n    private MockRestServiceServer server;\n\n    @Autowired\n    private ObjectMapper mapper;\n\n    @Autowired\n    private ViaCepApiService viaCepApiService;\n\n    private ViaCepResponse viaCepResponse;\n\n    @BeforeEach\n    void setUp() {\n\n        viaCepResponse = new ViaCepResponse(\n                &quot;88804-576&quot;,\n                &quot;Rua Albina Milanez&quot;,\n                &quot;&quot;,\n                &quot;&quot;,\n                &quot;Milanese&quot;,\n                &quot;Crici√∫ma&quot;,\n                &quot;SC&quot;,\n                &quot;Santa Catarina&quot;,\n                &quot;Sul&quot;,\n                &quot;4204608&quot;,\n                &quot;&quot;,\n                &quot;48&quot;,\n                &quot;8089&quot;\n        );\n    }\n\n    @Test\n    void getCep() throws JsonProcessingException {\n\n        String baseUrl = &quot;https://viacep.com.br&quot;;\n        String path = &quot;/ws/88804576/json/&quot;;\n\n        var jsonResponse = mapper.writeValueAsString(viaCepResponse);\n\n        var requestTo = MockRestRequestMatchers\n                .requestToUriTemplate(baseUrl.concat(path));\n\n        var withSuccess = MockRestResponseCreators.withSuccess(jsonResponse, MediaType.APPLICATION_JSON);\n\n        server.expect(requestTo).andRespond(withSuccess);\n\n        Assertions\n                .assertThat(viaCepApiService.getViaCep())\n                .isNotNull()\n                .isEqualTo(viaCepResponse);\n\n    }\n}\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}