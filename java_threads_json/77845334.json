{
  "question": {
    "tags": [
      "java",
      "apache-spark",
      "metrics"
    ],
    "owner": {
      "account_id": 29101702,
      "reputation": 131,
      "user_id": 22293394,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/QpciM.png?s=256",
      "display_name": "matszewczyk",
      "link": "https://stackoverflow.com/users/22293394/matszewczyk"
    },
    "is_answered": true,
    "view_count": 179,
    "accepted_answer_id": 77845742,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1728871604,
    "creation_date": 1705659603,
    "last_edit_date": 1705660138,
    "question_id": 77845334,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/77845334/are-taskmetrics-available-via-stagecompleted-sparklistener-onstagecompleted-ag",
    "title": "Are TaskMetrics available via stageCompleted SparkListener.onStageCompleted() aggregated metrics for all the tasks in the stage?",
    "body": "<p>I'm writing my own SparkListener to send metrics to 3rd party systems. At the end of the stage I'd like to send the aggregated metrics from all the tasks within this stage.</p>\n<p>SparkListener has onStageCompleted() method, which I can override to retrieve the TaskMetrics as per the code snippet below:</p>\n<pre><code> @Override\n    public void onStageCompleted(SparkListenerStageCompleted stageCompleted) {\n        TaskMetrics taskMetrics = stageCompleted.stageInfo().taskMetrics();\n    }\n</code></pre>\n<p><strong>Question:</strong>\nWhat the metrics from the <code>taskMetrics</code> objects above represents? Are these the metrics for most recent task from the stage or maybe aggreagated metrics for all the tasks within the stage?</p>\n<p>Docs of the 3.2.3 version I'm using: <a href=\"https://spark.apache.org/docs/3.2.3/api/java/index.html?org/apache/spark/scheduler/SparkListener.html\" rel=\"nofollow noreferrer\">https://spark.apache.org/docs/3.2.3/api/java/index.html?org/apache/spark/scheduler/SparkListener.html</a></p>\n<p>I checked the documentation, but couldn't find any information on this topic.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}