{
  "question": {
    "tags": [
      "java",
      "postgresql",
      "jpa",
      "orm",
      "nativequery"
    ],
    "owner": {
      "account_id": 17228781,
      "reputation": 4612,
      "user_id": 12473843,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/HkCxn.jpg?s=256",
      "display_name": "Sergey Tsypanov",
      "link": "https://stackoverflow.com/users/12473843/sergey-tsypanov"
    },
    "is_answered": true,
    "view_count": 156,
    "answer_count": 1,
    "score": 2,
    "last_activity_date": 1755639466,
    "creation_date": 1755613745,
    "last_edit_date": 1755628279,
    "question_id": 79740056,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79740056/jpa-repository-method-with-native-query-containing-works-with-long-but-no",
    "title": "JPA repository method with native query containing &#39;&amp;&amp;&#39; works with Long[] but not Collection&lt;Long&gt;",
    "body": "<p>In one of my Spring Data JPA repositories I have this native query (PostgreSQL):</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Query(value = &quot;SELECT * FROM ballots b WHERE b.companies &amp;&amp; :companyIds and b.meeting_id in :meetingIds&quot;, nativeQuery = true)\nList&lt;Ballot&gt; findByIds(Long[] companyIds, Long[] meetingIds);\n</code></pre>\n<p>Here's my entity:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Table(name=&quot;ballots&quot;)\npublic class Ballot {\n    @Id\n    private long id;\n\n    @Column\n    private long meetingId;\n\n    @Type(ListArrayType.class)\n    @Column(name = &quot;companies&quot;,columnDefinition = &quot;bigint[]&quot;)\n    private List&lt;Long&gt; companies = new ArrayList&lt;&gt;();\n}\n</code></pre>\n<p>Here's how I call the method:</p>\n<pre class=\"lang-java prettyprint-override\"><code>private final BallotRepository ballotRepo;\n\n  public void findBallots(Set&lt;Long&gt; companyIds, Set&lt;Long&gt; companyMeetingIds) {\n    List&lt;Ballot&gt; ballots = ballotRepository.findByIds(companyIds, companyMeetingIds);\n    // the rest of the code\n  }\n}\n</code></pre>\n<p>Method signature with</p>\n<ul>\n<li><code>Long[] companyIds, Long[] meetingIds</code> works fine</li>\n<li><code>Long[] companyIds, Collection&lt;Long&gt; meetingIds</code> works fine</li>\n<li><code>Collection&lt;Long&gt; companyIds, Collection&lt;Long&gt; meetingIds</code> fails:</li>\n</ul>\n<pre class=\"lang-none prettyprint-override\"><code>org.springframework.dao.InvalidDataAccessResourceUsageException: JDBC exception executing SQL [SELECT * FROM ballots b WHERE b.companies &amp;&amp; (?) and b.meeting_id in (?,?)] [ERROR: operator does not exist: bigint[] &amp;&amp; bigint\n  Hint: No operator matches the given name and argument types. You might need to add explicit type casts.\n  Position: 42] [n/a]; SQL [n/a]\n</code></pre>\n<p>How should I modify the query to make it work?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}