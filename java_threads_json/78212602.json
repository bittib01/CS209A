{
  "question": {
    "tags": [
      "java",
      "android",
      "linux",
      "function",
      "permissions"
    ],
    "owner": {
      "user_type": "does_not_exist",
      "display_name": "user16540876"
    },
    "is_answered": false,
    "view_count": 178,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1732284823,
    "creation_date": 1711230214,
    "last_edit_date": 1711230332,
    "question_id": 78212602,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78212602/injectinputevent-not-working-failing-to-get-instance",
    "title": "InjectInputEvent not working, failing to get instance",
    "body": "<p>This is what logcat outputs, I've signed my android apk with my own cert</p>\n<pre><code>java.lang.NoSuchMethodException: com.example.receiver.InputManager.getInstance []\n    at java.lang.Class.getMethod(Class.java:2937)\n    at java.lang.Class.getDeclaredMethod(Class.java:2914)\n    at com.example.receiver.InputHandler.getInputManager(InputHandler.java:59)\n    at com.example.receiver.InputHandler.injectInputEvent(InputHandler.java:43)\n    at com.example.receiver.InputHandler.Handle(InputHandler.java:84)\n    at com.example.receiver.Main.main(Main.java:38)\n    at com.example.receiver.MainActivity.lambda$onCreate$0(MainActivity.java:21)\n    at com.example.receiver.MainActivity$$ExternalSyntheticLambda0.run(Unknown Source:2)\n</code></pre>\n<p>this is the code related to injectInputEvent()</p>\n<pre><code>    private void injectInputEvent(MotionEvent event) {\n        try {\n            getInjectInputEvent().invoke(getInputManager(), event, 0);\n        } catch (IllegalAccessException | InvocationTargetException | NoSuchMethodException e) {\n            e.printStackTrace();\n        }\n    }\n\n    private static Method getInjectInputEvent() throws NoSuchMethodException {\n\n        Class&lt;InputManager&gt; cl = InputManager.class;\n        Method method = cl.getDeclaredMethod(&quot;injectInputEvent&quot;, InputEvent.class, int.class);\n        method.setAccessible(true);\n        return method;\n    }\n\n    private static InputManager getInputManager() throws NoSuchMethodException, InvocationTargetException, IllegalAccessException {\n        Class&lt;InputManager&gt; cl = InputManager.class;\n        Method method = cl.getDeclaredMethod(&quot;getInstance&quot;);\n        method.setAccessible(true);\n        return (InputManager) method.invoke(cl);\n    }\n</code></pre>\n<p>I have set the following permission in my manifest:</p>\n<pre><code>&lt;uses-permission android:name=&quot;android.permission.INJECT_EVENTS&quot;/&gt;\n</code></pre>\n<p>I run my apk from adb shell like so:</p>\n<pre><code>am start com.example.receiver/com.example.receiver.MainActivity\n</code></pre>\n<p>This should work I think at it works for scrcpy's server\nwhy it doesn't for mine?</p>\n<p>I don't have root access.</p>\n<p>I was expecting for the app to be able to InjectInputEvents but it is not able to.\nI've tried starting it from adb shell and from android studio which didn't make any difference.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}