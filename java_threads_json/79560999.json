{
  "question": {
    "tags": [
      "java",
      "spring",
      "apache-camel",
      "ibm-mq"
    ],
    "owner": {
      "account_id": 12812865,
      "reputation": 21,
      "user_id": 9270417,
      "user_type": "registered",
      "profile_image": "https://lh5.googleusercontent.com/-dHf4ja20dvM/AAAAAAAAAAI/AAAAAAAADfU/2Rt-jqARz2w/s256-rj/photo.jpg",
      "display_name": "Joshua Bennier",
      "link": "https://stackoverflow.com/users/9270417/joshua-bennier"
    },
    "is_answered": false,
    "view_count": 98,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1745351266,
    "creation_date": 1744074794,
    "question_id": 79560999,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79560999/jmsendpoint-garbage-collection",
    "title": "JmsEndpoint garbage collection?",
    "body": "<p>My service uses Camel to read messages from several queues. Having recently migrated the JDK to Java 17 (and a number of dependencies for compatibility), I've seen a memory leak, tho I don't know that the two are related. I suspect the code presently doesn't properly collect garbage and that my JmsEndpoint interface object needs some combination of stop, shutdown, and close invoked. Presently, we are nowhere invoking any of these, nor are we using a try-with-resources block. A senior engineer I'm working with thinks garbage collection is being done behind the scenes by Spring or Camel. Below are relevant snippets of example code similar to what we've implemented. myMethod is called using the bean method in a route. We have implemented onException in the route, but we also aren't doing any explicit garbage collection there. Am I right that we need to explicitly collect garbage? Any other diagnoses?</p>\n<pre><code>import org.apache.camel.ConsumerTemplate;\nimport org.apache.camel.Exchange;\nimport org.apache.camel.component.jms.JmsComponent;\nimport org.apache.camel.component.jms.JmsEndpoint;\nimport org.springframework.beans.factory.annotation.Autowired;\n...\n\npublic class MyClass {\n\n    private JmsComponent jmsComponent;\n\n    @Autowired\n    ConsumerTemplate consumerTemplate;\n\n    ...\n\n    public void myMethod(Exchange exchange) {\n        //obviously-fake values below to protect the guilty\n        JmsEndpoint jmsEndpoint = new JmsEndpoint(&quot;uri&quot;, jmsComponent, &quot;destinationName&quot;, false, jmsConfiguration);\n\n        Exchange newExchange = null;\n\n        ...//logic for waiting, don't ask\n\n        newExchange = consumer.receiveNoWait(jmsEndpoint);\n\n        //something like the following?\n        //jmsEndpoint.close();\n\n        ...\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}