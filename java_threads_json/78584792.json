{
  "question": {
    "tags": [
      "java",
      "android",
      "firebase"
    ],
    "owner": {
      "account_id": 12034378,
      "reputation": 41,
      "user_id": 8803490,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/a77f55b57d6196c0da206b31ea2805fb?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Kevin Olson",
      "link": "https://stackoverflow.com/users/8803490/kevin-olson"
    },
    "is_answered": true,
    "view_count": 47,
    "answer_count": 2,
    "score": 1,
    "last_activity_date": 1728541602,
    "creation_date": 1717655088,
    "last_edit_date": 1728541602,
    "question_id": 78584792,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78584792/firebase-register-user-with-email-and-password-not-working-not-continuing-onto",
    "title": "Firebase Register User With Email and Password [NOT WORKING] Not continuing onto login page after registration",
    "body": "<p>Well, I get the user inside the Firebase database but it doesn't seem to be opening up the login activity after clicking register. It endlessly shows the progress bar...</p>\n<p>Heres the entire RegisterActivity.java code block</p>\n<pre><code>package com.example.goalhero;\n\nimport androidx.annotation.NonNull;\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.app.DatePickerDialog;\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.text.TextUtils;\nimport android.util.Patterns;\nimport android.util.Log;\nimport android.view.View;\nimport android.widget.Button;\nimport android.widget.DatePicker;\nimport android.widget.EditText;\nimport android.widget.ProgressBar;\nimport android.widget.RadioButton;\nimport android.widget.RadioGroup;\nimport android.widget.Toast;\n\nimport com.google.android.gms.tasks.OnCompleteListener;\nimport com.google.android.gms.tasks.Task;\nimport com.google.firebase.auth.AuthResult;\nimport com.google.firebase.auth.FirebaseAuth;\nimport com.google.firebase.auth.FirebaseAuthInvalidCredentialsException;\nimport com.google.firebase.auth.FirebaseAuthUserCollisionException;\nimport com.google.firebase.auth.FirebaseAuthWeakPasswordException;\nimport com.google.firebase.auth.FirebaseUser;\nimport com.google.firebase.auth.UserProfileChangeRequest;\nimport com.google.firebase.database.DatabaseReference;\nimport com.google.firebase.database.FirebaseDatabase;\n\nimport java.util.Calendar;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\npublic class RegisterActivity extends AppCompatActivity {\n\n    EditText etRegFullname, etRegEmail, etRegDob, etRegMobile, etRegPwd, etRegConfirmPwd;\n    ProgressBar progressBar;\n    RadioGroup rgRegGender;\n    RadioButton rbRegGenderSelected;\n    DatePickerDialog picker;\n\n    private static final String TAG = &quot;RegisterActivity&quot;;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_register);\n\n        setSupportActionBar(findViewById(R.id.toolbar));\n\n        Toast.makeText(RegisterActivity.this, &quot;You may register now.&quot;, Toast.LENGTH_LONG).show();\n\n        progressBar = findViewById(R.id.progress_bar);\n\n        etRegPwd = findViewById(R.id.et_register_password);\n        etRegConfirmPwd = findViewById(R.id.et_confirm_password);\n\n        etRegFullname = findViewById(R.id.et_register_fullname);\n        etRegEmail = findViewById(R.id.et_register_email);\n        etRegDob = findViewById(R.id.et_register_dob);\n        etRegMobile = findViewById(R.id.et_register_mobile);\n\n        rgRegGender = findViewById(R.id.radio_group_register_gender);\n        rgRegGender.clearCheck();\n\n        // Setting up the date picker\n        etRegDob.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View view) {\n                final Calendar cal = Calendar.getInstance();\n                int day = cal.get(Calendar.DAY_OF_MONTH);\n                int month = cal.get(Calendar.MONTH);\n                int year = cal.get(Calendar.YEAR);\n\n                // Date picker dialog\n                picker = new DatePickerDialog(RegisterActivity.this, new DatePickerDialog.OnDateSetListener() {\n                    @Override\n                    public void onDateSet(DatePicker datePicker, int year, int month, int day) {\n                        etRegDob.setText(day + &quot;/&quot; + (month + 1) + &quot;/&quot; + year);\n                        Log.d(TAG, &quot;Date of Birth selected: &quot; + etRegDob.getText().toString());\n                    }\n                }, year, month, day);\n                picker.show();\n            }\n        });\n\n        Button registerBtn = findViewById(R.id.registerBtn);\n\n        registerBtn.setOnClickListener(new View.OnClickListener() {\n            @Override\n            public void onClick(View view) {\n\n                int selectedGenderId = rgRegGender.getCheckedRadioButtonId();\n                rbRegGenderSelected = findViewById(selectedGenderId);\n\n                // Obtain the entered data\n                String txtFullname = etRegFullname.getText().toString();\n                String txtEmail = etRegEmail.getText().toString();\n                String txtDob = etRegDob.getText().toString();\n                String txtMobile = etRegMobile.getText().toString();\n                String txtPwd = etRegPwd.getText().toString();\n                String txtConfirmPwd = etRegConfirmPwd.getText().toString();\n                String txtGender;\n\n                Log.d(TAG, &quot;Register button clicked with details - Fullname: &quot; + txtFullname + &quot;, Email: &quot; + txtEmail + &quot;, DOB: &quot; + txtDob + &quot;, Mobile: &quot; + txtMobile + &quot;, Password: &quot; + txtPwd + &quot;, Confirm Password: &quot; + txtConfirmPwd);\n\n                // Validate the mobile number using matcher and pattern (regular express)\n                String mobileRegex = &quot;^(\\\\+\\\\d{1,2}\\\\s?)?\\\\(?\\\\d{3}\\\\)?[\\\\s.-]?\\\\d{3}[\\\\s.-]?\\\\d{4}$&quot;;\n                Matcher mobileMatcher;\n                Pattern mobilePattern = Pattern.compile(mobileRegex);\n                mobileMatcher = mobilePattern.matcher(txtMobile);\n\n                if (TextUtils.isEmpty(txtFullname)) {\n                    showError(etRegFullname, &quot;Please enter your full name.&quot;, &quot;Full name is required.&quot;);\n                } else if (TextUtils.isEmpty(txtEmail)) {\n                    showError(etRegEmail, &quot;Please enter a valid email.&quot;, &quot;Email is required.&quot;);\n                } else if (!Patterns.EMAIL_ADDRESS.matcher(txtEmail).matches()) {\n                    showError(etRegEmail, &quot;Please re-enter your email.&quot;, &quot;Valid email address required.&quot;);\n                } else if (TextUtils.isEmpty(txtDob)) {\n                    showError(etRegDob, &quot;Please enter your DOB.&quot;, &quot;DOB required.&quot;);\n                } else if (rgRegGender.getCheckedRadioButtonId() == -1) {\n                    showError(rbRegGenderSelected, &quot;Please select your gender.&quot;, &quot;Gender selection required.&quot;);\n                } else if (TextUtils.isEmpty(txtMobile)) {\n                    showError(etRegMobile, &quot;Please enter your 10-digit mobile number.&quot;, &quot;Phone number isn't valid.&quot;);\n                } else if (txtMobile.length() != 10) {\n                    showError(etRegMobile, &quot;Phone number must be 10-digits&quot;, &quot;Phone number isn't 10-digits.&quot;);\n                } else if (!mobileMatcher.find()) {\n                    showError(etRegMobile, &quot;This is not a valid phone number.&quot;, null);\n                } else if (TextUtils.isEmpty(txtPwd)) {\n                    showError(etRegPwd, &quot;You must enter a password.&quot;, &quot;No password entered.&quot;);\n                } else if (txtPwd.length() &lt; 6) {\n                    showError(etRegPwd, &quot;Password too short.&quot;, &quot;Password too short.&quot;);\n                } else if (TextUtils.isEmpty(txtConfirmPwd)) {\n                    showError(etRegConfirmPwd, &quot;Please confirm your password.&quot;, &quot;Password confirmation is required.&quot;);\n                } else if (!txtPwd.equals(txtConfirmPwd)) {\n                    showError(etRegConfirmPwd, &quot;Passwords must match.&quot;, &quot;Passwords don't match.&quot;);\n                    etRegConfirmPwd.clearComposingText();\n                    etRegPwd.clearComposingText();\n                } else {\n                    txtGender = rbRegGenderSelected.getText().toString();\n                    progressBar.setVisibility(View.VISIBLE);\n                    registerUser(txtFullname, txtEmail, txtDob, txtGender, txtMobile, txtPwd);\n                }\n            }\n        });\n    }\n\n    private void showError(View view, String toastMessage, String errorMessage) {\n        Toast.makeText(RegisterActivity.this, toastMessage, Toast.LENGTH_SHORT).show();\n        Log.e(TAG, &quot;Error: &quot; + toastMessage + &quot; - &quot; + errorMessage);\n        if (view instanceof EditText) {\n            ((EditText) view).setError(errorMessage);\n            view.requestFocus();\n        } else if (view instanceof RadioButton) {\n            ((RadioButton) view).setError(errorMessage);\n            view.requestFocus();\n        }\n    }\n\n    private void registerUser(String txtFullname, String txtEmail, String txtDob, String txtGender, String txtMobile, String txtPwd) {\n        FirebaseAuth auth = FirebaseAuth.getInstance();\n\n        auth.createUserWithEmailAndPassword(txtEmail, txtPwd)\n                .addOnCompleteListener(this, new OnCompleteListener&lt;AuthResult&gt;() {\n                    @Override\n                    public void onComplete(@NonNull Task&lt;AuthResult&gt; task) {\n                        if (task.isSuccessful()) {\n                            FirebaseUser firebaseUser = task.getResult().getUser();\n                            Log.d(TAG, &quot;User registered successfully with UID: &quot; + firebaseUser.getUid());\n                            updateUserProfile(firebaseUser, txtFullname);\n                            writeUserDataToDatabase(firebaseUser, new ReadWriteUserDetails(txtDob, txtGender, txtMobile));\n                        } else {\n                            handleRegistrationError(task.getException());\n                        }\n                        progressBar.setVisibility(View.GONE);\n                    }\n                });\n    }\n\n    private void updateUserProfile(FirebaseUser user, String displayName) {\n        user.updateProfile(new UserProfileChangeRequest.Builder()\n                        .setDisplayName(displayName)\n                        .build())\n                .addOnCompleteListener(new OnCompleteListener&lt;Void&gt;() {\n                    @Override\n                    public void onComplete(@NonNull Task&lt;Void&gt; task) {\n                        if (task.isSuccessful()) {\n                            Log.d(TAG, &quot;User profile updated.&quot;);\n                        } else {\n                            Log.e(TAG, &quot;Failed to update user profile.&quot;);\n                            Toast.makeText(RegisterActivity.this, &quot;Failed to update user profile.&quot;, Toast.LENGTH_SHORT).show();\n                        }\n                    }\n                });\n    }\n\n    private void writeUserDataToDatabase(FirebaseUser user, ReadWriteUserDetails userData) {\n        DatabaseReference referenceProfile = FirebaseDatabase.getInstance().getReference(&quot;Registered Users&quot;);\n        referenceProfile.child(user.getUid()).setValue(userData)\n                .addOnCompleteListener(new OnCompleteListener&lt;Void&gt;() {\n                    @Override\n                    public void onComplete(@NonNull Task&lt;Void&gt; task) {\n                        if (task.isSuccessful()) {\n                            Log.d(TAG, &quot;User data written to database.&quot;);\n                            sendVerificationEmail(user);\n                        } else {\n                            Log.e(TAG, &quot;Failed to save user data.&quot;);\n                            Toast.makeText(RegisterActivity.this, &quot;Failed to save user data.&quot;, Toast.LENGTH_SHORT).show();\n                        }\n                    }\n                });\n    }\n\n    private void sendVerificationEmail(FirebaseUser user) {\n        user.sendEmailVerification()\n                .addOnCompleteListener(new OnCompleteListener&lt;Void&gt;() {\n                    @Override\n                    public void onComplete(@NonNull Task&lt;Void&gt; task) {\n                        if (task.isSuccessful()) {\n                            Log.d(TAG, &quot;Verification email sent.&quot;);\n                            Toast.makeText(RegisterActivity.this, &quot;User registered successfully. Please verify your email.&quot;, Toast.LENGTH_SHORT).show();\n                            Intent intent = new Intent(RegisterActivity.this, LoginActivity.class);\n                            intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK);\n                            startActivity(intent);\n                            finish();\n                        } else {\n                            Log.e(TAG, &quot;Failed to send verification email.&quot;);\n                            Toast.makeText(RegisterActivity.this, &quot;Failed to send verification email.&quot;, Toast.LENGTH_SHORT).show();\n                        }\n                    }\n                });\n    }\n\n    private void handleRegistrationError(Exception e) {\n        String message;\n        if (e instanceof FirebaseAuthWeakPasswordException) {\n            message = &quot;Password must contain 6 or more characters. Letters, numbers, and special character required&quot;;\n        } else if (e instanceof FirebaseAuthInvalidCredentialsException) {\n            message = &quot;Your email is invalid or already in use.&quot;;\n        } else if (e instanceof FirebaseAuthUserCollisionException) {\n            message = &quot;User is already registered.&quot;;\n        } else {\n            message = e.getMessage();\n        }\n        Log.e(TAG, &quot;Registration error: &quot; + message, e);\n        Toast.makeText(RegisterActivity.this, message, Toast.LENGTH_SHORT).show();\n    }\n}\n\n</code></pre>\n<p>This is the output of the code</p>\n<p>RegisterActivity        com.example.goalhero                 D  Date of Birth selected: 6/6/2024\nRegisterActivity        com.example.goalhero                 D  Register button clicked with details - Fullname: K, Email: Kevinalexolson@gmail.com, DOB: 6/6/2024, Mobile: 2042322553, Password: *******, Confirm Password: *******\nRegisterActivity        com.example.goalhero                 D  User registered successfully with UID: T49FfhdctwOcevRDuA94K0IDw8t2\nRegisterActivity        com.example.goalhero                 D  User profile updated.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}