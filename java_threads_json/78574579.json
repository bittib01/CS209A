{
  "question": {
    "tags": [
      "java",
      "android",
      "kotlin",
      "gradle"
    ],
    "owner": {
      "account_id": 6234863,
      "reputation": 1489,
      "user_id": 4850493,
      "user_type": "registered",
      "accept_rate": 93,
      "profile_image": "https://i.sstatic.net/rg5TA.jpg?s=256",
      "display_name": "YMonnier",
      "link": "https://stackoverflow.com/users/4850493/ymonnier"
    },
    "is_answered": true,
    "view_count": 6558,
    "accepted_answer_id": 78686026,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1738559359,
    "creation_date": 1717494238,
    "question_id": 78574579,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78574579/kotlin-2-failed-to-compile-with-kotlin-daemon",
    "title": "Kotlin 2 Failed to compile with Kotlin daemon",
    "body": "<p>I migrated an Android project to Kotlin 2 and I am facing to an issue related to K2 compilation:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>&gt; Task :commonKotlin:compileDebugKotlin\ne: The daemon has terminated unexpectedly on startup attempt #1 with error code: 1. The daemon process output:\n    1. Invalid initial heap size: -Xms=512M\n    2. Error: Could not create the Java Virtual Machine.\n    3. Error: A fatal exception has occurred. Program will exit.\ne: Failed connecting to the daemon in 3 retries\ne: Daemon compilation failed: Could not connect to Kotlin compile daemon\njava.lang.RuntimeException: Could not connect to Kotlin compile daemon\n    at org.jetbrains.kotlin.compilerRunner.GradleKotlinCompilerWork.compileWithDaemon(GradleKotlinCompilerWork.kt:214)\n    at org.jetbrains.kotlin.compilerRunner.GradleKotlinCompilerWork.compileWithDaemonOrFallbackImpl(GradleKotlinCompilerWork.kt:159)\n    at org.jetbrains.kotlin.compilerRunner.GradleKotlinCompilerWork.run(GradleKotlinCompilerWork.kt:111)\n    at org.jetbrains.kotlin.compilerRunner.GradleCompilerRunnerWithWorkers$GradleKotlinCompilerWorkAction.execute(GradleCompilerRunnerWithWorkers.kt:76)\n    at org.gradle.workers.internal.DefaultWorkerServer.execute(DefaultWorkerServer.java:63)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1$1.create(NoIsolationWorkerFactory.java:66)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1$1.create(NoIsolationWorkerFactory.java:62)\n    at org.gradle.internal.classloader.ClassLoaderUtils.executeInClassloader(ClassLoaderUtils.java:100)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1.lambda$execute$0(NoIsolationWorkerFactory.java:62)\n    at org.gradle.workers.internal.AbstractWorker$1.call(AbstractWorker.java:44)\n    at org.gradle.workers.internal.AbstractWorker$1.call(AbstractWorker.java:41)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:200)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:195)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:66)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:157)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:53)\n    at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:73)\n    at org.gradle.workers.internal.AbstractWorker.executeWrappedInBuildOperation(AbstractWorker.java:41)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1.execute(NoIsolationWorkerFactory.java:59)\n    at org.gradle.workers.internal.DefaultWorkerExecutor.lambda$submitWork$0(DefaultWorkerExecutor.java:174)\n    at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.runExecution(DefaultConditionalExecutionQueue.java:187)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.access$700(DefaultConditionalExecutionQueue.java:120)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner$1.run(DefaultConditionalExecutionQueue.java:162)\n    at org.gradle.internal.Factories$1.create(Factories.java:31)\n    at org.gradle.internal.work.DefaultWorkerLeaseService.withLocks(DefaultWorkerLeaseService.java:264)\n    at org.gradle.internal.work.DefaultWorkerLeaseService.runAsWorkerThread(DefaultWorkerLeaseService.java:128)\n    at org.gradle.internal.work.DefaultWorkerLeaseService.runAsWorkerThread(DefaultWorkerLeaseService.java:133)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.runBatch(DefaultConditionalExecutionQueue.java:157)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.run(DefaultConditionalExecutionQueue.java:126)\n    at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)\n    at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n    at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:64)\n    at org.gradle.internal.concurrent.AbstractManagedExecutor$1.run(AbstractManagedExecutor.java:47)\n    at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n    at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n    at java.base/java.lang.Thread.run(Thread.java:840)\n\nFailed to compile with Kotlin daemon: java.lang.RuntimeException: Could not connect to Kotlin compile daemon\n    at org.jetbrains.kotlin.compilerRunner.GradleKotlinCompilerWork.compileWithDaemon(GradleKotlinCompilerWork.kt:214)\n    at org.jetbrains.kotlin.compilerRunner.GradleKotlinCompilerWork.compileWithDaemonOrFallbackImpl(GradleKotlinCompilerWork.kt:159)\n    at org.jetbrains.kotlin.compilerRunner.GradleKotlinCompilerWork.run(GradleKotlinCompilerWork.kt:111)\n    at org.jetbrains.kotlin.compilerRunner.GradleCompilerRunnerWithWorkers$GradleKotlinCompilerWorkAction.execute(GradleCompilerRunnerWithWorkers.kt:76)\n    at org.gradle.workers.internal.DefaultWorkerServer.execute(DefaultWorkerServer.java:63)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1$1.create(NoIsolationWorkerFactory.java:66)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1$1.create(NoIsolationWorkerFactory.java:62)\n    at org.gradle.internal.classloader.ClassLoaderUtils.executeInClassloader(ClassLoaderUtils.java:100)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1.lambda$execute$0(NoIsolationWorkerFactory.java:62)\n    at org.gradle.workers.internal.AbstractWorker$1.call(AbstractWorker.java:44)\n    at org.gradle.workers.internal.AbstractWorker$1.call(AbstractWorker.java:41)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:200)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$CallableBuildOperationWorker.execute(DefaultBuildOperationRunner.java:195)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:66)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner$2.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:157)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.execute(DefaultBuildOperationRunner.java:59)\n    at org.gradle.internal.operations.DefaultBuildOperationRunner.call(DefaultBuildOperationRunner.java:53)\n    at org.gradle.internal.operations.DefaultBuildOperationExecutor.call(DefaultBuildOperationExecutor.java:73)\n    at org.gradle.workers.internal.AbstractWorker.executeWrappedInBuildOperation(AbstractWorker.java:41)\n    at org.gradle.workers.internal.NoIsolationWorkerFactory$1.execute(NoIsolationWorkerFactory.java:59)\n    at org.gradle.workers.internal.DefaultWorkerExecutor.lambda$submitWork$0(DefaultWorkerExecutor.java:174)\n    at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.runExecution(DefaultConditionalExecutionQueue.java:187)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.access$700(DefaultConditionalExecutionQueue.java:120)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner$1.run(DefaultConditionalExecutionQueue.java:162)\n    at org.gradle.internal.Factories$1.create(Factories.java:31)\n    at org.gradle.internal.work.DefaultWorkerLeaseService.withLocks(DefaultWorkerLeaseService.java:264)\n    at org.gradle.internal.work.DefaultWorkerLeaseService.runAsWorkerThread(DefaultWorkerLeaseService.java:128)\n    at org.gradle.internal.work.DefaultWorkerLeaseService.runAsWorkerThread(DefaultWorkerLeaseService.java:133)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.runBatch(DefaultConditionalExecutionQueue.java:157)\n    at org.gradle.internal.work.DefaultConditionalExecutionQueue$ExecutionRunner.run(DefaultConditionalExecutionQueue.java:126)\n    at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)\n    at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n    at org.gradle.internal.concurrent.ExecutorPolicy$CatchAndRecordFailures.onExecute(ExecutorPolicy.java:64)\n    at org.gradle.internal.concurrent.AbstractManagedExecutor$1.run(AbstractManagedExecutor.java:47)\n    at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)\n    at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)\n    at java.base/java.lang.Thread.run(Thread.java:840)\nUsing fallback strategy: Compile without Kotlin daemon\nTry ./gradlew --stop if this issue persists\nIf it does not look related to your configuration, please file an issue with logs to https://kotl.in/issue\n</code></pre>\n<p>Currently it is not a blocker because it fallback to another strategy to compile.</p>\n<h2>Configuration</h2>\n<ul>\n<li>gradle-8.7</li>\n<li>Android Studio Jellyfish | 2023.3.1 Patch 1</li>\n<li>plugin-android-gradle = &quot;8.4.1&quot;</li>\n<li>Java 17</li>\n</ul>\n<h3>gradle.properties</h3>\n<pre><code>org.gradle.jvmargs=-Xmx4g\norg.gradle.parallel=true\n\n# Android options\nandroid.defaults.buildfeatures.aidl=false\nandroid.defaults.buildfeatures.renderscript=false\nandroid.defaults.buildfeatures.resvalues=true\nandroid.defaults.buildfeatures.shaders=false\nandroid.enableJetifier=true\nandroid.useAndroidX=true\n\n# Kotlin options\nkotlin.code.style=official\nkotlin.daemon.jvmargs=-Xmx1500m -Xms=500m\n\n# Gradle options\norg.gradle.caching=true\norg.gradle.configuration-cache=false\norg.gradle.configureondemand=true\norg.gradle.kotlin.dsl.caching.buildcache=true\n</code></pre>\n<h3>build.gradle</h3>\n<pre><code>kotlin {\n    compilerOptions {\n        jvmTarget.set(JvmTarget.JVM_17)\n        freeCompilerArgs.addAll(\n                &quot;-opt-in=kotlin.RequiresOptIn&quot;,\n                &quot;-opt-in=kotlinx.coroutines.ExperimentalCoroutinesApi&quot;,\n        )\n    }\n}\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}