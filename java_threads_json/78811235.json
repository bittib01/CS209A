{
  "question": {
    "tags": [
      "java",
      "javafx",
      "tableview"
    ],
    "owner": {
      "account_id": 30215796,
      "reputation": 33,
      "user_id": 23156657,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/1d5d924ccbed8e0c19c48f0e69aeb2eb?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "IO DHarby",
      "link": "https://stackoverflow.com/users/23156657/io-dharby"
    },
    "is_answered": false,
    "view_count": 85,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1729579111,
    "creation_date": 1722335849,
    "last_edit_date": 1722431817,
    "question_id": 78811235,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78811235/tableview-not-updating-after-adding-or-updating-record-in-javafx",
    "title": "TableView not updating after adding or updating record in JavaFX",
    "body": "<p>I'm working on a JavaFX application with a TableView for managing employee records. I have an EmployeeRepository class for handling CRUD operations that communicates with &quot;CsvHandler&quot; class to save the data in a csv and an EmployeeManagementController for interacting with the TableView.</p>\n<p>The issue I'm facing is that when I add or update an employee record through the dialog launched by EmployeeDetailsController, the TableView in EmployeeManagementController does not update to reflect these changes.</p>\n<p>Here's a brief overview of the relevant code:</p>\n<ol>\n<li><p>EmployeeRepository: Manages CRUD operations and maintains an ObservableList&lt;Employee&gt; that the TableView should be bound to.</p>\n</li>\n<li><p>EmployeeManagementController: Initializes the TableView with employeeObservableList, which is supposed to be updated when records are added or updated.</p>\n</li>\n<li><p>EmployeeDetailsController: Handles the dialog for adding or updating records and calls methods in EmployeeRepository to save the data.</p>\n</li>\n</ol>\n<p>Despite updating the ObservableList in EmployeeRepository after operations, the TableView in EmployeeManagementController does not reflect these changes.</p>\n<p>Here's the EmployeeRepository Class:</p>\n<pre><code>public class EmployeeRepository {\n\n    private final CsvHandler csvHandler;\n    private final String EMPLOYEE_DATA_FILE = &quot;Data/employeeData.csv&quot;;\n    private final List&lt;String[]&gt; employeeData;\n    private final ObservableList&lt;Employee&gt; employeeList;\n    private final String[] HEADERS;\n\n    public EmployeeRepository() {\n        csvHandler = new CsvHandler(EMPLOYEE_DATA_FILE);\n        employeeData = csvHandler.retrieveCsvData(true);\n        employeeList = FXCollections.observableArrayList(getAllEmployees());\n        HEADERS = csvHandler.retrieveFieldNames();\n    }\n\n    public Employee convertArrayToEmployee(String[] employeeData) {\n        return new Employee(\n                Integer.parseInt(employeeData[0]),\n                employeeData[1],\n                employeeData[2],\n                employeeData[3],\n                employeeData[4],\n                employeeData[5],\n                employeeData[6],\n                employeeData[7],\n                employeeData[8],\n                employeeData[9],\n                employeeData[10],\n                employeeData[11],\n                employeeData[12],\n                employeeData[13],\n                employeeData[14],\n                Double.parseDouble(employeeData[15]),\n                Double.parseDouble(employeeData[16]),\n                Double.parseDouble(employeeData[17]),\n                Double.parseDouble(employeeData[18]),\n                Double.parseDouble(employeeData[19]),\n                Double.parseDouble(employeeData[20])\n        );\n    }\n\n    public List&lt;Employee&gt; getAllEmployees() {\n        List&lt;Employee&gt; employees = new ArrayList&lt;&gt;();\n\n        for (String[] row : employeeData) {\n            employees.add(convertArrayToEmployee(row));\n        }\n        return employees;\n    }\n\n    public ObservableList&lt;Employee&gt; getEmployeeList() {\n        return employeeList;\n    }\n\n    public boolean recordExists(String[] record, int currentEmpId) {\n        for (String[] row : employeeData) {\n            if (Integer.parseInt(row[0]) != currentEmpId &amp;&amp; // EmployeeID\n                    (record[4].equals(row[4]) || // address\n                            record[5].equals(row[5]) || // phone number\n                            record[7].equals(row[7]) || // SSS\n                            record[8].equals(row[8]) || // PhilHealth\n                            record[9].equals(row[9]) || // TIN\n                            record[10].equals(row[10]))) { // Pag-IBIG\n                return true;\n            }\n        }\n        return false;\n    }\n\n    public void addEmployeeRecord(String[] record) {\n\n        if (recordExists(record, -1)) {\n            AlertUtil.showDuplicateRecordExists();\n            return;\n        }\n\n        employeeData.add(record);\n        employeeList.add(convertArrayToEmployee(record));\n\n        csvHandler.writeDataToCsv(employeeData, HEADERS);\n\n        employeeList.clear();\n        employeeList.addAll(getAllEmployees());\n\n        AlertUtil.showRecordSavedAlert();\n        System.out.println(&quot;Record saved&quot;);\n    }\n\n    public int getNewEmployeeID() {\n        return Integer.parseInt(employeeData.getLast()[0]) + 1;\n    }\n\n    public void updateEmployeeRecord(String[] record) {\n\n        if (recordExists(record, Integer.parseInt(record[0]))) {\n            AlertUtil.showDuplicateRecordExists();\n            return;\n        }\n\n        for (int i = 0; i &lt; employeeData.size(); i++) {\n            String[] row = employeeData.get(i);\n            if (row[0].equals(record[0])) {\n                employeeData.set(i, record);\n                employeeList.set(i, convertArrayToEmployee(record));\n                break;\n            }\n        }\n        csvHandler.writeDataToCsv(employeeData, HEADERS);\n\n        employeeList.clear();\n        employeeList.addAll(getAllEmployees());\n\n        AlertUtil.showRecordUpdatedAlert();\n        System.out.println(&quot;Record Updated&quot;);\n    }\n\n    public void deleteEmployeeRecord(int employeeId) {\n\n        employeeData.removeIf(row -&gt; row[0].equals(String.valueOf(employeeId)));\n\n        csvHandler.writeDataToCsv(employeeData, HEADERS);\n\n        employeeList.clear();\n        employeeList.addAll(getAllEmployees());\n\n        AlertUtil.showRecordDeletedAlert();\n        System.out.println(&quot;Record deleted&quot;);\n    }\n}\n\n</code></pre>\n<p>Here’s the EmployeeManagementController:</p>\n<pre><code>\npublic class EmployeeManagementController {\n\n    private final EmployeeRepository empDataService;\n\n    private final ObservableList&lt;Employee&gt; employeeObservableList;\n\n    @FXML\n    private TableView&lt;Employee&gt; employeeTable;\n\n    @FXML\n    private TableColumn&lt;Employee, Integer&gt; employeeIdColumn;\n\n    @FXML\n    private TableColumn&lt;Employee, String&gt; firstNameColumn, lastNameColumn, tinNoColumn, sssNoColumn, philhealthNoColumn, pagibigNoColumn;\n\n    public EmployeeManagementController() {\n        empDataService = new EmployeeRepository();\n        employeeObservableList = empDataService.getEmployeeList();\n    }\n\n    @FXML\n    public void initialize() {\n        initializeTableColumns();\n        loadEmployeeData();\n        handleViewEmployeeDetails();\n    }\n\n    @FXML\n    private void handleAddNewRecord() {\n        new EmployeeDetailsController().displayEmployeeDialog(false, null, false);\n    }\n\n    @FXML\n    private void handleUpdateRecord() {    Employee selectedEmployee = selectedEmployee();\n        if (selectedEmployee != null) {\n             new EmployeeDetailsController().displayEmployeeDialog(true, selectedEmployee, false);\n        } else {\n            AlertUtil.showNoSelectionAlert(&quot;Please select an employee record to update&quot;);\n        }\n    }\n\n    @FXML\n    public void handleDeleteRecord() {\n        Employee selectedEmployee = selectedEmployee();\n        if (selectedEmployee == null) {\n            AlertUtil.showNoSelectionAlert(&quot;Please select an employee record to delete&quot;);\n            return;\n        }\n\n        boolean confirmed = AlertUtil.showConfirmationAlert(&quot;Confirm Deletion&quot;, &quot;Are you sure you want to delete this employee record? This action cannot be undone.&quot;);\n        if (confirmed) {\n\n            empDataService.deleteEmployeeRecord(selectedEmployee.getEmployeeID());\n        }\n    }\n\n    private void handleViewEmployeeDetails() {\n        employeeTable.setOnMouseClicked((MouseEvent event) -&gt; {\n            if (event.getClickCount() == 2) {\n                new EmployeeDetailsController().displayEmployeeDialog(false, selectedEmployee(), true);\n            }\n        });\n    }\n\n\n    private void initializeTableColumns() {\n\n        employeeIdColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;employeeID&quot;));\n        firstNameColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;firstName&quot;));\n        lastNameColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;lastName&quot;));\n        tinNoColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;tinNumber&quot;));\n        sssNoColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;sssNumber&quot;));\n        philhealthNoColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;philhealthNumber&quot;));\n        pagibigNoColumn.setCellValueFactory(new PropertyValueFactory&lt;&gt;(&quot;pagibigNumber&quot;));\n\n        bindTableColumnsToTableViewWidth();\n    }\n\n\n    private void loadEmployeeData() {\n        employeeTable.setItems(employeeObservableList);\n    }\n\n    private Employee selectedEmployee() {\n        return employeeTable.getSelectionModel().getSelectedItem();\n    }\n\n}\n</code></pre>\n<p>Here’s the EmployeeDetailsController:</p>\n<pre><code>public class EmployeeDetailsController {\n\n    private final EmployeeRepository empRepository = new EmployeeRepository();\n    private Employee employee;\n    private boolean updateMode = false;\n\n\n    public void setEmployee(Employee employee) {\n        this.employee = employee;\n        updateMode = true;\n        populateFields();\n    }\n\n\n    @FXML\n    public void handleSaveRecord() {\n        if (!validateFields()) {\n            AlertUtil.showIncompleteDataAlert();\n            return;\n        }\n\n        try {\n            if (AlertUtil.confirmDetails()) {\n                String[] record = retrieveInputAsStringArray();\n\n                if (updateMode) {\n                    handleUpdateMode(record);\n                } else {\n                    handleAddMode(record);\n                }\n            }\n        } catch (NumberFormatException e) {\n            AlertUtil.showAlert(Alert.AlertType.ERROR, &quot;Invalid Number Format&quot;, &quot;Please enter a valid number.&quot;);\n        }\n    }\n\n    private void handleAddMode(String[] record) {\n        empRepository.addEmployeeRecord(record);\n    }\n\n    private void handleUpdateMode(String[] record) {\n        empRepository.updateEmployeeRecord(record);\n    }\n\n    public void displayEmployeeDialog(boolean updateMode, Employee employee, boolean showOnly) {\n        try {\n            FXMLLoader loader = new FXMLLoader(getClass().getResource(&quot;/View/EmployeeDetails.fxml&quot;));\n            DialogPane empDetailsDialogPane = loader.load();\n\n            EmployeeDetailsController controller = loader.getController();\n\n            if (updateMode) {\n                controller.setEmployee(employee);\n            } else if (employee != null) {\n                controller.setEmployee(employee);\n                controller.disableTextFields();\n            }\n\n            Dialog&lt;ButtonType&gt; dialog = new Dialog&lt;&gt;();\n            dialog.setDialogPane(empDetailsDialogPane);\n\n            if (showOnly) {\n                empDetailsDialogPane.lookupButton(ButtonType.OK).setVisible(false);\n                empDetailsDialogPane.lookupButton(ButtonType.CANCEL).setVisible(false);\n            }\n\n            Optional&lt;ButtonType&gt; clickedButton = dialog.showAndWait();\n            if (clickedButton.isPresent() &amp;&amp; clickedButton.get() == ButtonType.OK &amp;&amp; !showOnly) {\n                controller.handleSaveRecord();\n            }\n\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    private void disableTextFields() {\n        for (TextField textField : textFields) {\n            textField.setEditable(false);\n        }\n    }\n}\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}