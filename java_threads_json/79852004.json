{
  "question": {
    "tags": [
      "java",
      "postgresql",
      "ssl",
      "graalvm",
      "graalvm-native-image"
    ],
    "owner": {
      "account_id": 9107988,
      "reputation": 4117,
      "user_id": 6777695,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/82120153a9fce415fd4983897d45d441?s=256&d=identicon&r=PG",
      "display_name": "Hakan54",
      "link": "https://stackoverflow.com/users/6777695/hakan54"
    },
    "is_answered": false,
    "view_count": 81,
    "answer_count": 0,
    "score": 2,
    "last_activity_date": 1766395418,
    "creation_date": 1766268155,
    "last_edit_date": 1766395418,
    "question_id": 79852004,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79852004/custom-security-provider-works-in-fat-jar-but-not-in-graalvm-native-image-while",
    "title": "Custom Security Provider works in fat jar but not in GraalVM native image while extracting Postgresql server certificates",
    "body": "<p>I am trying to extract the public certificate of any postgresql database. I got it working with plain java as a library and as a standalone fat jar, but not in a native-image build with GraalVM. I posted a bug report at GraalVM github page <a href=\"https://github.com/oracle/graal/issues/12703\" rel=\"nofollow noreferrer\">here</a> but I have the feeling it is not a bug. I have the feeling I didn't configured graalvm correctly while using a custom security provider however, I am not sure. Next to that it sometimes takes years before bug reports can be resolve at their page... Using custom security provider is not something exceptional as some use Bouncy Castle and it has proven to work with graalvm native image so that is why I have the feeling that I might missed a configuration, however my knowledge on that area is quite low and hoping to get help from the community here.</p>\n<p>I spin up a Postgresql database with ssl enabled with this command:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>docker run --rm -e POSTGRES_PASSWORD=password -p 5432:5432 postgres:12 -c ssl=on -c ssl_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem -c ssl_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\n</code></pre>\n<p>I am using postgresql jdbc driver from here</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n    &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n    &lt;version&gt;42.7.8&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>I use my own library which provides the utility to capture certificates during the SSL Handshake. It can be found here: <a href=\"https://github.com/Hakky54/ayza\" rel=\"nofollow noreferrer\">GitHub - Ayza</a> And the maven declaration:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;io.github.hakky54&lt;/groupId&gt;\n    &lt;artifactId&gt;ayza&lt;/artifactId&gt;\n    &lt;version&gt;10.0.2&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>And I am using the following plugins to build the native image with maven:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;plugin&gt;\n    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n    &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;\n    &lt;version&gt;3.6.1&lt;/version&gt;\n    &lt;configuration&gt;\n        &lt;finalName&gt;crip&lt;/finalName&gt;\n        &lt;transformers&gt;\n            &lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&gt;\n                &lt;mainClass&gt;${application-main-class}&lt;/mainClass&gt;\n            &lt;/transformer&gt;\n        &lt;/transformers&gt;\n    &lt;/configuration&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;shade&lt;/goal&gt;\n            &lt;/goals&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n&lt;/plugin&gt;\n&lt;plugin&gt;\n    &lt;groupId&gt;org.graalvm.nativeimage&lt;/groupId&gt;\n    &lt;artifactId&gt;native-image-maven-plugin&lt;/artifactId&gt;\n    &lt;version&gt;21.2.0&lt;/version&gt;\n    &lt;executions&gt;\n        &lt;execution&gt;\n            &lt;goals&gt;\n                &lt;goal&gt;native-image&lt;/goal&gt;\n            &lt;/goals&gt;\n            &lt;phase&gt;package&lt;/phase&gt;\n        &lt;/execution&gt;\n    &lt;/executions&gt;\n    &lt;configuration&gt;\n        &lt;skip&gt;false&lt;/skip&gt;\n        &lt;buildArgs&gt;\n            --no-fallback\n            -H:EnableURLProtocols=https\n            -H:EnableURLProtocols=http\n            -H:Name=crip\n            -march=compatibility\n            --future-defaults=all\n            -H:AdditionalSecurityProviders=nl.altindag.ssl.provider.FenixProvider\n            -H:AdditionalSecurityServiceTypes=nl.altindag.ssl.provider.FenixProvider\n        &lt;/buildArgs&gt;\n    &lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre>\n<p>A small reproducable code snippet would be something like this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import nl.altindag.ssl.SSLFactory;\nimport nl.altindag.ssl.util.ProviderUtils;\nimport nl.altindag.ssl.util.TrustManagerUtils;\n\nimport javax.net.ssl.X509ExtendedTrustManager;\nimport java.security.cert.X509Certificate;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.SQLException;\nimport java.util.List;\nimport java.util.concurrent.CopyOnWriteArrayList;\n\npublic class App {\n\n    public static void main(String[] args) {\n        List&lt;X509Certificate&gt; capturedCertificates = new CopyOnWriteArrayList&lt;&gt;();\n        X509ExtendedTrustManager trustManager = TrustManagerUtils.createCertificateCapturingTrustManager(capturedCertificates);\n        SSLFactory sslFactory = SSLFactory.builder()\n                .withTrustMaterial(trustManager)\n                .build();\n\n        ProviderUtils.configure(sslFactory);\n\n        try (Connection conn = DriverManager.getConnection(&quot;jdbc:postgresql://localhost:5432/&quot;)) {\n            // calling getConnection to trigger the SSL handshake\n        } catch (SQLException ignored) {\n            \n        } finally {\n            ProviderUtils.remove();\n        }\n\n        System.out.println(&quot;Amount of captured certificates: &quot; + capturedCertificates.size());\n        System.out.println(&quot;Captured certificates: &quot;);\n        capturedCertificates.forEach(System.out::println);\n    }\n\n}\n</code></pre>\n<p>The output of this main method is:</p>\n<pre><code>Amount of captured certificates: 1\nCaptured certificates: \n[\n[\n  Version: V3\n  Subject: CN=localhost\n  Signature Algorithm: SHA256withRSA, OID = 1.2.840.113549.1.1.11\n\n  Key:  Sun RSA public key, 2048 bits\n  params: null\n  modulus: 31211996126076596147999338027719495623709022913370591887632988720610004032097760016008345790156702342195009365368156959125712771875783177237122222689823196867653884881232812806555219009894942490288929180418493391254446706821512257672335346037892662566871554703869495753177918085413564534189604133485556381243824728959475350934112799133217319962706911642363362829383506782715080237659432175302233892295525841514632241532146162042423493679178952709219542178492548540252419613055282285791992580920922147065723236149506037158805915815773798115281679259390591323530600590552570955839294244330974808478242461235603855182171\n  public exponent: 65537\n  Validity: [From: Tue Jan 14 03:32:28 CET 2025,\n               To: Fri Jan 12 03:32:28 CET 2035]\n  Issuer: CN=localhost\n  SerialNumber: 26:97:cd:84:a8:93:e2:5d:d3:2c:a0:ea:40:8d:7c:93:bf:06:e4:1d\n\nCertificate Extensions: 3\n[1]: ObjectId: 2.5.29.19 Criticality=false\nBasicConstraints:[\n  CA:false\n  PathLen: undefined\n]\n\n[2]: ObjectId: 2.5.29.17 Criticality=false\nSubjectAlternativeName [\n  DNSName: localhost\n]\n\n[3]: ObjectId: 2.5.29.14 Criticality=false\nSubjectKeyIdentifier [\nKeyIdentifier [\n0000: ED 8A 72 6D B7 87 AB 26   5E 6C 75 33 5B C9 BE E8  ..rm...&amp;^lu3[...\n0010: 04 6E 1A 06                                        .n..\n]\n]\n\n]\n  Algorithm: [SHA256withRSA]\n  Signature:\n0000: 00 EE 2E CB 87 F7 20 FD   B6 36 AE E1 7B 3F AA 8F  ...... ..6...?..\n0010: 44 38 42 94 BB 50 77 BE   69 21 CA 2B 4A 2F 90 1B  D8B..Pw.i!.+J/..\n0020: 93 B0 3D B7 FA FB DB 56   40 BA F6 20 52 78 FC 0F  ..=....V@.. Rx..\n0030: EA DE F1 66 13 6F 91 30   B9 48 6A B8 2A 32 32 FE  ...f.o.0.Hj.*22.\n0040: 79 DF C8 DD B2 6D 83 C7   D7 56 04 5D 0F 4B 6B 98  y....m...V.].Kk.\n0050: 73 AE C3 5C A5 3F 52 3C   A3 F1 6E CF 6D AF 28 E4  s..\\.?R&lt;..n.m.(.\n0060: 11 79 97 0D 69 02 D5 77   FF CA 9F B0 F7 ED D4 3F  .y..i..w.......?\n0070: 17 ED 65 A4 9E CE 2D 42   C5 37 F5 52 98 D7 D9 C2  ..e...-B.7.R....\n0080: 9B E5 91 54 A1 64 4C BA   17 BD 7C 14 B8 F2 51 51  ...T.dL.......QQ\n0090: 0D 42 CA 2D 19 82 59 5A   AF BB 8E B4 AA 9C FB 37  .B.-..YZ.......7\n00A0: 64 DC F4 78 EA 17 13 3D   07 88 45 2E FB 02 96 68  d..x...=..E....h\n00B0: 9B F1 25 AF 6E 85 02 DB   77 5A CF 40 4E 70 5B 62  ..%.n...wZ.@Np[b\n00C0: C1 83 15 3F 3E CE BC 32   BB 45 4F E3 AC 44 8E A5  ...?&gt;..2.EO..D..\n00D0: 47 02 D6 D4 86 34 A4 19   04 3E B2 7B 8F 72 3F 62  G....4...&gt;...r?b\n00E0: 19 02 AF F8 C6 9B 96 14   D1 36 AA D7 74 39 7F C3  .........6..t9..\n00F0: AB 49 02 94 CE 96 7C B1   F2 D5 1F 5B A2 73 DE B9  .I.........[.s..\n\n]\n</code></pre>\n<p>I will try to give some context. I am using postgres driver manager to interact with the actual database. When establishing the connection it will create an sslcontext instance under the covers by the postgres library itself, see <a href=\"https://github.com/pgjdbc/pgjdbc/blob/bdd930bf458e3d490d93edc4dc24a67e3a2d5964/pgjdbc/src/main/java/org/postgresql/ssl/LibPQFactory.java#L121\" rel=\"nofollow noreferrer\">here</a>. I am intercepting this by adding a custom security provider <a href=\"https://github.com/Hakky54/certificate-ripper/pull/110/files#diff-8fe706de15f335f6dc0f7298b1d00697c51e237e9a4e919aacba489893bf469eR36\" rel=\"nofollow noreferrer\">here</a>. This code snippet creates a custom security provider and inserts it in the first position. Under the cover the following code statements will be executed <a href=\"https://github.com/Hakky54/ayza/blob/master/ayza/src/main/java/nl/altindag/ssl/util/ProviderUtils.java#L32-L40\" rel=\"nofollow noreferrer\">first</a> and <a href=\"https://github.com/Hakky54/ayza/blob/master/ayza/src/main/java/nl/altindag/ssl/provider/FenixProvider.java\" rel=\"nofollow noreferrer\">second</a></p>\n<p>With this logic I can easily replace an sslcontext of a different library with a custom one. In this case I provide my own one which is able to capture server certificates. This works when running in my IDE and with a fat-jar. However it does not work when running it with a native executable create with native image. Although I posted a small working app above, this issue is related to my changes to the project <a href=\"https://github.com/Hakky54/certificate-ripper\" rel=\"nofollow noreferrer\">Certificate Ripper</a>, the actual code changes can be found <a href=\"https://github.com/Hakky54/certificate-ripper/pull/110/files\" rel=\"nofollow noreferrer\">here</a></p>\n<p>If you want to try it with the changes from the repository, you can run the following steps:</p>\n<ol>\n<li><code>git clone git@github.com:Hakky54/certificate-ripper.git</code></li>\n<li><code>cd certificate-ripper</code></li>\n<li><code>git switch feature/support-for-postgres-db</code></li>\n<li><code>mvn clean install -Pfat-jar</code></li>\n<li><code>docker run -d --rm -e POSTGRES_PASSWORD=password -p 5432:5432 postgres:12 -c ssl=on -c ssl_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem -c ssl_key_file=/etc/ssl/private/ssl-cert-snakeoil.key</code></li>\n<li><code>java -jar target/crip.jar print -u=postgresql://localhost:5432/</code> --&gt; will print the certificate</li>\n<li><code>mvn clean install -Pnative-image</code></li>\n<li><code>./target/crip print -u=postgresql://localhost:5432/</code> --&gt; does not print the certificate</li>\n</ol>\n<p>So it is actually possible to capture the certificates of postgresql with these snippets. It works in plain java, but not anymore when compiled to a native image. I checked whether the custom Security Provider is present and it is. I am getting the following output:</p>\n<pre><code>Fenix version 1.0, CertificateRipper version 1.0, SUN version 25, SunRsaSign version 25, SunEC version 25, SunJSSE version 25, SunJCE version 25, SunSASL version 25, JdkLDAP version 25, JdkSASL version 25, Apple version 25\n</code></pre>\n<p>As you can see it is also at the first position, so it should just work. I just have the feeling that at runtime the custom security provider is not used because it is not at the first place or not available maybe. As I am not sure whether I followed the guidelines correctly as explained here: <a href=\"https://www.graalvm.org/latest/reference-manual/native-image/dynamic-features/JCASecurityServices/#provider-registration\" rel=\"nofollow noreferrer\">https://www.graalvm.org/latest/reference-manual/native-image/dynamic-features/JCASecurityServices/#provider-registration</a></p>\n<p>I hope someone can guide me regarding this topic as it is though to debug.</p>\n<p><strong>Update 1 - alternative without jdbc driver</strong></p>\n<p>As @Robert suggested in the comment section I also tried without the Postgresql jdbc driver and just plain code, however then I fail to connect to the server. Below is the code snippet which I used:</p>\n<pre class=\"lang-java prettyprint-override\"><code>import nl.altindag.ssl.SSLFactory;\nimport nl.altindag.ssl.util.TrustManagerUtils;\n\nimport javax.net.ssl.SSLSocket;\nimport javax.net.ssl.X509ExtendedTrustManager;\nimport java.security.cert.X509Certificate;\nimport java.util.List;\nimport java.util.concurrent.CopyOnWriteArrayList;\n\npublic class App {\n\n    public static void main(String[] args) {\n        List&lt;X509Certificate&gt; capturedCertificates = new CopyOnWriteArrayList&lt;&gt;();\n        X509ExtendedTrustManager trustManager = TrustManagerUtils.createCertificateCapturingTrustManager(capturedCertificates);\n        SSLFactory sslFactory = SSLFactory.builder()\n                .withTrustMaterial(trustManager)\n                .build();\n\n        try {\n            SSLSocket socket = (SSLSocket) sslFactory.getSslSocketFactory().createSocket(&quot;localhost&quot;, 5432);\n            socket.setSoTimeout(10000);\n            socket.setUseClientMode(true);\n            socket.startHandshake();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n}\n</code></pre>\n<p>And the following logs are being generated with the stacktrace:</p>\n<pre><code>javax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.056 CET|SSLCipher.java:423|jdk.tls.keyLimits:  entry = AES/GCM/NoPadding KeyUpdate 2^37. AES/GCM/NOPADDING:KEYUPDATE = 137438953472\njavax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.066 CET|SSLCipher.java:423|jdk.tls.keyLimits:  entry =  ChaCha20-Poly1305 KeyUpdate 2^37. CHACHA20-POLY1305:KEYUPDATE = 137438953472\njavax.net.ssl|WARNING|30|main|2025-12-22 24:46:43.159 CET|ServerNameExtension.java:265|Unable to indicate server name\njavax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.159 CET|SSLExtensions.java:272|Ignore, context unavailable extension: server_name\njavax.net.ssl|INFO|30|main|2025-12-22 24:46:43.162 CET|AlpnExtension.java:174|No available application protocols\njavax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.162 CET|SSLExtensions.java:272|Ignore, context unavailable extension: application_layer_protocol_negotiation\njavax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.162 CET|SessionTicketExtension.java:350|Stateless resumption supported\njavax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.166 CET|SSLExtensions.java:272|Ignore, context unavailable extension: cookie\njavax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.235 CET|SSLExtensions.java:272|Ignore, context unavailable extension: renegotiation_info\njavax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.235 CET|PreSharedKeyExtension.java:659|No session to resume.\njavax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.235 CET|SSLExtensions.java:272|Ignore, context unavailable extension: pre_shared_key\njavax.net.ssl|DEBUG|30|main|2025-12-22 24:46:43.246 CET|ClientHello.java:638|Produced ClientHello handshake message (\n&quot;ClientHello&quot;: {\n  &quot;client version&quot;      : &quot;TLSv1.2&quot;,\n  &quot;random&quot;              : &quot;2B9ADD1F533E9AFF111BBACDCF738A5FA7CA694973016903E7DE8BB38D2F2A6B&quot;,\n  &quot;session id&quot;          : &quot;3CBEEDA9D55BFC0FA25D66DF92C37AF4C9E91B5F20607FFEFD7EB86115CDBE11&quot;,\n  &quot;cipher suites&quot;       : &quot;[TLS_AES_256_GCM_SHA384(0x1302), TLS_AES_128_GCM_SHA256(0x1301), TLS_CHACHA20_POLY1305_SHA256(0x1303), TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384(0xC02C), TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256(0xC02B), TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256(0xCCA9), TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384(0xC030), TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256(0xCCA8), TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256(0xC02F), TLS_DHE_RSA_WITH_AES_256_GCM_SHA384(0x009F), TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256(0xCCAA), TLS_DHE_DSS_WITH_AES_256_GCM_SHA384(0x00A3), TLS_DHE_RSA_WITH_AES_128_GCM_SHA256(0x009E), TLS_DHE_DSS_WITH_AES_128_GCM_SHA256(0x00A2), TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384(0xC024), TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384(0xC028), TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256(0xC023), TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256(0xC027), TLS_DHE_RSA_WITH_AES_256_CBC_SHA256(0x006B), TLS_DHE_DSS_WITH_AES_256_CBC_SHA256(0x006A), TLS_DHE_RSA_WITH_AES_128_CBC_SHA256(0x0067), TLS_DHE_DSS_WITH_AES_128_CBC_SHA256(0x0040), TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA(0xC00A), TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA(0xC014), TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA(0xC009), TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA(0xC013), TLS_DHE_RSA_WITH_AES_256_CBC_SHA(0x0039), TLS_DHE_DSS_WITH_AES_256_CBC_SHA(0x0038), TLS_DHE_RSA_WITH_AES_128_CBC_SHA(0x0033), TLS_DHE_DSS_WITH_AES_128_CBC_SHA(0x0032), TLS_EMPTY_RENEGOTIATION_INFO_SCSV(0x00FF)]&quot;,\n  &quot;compression methods&quot; : &quot;00&quot;,\n  &quot;extensions&quot;          : [\n    &quot;status_request (5)&quot;: {\n      &quot;certificate status type&quot;: ocsp\n      &quot;OCSP status request&quot;: {\n        &quot;responder_id&quot;: &lt;empty&gt;\n        &quot;request extensions&quot;: {\n          &lt;empty&gt;\n        }\n      }\n    },\n    &quot;supported_groups (10)&quot;: {\n      &quot;named groups&quot;: [x25519, secp256r1, secp384r1, secp521r1, x448, ffdhe2048, ffdhe3072, ffdhe4096, ffdhe6144, ffdhe8192]\n    },\n    &quot;ec_point_formats (11)&quot;: {\n      &quot;formats&quot;: [uncompressed]\n    },\n    &quot;status_request_v2 (17)&quot;: {\n      &quot;cert status request&quot;: {\n        &quot;certificate status type&quot;: ocsp_multi\n        &quot;OCSP status request&quot;: {\n          &quot;responder_id&quot;: &lt;empty&gt;\n          &quot;request extensions&quot;: {\n            &lt;empty&gt;\n          }\n        }\n      }\n    },\n    &quot;extended_master_secret (23)&quot;: {\n      &lt;empty&gt;\n    },\n    &quot;session_ticket (35)&quot;: {\n      &lt;empty&gt;\n    },\n    &quot;signature_algorithms (13)&quot;: {\n      &quot;signature schemes&quot;: [ecdsa_secp256r1_sha256, ecdsa_secp384r1_sha384, ecdsa_secp521r1_sha512, ed25519, ed448, rsa_pss_rsae_sha256, rsa_pss_rsae_sha384, rsa_pss_rsae_sha512, rsa_pss_pss_sha256, rsa_pss_pss_sha384, rsa_pss_pss_sha512, rsa_pkcs1_sha256, rsa_pkcs1_sha384, rsa_pkcs1_sha512, dsa_sha256, ecdsa_sha224, rsa_sha224, dsa_sha224, ecdsa_sha1, rsa_pkcs1_sha1, dsa_sha1]\n    },\n    &quot;supported_versions (43)&quot;: {\n      &quot;versions&quot;: [TLSv1.3, TLSv1.2]\n    },\n    &quot;psk_key_exchange_modes (45)&quot;: {\n      &quot;ke_modes&quot;: [psk_dhe_ke]\n    },\n    &quot;signature_algorithms_cert (50)&quot;: {\n      &quot;signature schemes&quot;: [ecdsa_secp256r1_sha256, ecdsa_secp384r1_sha384, ecdsa_secp521r1_sha512, ed25519, ed448, rsa_pss_rsae_sha256, rsa_pss_rsae_sha384, rsa_pss_rsae_sha512, rsa_pss_pss_sha256, rsa_pss_pss_sha384, rsa_pss_pss_sha512, rsa_pkcs1_sha256, rsa_pkcs1_sha384, rsa_pkcs1_sha512, dsa_sha256, ecdsa_sha224, rsa_sha224, dsa_sha224, ecdsa_sha1, rsa_pkcs1_sha1, dsa_sha1]\n    },\n    &quot;key_share (51)&quot;: {\n      &quot;client_shares&quot;: [  \n        {\n          &quot;named group&quot;: x25519\n          &quot;key_exchange&quot;: {\n            0000: 9B 70 95 2B 4B 25 76 42   52 BD 2E 09 C8 DA A8 08  .p.+K%vBR.......\n            0010: A2 39 04 4C 40 F5 EC 86   33 49 65 71 BD 0F 9F 6E  .9.L@...3Ieq...n\n          }\n        },\n        {\n          &quot;named group&quot;: secp256r1\n          &quot;key_exchange&quot;: {\n            0000: 04 57 5B 93 97 52 BF 01   91 B1 4B E1 F0 E9 BB B2  .W[..R....K.....\n            0010: AB 6F 44 0E 2F BA 39 03   E1 3F 1B 06 E9 10 94 D3  .oD./.9..?......\n            0020: AB 02 2F 05 3E A2 A5 FC   4B 81 10 E5 21 76 17 7F  ../.&gt;...K...!v..\n            0030: D3 7D 00 2F C4 8C DA 2D   10 C5 4B 83 D2 79 D9 6A  .../...-..K..y.j\n            0040: BB \n          }\n        },\n      ]\n    }\n  ]\n}\n)\njavax.net.ssl|ERROR|30|main|2025-12-22 24:46:43.251 CET|TransportContext.java:368|Fatal (HANDSHAKE_FAILURE): Couldn't kickstart handshaking (\n&quot;throwable&quot; : {\n  javax.net.ssl.SSLHandshakeException: Remote host terminated the handshake\n    at java.base/sun.security.ssl.SSLSocketImpl.handleEOF(SSLSocketImpl.java:1716)\n    at java.base/sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1514)\n    at java.base/sun.security.ssl.SSLSocketImpl.readHandshakeRecord(SSLSocketImpl.java:1421)\n    at java.base/sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:455)\n    at java.base/sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:426)\n    at nl.altindag.certificate.ripper@2.6.2-SNAPSHOT/nl.altindag.crip.App2.main(App2.java:25)\n  Caused by: java.io.EOFException: SSL peer shut down incorrectly\n    at java.base/sun.security.ssl.SSLSocketInputRecord.read(SSLSocketInputRecord.java:494)\n    at java.base/sun.security.ssl.SSLSocketInputRecord.readHeader(SSLSocketInputRecord.java:483)\n    at java.base/sun.security.ssl.SSLSocketInputRecord.decode(SSLSocketInputRecord.java:160)\n    at java.base/sun.security.ssl.SSLTransport.decode(SSLTransport.java:111)\n    at java.base/sun.security.ssl.SSLSocketImpl.decode(SSLSocketImpl.java:1506)\n    ... 4 more}\n\n)\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}