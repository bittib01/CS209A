{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "spring-kafka",
      "testcontainers"
    ],
    "owner": {
      "account_id": 1425,
      "reputation": 8627,
      "user_id": 1900,
      "user_type": "registered",
      "accept_rate": 84,
      "profile_image": "https://i.sstatic.net/VZ4ge.jpg?s=256",
      "display_name": "Lee Theobald",
      "link": "https://stackoverflow.com/users/1900/lee-theobald"
    },
    "is_answered": false,
    "view_count": 67,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1748313594,
    "creation_date": 1744570638,
    "last_edit_date": 1748313594,
    "question_id": 79571923,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79571923/where-is-the-second-kafka-listener-coming-from",
    "title": "Where is the second Kafka listener coming from?",
    "body": "<p>I'm trying to setup a project using Spring Boot, Spring Kafka &amp; TestContainers. My TestContainer setup looks like below:</p>\n<pre><code>  private static final Network NETWORK = Network.newNetwork();\n\n  @Bean\n  @ServiceConnection\n  public ConfluentKafkaContainer kafkaContainer() {\n    return new ConfluentKafkaContainer(\n            DockerImageName.parse(&quot;confluentinc/cp-kafka:7.9.0&quot;)\n                .asCompatibleSubstituteFor(&quot;apache/kafka&quot;))\n        .withNetwork(NETWORK)\n        .withNetworkAliases(&quot;kafka&quot;)\n        .withEnv(&quot;KAFKA_KRAFT_MODE&quot;, &quot;true&quot;)\n        .withEnv(&quot;KAFKA_PROCESS_ROLES&quot;, &quot;broker,controller&quot;)\n        .withEnv(&quot;KAFKA_CONTROLLER_QUORUM_VOTERS&quot;, &quot;1@kafka:9093&quot;)\n        .withEnv(&quot;KAFKA_NODE_ID&quot;, &quot;1&quot;)\n        .withEnv(&quot;KAFKA_LISTENERS&quot;, &quot;BROKER://0.0.0.0:9092,CONTROLLER://0.0.0.0:9093&quot;)\n        .withEnv(&quot;KAFKA_ADVERTISED_LISTENERS&quot;, &quot;BROKER://kafka:9092&quot;)\n        .withEnv(&quot;KAFKA_LISTENER_SECURITY_PROTOCOL_MAP&quot;, &quot;BROKER:PLAINTEXT,CONTROLLER&quot;)\n        .withEnv(&quot;KAFKA_INTER_BROKER_LISTENER_NAME&quot;, &quot;BROKER&quot;)\n        .withEnv(&quot;KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR&quot;, &quot;1&quot;)\n        .withEnv(&quot;KAFKA_TRANSACTION_STATE_LOG_MIN_ISR&quot;, &quot;1&quot;)\n        .withEnv(&quot;KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR&quot;, &quot;1&quot;)\n        .withEnv(&quot;KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS&quot;, &quot;0&quot;)\n        .withEnv(&quot;KAFKA_CONTROLLER_LISTENER_NAMES&quot;, &quot;CONTROLLER&quot;)\n        .withEnv(&quot;KAFKA_AUTO_CREATE_TOPICS_ENABLE&quot;, &quot;true&quot;)\n        .withLogConsumer(new Slf4jLogConsumer(LoggerFactory.getLogger(&quot;KafkaContainer&quot;)));\n  }\n</code></pre>\n<p>But when I attempt to run a test, I get the message along the lines of:</p>\n<pre><code>STDOUT: Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: Error creating broker listeners from 'PLAINTEXT://localhost:59694,BROKER://c958fa04fe68:9093': No security protocol defined for listener BROKER at kafka.utils.CoreUtils$.listenerListToEndPoints(CoreUtils.scala:216)...\n</code></pre>\n<p>BUt I have no idea where the PLAINTEXT listener is coming from.</p>\n<p>Does anyone know what I'm getting wrong? I can update the description with further details (e.g. dependencies etc.) if I need to. Doing a search in my project for <code>PLAINTEXT</code> and I only get the line above setting the security.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}