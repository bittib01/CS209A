{
  "question": {
    "tags": [
      "java",
      "oauth-2.0",
      "discord",
      "oauth"
    ],
    "owner": {
      "account_id": 36943761,
      "reputation": 3,
      "user_id": 27998723,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/958a3849e15f858e55feb9656d92c5e3?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Aaron Akhtar",
      "link": "https://stackoverflow.com/users/27998723/aaron-akhtar"
    },
    "is_answered": true,
    "view_count": 52,
    "accepted_answer_id": 79474047,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1740694281,
    "creation_date": 1729949302,
    "question_id": 79128637,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79128637/discord-oauth-api-400-error-getting-token-from-code",
    "title": "Discord oAuth API - 400 error getting token from code",
    "body": "<p>What I'm trying to do:\nsetup oauth discord logins on my website, I've setup the first part, <code>identify email</code> scope for getting the initial <code>code</code>, now that I've got the code, I'm unable to use the /oauth/token endpoint without getting a consistent 400 error.</p>\n<p>I've attempted 1 thing so far, changing my Auth from Basic to inside of my post params, still didn't work:</p>\n<pre class=\"lang-java prettyprint-override\"><code>final HttpURLConnection connection = (HttpURLConnection) new URL(&quot;https://discord.com/api/v10/oauth2/token&quot;).openConnection();\ntry(AutoCloseable autoCloseable = () -&gt; connection.disconnect()){\n    connection.setRequestMethod(&quot;POST&quot;);\n    connection.addRequestProperty(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;);\n    //connection.setRequestProperty(&quot;Authorization&quot;, &quot;Basic &quot; + Base64.getEncoder().encodeToString((CLIENT_ID + &quot;:&quot; + CLIENT_SECRET).getBytes()));\n    connection.setDoOutput(true);\n    try(BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(connection.getOutputStream()));\n        BufferedReader reader = new BufferedReader(new InputStreamReader(connection.getInputStream()))){\n        writer.write(&quot;grant_type=authorization_code&amp;&quot; +\n                &quot;code=&quot;+code+&quot;&amp;&quot; +\n                &quot;redirect_uri=https://website/api/discord&amp;&quot; +\n                &quot;&amp;client_secret=&quot; + CLIENT_SECRET +\n                &quot;&amp;client_id=&quot; + CLIENT_ID);\n        writer.flush();\n        String s;\n        while((s = reader.readLine()) != null){\n            resp.getWriter().println(s);\n        }\n        resp.getWriter().flush();\n    }\n}catch (Exception e){\n    e.printStackTrace();\n}\n</code></pre>\n<p>My error stacktrace:</p>\n<pre><code>java.io.IOException: Server returned HTTP response code: 400 for URL: https://discord.com/api/v10/oauth2/token\n        at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1998)\n        at java.base/sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1599)\n        at java.base/sun.net.www.protocol.https.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:223)\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}