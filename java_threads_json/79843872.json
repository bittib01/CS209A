{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-boot",
      "mockito"
    ],
    "owner": {
      "account_id": 22577442,
      "reputation": 1127,
      "user_id": 16775102,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/VZtyD.jpg?s=256",
      "display_name": "Feel free",
      "link": "https://stackoverflow.com/users/16775102/feel-free"
    },
    "is_answered": true,
    "view_count": 113,
    "closed_date": 1765625828,
    "accepted_answer_id": 79844478,
    "answer_count": 1,
    "score": -1,
    "last_activity_date": 1765625812,
    "creation_date": 1765449961,
    "last_edit_date": 1765625812,
    "question_id": 79843872,
    "link": "https://stackoverflow.com/questions/79843872/adding-a-new-handlerinterceptor-causes-many-existing-tests-to-fail-how-to-fix",
    "closed_reason": "Opinion-based",
    "title": "Adding a new HandlerInterceptor causes many existing tests to fail — how to fix or isolate it?",
    "body": "<p>I have a large Spring Boot application with an extensive test suite (unit tests + controller tests).</p>\n<p>After introducing a new <code>HandlerInterceptor</code>, many of my previously passing tests started failing. Most of these tests were not written with interceptors in mind, and now the interceptor’s logic is being executed for almost every request inside the tests.</p>\n<p>I'm looking for guidance on how to fix or isolate the interceptor for tests, and what the recommended approach is:</p>\n<ul>\n<li><p>Should I disable the interceptor in certain tests?</p>\n</li>\n<li><p>Should I mock the service the interceptor depends on?</p>\n</li>\n<li><p>Should I update every test to account for the interceptor?</p>\n</li>\n<li><p>Is there a way to automatically exclude it in MockMvc/WebMvcTest setups?</p>\n</li>\n</ul>\n<p>Below is a simplified example of the configuration and interceptor. (Names changed.)</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Configuration\n@RequiredArgsConstructor\npublic class DemoPathConfig implements WebMvcConfigurer {\n\n    private final DemoAccessInterceptor demoAccessInterceptor;\n\n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        registry.addInterceptor(demoAccessInterceptor)\n                .addPathPatterns(&quot;/api/internal/**&quot;);\n    }\n}\n</code></pre>\n<pre class=\"lang-java prettyprint-override\"><code>@Component\n@RequiredArgsConstructor\n@Slf4j\npublic class DemoAccessInterceptor implements HandlerInterceptor {\n\n    private final DemoCheckService demoCheckService;\n\n    @Override\n    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) {\n        if (HttpMethod.OPTIONS.matches(request.getMethod())) {\n            return true;\n        }\n\n        demoCheckService.validateAccess();\n        return true;\n    }\n}\n</code></pre>\n<p>What is the best way to handle the sudden test failures after adding an interceptor?**</p>\n<p>I'm especially interested in strategies used in large code bases, such as disabling interceptors globally for tests, conditional registration, or MockMvc/WebMvcTest configuration tricks.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}