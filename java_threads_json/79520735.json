{
  "question": {
    "tags": [
      "java",
      "sharepoint",
      "microsoft-graph-api",
      "microsoft-graph-sdks"
    ],
    "owner": {
      "account_id": 21122686,
      "reputation": 13,
      "user_id": 15528401,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/-CuPfsivorIw/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuckPeMkquMjRb8gqY_lcEzPtEbq3PQ/s96-c/s256-rj/photo.jpg",
      "display_name": "vulej",
      "link": "https://stackoverflow.com/users/15528401/vulej"
    },
    "is_answered": true,
    "view_count": 333,
    "accepted_answer_id": 79522046,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1742458959,
    "creation_date": 1742399832,
    "question_id": 79520735,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79520735/how-to-fetch-all-sharepoint-sites-with-microsoft-graph-sdk-for-java",
    "title": "How to fetch all SharePoint sites with Microsoft Graph SDK for Java",
    "body": "<p>I want to fetch all SharePoint Sites a user has access to using graph SDK for Java (version 6.32.0). I've obtained the access token and created a graph client (I'd like to use delegated permissions to get information user has access to).</p>\n<p>The suggestions in Microsoft Graph docs suggest using <code>graphClient.sites().get()</code> however this return an empty list. Even if I try the same query in Microsoft Graph Explorer the list is empty as some comment on the Microsoft learn platform suggested this only works with Application permission type (<a href=\"https://learn.microsoft.com/en-us/answers/questions/1103068/how-to-get-all-sharepoint-sites-of-organization-us\" rel=\"nofollow noreferrer\">https://learn.microsoft.com/en-us/answers/questions/1103068/how-to-get-all-sharepoint-sites-of-organization-us</a>). I then found the following API that returns all sites available to user:</p>\n<pre><code>https://graph.microsoft.com/v1.0/sites?search=*\n</code></pre>\n<p>and this indeed returns all the sites. Inside the graph explorer <code>Code snippets</code> tab there is an SDK snippet that corresponds to the above API:</p>\n<pre><code>SiteCollectionResponse result = graphClient.sites().get(requestConfiguration -&gt; {\n    requestConfiguration.queryParameters.search = &quot;*&quot;;\n});\n</code></pre>\n<p>which I've tried to use but I get the following ODataError:</p>\n<pre><code>com.microsoft.graph.models.odataerrors.ODataError: Syntax error: character '*' is not valid at position 0 in '*'.\n    at com.microsoft.graph.models.odataerrors.ODataError.createFromDiscriminatorValue(ODataError.java:36) ~[microsoft-graph-6.32.0.jar:na]\n    at com.microsoft.kiota.serialization.JsonParseNode.getObjectValue(JsonParseNode.java:212) ~[microsoft-kiota-serialization-json-1.8.4.jar:na]\n    at com.microsoft.kiota.http.OkHttpRequestAdapter.lambda$throwIfFailedResponse$0(OkHttpRequestAdapter.java:704) ~[microsoft-kiota-http-okHttp-1.8.4.jar:na]\n    at com.microsoft.kiota.ApiExceptionBuilder.&lt;init&gt;(ApiExceptionBuilder.java:26) ~[microsoft-kiota-abstractions-1.8.4.jar:na]\n    at com.microsoft.kiota.http.OkHttpRequestAdapter.throwIfFailedResponse(OkHttpRequestAdapter.java:703) ~[microsoft-kiota-http-okHttp-1.8.4.jar:na]\n    at com.microsoft.kiota.http.OkHttpRequestAdapter.send(OkHttpRequestAdapter.java:307) ~[microsoft-kiota-http-okHttp-1.8.4.jar:na]\n    at com.microsoft.graph.sites.SitesRequestBuilder.get(SitesRequestBuilder.java:119) ~[microsoft-graph-6.32.0.jar:na]\n</code></pre>\n<p>I can't figure out what I'm missing and what would be the way to do this?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}