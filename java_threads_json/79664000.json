{
  "question": {
    "tags": [
      "java",
      "spring-boot"
    ],
    "owner": {
      "account_id": 14840982,
      "reputation": 39,
      "user_id": 10717742,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/47416b8ea15265d0c440de08fb22599a?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "user10717742",
      "link": "https://stackoverflow.com/users/10717742/user10717742"
    },
    "is_answered": true,
    "view_count": 71,
    "accepted_answer_id": 79664250,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1749841445,
    "creation_date": 1749755136,
    "last_edit_date": 1749802734,
    "question_id": 79664000,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79664000/spring-boot-oauth2-workflow-with-exchanging-code-for-jwt",
    "title": "spring-boot-oauth2 workflow with exchanging code for jwt",
    "body": "<p>I've an existing spring boot bff where the authentication workflow is somewhat cumbersome and I thought about upgrading it.\nThe workflow is as follows:</p>\n<p>A user access the application, if the user is not authorised (no jwt available, or it is expired) he is redirected to some auth server. After login there the user is redirect back to the application with a code. The code is exchanged by the application for a jwt.</p>\n<p>It kind of reads like oauth2, so I tried my hand at it, but all it does right now is blocking me from accessing any of the restricted endpoints, which is what I want, but it is also not redirecting me to the auth server.</p>\n<p>pom entries:\nspring-boot-parent - 3.5.0\nspring-boot-starter-web\nspring-boot-starter-security\nspring-security-oauth2-client\nlombok</p>\n<p>as for the code, I've a controller:</p>\n<pre><code>@RestController\n@Slf4j\npublic class TestController {\n    @GetMapping(&quot;/home&quot;)\n    public String home() {\n        return &quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;greetings&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;;\n    }\n\n    @GetMapping(&quot;/liveness&quot;)\n    public ResponseEntity&lt;Object&gt; liveness() {\n        return ResponseEntity.ok().build();\n    }\n</code></pre>\n<p>some security config:</p>\n<pre><code>@configuration\npublic class TestConfig {\n    @Bean\n    public SecurityFilterChan(HttpSecurity httpSecurity) {\n        return httpSecurity\n            .authorizeHttpRequests(e -&gt; e.requestMatchers(&quot;/liveness&quot;).permitAll())\n            .authorizeHttpRequests(e -&gt; e.anyRequest().authenticated())\n            .build();\n    }\n}\n</code></pre>\n<p>as for the application yaml</p>\n<pre><code>spring:\n  security:    \n    oauth2:\n      client:\n        registration:\n          client-id: ${client-id}\n          client-secret: ${client-secret}\n          provider: auth-server\n          authorization-grant-type: authorization_grant\n          redirect-uri: ${redirect-uri}\n        provider:\n          auth-server:\n            issuer-uri: ${issuer-uri}\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}