{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "grpc-java"
    ],
    "owner": {
      "account_id": 12281239,
      "reputation": 1,
      "user_id": 8962745,
      "user_type": "registered",
      "profile_image": "https://lh4.googleusercontent.com/-9xzljZzWrY0/AAAAAAAAAAI/AAAAAAAAAAA/pffQQh6NsYk/s256-rj/photo.jpg",
      "display_name": "krish",
      "link": "https://stackoverflow.com/users/8962745/krish"
    },
    "is_answered": false,
    "view_count": 77,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1724333349,
    "creation_date": 1724326942,
    "last_edit_date": 1724333349,
    "question_id": 78901377,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78901377/grpc-java-latency-between-headers-and-data-resulting-in-client-timeouts",
    "title": "grpc java latency between HEADERS and DATA resulting in client timeouts",
    "body": "<p>We are facing multiple issues during the moderate load from grpc client written in C++ to grpc server written in java. (C++ is managed by clients and not in our control)</p>\n<p>When we enabled the logs for io.grpc, for few calls we have seen latency between HEADERS and DATA.</p>\n<p>When we tested with java client, we didn't see any latency between HEADERS and DATA.</p>\n<p><a href=\"https://i.sstatic.net/7oYB5BGe.png\" rel=\"nofollow noreferrer\">logs screenshot showing Data and Headers</a></p>\n<p>Another issue:</p>\n<p>Client sends a request, Server started executing the the interceptors. But it's struck at onReady(), by the time onMessage() executes there is a significant delay of close to 100 ms, and started executing rpc method.</p>\n<p>One More issue:</p>\n<p>Client sends a request, Server started executing the the interceptors, service method was not invoked. we have received client deadline and cancellation, and then on the server side, grpc directly called <code>onCancel()</code> method.</p>\n<p>The RPC call that we have implemented is very simple, in general case entire rpc completes in less than 10ms. When there is a moderate load, out of 10K calls, we are facing close to 10 calls running into deadline issues.</p>\n<p>On the server side, it's a 6 CPU and worker threads we have put it in as 32.</p>\n<p>Questions:</p>\n<ol>\n<li>streamid for HEADERS and DATA is same, then why would there be a delay in receiving the headers vs data.? What options I have to identify this problem.</li>\n<li>Delay between onMessage() and onReady(), what causes this latency. These are callbacks by grpc and we won't be able to control any here. We leverage Simple Executor with fixed thread pool.</li>\n</ol>\n<p>We have explored in increasing the threads but didn't help much in solving the latency problem.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}