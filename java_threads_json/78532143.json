{
  "question": {
    "tags": [
      "java",
      "postgresql",
      "spring-boot",
      "hibernate",
      "hibernate-envers"
    ],
    "owner": {
      "account_id": 28471946,
      "reputation": 33,
      "user_id": 21787133,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/AGNmyxbbMcz2DTO0uLbU43SBp13olPu1ITaetTgfPf2IpA=k-s256",
      "display_name": "Yzee",
      "link": "https://stackoverflow.com/users/21787133/yzee"
    },
    "is_answered": true,
    "view_count": 814,
    "answer_count": 1,
    "score": 3,
    "last_activity_date": 1727785408,
    "creation_date": 1716632708,
    "last_edit_date": 1718967529,
    "question_id": 78532143,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78532143/error-duplicate-key-value-violates-unique-constraint-revinfo-pkey-during-audit",
    "title": "Error duplicate key value violates unique constraint &#39;revinfo_pkey&#39; during audit table insertion after Hibernate Envers 6.4.4.Final upgrade",
    "body": "<p>After upgrading Java from 11 to 21 and Hibernate Envers to 6.4.4.Final, I encountered the following error while saving data into the audit table:</p>\n<blockquote>\n<p>org.springframework.dao.DataIntegrityViolationException: could not execute statement [ERROR: duplicate key value violates unique constraint &quot;revinfo_pkey&quot;</p>\n</blockquote>\n<p>I am using <code>@Audited</code> and <code>@EntityListeners(AuditingEntityListener.class)</code> to create audit tables. I already have multiple audit tables and a <code>revinfo</code> table with existing entries. The error occurs because the insert process is not appending to the end of the <code>revinfo</code> table, but instead starting from the beginning, causing intermittent duplicate key violations. Ideally, it should start inserting after the last entry.</p>\n<p>How can I resolve this issue?</p>\n<p>I attempted further upgrades to resolve this issue, but the problem persists. I prefer not to clean all the audit tables as they contain rev columns that are foreign keys referencing the <code>revinfo</code> table.</p>\n<p>My goal is to restore the previous behavior, where new entries in the <code>revinfo</code> table follow the last existing entry without causing key duplication.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}