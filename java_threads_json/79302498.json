{
  "question": {
    "tags": [
      "java",
      "pdfbox",
      "pdfbox-layout"
    ],
    "owner": {
      "account_id": 12150509,
      "reputation": 113,
      "user_id": 8870965,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/558d998174c567ea73bdf40e2b6550df?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "code_warrior",
      "link": "https://stackoverflow.com/users/8870965/code-warrior"
    },
    "is_answered": true,
    "view_count": 154,
    "accepted_answer_id": 79302813,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1734957649,
    "creation_date": 1734940565,
    "question_id": 79302498,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79302498/trying-to-draw-box-around-checkbox-and-display-text-using-pdfbox",
    "title": "Trying to draw box around checkbox and display text using pdfbox",
    "body": "<p>Trying to create a PDF fillable form using java 8 and pdfbox  2.0.30 .\nFor each topping I want a checkbox with a box drawn around it and the topping. Seems pretty simple.</p>\n<p>Code executes and viewing the resulting toppingsForm.pdf in a browser shows</p>\n<ul>\n<li>checkboxes with boxes drawn around them but no topping\nOR</li>\n<li>checkboxes with toppings but with no box drawn around the checkbox</li>\n</ul>\n<pre><code>    import java.io.*;\n    import java.util.*;\n    import java.awt.Color;\n    import java.awt.geom.Rectangle2D;\n    \n    import org.apache.pdfbox.*;\n    import org.apache.pdfbox.util.*;\n    import org.apache.pdfbox.cos.*;\n    import org.apache.pdfbox.pdmodel.*;\n    import org.apache.pdfbox.pdmodel.common.PDRectangle;\n    import org.apache.pdfbox.pdmodel.font.PDType1Font;\n    import org.apache.pdfbox.pdmodel.graphics.color.PDColor;\n    import org.apache.pdfbox.pdmodel.graphics.color.PDDeviceRGB;\n    import org.apache.pdfbox.pdmodel.graphics.form.PDFormXObject;\n    import org.apache.pdfbox.pdmodel.interactive.*;\n    import org.apache.pdfbox.pdmodel.interactive.annotation.PDAnnotationWidget;\n    import org.apache.pdfbox.pdmodel.interactive.annotation.PDAppearanceCharacteristicsDictionary;\n    import org.apache.pdfbox.pdmodel.interactive.annotation.PDAppearanceDictionary;\n    import org.apache.pdfbox.pdmodel.interactive.annotation.PDAppearanceEntry;\n    import org.apache.pdfbox.pdmodel.interactive.annotation.PDAppearanceStream;\n    import org.apache.pdfbox.pdmodel.interactive.annotation.PDBorderStyleDictionary;\n    import org.apache.pdfbox.pdmodel.interactive.form.*;\n    import org.apache.pdfbox.text.*;\n    import org.apache.pdfbox.contentstream.*;\n    import org.apache.pdfbox.pdfparser.*;\n    import org.apache.pdfbox.io.*;\n    \n    public class Toppings {\n    \n        private static float getLineWidth( PDAnnotationWidget widget) {\n            \n            PDBorderStyleDictionary bs = widget.getBorderStyle();\n            if( bs != null) {\n                return bs.getWidth();\n            }\n            return 1;\n        }\n        \n        private static void drawRect( PDDocument document, PDPage page, PDRectangle rect) {\n            try {\n                PDPageContentStream contentStream = new PDPageContentStream(document, page, PDPageContentStream.AppendMode.APPEND, true);\n     \n                float ll_x = rect.getLowerLeftX();\n                float ll_y = rect.getLowerLeftY();\n                float height = rect.getHeight();\n                float length = rect.getWidth();\n                \n                contentStream.addRect( ll_x, ll_y, height, length);\n                contentStream.setLineWidth(1);\n                contentStream.setNonStrokingColor(Color.WHITE);\n                contentStream.setStrokingColor(Color.BLACK);\n                contentStream.stroke();\n                contentStream.close();\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n        \n        // Generate Form Labels\n        private static void addText( PDDocument document, PDPage page, String myText, float x, float y, boolean bold) {\n     \n            try {\n                PDPageContentStream contentStream = new PDPageContentStream(document, page, PDPageContentStream.AppendMode.APPEND, true);\n                contentStream.beginText(); \n                contentStream.setFont(PDType1Font.HELVETICA, 6);\n                if( bold) {\n                    contentStream.setFont(PDType1Font.HELVETICA_BOLD, 6);\n                }\n                contentStream.newLineAtOffset(x, y);\n                contentStream.showText(myText);      \n                contentStream.endText();\n                contentStream.close();\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n        \n        private static void addCheckbox( PDDocument pdfDoc, PDAcroForm acroForm, PDPage page, String name, float x, float y) {\n            \n            try {            \n                PDCheckBox checkbox = new PDCheckBox(acroForm);\n                checkbox.setPartialName( name);\n                \n                PDAppearanceCharacteristicsDictionary appearanceCharacteristics = new PDAppearanceCharacteristicsDictionary(new COSDictionary());\n                appearanceCharacteristics.setBorderColour(new PDColor(new float[] { 1, 0, 0 }, PDDeviceRGB.INSTANCE));\n                appearanceCharacteristics.setBackground(  new PDColor(new float[]{0, 1, 0.3f}, PDDeviceRGB.INSTANCE));\n                appearanceCharacteristics.setNormalCaption(&quot;4&quot;);\n                \n                PDBorderStyleDictionary borderStyleDictionary = new PDBorderStyleDictionary();\n                borderStyleDictionary.setWidth(1);\n                borderStyleDictionary.setStyle(PDBorderStyleDictionary.STYLE_SOLID);\n    \n                PDAnnotationWidget widget = new PDAnnotationWidget();\n                widget.setRectangle( new PDRectangle( x, y, 16, 16) );\n                drawRect( pdfDoc, page, widget.getRectangle());        // comment out this line and toppings appear\n                widget.setAnnotationFlags(4);\n                widget.setBorderStyle(borderStyleDictionary);\n                widget.setPage( page);\n                widget.setParent( checkbox);\n                \n                List&lt;PDAnnotationWidget&gt; widgets = new ArrayList&lt;&gt;();\n                widgets.add(widget);\n                page.getAnnotations().add(widget);\n                checkbox.setWidgets(widgets);\n                \n                acroForm.getFields().add(checkbox);\n                \n                addText(  pdfDoc, page, name, x + 20, y + 6, false);  // comment out this line and checkbox outlines appear\n     \n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n              \n        private static void addToppings( PDDocument pdfDoc, PDAcroForm acroForm, PDPage page, float x, float y) throws IOException {\n            \n            List&lt;String&gt; options = Arrays.asList(&quot;pepperoni&quot;,&quot;sausage&quot;,&quot;ham&quot;\n                                                ,&quot;chicken&quot;,&quot;canadian bacon&quot;,&quot;mushrooms&quot;\n                                                ,&quot;pineapple&quot;,&quot;onions&quot;,&quot;green pepper&quot;\n                                                ,&quot;red pepper&quot;,&quot;black olives&quot;,&quot;green olives&quot;);\n    \n            for( int i = 0; i &lt; 12; i++ ) {\n                addCheckbox( pdfDoc, acroForm, page, options.get(i), x, y);\n                y = y - 20;\n            }    \n        }        \n        \n        public static void main(String[] args) {\n            try {\n                PDDocument pdfDoc = new PDDocument();  // outfile\n                PDPage page = new PDPage();\n                pdfDoc.addPage(page);\n                PDPageContentStream contentStream = new PDPageContentStream( pdfDoc, page);\n                PDAcroForm acroForm = new PDAcroForm( pdfDoc);\n\n                float x = 20;\n                float y = 500;\n                addToppings( pdfDoc, acroForm, page, x, y);\n                \n                contentStream.close();\n                pdfDoc.save(&quot;C:/Users/MainUser/toppingsForm.pdf&quot;);\n                pdfDoc.close();\n            } catch ( IOException e) {\n                e.getMessage();\n            }\n        }\n    \n    }\n</code></pre>\n<p>My first time using pdfBox to create forms, am usually filling them in.\nMaybe there's some subtle sizing/overlap issue I'm bumping in to. Or a better way altogether, like  setting a visible border on the checkbox itself.</p>\n<p>TIA,</p>\n<p>Still-learning Steve</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}