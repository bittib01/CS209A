{
  "question": {
    "tags": [
      "java",
      "oracle-database",
      "ssl",
      "ssl-certificate"
    ],
    "owner": {
      "account_id": 14078892,
      "reputation": 328,
      "user_id": 11678700,
      "user_type": "registered",
      "profile_image": "https://lh4.googleusercontent.com/-BANxSQY5VSo/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rRibWSnBL1vR0gb9AOsDpY1_cvfA/mo/s256-rj/photo.jpg",
      "display_name": "Liam385",
      "link": "https://stackoverflow.com/users/11678700/liam385"
    },
    "is_answered": false,
    "view_count": 148,
    "answer_count": 1,
    "score": -1,
    "last_activity_date": 1727077423,
    "creation_date": 1726735401,
    "last_edit_date": 1726737518,
    "question_id": 79001658,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79001658/even-after-importing-a-self-signed-certificate-from-an-oracle-database-into-the",
    "title": "Even after importing a self signed certificate from an Oracle database into the trust store, it is still not trusted",
    "body": "<p>I have a simple Java application that opens a connection to an Oracle database. The Oracle database has a self signed certificate. I exported the self signed certificate from the Oracle wallet and imported it into the cacerts java trust store.</p>\n<p>However when I run the program I am still seeing the error:</p>\n<pre><code>javax.net.ssl|ERROR|01|main|2024-09-19 10:35:54.501 CEST|TransportContext.java:352|Fatal (CERTIFICATE_UNKNOWN): PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target (\n&quot;throwable&quot; : {\n  sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\n</code></pre>\n<p>Since its a self-signed cert there is no &quot;valid certification path&quot; but is it is in the trust store, my expectation is that it should be trusted and that this error should not occur.</p>\n<p>Java Code</p>\n<pre><code>package org.ibm;\n\n\nimport javax.net.ssl.HttpsURLConnection;\nimport javax.net.ssl.SSLContext;\nimport javax.net.ssl.TrustManager;\nimport javax.net.ssl.X509TrustManager;\nimport java.io.FileInputStream;\nimport java.security.KeyStore;\nimport java.security.cert.Certificate;\nimport java.security.cert.CertificateException;\nimport java.security.cert.X509Certificate;\nimport java.sql.Connection;\nimport java.sql.DriverManager;\nimport java.sql.SQLException;\nimport java.util.Properties;\n\npublic class OracleConnection {\n\n    public static void main(String[] args) throws Exception {\n\n\n        //Create a custom TrustManager\n\n\n        VerifyCertificate.verifyCert();\n        String url = &quot;jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(PROTOCOL=tcps)(HOST=localhost)(PORT=5500))(CONNECT_DATA=(SERVICE_NAME=your_db))(SECURITY=(SSL_SERVER_CERT_DN=\\&quot;\\&quot;)))&quot;;\n        Properties props = new Properties();\n        props.setProperty(&quot;user&quot;, &quot;sys&quot;);\n        props.setProperty(&quot;password&quot;, &quot;password&quot;);\n\n        try (Connection conn = DriverManager.getConnection(url, props)) {\n            System.out.println(&quot;Connected to the database successfully!&quot;);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre>\n<pre><code>/home/pat/.sdkman/candidates/java/11.0.23-sem/bin/java -Djavax.net.debug=ssl  -classpath /home/pat/Projects/clients/blm/oracle-ssl/target/classes:/home/pat/.m2/repository/com/oracle/database/jdbc/ojdbc8/19.8.0.0/ojdbc8-19.8.0.0.jar org.ibm.OracleConnection\n</code></pre>\n<p>I used this command to import the cert:</p>\n<pre><code>keytool -importcert -v -trustcacerts -cacerts -alias myselfsignedcert -file server_cert.pem  -storepass changeit\n</code></pre>\n<pre><code>➜  oracle-ssl git:(master) ✗ echo $JAVA_HOME\n/home/pat/.sdkman/candidates/java/current\n</code></pre>\n<p>I am baffled by this error frankly because all documentation says that if you import a self-signed certificate into the java truststore it should trust it.</p>\n<pre><code>openjdk 11.0.23 2024-04-16\nIBM Semeru Runtime Open Edition 11.0.23.0 (build 11.0.23+9)\nEclipse OpenJ9 VM 11.0.23.0 (build openj9-0.44.0, JRE 11 Linux amd64-64-Bit Compressed References 20240522_1104 (JIT enabled, AOT enabled)\nOpenJ9   - b0699311c7\nOMR      - 254af5a04\nJCL      - 3d1045c3ea based on jdk-11.0.23+9)\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}