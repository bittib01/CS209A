{
  "question": {
    "tags": [
      "java",
      "apache-spark"
    ],
    "owner": {
      "account_id": 3366819,
      "reputation": 3591,
      "user_id": 2827181,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/WJK16.jpg?s=256",
      "display_name": "Marc Le Bihan",
      "link": "https://stackoverflow.com/users/2827181/marc-le-bihan"
    },
    "is_answered": false,
    "view_count": 60,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1752901309,
    "creation_date": 1752473588,
    "last_edit_date": 1752486951,
    "question_id": 79700490,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79700490/why-the-encoder-of-maptogroupementrow-encoders-beangroupement-class-left",
    "title": "Why the Encoder of map(toGroupement(row), Encoders.bean(Groupement.class)) left some null members when toGroupement(...) has already created them?",
    "body": "<p>With Spark <code>3.5.6</code>, I have some complex <code>Row</code> to convert to Java objects.</p>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th>sirenGroupement</th>\n<th>nomGroupement</th>\n<th>natureJuridique</th>\n<th>sirenCommuneSiege</th>\n<th>codeCommuneSiege</th>\n<th>nomCommuneSiege</th>\n<th>codeRegionCommuneSiege</th>\n<th>sirenCommuneMembre</th>\n<th>codeCommuneMembre</th>\n<th>nomCommuneMembre</th>\n<th>codeDepartementCommuneMembre</th>\n<th>codeRegionCommuneMembre</th>\n<th>sirenMembre</th>\n<th>nomMembre</th>\n<th>sirenAdhesion</th>\n<th>nomAdhesion</th>\n<th>categorieMembresGroupement</th>\n<th>populationGroupement</th>\n<th>densiteDemographique</th>\n<th>arrondissementSiege</th>\n<th>populationCommuneSiegeTotale</th>\n<th>populationCommuneSiegeMunicipale</th>\n<th>populationCommuneSiegeCompteApart</th>\n<th>nombreCommunesMembres</th>\n<th>nombreDeCompetencesExercees</th>\n<th>dateCreation</th>\n<th>dateEffet</th>\n<th>modeRepartitionSieges</th>\n<th>autreModeRepartitionSieges</th>\n<th>nombreDeDelegues</th>\n<th>modeDeFinancement</th>\n<th>syndicatCarte</th>\n<th>interdepartemental</th>\n<th>zoneDeMontagne</th>\n<th>gestionDesEauxEPAGE</th>\n<th>eptBassin</th>\n<th>redevanceEnlevementOrduresMenageres</th>\n<th>taxeEnlevementOrduresMenageres</th>\n<th>populationMembre</th>\n<th>populationCommuneMembreTotale</th>\n<th>populationCommuneMembreMunicipale</th>\n<th>populationCommuneMembreCompteApart</th>\n<th>populationAdhesion</th>\n<th>libelleVoieSiege</th>\n<th>complementAdresseSiege</th>\n<th>distributionSpecialeSiege</th>\n<th>codePostalSiege</th>\n<th>villeSiege</th>\n<th>telephoneSiege</th>\n<th>courrielSiege</th>\n<th>siteInternetSiege</th>\n<th>libelleVoieAdministrative</th>\n<th>complementAdresseAdministrative</th>\n<th>distributionSpecialeAdministrative</th>\n<th>codePostalAdministrative</th>\n<th>villeAdministrative</th>\n<th>telephoneAdministrative</th>\n<th>civilitePresident</th>\n<th>prenomPresident</th>\n<th>nomPresident</th>\n<th>dotationGlobale</th>\n<th>dotationCompensation</th>\n<th>dotationIntercommunalite</th>\n<th>dotationGroupementsTouristiques</th>\n<th>populationDGF</th>\n<th>dgfParHabitant</th>\n<th>potentielFiscal</th>\n<th>C1005</th>\n<th>C1005_Deleguee</th>\n<th>C1005_InteretCommunautaire</th>\n<th>C1010</th>\n<th>C1010_Deleguee</th>\n<th>C1010_InteretCommunautaire</th>\n<th>C1015</th>\n<th>C1015_Deleguee</th>\n<th>C1015_InteretCommunautaire</th>\n<th>C1020</th>\n<th>C1020_Deleguee</th>\n<th>C1020_InteretCommunautaire</th>\n<th>C1025</th>\n<th>C1025_Deleguee</th>\n<th>C1025_InteretCommunautaire</th>\n<th>C1030</th>\n<th>C1030_Deleguee</th>\n<th>C1030_InteretCommunautaire</th>\n<th>C1035</th>\n<th>C1035_Deleguee</th>\n<th>C1035_InteretCommunautaire</th>\n<th>C1040</th>\n<th>C1040_Deleguee</th>\n<th>C1040_InteretCommunautaire</th>\n<th>C1045</th>\n<th>C1045_Deleguee</th>\n<th>C1045_InteretCommunautaire</th>\n<th>C1505</th>\n<th>C1505_Deleguee</th>\n<th>C1505_InteretCommunautaire</th>\n<th>C1510</th>\n<th>C1510_Deleguee</th>\n<th>C1510_InteretCommunautaire</th>\n<th>C1515</th>\n<th>C1515_Deleguee</th>\n<th>C1515_InteretCommunautaire</th>\n<th>C1520</th>\n<th>C1520_Deleguee</th>\n<th>C1520_InteretCommunautaire</th>\n<th>C2000</th>\n<th>C2000_Deleguee</th>\n<th>C2000_InteretCommunautaire</th>\n<th>C2005</th>\n<th>C2005_Deleguee</th>\n<th>C2005_InteretCommunautaire</th>\n<th>C2010</th>\n<th>C2010_Deleguee</th>\n<th>C2010_InteretCommunautaire</th>\n<th>C2015</th>\n<th>C2015_Deleguee</th>\n<th>C2015_InteretCommunautaire</th>\n<th>C2020</th>\n<th>C2020_Deleguee</th>\n<th>C2020_InteretCommunautaire</th>\n<th>C2025</th>\n<th>C2025_Deleguee</th>\n<th>C2025_InteretCommunautaire</th>\n<th>C2030</th>\n<th>C2030_Deleguee</th>\n<th>C2030_InteretCommunautaire</th>\n<th>C2035</th>\n<th>C2035_Deleguee</th>\n<th>C2035_InteretCommunautaire</th>\n<th>C2040</th>\n<th>C2040_Deleguee</th>\n<th>C2040_InteretCommunautaire</th>\n<th>C2045</th>\n<th>C2045_Deleguee</th>\n<th>C2045_InteretCommunautaire</th>\n<th>C2050</th>\n<th>C2050_Deleguee</th>\n<th>C2050_InteretCommunautaire</th>\n<th>C2055</th>\n<th>C2055_Deleguee</th>\n<th>C2055_InteretCommunautaire</th>\n<th>C2060</th>\n<th>C2060_Deleguee</th>\n<th>C2060_InteretCommunautaire</th>\n<th>C2065</th>\n<th>C2065_Deleguee</th>\n<th>C2065_InteretCommunautaire</th>\n<th>C2070</th>\n<th>C2070_Deleguee</th>\n<th>C2070_InteretCommunautaire</th>\n<th>C2075</th>\n<th>C2075_Deleguee</th>\n<th>C2075_InteretCommunautaire</th>\n<th>C2080</th>\n<th>C2080_Deleguee</th>\n<th>C2080_InteretCommunautaire</th>\n<th>C2085</th>\n<th>C2085_Deleguee</th>\n<th>C2085_InteretCommunautaire</th>\n<th>C2090</th>\n<th>C2090_Deleguee</th>\n<th>C2090_InteretCommunautaire</th>\n<th>C2095</th>\n<th>C2095_Deleguee</th>\n<th>C2095_InteretCommunautaire</th>\n<th>C2096</th>\n<th>C2096_Deleguee</th>\n<th>C2096_InteretCommunautaire</th>\n<th>C2500</th>\n<th>C2500_Deleguee</th>\n<th>C2500_InteretCommunautaire</th>\n<th>C2505</th>\n<th>C2505_Deleguee</th>\n<th>C2505_InteretCommunautaire</th>\n<th>C2510</th>\n<th>C2510_Deleguee</th>\n<th>C2510_InteretCommunautaire</th>\n<th>C3000</th>\n<th>C3000_Deleguee</th>\n<th>C3000_InteretCommunautaire</th>\n<th>C3005</th>\n<th>C3005_Deleguee</th>\n<th>C3005_InteretCommunautaire</th>\n<th>C3010</th>\n<th>C3010_Deleguee</th>\n<th>C3010_InteretCommunautaire</th>\n<th>C3015</th>\n<th>C3015_Deleguee</th>\n<th>C3015_InteretCommunautaire</th>\n<th>C3020</th>\n<th>C3020_Deleguee</th>\n<th>C3020_InteretCommunautaire</th>\n<th>C3025</th>\n<th>C3025_Deleguee</th>\n<th>C3025_InteretCommunautaire</th>\n<th>C3030</th>\n<th>C3030_Deleguee</th>\n<th>C3030_InteretCommunautaire</th>\n<th>C3035</th>\n<th>C3035_Deleguee</th>\n<th>C3035_InteretCommunautaire</th>\n<th>C3040</th>\n<th>C3040_Deleguee</th>\n<th>C3040_InteretCommunautaire</th>\n<th>C3045</th>\n<th>C3045_Deleguee</th>\n<th>C3045_InteretCommunautaire</th>\n<th>C3050</th>\n<th>C3050_Deleguee</th>\n<th>C3050_InteretCommunautaire</th>\n<th>C3055</th>\n<th>C3055_Deleguee</th>\n<th>C3055_InteretCommunautaire</th>\n<th>C3060</th>\n<th>C3060_Deleguee</th>\n<th>C3060_InteretCommunautaire</th>\n<th>C3500</th>\n<th>C3500_Deleguee</th>\n<th>C3500_InteretCommunautaire</th>\n<th>C4000</th>\n<th>C4000_Deleguee</th>\n<th>C4000_InteretCommunautaire</th>\n<th>C4005</th>\n<th>C4005_Deleguee</th>\n<th>C4005_InteretCommunautaire</th>\n<th>C4010</th>\n<th>C4010_Deleguee</th>\n<th>C4010_InteretCommunautaire</th>\n<th>C4500</th>\n<th>C4500_Deleguee</th>\n<th>C4500_InteretCommunautaire</th>\n<th>C4505</th>\n<th>C4505_Deleguee</th>\n<th>C4505_InteretCommunautaire</th>\n<th>C4510</th>\n<th>C4510_Deleguee</th>\n<th>C4510_InteretCommunautaire</th>\n<th>C4515</th>\n<th>C4515_Deleguee</th>\n<th>C4515_InteretCommunautaire</th>\n<th>C4520</th>\n<th>C4520_Deleguee</th>\n<th>C4520_InteretCommunautaire</th>\n<th>C5000</th>\n<th>C5000_Deleguee</th>\n<th>C5000_InteretCommunautaire</th>\n<th>C5005</th>\n<th>C5005_Deleguee</th>\n<th>C5005_InteretCommunautaire</th>\n<th>C5010</th>\n<th>C5010_Deleguee</th>\n<th>C5010_InteretCommunautaire</th>\n<th>C5015</th>\n<th>C5015_Deleguee</th>\n<th>C5015_InteretCommunautaire</th>\n<th>C5020</th>\n<th>C5020_Deleguee</th>\n<th>C5020_InteretCommunautaire</th>\n<th>C5025</th>\n<th>C5025_Deleguee</th>\n<th>C5025_InteretCommunautaire</th>\n<th>C5030</th>\n<th>C5030_Deleguee</th>\n<th>C5030_InteretCommunautaire</th>\n<th>C5035</th>\n<th>C5035_Deleguee</th>\n<th>C5035_InteretCommunautaire</th>\n<th>C5040</th>\n<th>C5040_Deleguee</th>\n<th>C5040_InteretCommunautaire</th>\n<th>C5045</th>\n<th>C5045_Deleguee</th>\n<th>C5045_InteretCommunautaire</th>\n<th>C5050</th>\n<th>C5050_Deleguee</th>\n<th>C5050_InteretCommunautaire</th>\n<th>C5500</th>\n<th>C5500_Deleguee</th>\n<th>C5500_InteretCommunautaire</th>\n<th>C5505</th>\n<th>C5505_Deleguee</th>\n<th>C5505_InteretCommunautaire</th>\n<th>C5510</th>\n<th>C5510_Deleguee</th>\n<th>C5510_InteretCommunautaire</th>\n<th>C5515</th>\n<th>C5515_Deleguee</th>\n<th>C5515_InteretCommunautaire</th>\n<th>C5520</th>\n<th>C5520_Deleguee</th>\n<th>C5520_InteretCommunautaire</th>\n<th>C5525</th>\n<th>C5525_Deleguee</th>\n<th>C5525_InteretCommunautaire</th>\n<th>C5530</th>\n<th>C5530_Deleguee</th>\n<th>C5530_InteretCommunautaire</th>\n<th>C5535</th>\n<th>C5535_Deleguee</th>\n<th>C5535_InteretCommunautaire</th>\n<th>C5540</th>\n<th>C5540_Deleguee</th>\n<th>C5540_InteretCommunautaire</th>\n<th>C6000</th>\n<th>C6000_Deleguee</th>\n<th>C6000_InteretCommunautaire</th>\n<th>C6005</th>\n<th>C6005_Deleguee</th>\n<th>C6005_InteretCommunautaire</th>\n<th>C6010</th>\n<th>C6010_Deleguee</th>\n<th>C6010_InteretCommunautaire</th>\n<th>C6015</th>\n<th>C6015_Deleguee</th>\n<th>C6015_InteretCommunautaire</th>\n<th>C6020</th>\n<th>C6020_Deleguee</th>\n<th>C6020_InteretCommunautaire</th>\n<th>C6025</th>\n<th>C6025_Deleguee</th>\n<th>C6025_InteretCommunautaire</th>\n<th>C6030</th>\n<th>C6030_Deleguee</th>\n<th>C6030_InteretCommunautaire</th>\n<th>C6035</th>\n<th>C6035_Deleguee</th>\n<th>C6035_InteretCommunautaire</th>\n<th>C6040</th>\n<th>C6040_Deleguee</th>\n<th>C6040_InteretCommunautaire</th>\n<th>C6045</th>\n<th>C6045_Deleguee</th>\n<th>C6045_InteretCommunautaire</th>\n<th>C6055</th>\n<th>C6055_Deleguee</th>\n<th>C6055_InteretCommunautaire</th>\n<th>C6060</th>\n<th>C6060_Deleguee</th>\n<th>C6060_InteretCommunautaire</th>\n<th>C6065</th>\n<th>C6065_Deleguee</th>\n<th>C6065_InteretCommunautaire</th>\n<th>C6070</th>\n<th>C6070_Deleguee</th>\n<th>C6070_InteretCommunautaire</th>\n<th>C6075</th>\n<th>C6075_Deleguee</th>\n<th>C6075_InteretCommunautaire</th>\n<th>C6500</th>\n<th>C6500_Deleguee</th>\n<th>C6500_InteretCommunautaire</th>\n<th>C6505</th>\n<th>C6505_Deleguee</th>\n<th>C6505_InteretCommunautaire</th>\n<th>C6510</th>\n<th>C6510_Deleguee</th>\n<th>C6510_InteretCommunautaire</th>\n<th>C6515</th>\n<th>C6515_Deleguee</th>\n<th>C6515_InteretCommunautaire</th>\n<th>C6520</th>\n<th>C6520_Deleguee</th>\n<th>C6520_InteretCommunautaire</th>\n<th>C6525</th>\n<th>C6525_Deleguee</th>\n<th>C6525_InteretCommunautaire</th>\n<th>C6530</th>\n<th>C6530_Deleguee</th>\n<th>C6530_InteretCommunautaire</th>\n<th>C6535</th>\n<th>C6535_Deleguee</th>\n<th>C6535_InteretCommunautaire</th>\n<th>C7000</th>\n<th>C7000_Deleguee</th>\n<th>C7000_InteretCommunautaire</th>\n<th>C7500</th>\n<th>C7500_Deleguee</th>\n<th>C7500_InteretCommunautaire</th>\n<th>C7505</th>\n<th>C7505_Deleguee</th>\n<th>C7505_InteretCommunautaire</th>\n<th>C7510</th>\n<th>C7510_Deleguee</th>\n<th>C7510_InteretCommunautaire</th>\n<th>C7515</th>\n<th>C7515_Deleguee</th>\n<th>C7515_InteretCommunautaire</th>\n<th>C7520</th>\n<th>C7520_Deleguee</th>\n<th>C7520_InteretCommunautaire</th>\n<th>C7525</th>\n<th>C7525_Deleguee</th>\n<th>C7525_InteretCommunautaire</th>\n<th>C7530</th>\n<th>C7530_Deleguee</th>\n<th>C7530_InteretCommunautaire</th>\n<th>C7535</th>\n<th>C7535_Deleguee</th>\n<th>C7535_InteretCommunautaire</th>\n<th>C7540</th>\n<th>C7540_Deleguee</th>\n<th>C7540_InteretCommunautaire</th>\n<th>C7541</th>\n<th>C7541_Deleguee</th>\n<th>C7541_InteretCommunautaire</th>\n<th>C7545</th>\n<th>C7545_Deleguee</th>\n<th>C7545_InteretCommunautaire</th>\n<th>C7546</th>\n<th>C7546_Deleguee</th>\n<th>C7546_InteretCommunautaire</th>\n<th>C7550</th>\n<th>C7550_Deleguee</th>\n<th>C7550_InteretCommunautaire</th>\n<th>C7555</th>\n<th>C7555_Deleguee</th>\n<th>C7555_InteretCommunautaire</th>\n<th>C7560</th>\n<th>C7560_Deleguee</th>\n<th>C7560_InteretCommunautaire</th>\n<th>C7565</th>\n<th>C7565_Deleguee</th>\n<th>C7565_InteretCommunautaire</th>\n<th>C7570</th>\n<th>C7570_Deleguee</th>\n<th>C7570_InteretCommunautaire</th>\n<th>C7575</th>\n<th>C7575_Deleguee</th>\n<th>C7575_InteretCommunautaire</th>\n<th>codeDepartementCommuneSiege</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>249740077</td>\n<td>CA CIVIS (Communauté Intercommunale des Villes Solidaires)</td>\n<td>CA</td>\n<td>219740164</td>\n<td>97416</td>\n<td>Saint-Pierre</td>\n<td>04</td>\n<td>219740016</td>\n<td>97401</td>\n<td>Les Avirons</td>\n<td>974</td>\n<td>04</td>\n<td>219740016</td>\n<td>Les Avirons</td>\n<td>200045276</td>\n<td>Ile De La Réunion Mobilités</td>\n<td>commune</td>\n<td>185848</td>\n<td>491.7</td>\n<td>9742</td>\n<td>86140</td>\n<td>85254</td>\n<td>886</td>\n<td>6</td>\n<td>46</td>\n<td>2002-12-26</td>\n<td>2002-12-31</td>\n<td>RDC</td>\n<td></td>\n<td>70</td>\n<td>FPU</td>\n<td>NULL</td>\n<td>0</td>\n<td>0</td>\n<td>NULL</td>\n<td>NULL</td>\n<td>0</td>\n<td>1</td>\n<td>11663</td>\n<td>11663</td>\n<td>11445</td>\n<td>218</td>\n<td>891190</td>\n<td>29 Route de l'Entre-Deux</td>\n<td></td>\n<td></td>\n<td>97410</td>\n<td>Saint-Pierre</td>\n<td></td>\n<td>info.civis@wanadoo.fr</td>\n<td>www.civis.re</td>\n<td>29 Route de l'Entre-Deux</td>\n<td></td>\n<td></td>\n<td>97410</td>\n<td>Saint-Pierre</td>\n<td></td>\n<td>M.</td>\n<td>David</td>\n<td>LORION</td>\n<td>9325112</td>\n<td>4108814</td>\n<td>5216298</td>\n<td>NULL</td>\n<td>NULL</td>\n<td>NULL</td>\n<td>NULL</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>0</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td>974</td>\n</tr>\n</tbody>\n</table></div>\n<p>I have to create from them objects of class <code>Groupement</code> whose constructor is:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public Groupement(String sirenGroupement, String nomGroupement, NatureJuridiqueGroupement natureJuridique,\n   Siege siege, CommuneMembreGroupement communeMembreGroupement, MembreAdherentSyndicatMixte membreAdherentSyndicatMixte,\n   String categorieMembresGroupement,\n   Integer populationGroupement, Double densiteDemographiqueHabitantsAuKilometreCarre,\n   Integer nombreDeCommunesMembre,\n   OrganigrammeElection organigrammeElection,\n   Boolean interdepartemental,\n   Boolean zoneDeMontagne, Boolean gestionDesEaux, Boolean etablissementPublicTerritorialDeBassin,\n   Boolean redevanceEnlevementOrduresMenageres, Boolean taxeEnlevementOrduresMenageres,\n   FiscaliteFinancement fiscaliteFinancement,\n   CompetencesExercees competencesExercees\n)\n</code></pre>\n<p>requiring the creation of these objects members to be complete:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public Siege(CommuneSiegeGroupement communeSiege, String codeCommune,\n      LocalDate dateCreation, LocalDate dateEffet,\n      Adresse adresseSiege, String telephoneSiege, String obsoleteFaxAdministratif, String obsoleteFaxSiege, String email, String siteInternet,\n      CodeDepartement codeDepartementCommune, CodeRegion codeRegionCommune,\n      Adresse adresseAdministrative, String telephoneAdministratif) {...}\n\npublic CommuneGroupement(String nomCommune, String codeCommune, String sirenCommune, CodeDepartement codeDepartementCommune, CodeRegion codeRegionCommune,\n      Integer populationCommuneTotale, Integer populationCommuneMunicipale, Integer populationCommuneCompteAPart) {...}\n\n[...]\n\npublic CommuneGroupement(String nomCommune, String codeCommune, String sirenCommune, CodeDepartement codeDepartementCommune, CodeRegion codeRegionCommune,\n      Integer populationCommuneTotale, Integer populationCommuneMunicipale, Integer populationCommuneCompteAPart) {...}\n\npublic CompetenceExercee(String code, Boolean obligatoire, Boolean deleguee, Boolean interetIntercommunal) {...}\n</code></pre>\n<p>In a class that I have myself named <code>EPCIPerimetreEncoder</code> (but is it really one? It's the question of this post),<br />\nI've declared a <code>public Groupement toObjetMetier(Row row, Map&lt;String, Object&gt; hints)</code> method, doing that conversion. It isn't trivial, I show a bit of it for information (I'm lacking characters in this question to show it entirely). It's not required to read it to understand my question.</p>\n<pre class=\"lang-java prettyprint-override\"><code>public Groupement toObjetMetier(Row r, Map&lt;String, Object&gt; hints) {\n   int anneeCOG = (Integer)hints.get(&quot;anneeCOG&quot;);\n\n   [...]\n\n   CompetencesExercees competencesGroupement;\n\n   Integer nombreDeCompetencesExercees = toInteger(r, this.indexNombreDeCompetencesExercees);\n   Boolean syndicatALaCarte = toBoolean(r, this.indexSyndicatALaCarte);\n\n   if (anneeCOG &gt;= 2025) {\n      competencesGroupement = new CompetencesExercees(null, nombreDeCompetencesExercees, syndicatALaCarte, new LinkedHashMap&lt;&gt;());\n   }\n   else {\n      Boolean competenceConservee = toBoolean(r, this.indexCompetenceConservee);\n      competencesGroupement = new CompetencesExercees(competenceConservee, nombreDeCompetencesExercees, syndicatALaCarte, new LinkedHashMap&lt;&gt;());\n   }\n\n   for(int index : this.indexsCompetences) {\n      String presenceCompetence = r.getString(index);\n      String nomCompetence = this.codesCompetences.get(index);\n\n      if (presenceCompetence.equals(&quot;1&quot;)) {\n         CompetenceExercee competenceExercee;\n\n         if (anneeCOG &gt;= 2025) {\n            Boolean deleguee = toBoolean(r, this.indexsCompetencesDeleguees.get(nomCompetence));\n            Boolean interetCommunautaire = toBoolean(r, this.indexsCompetencesInteretCommunautaire.get(nomCompetence));\n\n            competenceExercee = new CompetenceExercee(this.codesCompetences.get(index), null, deleguee, interetCommunautaire);\n         }\n         else {\n            [...]\n         }\n\n         competencesGroupement.put(competenceExercee.getCode(), competenceExercee);\n      }\n   }\n\n   if (anneeCOG &gt;= 2025) {\n      return new Groupement(\n         SIREN_GROUPEMENT.getAs(r), NOM_GROUPEMENT.getAs(r), enumNatureJuridique,\n         siege, communeMembreGroupement, membreAdherentSyndicatMixte, CATEGORIE_MEMBRES_GROUPEMENT.getAs(r),\n         POPULATION_GROUPEMENT.getAs(r), DENSITE_DEMOGRAPHIQUE.getAs(r),\n         NOMBRE_DE_COMMUNES_MEMBRE.getAs(r),\n         organigrammeElection,\n         interDepartemental, zoneDeMontagne, gestionDesEaux, etablissementPublicTerritorialDeBassin,\n         reom, teom,\n         fiscaliteFinancement, competencesGroupement);\n   }\n   else {\n     [...]\n   }\n}\n</code></pre>\n<p><strong>My problem:</strong></p>\n<p>I'm running this code:</p>\n<pre class=\"lang-java prettyprint-override\"><code>Dataset&lt;Row&gt; rowPerimetres = this.perimetreEPCIDataset.rowPerimetres(this.perimetreEPCIDataset.optionsCreationLecture(), new HistoriqueExecution(),\n   annee, false, new EPCIPerimetreTriCommuneSiegeCommuneMembreSirenMembre())\n   .where(SIREN_GROUPEMENT.col().equalTo(&quot;249740077&quot;));\n\n// This shows the rows at the beginning of this post\nrowPerimetres.show(2000, false);\n\nMap&lt;String, Object&gt; hints = new HashMap&lt;&gt;();\nhints.put(&quot;anneeCOG&quot;, 2025);\nDataset&lt;Groupement&gt; perimetres = this.perimetreEPCIDataset.toDatasetObjetsMetiers(rowPerimetres, hints);\n\nperimetres.show(2000, false);\n</code></pre>\n<p>where <code>toDatasetObjetsMetiers(rowPerimetres, hints)</code> calls a:</p>\n<p><code>rows.map((MapFunction&lt;Row, Groupement&gt;) row -&gt; toObjetMetier(row, hints), Encoders.bean(Groupement.class))</code><br />\nto create from the <code>Dataset&lt;Row&gt;</code> a <code>Dataset&lt;Groupement&gt;</code>.</p>\n<p>During the Spark pre-analysis (lazy phase, where it generates code), things seems working well, and it prepares <code>Groupement</code> objects such as:</p>\n<p><a href=\"https://i.sstatic.net/kcys00b8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/kcys00b8.png\" alt=\"enter image description here\" /></a></p>\n<p>(what is important here, is the <code>competencesExcercees</code> member that has for member itself a <code>Map</code> having for keys <code>C1020</code>, <code>C1505</code>)</p>\n<p>then, the problem happens when it's time to show/collect objects.<br />\nthe <code>Encoders.bean(Groupement.class)</code>, I guess it's him, is using constructors without arguments of objects (sometimes or always ?) to recreate them, and then use their setter to fill their members. But for <code>competencesExcercees</code> it returns an incomplete object, having an empty map:</p>\n<p><a href=\"https://i.sstatic.net/bB4iy9Ur.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/bB4iy9Ur.png\" alt=\"enter image description here\" /></a></p>\n<p>At the end, <code>my show(...)</code> command displays this <code>Dataset&lt;Groupement&gt;</code> content:</p>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th>categorieMembresGroupement</th>\n<th>communeMembreGroupement</th>\n<th>competences</th>\n<th>densiteDemographiqueHabitantsAuKilometreCarre</th>\n<th>fiscaliteFinancement</th>\n<th>fiscalitePropre</th>\n<th>membreGroupement</th>\n<th>natureJuridique</th>\n<th>nomGroupement</th>\n<th>organigramme</th>\n<th>population</th>\n<th>siege</th>\n<th>siren</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>commune</td>\n<td>{97401, {974}, {04}, Les Avirons, 218, 11445, 11663, 219740016}</td>\n<td>{NULL, 46, NULL}</td>\n<td>491.7</td>\n<td>{NULL, 4108814, NULL, 9325112, 5216298, FPU, NULL, NULL, NULL, NULL, NULL, NULL}</td>\n<td>true</td>\n<td>{Ile De La Réunion Mobilités, 891190, 200045276}</td>\n<td>COMMUNAUTE_AGGLOMERATION</td>\n<td>CA CIVIS (Communauté Intercommunale des Villes Solidaires)</td>\n<td>{M., RDC,  , LORION, 70, NULL, David}</td>\n<td>185848</td>\n<td>{{ , NULL, NULL, NULL, 97410, NULL, NULL,  , NULL, NULL, NULL, NULL, NULL, NULL, Saint-Pierre, 29 Route de l'Entre-Deux}, { , NULL, NULL, NULL, 97410, NULL, NULL,  , NULL, NULL, NULL, NULL, NULL, NULL, Saint-Pierre, 29 Route de l'Entre-Deux}, 97416, {974}, {04}, {9742, 97416, {974}, {04}, {9742, NULL, 97416, NULL, NULL, NULL, NULL, NULL, NULL, NULL, Saint-Pierre, NULL, NULL, NULL, 86140, 219740164, NULL, NULL, NULL, NULL}, Saint-Pierre, 886, 85254, 86140, 219740164}, 2002-12-26, 2002-12-31, info.civis@wanadoo.fr, NULL, NULL, <a href=\"http://www.civis.re\" rel=\"nofollow noreferrer\">www.civis.re</a>,  ,  }</td>\n<td>249740077</td>\n</tr>\n</tbody>\n</table></div>\n<p><code>Groupement</code> objects aren't empty, and it's sure that their constructor with arguments must have been used at some time, else they couldn't had had this content, but they aren't perfectly filled, as <code>competencesExcerces</code> member is only partially filled.</p>\n<p>What could explain this?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}