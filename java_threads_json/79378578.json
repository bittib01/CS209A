{
  "question": {
    "tags": [
      "java",
      "akka",
      "akka-http",
      "timeoutexception"
    ],
    "owner": {
      "account_id": 13186626,
      "reputation": 1,
      "user_id": 9524492,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/35c2912a3bb906cd696be38cabedf91d?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "ccirim",
      "link": "https://stackoverflow.com/users/9524492/ccirim"
    },
    "is_answered": false,
    "view_count": 54,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1738042842,
    "creation_date": 1737564528,
    "last_edit_date": 1738042842,
    "question_id": 79378578,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79378578/akka-entity-discardbytes-with-unmarshaller-function",
    "title": "Akka entity.discardBytes with Unmarshaller function",
    "body": "<p>I have this function for POST http calls:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public static String post(ActorSystem system, String uri, String json) throws Exception {\n    try {\n        HttpRequest post = HttpRequest.POST(uri).withEntity(HttpEntities.create(ContentTypes.APPLICATION_JSON, json));\n        return Http.get(system).singleRequest(post).thenCompose(response -&gt; {\n            if (response.status().isFailure()) {\n                response.discardEntityBytes(system);\n                return CompletableFuture.completedFuture(null);\n            }\n            else{\n                return Unmarshaller.entityToString().unmarshal(response.entity(), system);\n            }\n        }).toCompletableFuture().get();\n    } catch (Exception e) {\n        throw e;\n    }\n}\n</code></pre>\n<p>Sometimes receive this error:</p>\n<p>java.util.concurrent.TimeoutException: Response entity was not subscribed after 5 seconds. Make sure to read the response <code>entity</code> body or call <code>entity.discardBytes()</code> on it -- in case you deal with <code>HttpResponse</code>, use the shortcut <code>response.discardEntityBytes()</code>. POST /some/path/service Strict(38450 bytes) -&gt; 200 OK Chunked</p>\n<p>I have see the warning note in <a href=\"https://doc.akka.io/libraries/akka-http/current/client-side/request-level.html\" rel=\"nofollow noreferrer\">https://doc.akka.io/libraries/akka-http/current/client-side/request-level.html</a></p>\n<p>How to I can fix/solve this in &quot;else&quot; case?</p>\n<p>Tnx</p>\n<p>ps: increment timeout is a weak solution :(</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}