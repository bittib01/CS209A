{
  "question": {
    "tags": [
      "java",
      "cryptography",
      "rsa",
      "javacard"
    ],
    "owner": {
      "account_id": 31146942,
      "reputation": 21,
      "user_id": 23954585,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/ea714103c6ebbecaa713b400e7495c95?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Tuija Palovuori",
      "link": "https://stackoverflow.com/users/23954585/tuija-palovuori"
    },
    "is_answered": false,
    "view_count": 61,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1729307294,
    "creation_date": 1722495855,
    "question_id": 78819540,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78819540/javacard-rsaprivatekey-setmodulus-throws-cryptoexception-illegal-value",
    "title": "JavaCard: RSAPrivateKey.setModulus throws CryptoException.ILLEGAL_VALUE",
    "body": "<p>I am working on a JavaCard applet, and right now I have to calculate a modular exponential operation. I have been using a self-modified version of <a href=\"https://github.com/OpenCryptoProject/JCMathLib\" rel=\"nofollow noreferrer\">JCMathLib</a> for this, which ultimately uses RSAPrivateKey to handle the operation, specifically <a href=\"https://github.com/OpenCryptoProject/JCMathLib/blob/master/applet/src/main/java/opencrypto/jcmathlib/BigNat.java\" rel=\"nofollow noreferrer\">in the file BigNat.java.</a>. However, when I run this on my card, <a href=\"https://github.com/OpenCryptoProject/JCMathLib/blob/cabb25f74a8e519fdd0faa097a02df1698a314e9/applet/src/main/java/opencrypto/jcmathlib/BigNat.java#L291\" rel=\"nofollow noreferrer\">the line 291</a> throws a CryptoException with a reason code of ILLEGAL_VALUE.</p>\n<p><a href=\"https://docs.oracle.com/javacard/3.0.5/api/javacard/security/RSAPrivateKey.html#setModulus(byte%5B%5D,%20short,%20short)\" rel=\"nofollow noreferrer\">The documentation for RSAPrivateKey.setModulus on JavaCard</a> says that the method throws a CryptoException like this &quot;if the input modulus data length is inconsistent with the implementation or if input data decryption is required and fails&quot;. I'm not certain, but I don't think input data decryption is required in this scenario, so I'm assuming that the modulus data length is &quot;inconsistent with the implementation&quot;. However, I'm not sure what <em>would</em> be consistent with the implementation. Would anyone know what determines the correct modulus input length, and whether this length is measured in bits or bytes?</p>\n<p>For reference, the modulus I want to use is, in its original form, 32 bytes long. The code pads it to 64 bytes (rm.MAX_EXP_LENGTH) with zeros (prepended) before passing it as the input to the setModulus call. That same length is given as the length argument. When the RSAPrivateKey object in question was built with KeyBuilder, it was given a length of 512 bits, which equals 64 bytes.</p>\n<p>I have also attempted to pass 512 as the length argument in case the length is measured in bits, but this results in an IndexOutOfBoundsException, which indicates that it does indeed want bytes. I still want to ask to make sure, though.</p>\n<p>Thank you in advance!</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}