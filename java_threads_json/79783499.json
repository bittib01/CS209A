{
  "question": {
    "tags": [
      "java",
      "sonarlint"
    ],
    "owner": {
      "account_id": 2259314,
      "reputation": 11357,
      "user_id": 1989769,
      "user_type": "registered",
      "accept_rate": 45,
      "profile_image": "https://i.sstatic.net/37IMZ.jpg?s=256",
      "display_name": "Sergiy Medvynskyy",
      "link": "https://stackoverflow.com/users/1989769/sergiy-medvynskyy"
    },
    "is_answered": true,
    "view_count": 136,
    "answer_count": 1,
    "score": 3,
    "last_activity_date": 1759822494,
    "creation_date": 1759741709,
    "last_edit_date": 1759822494,
    "question_id": 79783499,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79783499/sonarqube-provides-an-error-message-for-optional-with-value-marked-as-nullable",
    "title": "SonarQube provides an error message for Optional with value marked as Nullable (JSpecify)",
    "body": "<p>We have migrated our null-check annotations from javax.annotation to org.jspecify.annotations and got a new message from SonarQube in different locations of our code.</p>\n<p>Here is an example of code that now brings an error message:</p>\n<pre><code>import java.util.Optional;\n\nimport org.jspecify.annotations.Nullable;\n\npublic class SonarLinOptionaJSpecifyProblem {\n\n    public static String toLowerCaseNullSafe(@Nullable String string) {\n        return Optional.ofNullable(string).map(String::toLowerCase).orElse(null);\n    }\n}\n</code></pre>\n<p>The Sonar message is: A &quot;NullPointerException&quot; could be thrown; &quot;ofNullable()&quot; can return null. (rule java:S2259)</p>\n<p>May be I'm wrong, but Optional.ofNullable can't return null.</p>\n<p>Is it a bug of Sonar or I completely missunderstand Optional?</p>\n<p>P.S. If I switch back to javax.annotation.Nullable, I get no such message from SonarQube</p>\n<p>Thanks to <strong>k314159</strong>. It's a <a href=\"https://community.sonarsource.com/t/a-nullpointerexception-could-be-thrown-ofnullable-can-return-null/134892/9\" rel=\"nofollow noreferrer\">bug</a> of SonarQube. Discussion is closed. I hope the great SonarQube team will fix this bug as soon as possible.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}