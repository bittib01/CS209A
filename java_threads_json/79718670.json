{
  "question": {
    "tags": [
      "java",
      "couchbase",
      "sql++"
    ],
    "owner": {
      "account_id": 5289146,
      "reputation": 9950,
      "user_id": 4222206,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/416696430ab23f397a5dbeda73e72896?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "queeg",
      "link": "https://stackoverflow.com/users/4222206/queeg"
    },
    "is_answered": true,
    "view_count": 159,
    "accepted_answer_id": 79719191,
    "answer_count": 1,
    "score": 4,
    "last_activity_date": 1760040883,
    "creation_date": 1753794643,
    "last_edit_date": 1760040883,
    "question_id": 79718670,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79718670/how-to-retrieve-metrics-from-couchbase-query",
    "title": "How to retrieve metrics from Couchbase query?",
    "body": "<p>Looking for an async solution? Look <a href=\"https://stackoverflow.com/questions/79775868/how-to-retrieve-metrics-from-couchbase-query-with-async-api\">here</a>. Otherwise read on.</p>\n<p>I am trying to delete documents that have expired via a query. I am not using Couchbase's feature of expiring documents as I need better control over this.</p>\n<p>Now apart from running a delete query like this</p>\n<pre><code>Instant threshold = Instant.now().minus(retention);\nString query = String.format(&quot;delete from %s.%s.%s where _lastmodified &lt; \\&quot;%s\\&quot;&quot;, bucketName, scopeName, collectionName, threshold);\nQueryResult result = cluster.query(query);\n</code></pre>\n<p>I'd like to see some metrics how many documents were impacted. For this I am challenging the <code>returning</code> clause but it only partly works for me. I can do something like</p>\n<pre><code>Instant threshold = Instant.now().minus(retention);\nString query = String.format(&quot;delete from %s.%s.%s where _lastmodified &lt; \\&quot;%s\\&quot; returning _id, _lastmodified&quot;, bucketName, scopeName, collectionName, threshold);\nQueryResult result = cluster.query(query);\n</code></pre>\n<p>and the query result will deliver all the identifiers and timestamps of the documents that were deleted. But I am more or also interested to see the metrics listed here: <a href=\"https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/insert.html#result\" rel=\"nofollow noreferrer\">https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/insert.html#result</a></p>\n<ul>\n<li>errors</li>\n<li>status</li>\n<li>metrics (elapsedTime, executionTime, resultCount, resultSize, and mutationCount)</li>\n</ul>\n<p>How can I get hold of those?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}