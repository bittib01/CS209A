{
  "question": {
    "tags": [
      "java",
      "sql",
      "jooq",
      "sql-parser"
    ],
    "owner": {
      "account_id": 25917081,
      "reputation": 59,
      "user_id": 19640317,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/MOEOkdpB.jpg?s=256",
      "display_name": "Raoua KHATERCHI",
      "link": "https://stackoverflow.com/users/19640317/raoua-khaterchi"
    },
    "is_answered": true,
    "view_count": 109,
    "answer_count": 1,
    "score": 2,
    "last_activity_date": 1760007116,
    "creation_date": 1760006054,
    "question_id": 79786299,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79786299/jooq-removes-sql-inside-ignore-comments-during-execution",
    "title": "jOOQ removes SQL inside ignore comments during execution",
    "body": "<p>I'm using jOOQ with PostgreSQL and want to execute a query with an EXPLAIN (ANALYZE, FORMAT JSON) prefix.</p>\n<p>I set the parser settings to ignore comments:</p>\n<pre><code>Settings settings = new Settings()\n                .withParseDialect(SQLDialect.ORACLE)\n                .withParseUnknownFunctions(ParseUnknownFunctions.IGNORE)\n                .withTransformTableListsToAnsiJoin(true)\n                .withTransformUnneededArithmeticExpressions(TransformUnneededArithmeticExpressions.ALWAYS)\n                .withTransformRownum(Transformation.ALWAYS)\n                .withParamCastMode(ParamCastMode.DEFAULT)\n                .withRenderOptionalAsKeywordForFieldAliases(RenderOptionalKeyword.ON)\n                .withRenderOptionalAsKeywordForTableAliases(RenderOptionalKeyword.ON)\n                .withRenderQuotedNames(RenderQuotedNames.EXPLICIT_DEFAULT_UNQUOTED)\n                .withRenderNameCase(RenderNameCase.UPPER)\n                .withRenderCoalesceToEmptyStringInConcat(true)\n                .withBatchSize(DbConnectionHelper.MAX_BATCH_SIZE)\n                .withParseIgnoreComments(true)\n                ;\n        return settings;\n</code></pre>\n<p>Then I delimit the EXPLAIN clause like this:</p>\n<pre><code>String explainSql = &quot;&quot;&quot;\n    /* [jooq ignore start] */\n    EXPLAIN (ANALYZE, FORMAT JSON)\n    /* [jooq ignore stop] */\n&quot;&quot;&quot; + sql;\n\ntry (Statement stmt = conn.createStatement();\n     ResultSet rs = stmt.executeQuery(explainSql)) {\n    // process result\n}\n</code></pre>\n<p><strong>Issue:</strong></p>\n<p>jOOQ now ignores the EXPLAIN clause during parsing as expected, but it also removes it from the executed SQL.\nSo, the executed query no longer contains EXPLAIN (ANALYZE, FORMAT JSON) and fails to produce the plan.</p>\n<p><strong>I'm using:</strong></p>\n<ul>\n<li>jOOQ version: 3.19.6</li>\n<li>PostgreSQL 14</li>\n<li>JDBC (not via DSL fetch)</li>\n<li>Java 11</li>\n<li>Database source dialect: Oracle</li>\n<li>Destination dialect: PostgreSQL</li>\n</ul>\n<p><strong>Question:</strong></p>\n<p>Is there a way to make jOOQ <strong>ignore a part of SQL during parsing</strong> but <strong>keep it in the actual execution</strong>?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}