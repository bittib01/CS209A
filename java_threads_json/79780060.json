{
  "question": {
    "tags": [
      "java",
      "json",
      "jackson"
    ],
    "owner": {
      "account_id": 1921,
      "reputation": 187582,
      "user_id": 2648,
      "user_type": "registered",
      "accept_rate": 52,
      "profile_image": "https://www.gravatar.com/avatar/8b2d39a59a961ef26440e9c1453d1939?s=256&d=identicon&r=PG",
      "display_name": "D&#243;nal",
      "link": "https://stackoverflow.com/users/2648/d%c3%b3nal"
    },
    "is_answered": true,
    "view_count": 497,
    "answer_count": 3,
    "score": 1,
    "last_activity_date": 1760346616,
    "creation_date": 1759322714,
    "last_edit_date": 1759326845,
    "question_id": 79780060,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79780060/deserialize-a-json-property-to-a-string-numeric-boolean-type-with-jackson",
    "title": "Deserialize a JSON property to a string/numeric/boolean type with Jackson",
    "body": "<p>Given this JSON</p>\n<pre class=\"lang-json prettyprint-override\"><code>{\n  &quot;rejectedValue&quot;: &quot;rejected&quot;\n}\n</code></pre>\n<p>I'm trying to use Jackson to deserialize this to an instance of</p>\n<pre><code>public record MyClass(Object rejectedValue) {\n}\n</code></pre>\n<p>(In reality, the JSON and Java record have other properties, but I've omitted them because they're not relevant to the question)</p>\n<p>The <code>rejectedValue</code> JSON property will always be one of the following:</p>\n<ul>\n<li>string</li>\n<li>number</li>\n<li>boolean</li>\n<li>null</li>\n</ul>\n<p>So if the JSON property is not null the runtime-type of the corresponding Java object property should be one of</p>\n<ul>\n<li>String</li>\n<li>A subclass of Number (Integer, Double, etc)</li>\n<li>Boolean</li>\n</ul>\n<p>My attempt at writing a Jackson deserializer is below. I'm using a Jackson release candidate version, specifically v3.0.0-rc9.</p>\n<pre class=\"lang-java prettyprint-override\"><code>import tools.jackson.databind.ValueDeserializer;\nimport tools.jackson.databind.JsonNode;\n\npublic class MyClassDeserializer extends ValueDeserializer&lt;MyClass&gt; {\n\n    @Override\n    public MyClass deserialize(JsonParser parser, DeserializationContext ctx) throws JacksonException {\n        JsonNode jsonRoot = parser.readValueAsTree();\n        JsonNode rejectedValue = jsonRoot.get(&quot;rejectedValue&quot;);\n        Object convertedValue = toSimpleValue(rejectedValue);\n        return new MyClass(convertedValue);\n    }\n\n    private Object toSimpleValue(JsonNode node) {\n        return switch (node.getNodeType()) {\n            case NULL, MISSING -&gt; null;\n            case BOOLEAN -&gt; node.asBoolean();\n            case NUMBER -&gt; node.isInt() ? node.asInt() : node.isLong() ? node.asLong() : node.asDouble();\n            default -&gt; node.asString();\n        };\n    }  \n}\n</code></pre>\n<p>Although this works, the code is pretty unpleasant. I suspect there must be a more concise/elegant way to achieve the same result?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}