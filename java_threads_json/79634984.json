{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "spring-native"
    ],
    "owner": {
      "account_id": 12263552,
      "reputation": 11,
      "user_id": 8950622,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/-cO45UDed_w4/AAAAAAAAAAI/AAAAAAAAAEs/usCHP7LvQ1U/s256-rj/photo.jpg",
      "display_name": "Qeir Mr.é’Ÿ",
      "link": "https://stackoverflow.com/users/8950622/qeir-mr-%e9%92%9f"
    },
    "is_answered": true,
    "view_count": 57,
    "accepted_answer_id": 79639718,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1748309592,
    "creation_date": 1747983113,
    "last_edit_date": 1747983704,
    "question_id": 79634984,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79634984/spring-native-process-aot-unable-to-register-lambda",
    "title": "spring native process-aot unable to register lambda",
    "body": "<p>If you want to use lambda expressions under native, you must register the lambdaCapturingTypes type in serialization-config.json.</p>\n<pre><code>\n@Service\n@AllArgsConstructor\npublic class SysRegionServiceImpl implements ISysRegionService {\n\n    private final SysRegionRepository sysRegionRepository;\n\n    @Override\n    public SysRegion selectSysRegionByRegionCodel(String regionCode) {\n        return sysRegionRepository.getOne(Wrappers.&lt;SysRegion&gt;lambdaQuery().eq(SysRegion::getRegionCode, regionCode));\n    }\n\n}\n</code></pre>\n<p>Must be registered in serialization-config.json</p>\n<pre><code>{\n  &quot;types&quot;:[\n  ],\n  &quot;lambdaCapturingTypes&quot;:[\n    {&quot;name&quot;:&quot;com.shushang.system.service.impl.SysRegionServiceImpl&quot;}\n  ],\n  &quot;proxies&quot;:[\n  ]\n}\n\n</code></pre>\n<p>or add buildArg --features=x.x.x.LambdaRegistrationFeature</p>\n<pre><code>public class LambdaRegistrationFeature implements Feature {\n\n    @Override\n    public void duringSetup(DuringSetupAccess access) {\n        RuntimeSerialization.registerLambdaCapturingClass(SysRegionServiceImpl.class);\n    }\n\n}\n</code></pre>\n<p>It is very troublesome to use.</p>\n<p>but Spring provides APIs related to Hints to generate JSON files in advance, org.springframework.aot.hint.SerializationHints</p>\n<p>use RuntimeHintsRegistrar</p>\n<pre><code>hints.serialization().registerType(SysRegionServiceImpl.class);\n</code></pre>\n<p>But the registered lambdaCapturingTypes type cannot be added.</p>\n<p>What Spring process-aot helped me generate is like this serialization-config.json</p>\n<pre><code>[\n  {\n    &quot;name&quot;: &quot;com.shushang.system.service.impl.SysRegionServiceImpl&quot;\n  }\n]\n\n</code></pre>\n<p>How should I dynamically add classes that need to be registered during process-aot, such as classes annotated by @Service, and add them to lambdaCapturingTypes?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}