{
  "question": {
    "tags": [
      "java",
      "reflection",
      "final",
      "spigot"
    ],
    "owner": {
      "account_id": 28195297,
      "reputation": 162,
      "user_id": 21550046,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/AGNmyxYteMBojPQfR3HvmDzoOgwQhCkZxrZhTAXh2MXQ=k-s256",
      "display_name": "Nathalie Kitty",
      "link": "https://stackoverflow.com/users/21550046/nathalie-kitty"
    },
    "is_answered": true,
    "view_count": 520,
    "answer_count": 3,
    "score": 4,
    "last_activity_date": 1757335255,
    "creation_date": 1755174233,
    "last_edit_date": 1755182342,
    "question_id": 79735396,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79735396/can-you-set-value-of-a-private-final-variable-in-java-21",
    "title": "Can you set value of a private final variable in Java 21?",
    "body": "<p>This used to be easy in Java 8 and I want to know if it's still possible in Java 21. I've seen a bunch of old posts, all giving different methods for this, none of which worked. I'm hoping for a universal solution, but I'll include details of my use case too.</p>\n<p><em>What do I need it for and what can I control?</em><br />\nI am making a Minecraft plugin - that means my code is in a <code>jar</code> file and is not loaded instantly alongside the server, that happens a few seconds later using a class loader. This being a plugin also means I can't control environment variables or parameters when JVM is started.<br />\nI want to change the value of a <code>private final</code> <code>commandMap</code> variable in <code>org.bukkit.plugin.SimplePluginManager</code> class. It's not primitive.</p>\n<p><em>What have I tried?</em><br />\nI cannot use just <code>field.setAccessible(true);</code>, because modern java throws <code>IllegalArgumentException: Can not set final field</code>.<br />\nI cannot make the field non-final using <code>modifiers</code> field (code below), since <a href=\"https://bugs.openjdk.org/browse/JDK-8210522\" rel=\"nofollow noreferrer\"><code>java.lang.reflect.Field</code> fields have been hidden</a>.</p>\n<pre><code>field.setAccessible(true);\nField modifiersField = field.getClass().getDeclaredField(&quot;modifiers&quot;);\nmodifiersField.setAccessible(true);\nmodifiersField.setInt(field, field.getModifiers() &amp; ~Modifier.FINAL);\n</code></pre>\n<p>I tried <code>org.apache.commons.lang3.reflect.FieldUtils</code> only to realize it uses the same trick as above.<br />\nI tried using <code>sun.misc.Unsafe</code> from <a href=\"https://stackoverflow.com/a/71465198/21550046\">this answer</a> but I don't know how to apply it to a non-static variable. The comments say this works on Java 21.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}