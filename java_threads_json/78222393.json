{
  "question": {
    "tags": [
      "java",
      "log4j2",
      "apache-zookeeper"
    ],
    "owner": {
      "account_id": 4758445,
      "reputation": 4016,
      "user_id": 3846548,
      "user_type": "registered",
      "accept_rate": 70,
      "profile_image": "https://www.gravatar.com/avatar/f59b587beb62618436c39d74bac9b5ea?s=256&d=identicon&r=PG",
      "display_name": "terrywb",
      "link": "https://stackoverflow.com/users/3846548/terrywb"
    },
    "is_answered": true,
    "view_count": 421,
    "answer_count": 2,
    "score": 1,
    "last_activity_date": 1730829311,
    "creation_date": 1711413809,
    "question_id": 78222393,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78222393/suppress-log4j-output-from-org-apache-zookeeper-zookeeper",
    "title": "Suppress Log4j Output from org.apache.zookeeper.ZooKeeper",
    "body": "<p>I am building a test driver that will utilize org.apache.zookeeper.ZooKeeper.  The library is dumping noisy output to the console that I would like to control or suppress.</p>\n<p>I have attempted to create a custom logj2.properties file and a custom log4j2.xml file.\nI have tried passing several runtime properties to override the log4j configuration, but I have not been able suppress this output.</p>\n<p>I think the logger is created <a href=\"https://github.com/apache/zookeeper/blob/master/zookeeper-server/src/main/java/org/apache/zookeeper/ZooKeeper.java#L171\" rel=\"nofollow noreferrer\">here</a>.</p>\n<h2>Run Zookeeper locally: <code>docker-compose.yml</code></h2>\n<pre class=\"lang-yaml prettyprint-override\"><code>version: '3.9'\nservices:\n  zoo:\n    container_name: zoo\n    image: zookeeper:3.8.3\n    ports:\n    - published: 8084\n      target: 2181\n    restart: unless-stopped\n    stdin_open: true\n    tty: true\n</code></pre>\n<h2>Pom File to pull in ZooKeeper: <code>pom.xml</code></h2>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;org.my&lt;/groupId&gt;\n    &lt;artifactId&gt;MyApp&lt;/artifactId&gt;\n    &lt;version&gt;1.0&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;name&gt;Test&lt;/name&gt;\n    &lt;url&gt;http://maven.apache.org&lt;/url&gt;\n\n    &lt;properties&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;\n      &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;\n      &lt;version&gt;3.8.3&lt;/version&gt;\n    &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.3.2&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;source&gt;1.8&lt;/source&gt;\n                    &lt;target&gt;1.8&lt;/target&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;\n                &lt;version&gt;2.4&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;archive&gt;\n                        &lt;manifest&gt;\n                            &lt;addClasspath&gt;true&lt;/addClasspath&gt;\n                            &lt;mainClass&gt;org.my.Test&lt;/mainClass&gt;\n                        &lt;/manifest&gt;\n                    &lt;/archive&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;phase&gt;install&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;copy-dependencies&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;outputDirectory&gt;${project.build.directory}&lt;/outputDirectory&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n      &lt;plugin&gt;\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;\n        &lt;version&gt;2.22.2&lt;/version&gt;\n        &lt;configuration&gt;\n            &lt;!-- Includes Test* and *Test by default --&gt;\n            &lt;!-- skips surefire tests without skipping failsafe tests.\n             Property\n            value seems to magically default to false --&gt;\n            &lt;skipTests&gt;${skip.surefire.tests}&lt;/skipTests&gt;\n        &lt;/configuration&gt;\n      &lt;/plugin&gt;\n    &lt;/plugins&gt;\n        &lt;directory&gt;target&lt;/directory&gt;\n        &lt;outputDirectory&gt;target/classes&lt;/outputDirectory&gt;\n        &lt;finalName&gt;${project.artifactId}-${project.version}&lt;/finalName&gt;\n        &lt;sourceDirectory&gt;src/main/java&lt;/sourceDirectory&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n<h2>Test Driver: <code>src/main/java/org/my/Test.java</code></h2>\n<pre class=\"lang-java prettyprint-override\"><code>package org.my;\n\nimport java.io.IOException;\n\nimport org.apache.zookeeper.ZooKeeper;\n\npublic class Test {\n  public static void main(String[] argv) throws IOException {\n    System.out.println(&quot;hello&quot;);\n    ZooKeeper zk = new ZooKeeper(&quot;localhost:8084&quot;, 100, null);\n  }\n}\n</code></pre>\n<h2>Build Command</h2>\n<pre><code>mvn clean install\n</code></pre>\n<h2>Run Command</h2>\n<pre><code>java -jar target/MyApp-1.0.jar \n</code></pre>\n<h2>Output (partially redacted)</h2>\n<pre><code>hello\n17:26:50.713 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:zookeeper.version=3.8.3-6ad6d364c7c0bcf0de452d54ebefa3058098ab56, built on 2023-10-05 10:34 UTC\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:host.name=...\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:java.version=11.0.22\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:java.vendor=Red Hat, Inc.\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:java.home=/usr/lib/jvm/java-11-openjdk-11.0.22.0.7-1.amzn2.0.1.x86_64\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:java.class.path=target/MyApp-1.0.jar\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:java.library.path=/usr/java/packages/lib:/usr/lib64:/lib64:/lib:/usr/lib\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:java.io.tmpdir=/tmp\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:java.compiler=&lt;NA&gt;\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:os.name=Linux\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:os.arch=amd64\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:os.version=4.14.336-257.562.amzn2.x86_64\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:user.name=...\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:user.home=...\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:user.dir=...\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:os.memory.free=244MB\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:os.memory.max=3962MB\n17:26:50.716 [main] INFO org.apache.zookeeper.ZooKeeper - Client environment:os.memory.total=250MB\n17:26:50.721 [main] INFO org.apache.zookeeper.ZooKeeper - Initiating client connection, connectString=localhost:8084 sessionTimeout=100 watcher=null\n17:26:50.728 [main] INFO org.apache.zookeeper.common.X509Util - Setting -D jdk.tls.rejectClientInitiatedRenegotiation=true to disable client-initiated TLS renegotiation\n17:26:50.734 [main] INFO org.apache.zookeeper.ClientCnxnSocket - jute.maxbuffer value is 1048575 Bytes\n17:26:50.745 [main] INFO org.apache.zookeeper.ClientCnxn - zookeeper.request.timeout value is 0. feature enabled=false\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}