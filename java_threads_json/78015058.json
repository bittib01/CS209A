{
  "question": {
    "tags": [
      "java",
      "android",
      "flutter",
      "flutter-method-channel",
      "euiccmanager"
    ],
    "owner": {
      "account_id": 29196778,
      "reputation": 16,
      "user_id": 22367702,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/AAcHTtf8b6up7Ms30zKrutwDnGuLcqQAPFd6wyCNrSDQ7oAZ=k-s256",
      "display_name": "Abdullah Rashed",
      "link": "https://stackoverflow.com/users/22367702/abdullah-rashed"
    },
    "is_answered": false,
    "view_count": 538,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1712854747,
    "creation_date": 1708244554,
    "last_edit_date": 1708330629,
    "question_id": 78015058,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78015058/esim-euicc-native-android-code-java-working-in-native-android-project-but-not",
    "title": "eSIM EUICC Native Android Code (Java) Working In Native Android Project, But Not In Flutter Method Channel",
    "body": "<p>I am trying to implement eSIM functionality with Flutter as UI and native Java for the EUICC APIs. After debugging it turns out that my code exits right when the new BroadcastReceiver() line executes and skips to the end of the code block and logs (&quot;I am downloading&quot;)(No exceptions, No crashes) Last logged value is (&quot;stt3&quot;). Knowing the code works when using a pure native Android project, what could be the issue?</p>\n<p><strong>I Have used the same method channel to check for eSIM compatibility and to get the battery level and it works fine</strong></p>\n<pre><code> @RequiresApi(api = Build.VERSION_CODES.P)\n    private void downloadSubscription(){\n//        Context context = getApplicationContext();\n        Log.d(&quot;init&quot;, &quot;ASKJDGAKJHSDHFGKJASF&quot;);\n        EuiccManager mgr = (EuiccManager) context.getSystemService(Context.EUICC_SERVICE);\n        Log.d(&quot;stt2&quot;, &quot;ASKJDGAKJHSDHFGKJASF&quot;);\n        // Register receiver.\n        try {\n            Log.d(&quot;stt3&quot;, &quot;stt3&quot;);\n            BroadcastReceiver receiver =\n                    new BroadcastReceiver() {\n\n                        @Override\n                        public void onReceive(Context context, Intent intent) {\n                            Log.d(&quot;stt4&quot;, &quot;stt4&quot;);\n\n                            if (!ACTION_DOWNLOAD_SUBSCRIPTION.equals(intent.getAction())) {\n                                return;\n                            }\n                            Intent resultIntent = new Intent();\n                            int resultCode = getResultCode();\n                            Log.d(&quot;result code&quot;, &quot;result code&quot; + resultCode);\n                            int detailedCode = intent.getIntExtra(\n                                    EuiccManager.EXTRA_EMBEDDED_SUBSCRIPTION_DETAILED_CODE,\n                                    0 /* defaultValue*/);\n\n                            // If the result code is a resolvable error, call startResolutionActivity\n                            if (resultCode == EuiccManager.EMBEDDED_SUBSCRIPTION_RESULT_RESOLVABLE_ERROR) {\n                                PendingIntent callbackIntent = PendingIntent.getBroadcast(\n                                        context , 0 /* requestCode */, intent,\n                                        PendingIntent.FLAG_UPDATE_CURRENT | PendingIntent.FLAG_MUTABLE);\n                                try {\n                                    mgr.startResolutionActivity(\n                                            activity,\n                                            0 /* requestCode */,\n                                            intent,\n                                            callbackIntent);\n                                } catch (Exception e) {\n\n                                    throw new RuntimeException(e);\n                                }\n                            }\n\n                            resultIntent = intent;\n                            Log.d(&quot;HALO result code&quot;, &quot;result code is &quot; + resultCode);\n                        }\n\n\n                    };\n            context.registerReceiver(receiver,\n                    new IntentFilter(ACTION_DOWNLOAD_SUBSCRIPTION),\n                    LPA_DECLARED_PERMISSION, null /* broadcastPermission*/);\n                    // Download subscription asynchronously.\n        Log.d(&quot;I am downloading &quot;, &quot;I am downloading&quot;);\n        DownloadableSubscription sub = DownloadableSubscription\n                .forActivationCode(&quot;2378462378wjgdjghiw&quot; /* encodedActivationCode*/);\n        Intent intent = new Intent(ACTION_DOWNLOAD_SUBSCRIPTION).setPackage(context.getPackageName());\n        PendingIntent callbackIntent = PendingIntent.getBroadcast(\n                context, 0 /* requestCode */, intent,\n                PendingIntent.FLAG_UPDATE_CURRENT | PendingIntent.FLAG_MUTABLE);\n        mgr.downloadSubscription(sub, true /* switchAfterDownload */,\n                callbackIntent);\n\n        } catch (Exception e){\n            Log.d(&quot;lblblblblb&quot;, &quot;lblblblblb I AM EXCEPTION &quot; + e);\n            throw new RuntimeException(e);\n        }\n\n\n\n    }\n\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}