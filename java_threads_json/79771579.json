{
  "question": {
    "tags": [
      "java",
      "kotlin",
      "gradle"
    ],
    "owner": {
      "account_id": 10720600,
      "reputation": 113,
      "user_id": 7889829,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/PnrpX.jpg?s=256",
      "display_name": "GSerum_",
      "link": "https://stackoverflow.com/users/7889829/gserum"
    },
    "is_answered": false,
    "view_count": 297,
    "answer_count": 0,
    "score": 8,
    "last_activity_date": 1759410928,
    "creation_date": 1758542309,
    "question_id": 79771579,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79771579/kotlin-slow-compile-times",
    "title": "Kotlin slow compile times",
    "body": "<p>When we want to compile our project, it regularly takes somewhere between 5-8 minutes. This is an issue for our developers as we want to be able to quickly test our changes. More often than not, the &quot;Apply HotSwap&quot; feature from IntelliJ IDEA also does not work, as it crashes out saying it can't apply the hotswap for a plethora of reasons, none of which have been indicative of why it went wrong so far.</p>\n<p>We've already scoured the web trying to find solutions and have (attempted to) implement(ed) most of the highly upvoted solutions.</p>\n<p>The only thing we haven't yet done is split our product into modules, which would not be an ideal sole solution as we have quite a huge codebase. We'd consider this as a &quot;last resort&quot; for now.</p>\n<p>We've also thought of e.g. only running the jOOQ codegen if the model has changed in our database, and caching or even committing the generated files, but that won't cut down multiple minutes of the time spent.</p>\n<p>Our codebase is around 72% Kotlin, which, according to our Git repository, is around 1.6k files.</p>\n<p>What can we do to cut down our compile times?</p>\n<hr />\n<p>Notable frameworks: RePlay, jOOQ, flyway, openAPI</p>\n<p>Device: Lenovo laptop (OpenSUSE) with 32Gb RAM + 32Gb Swap allocated</p>\n<p>Java: Coretto 21\nGradle: 8.5\nKotlin: 2.2.20-RC2</p>\n<p>VM options in our run configuration:</p>\n<pre class=\"lang-none prettyprint-override\"><code>-Dlog4j_rootLogger=INFO,Console \n-XX:+ShowCodeDetailsInExceptionMessages \n-Djdk.attach.allowAttachSelf=true \n--add-exports=java.base/jdk.internal.access.foreign=ALL-UNNAMED \n--add-opens=java.base/java.nio=ALL-UNNAMED \n--add-opens=java.base/java.util=ALL-UNNAMED \n--add-opens=java.base/java.lang=ALL-UNNAMED\n</code></pre>\n<p>Gradle properties from <code>gradle.properties</code>:</p>\n<pre class=\"lang-none prettyprint-override\"><code>org.gradle.caching=true\norg.gradle.parallel=true\norg.gradle.jvmargs=-XX:+UseParallelGC -Xmx8g -Dkotlin.daemon.jvm.options=-Xmx6g \\\n  --add-exports jdk.compiler/com.sun.tools.javac.api=ALL-UNNAMED \\\n  --add-exports jdk.compiler/com.sun.tools.javac.file=ALL-UNNAMED \\\n  --add-exports jdk.compiler/com.sun.tools.javac.parser=ALL-UNNAMED \\\n  --add-exports jdk.compiler/com.sun.tools.javac.tree=ALL-UNNAMED \\\n  --add-exports jdk.compiler/com.sun.tools.javac.util=ALL-UNNAMED\n\nkotlin.compiler.execution.strategy=in-process\n</code></pre>\n<p>Kotlin free compiler args from <code>build.gradle.kts</code>:</p>\n<pre class=\"lang-kotlin prettyprint-override\"><code>-Xjsr305=strict\n-Xbackend-threads=0\n-Xenable-incremental-compilation\n-Xlambdas=indy\n</code></pre>\n<p>Gradle profile report after editing a single line of source code:</p>\n<pre><code>compileKotlin           - 3m 32.672s\nnpm:build               - 2m 59.938s // Export our Kotlinx html as webpack\ndetekt                  - 1m 14.514s    \nflywayMigrate           - 41.606s   \njooqCodegen             - 35.940s   \nflywayLoadSchemaAndSeed - 22.542s   \nflywayClean             - 12.956s   \n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}