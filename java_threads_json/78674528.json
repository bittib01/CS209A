{
  "question": {
    "tags": [
      "java",
      "jar"
    ],
    "owner": {
      "account_id": 7050254,
      "reputation": 135,
      "user_id": 5399598,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/7b6f8d60db9d793f53f68389157aec7e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "CoSoCo",
      "link": "https://stackoverflow.com/users/5399598/cosoco"
    },
    "is_answered": true,
    "view_count": 316,
    "accepted_answer_id": 78751388,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1722442368,
    "creation_date": 1719433551,
    "last_edit_date": 1719442600,
    "question_id": 78674528,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78674528/how-to-correctly-read-from-jarurlinputstream-java",
    "title": "How to correctly read from JarURLInputStream ? (Java)",
    "body": "<p>I'm trying to read the contents of my own JAR.</p>\n<p>With <code>getResourceAsStream(path)</code> I get a <code>sun.net.www.protocol.jar.JarURLConnection$JarURLInputStream</code>. But this stream seems empty, when the path is a directory.</p>\n<p>This is my test code:</p>\n<pre><code>package de.CoSoCo.testzone;\n\nimport java.io.*;\n\n/**\n *\n * @author Ulf Zibis &lt;Ulf.Zibis@CoSoCo.de&gt;\n * @version \n */\npublic class ResourceAsStream {\n\n  /**\n   * @param args the command line arguments\n   */\n  public static void main(String[] args) {\n    String packagePath = ResourceAsStream.class.getPackageName().replace('.', '/');\n    String path;\n    ClassLoader cl = Thread.currentThread().getContextClassLoader();\n    Class c = ResourceAsStream.class;\n    InputStream in;\n    byte [] bytes = new byte[16];\n    try {\n      System.out.println(&quot;path=&quot;+(\n          path = packagePath));\n      System.out.println(&quot;Class=&quot;+(\n          in = cl.getResourceAsStream(path)));\n      BufferedReader r = new BufferedReader(new InputStreamReader(in));\n      System.out.println(&quot;entries=&quot;);\n      for (String line; (line = r.readLine()) != null; )\n        System.out.println(&quot;  &quot;+line);\n      in = cl.getResourceAsStream(path);\n      System.out.println(&quot;read bytes=&quot;+in.read(bytes));\n    } catch (Exception ex) { System.out.println(ex); }\n    try {\n      System.out.println(&quot;path=&quot;+(\n          path = packagePath+'/'+&quot;A_Picture.png&quot;));\n      System.out.println(&quot;Class=&quot;+(\n          in = cl.getResourceAsStream(path)));\n      System.out.println(&quot;read bytes=&quot;+in.read(bytes));\n    } catch (Exception ex) { System.out.println(ex); }\n    try {\n      System.out.println(&quot;path=&quot;+(\n          path = &quot;&quot;));\n      System.out.println(&quot;Class=&quot;+(\n          in = c.getResourceAsStream(path)));\n      BufferedReader r = new BufferedReader(new InputStreamReader(in));\n      System.out.println(&quot;entries=&quot;);\n      for (String line; (line = r.readLine()) != null; )\n        System.out.println(&quot;  &quot;+line);\n      in = c.getResourceAsStream(path);\n      System.out.println(&quot;read bytes=&quot;+in.read(bytes));\n    } catch (Exception ex) { System.out.println(ex); }\n    try {\n      System.out.println(&quot;path=&quot;+(\n          path = &quot;A_Picture.png&quot;));\n      System.out.println(&quot;Class=&quot;+(\n          in = c.getResourceAsStream(path)));\n      System.out.println(&quot;read bytes=&quot;+in.read(bytes));\n    } catch (Exception ex) { System.out.println(ex); }\n  }\n    \n}\n</code></pre>\n<p>When I run this with separate class files – e.g. inside my NetBeans IDE – I get the expected directory entries:</p>\n<pre><code>path=de/CoSoCo/testzone\nClass=java.io.ByteArrayInputStream@4e50df2e\nentries=\n  A_Picture.png\n  ClassFinder.class\n  ClassFinder$1.class\n  FileChooserDemo.class\n  FileTimesFromCalendar.class\n  ResourceAsStream.class\nread bytes=16\npath=de/CoSoCo/testzone/A_Picture.png\nClass=java.io.BufferedInputStream@3941a79c\nread bytes=16\npath=\nClass=java.io.ByteArrayInputStream@506e1b77\nentries=\n  A_Picture.png\n  ClassFinder.class\n  ClassFinder$1.class\n  FileChooserDemo.class\n  FileTimesFromCalendar.class\n  ResourceAsStream.class\nread bytes=16\npath=A_Picture.png\nClass=java.io.BufferedInputStream@4fca772d\nread bytes=16\n</code></pre>\n<p>But when I run it from the JAR it fails:</p>\n<pre><code>$ java -jar TestZone.jar\npath=de/CoSoCo/testzone\nClass=sun.net.www.protocol.jar.JarURLConnection$JarURLInputStream@3d4eac69\nentries=\nread bytes=-1\npath=de/CoSoCo/testzone/A_Picture.png\nClass=sun.net.www.protocol.jar.JarURLConnection$JarURLInputStream@135fbaa4\nread bytes=16\npath=\nClass=sun.net.www.protocol.jar.JarURLConnection$JarURLInputStream@330bedb4\nentries=\nread bytes=-1\npath=A_Picture.png\nClass=sun.net.www.protocol.jar.JarURLConnection$JarURLInputStream@7ea987ac\nread bytes=16\n</code></pre>\n<p>To me this <strong>looks like a bug</strong>, but maybe I'm doing wrong.</p>\n<p>My goal is to <strong>read the directory entries</strong>.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}