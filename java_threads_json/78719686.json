{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-boot",
      "docker",
      "mqtt"
    ],
    "owner": {
      "account_id": 29514676,
      "reputation": 41,
      "user_id": 22618894,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/d4c869e330d018cd2610faa2c3926c0f?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Hani Bikdeli",
      "link": "https://stackoverflow.com/users/22618894/hani-bikdeli"
    },
    "is_answered": true,
    "view_count": 153,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1721804238,
    "creation_date": 1720425201,
    "question_id": 78719686,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78719686/dockerized-spring-boot-error-while-instantiating-mqttclient",
    "title": "dockerized spring boot error while instantiating MqttClient",
    "body": "<p>Im trying to instantiate MqttClient in my MqttClientService like this</p>\n<pre class=\"lang-java prettyprint-override\"><code>    public MqttClientService(KipitProperties properties) {\n\n        String connectionString = String.format(&quot;%s://%s:%s&quot;,\n                properties.getMqtt().getProtocol(),\n                properties.getMqtt().getUrl(),\n                properties.getMqtt().getPort());\n\n        try {\n            this.publisher = new MqttClient(connectionString, properties.getMqtt().getPublisher().getId());\n        } catch (MqttException ex) {\n            log.error(ExceptionUtils.getMessage(ex));\n            log.error(ExceptionUtils.getFullStackTrace(ex));\n        }\n    }\n\n</code></pre>\n<p>The application runs fine on my local machine, however i get this error when i deploy my docker image which i made using jib</p>\n<pre><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'mqttClientService' defined in file [/app/classes/com/kipit/wallet/event/mqtt/MqttClientService.class]: Bean instantiation via constructor failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.kipit.wallet.event.mqtt.MqttClientService]: Constructor threw exception; nested exception is java.lang.RuntimeException: Can not initialize MqttClients\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:310)\n    at org.springframework.beans.factory.support.ConstructorResolver.autowireConstructor(ConstructorResolver.java:291)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireConstructor(AbstractAutowireCapableBeanFactory.java:1372)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1222)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582)\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\n    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:955)\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:929)\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:591)\n    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:147)\n    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:732)\n    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:409)\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:308)\n    at com.kipit.WalletServiceApplication.main(WalletServiceApplication.java:40)\nCaused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [com.kipit.wallet.event.mqtt.MqttClientService]: Constructor threw exception; nested exception is java.lang.RuntimeException: Can not initialize MqttClients\n    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:226)\n    at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:117)\n    at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:306)\n    ... 17 common frames omitted\nCaused by: java.lang.RuntimeException: Can not initialize MqttClients\n    at com.kipit.wallet.event.mqtt.MqttClientService.&lt;init&gt;(MqttClientService.java:30)\n    at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n    at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)\n    at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n    at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)\n    at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480)\n    at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:213)\n    ... 19 common frames omitted\n</code></pre>\n<p>I think the problem is that MqttClient cant create the file for file persistence inside of the docker container (base image is openjdk:17-oracle)</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}