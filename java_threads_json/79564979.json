{
  "question": {
    "tags": [
      "java",
      "amazon-s3",
      "file-upload"
    ],
    "owner": {
      "account_id": 340001,
      "reputation": 635,
      "user_id": 669789,
      "user_type": "registered",
      "accept_rate": 73,
      "profile_image": "https://www.gravatar.com/avatar/6ef19f6d112f25ef31d12d7414c4e677?s=256&d=identicon&r=PG",
      "display_name": "user669789",
      "link": "https://stackoverflow.com/users/669789/user669789"
    },
    "is_answered": true,
    "view_count": 642,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1756909426,
    "creation_date": 1744219859,
    "question_id": 79564979,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79564979/s3exception-x-amz-content-sha256-error-in-java-client",
    "title": "S3Exception: x-amz-content-sha256 error in Java client",
    "body": "<p>I have onTap ObjectStore setup, able to access ObjectStore for finding list of objects, download object actions using java code. I am using Amazon's software.amazon.awssdk. Here is my maven dependency</p>\n<pre><code>      &lt;dependency&gt;\n        &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n        &lt;artifactId&gt;aws-sdk-java&lt;/artifactId&gt;\n        &lt;version&gt;2.31.14&lt;/version&gt;\n      &lt;/dependency&gt;\n      &lt;dependency&gt;\n        &lt;groupId&gt;software.amazon.awssdk&lt;/groupId&gt;\n        &lt;artifactId&gt;apache-client&lt;/artifactId&gt;\n        &lt;version&gt;2.31.14&lt;/version&gt;\n      &lt;/dependency&gt;\n</code></pre>\n<p>Here is the code that creates S3 Client. With S3Client, I am able to get the list of objects or download a object.</p>\n<pre><code>private S3Client getS3Client()\n    {\n        String secretKey = &quot;secretKey&quot;;\n        String accessKey = &quot;accessKey&quot;;\n        String endPoint = &quot;http://198.10.11.131&quot;;\n        AwsCredentials credentials = AwsBasicCredentials.create(accessKey, secretKey);\n        S3Configuration s3Config = S3Configuration.builder()\n            .pathStyleAccessEnabled(true)\n            .build();\n        S3ClientBuilder s3ClientBuilder = S3Client.builder()\n            .endpointOverride(URI.create(endPoint))\n            .region(Region.US_WEST_2)\n            .serviceConfiguration(s3Config)\n            .credentialsProvider(StaticCredentialsProvider.create(credentials));\n        return s3ClientBuilder.build();\n    }\n</code></pre>\n<p>Here is the code to upload file which fails.</p>\n<pre><code> PutObjectRequest request = PutObjectRequest.builder()\n            .bucket(bucketName)\n            .key(keyName)\n            .build();\n        s3Client.putObject(request, Path.of(filePath));\n</code></pre>\n<p>The exception</p>\n<pre><code>Caused by: software.amazon.awssdk.services.s3.model.S3Exception: x-amz-content-sha256 must be UNSIGNED-PAYLOAD, STREAMING-AWS4-HMAC-SHA256-PAYLOAD or a valid sha256 value. (Service: S3, Status Code: 400, Request ID: null) (SDK Attempt Count: 1)\n</code></pre>\n<p>I don't see a way to set this header either in PutObjectRequest or putObject method. I tried to set checkAlgorithm on PutObjectRequest didn't help. I tried different method of putObject, I see same error.</p>\n<p>Any one facing such error, How to pass this header from java. I am following AWS user guide - <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/upload-objects.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/AmazonS3/latest/userguide/upload-objects.html</a></p>\n<p>Any help in this is greatly helpful, TIA</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}