{
  "question": {
    "tags": [
      "java",
      "android",
      "kotlin",
      "aidl"
    ],
    "owner": {
      "account_id": 11751904,
      "reputation": 39,
      "user_id": 8600762,
      "user_type": "registered",
      "accept_rate": 50,
      "profile_image": "https://www.gravatar.com/avatar/b35f12ada810bcb5c00ad4db45c70843?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Barry B Benson",
      "link": "https://stackoverflow.com/users/8600762/barry-b-benson"
    },
    "is_answered": false,
    "view_count": 173,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1727383080,
    "creation_date": 1725980150,
    "last_edit_date": 1725987906,
    "question_id": 78970105,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78970105/aidl-api-establishing-communication-from-a-proprietary-server-app",
    "title": "AIDL API establishing communication from a proprietary server app",
    "body": "<p>New to Android development, I have made an app (the server) in Android Studio, and I have made a simple plugin in civTAK (client). To put simply, my app is proprietary, so I can't expose or share the package/module of the app. So I came up with the solution to make a new library which will contain the aidl information, e.g., &quot;aidlinterface&quot; with the package name <code>com.aidlinterface</code>, and then add that to the app level gradle for both server and client apps.</p>\n<p>So the tree structure is project/server_app and project/aidlinterface and for the client project/client_app and project/aidlinterface. So, the app and the library are at the same hierarchy. Becuase of the this I was able to create the server and client packages to be the exact same &quot;com.aidlInterface&quot;. First question: is this approach ok for this problem/is this approach viable or is there a better way?</p>\n<p>Second question, I have then made the service in the server app, and ensured that the service is initialised by going in the MainActivity.kt in the <code>onCreate</code> function:</p>\n<pre><code>startService(Intent(this, ServiceName::class.java))\n</code></pre>\n<p>And for the purposes of this example we can say that the service only has a log statement that says &quot;service initialised&quot;, but when I go on logcat and filter by <code>com.aidlinterface</code>, nothing is showing up, which tells me that the package is not attached. but I have added the package in:</p>\n<pre><code>dependencies {\n    implementation(project(&quot;:aidlInterface&quot;))\n...\n}\n</code></pre>\n<p>Here is the AIDL interface:</p>\n<pre><code>// IAIDLColorInterface.aidl\npackage com.aidlinterface;\n\n// Declare any non-default types here with import statements\n\ninterface IAIDLColorInterface {\n    /**\n     * Demonstrates some basic types that you can use as parameters\n     * and return values in AIDL.\n     */\n     int getColor();\n}\n</code></pre>\n<p>The same interface is present in the client app library.</p>\n<p>Here is the service in the server app:</p>\n<pre><code>package com.aidlinterface;\n\nimport android.app.Service;\nimport android.content.Intent;\nimport android.graphics.Color;\nimport android.os.IBinder;\nimport android.os.RemoteException;\nimport android.util.Log;\n\nimport java.util.Random;\n\npublic class AIDLColorService extends Service {\n\n    private static final String TAG =&quot;AIDLColorService&quot; ;\n\n    public AIDLColorService() {\n    }\n\n    @Override\n    public IBinder onBind(Intent intent) {\n        // TODO: Return the communication channel to the service.\n        return binder;\n    }\n\n    private final IAIDLColorInterface.Stub binder = new IAIDLColorInterface.Stub() {\n        @Override\n        public int getColor() throws RemoteException {\n            Random rnd = new Random();\n            int color = Color.argb(255, rnd.nextInt(256), rnd.nextInt(256), rnd.nextInt(256));\n            Log.d(TAG, &quot;getColor: &quot;+ color);\n            return color;\n        }\n    };\n}\n</code></pre>\n<p>The manifest for the server app's <code>aidlInterface</code> library:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;\n\n    &lt;application\n        android:label=&quot;@string/app_name&quot;\n        android:supportsRtl=&quot;true&quot;&gt;\n        &lt;service\n            android:name=&quot;.AIDLColorService&quot;\n            android:enabled=&quot;true&quot;\n            android:exported=&quot;true&quot;&gt;\n            &lt;intent-filter&gt;\n                &lt;action android:name=&quot;AIDLColorService&quot; /&gt;\n            &lt;/intent-filter&gt;\n        &lt;/service&gt;\n    &lt;/application&gt;\n\n&lt;/manifest&gt;\n</code></pre>\n<p>Here is the code from the client app where I am using this information:</p>\n<pre><code>&lt;civTAK imports&gt;\nimport com.aidlinterface.IAIDLColorInterface\n\nclass ColorPlugin(\nmapView:MapView ){\n\nprivate var AIDLColorService: IAIDLColorInterface? = null\n\nprivate val serviceConnection = object: ServiceConnection {\n    override fun onServiceConnected(name: ComponentName?, service:IBinder?){\n    AIDLColorService = IAIDLColorInterface.Stub.asInterface(service)\n    }\n    override fun onServiceDisconnected(name: ComponentName?){\n        AIDLColorService = null\n    }\n    init{\n        val serviceIntent = Intent(&quot;AIDLColorService&quot;)\n        serviceIntent.setPackage(&quot;com.aidlInterface&quot;)\n        pluginContext.bindService(serviceIntent, serviceConnection, Context.BIND_AUTO_CREATE)\n    override fun disposeImpl(){\n        pluginContext.unbindService(serviceConnection)\n    }\n\n    override fun onReceive(context:Context, intent: Intent){\n        // code for plugin\n\n        // CODE THAT CALLS SERVICE\n        b.setOnClickListener {\n    try {\n        val color = iADILColorService.color\n        it.setBackgroundColor(color)\n    } catch (e: RemoteException) {\n        // Handle exception\n    }\n}\n\n}\n</code></pre>\n<p>Any advice on this will be greatly appreciated. I understand this is a very vague problem, but I will try to answer any questions as best as possible!</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}