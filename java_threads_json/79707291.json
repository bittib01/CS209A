{
  "question": {
    "tags": [
      "java",
      "jvm",
      "unsafe",
      "low-level-code"
    ],
    "owner": {
      "account_id": 1845234,
      "reputation": 1276,
      "user_id": 1673705,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/abe6098dc122d57b2c7b1aa8f074723a?s=256&d=identicon&r=PG",
      "display_name": "barneypitt",
      "link": "https://stackoverflow.com/users/1673705/barneypitt"
    },
    "is_answered": false,
    "view_count": 178,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1752996933,
    "creation_date": 1752932766,
    "last_edit_date": 1752945143,
    "question_id": 79707291,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79707291/is-there-any-way-in-java-even-if-unsafe-to-instantiate-an-uninitialized-ob",
    "title": "Is there _any_ way in Java (even if &quot;unsafe&quot;) to instantiate an uninitialized object directly at a specified address?",
    "body": "<p>[Edit: This would not be done on (regular) heap memory; but direct ByteBuffer, or off-heap memory allocated through Unsafe, or MemorySegment (from FFM) are all possible candidates.]</p>\n<p>I'm aware that via Unsafe I can allocate a new uninitialised instance and, if I know the object size via e.g. jol or jamm, copy it to the desired location also via Unsafe. But this creates unnecessary garbage (though via escape analysis garbage creation might sometimes be avoided).</p>\n<p>For example are there any libraries with instrumentation that could do this?</p>\n<p>I'd rather avoid JNI because of the overhead. If the FFM enhancement enables this it would I expect be faster than JNI, but looking at a recent spec it looks as though it won't.</p>\n<p>Of course I'd rather avoid forking and then hacking the JVM if at all possible. May be there's some technique I haven't even thought of which would avoid that.</p>\n<p>And of course, I'm aware Unsafe is to be gradually excised from the JDK. But using Unsafe would prove a concept and have some limited life, before having to resort to hacking the JVM.</p>\n<p>My motivation is to enable really, really fast serialization and (often deep) copying, and to create collections of objects with much better memory locality than typical higgledy-piggledy heap-allocated objects, as part of prototyping a new (fast) JVM language.</p>\n<p>Please don't close the question because I'm &quot;asking for library recommendations&quot;, because I'm not. I simply want to know if it is possible at all (with or without 3rd party libraries) and not whether any such library is &quot;better than&quot; any other such library, if indeed any exists.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}