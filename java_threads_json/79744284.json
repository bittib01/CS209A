{
  "question": {
    "tags": [
      "java",
      "java-dateformat",
      "java-time",
      "date-formatting",
      "datetimeformatter"
    ],
    "owner": {
      "account_id": 11726648,
      "reputation": 26401,
      "user_id": 8583692,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/joGZ9.png?s=256",
      "display_name": "Mahozad",
      "link": "https://stackoverflow.com/users/8583692/mahozad"
    },
    "is_answered": true,
    "view_count": 586,
    "accepted_answer_id": 79744487,
    "answer_count": 1,
    "score": 4,
    "last_activity_date": 1761739872,
    "creation_date": 1755955384,
    "last_edit_date": 1761739872,
    "question_id": 79744284,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79744284/what-is-the-difference-between-withlocale-and-localizedby-in-java-datetimefo",
    "title": "What is the difference between withLocale() and localizedBy() in Java DateTimeFormatter?",
    "body": "<h2><code>DateTimeFormatter</code></h2>\n<p><a href=\"https://www.oracle.com/java/technologies/jf14-date-time.html\" rel=\"nofollow noreferrer\">Java 8 introduced a modern date and time API</a> with new types like <code>LocalDate</code> available in <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/package-summary.html\" rel=\"nofollow noreferrer\"><code>java.time.*</code></a> package. It also provided a new <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html\" rel=\"nofollow noreferrer\"><code>DateTimeFormatter</code></a> class for formatting (generating strings from) those dates and times.</p>\n<p>To create an instance of a <code>DateTimeFormatter</code>, one should use its static methods/fields or use the underlying <code>DateTimeFormatterBuilder</code> class like below examples:</p>\n<pre class=\"lang-java prettyprint-override\"><code>DateTimeFormatter.ofPattern(&quot;yyyy-MM-dd&quot;)\n// or\nDateTimeFormatter.ofLocalizedDate(FormatStyle.FULL)\n// or\nDateTimeFormatter.ISO_LOCAL_DATE_TIME\n// or\nnew DateTimeFormatterBuilder().appendValue(ChronoField.YEAR).toFormatter()\n</code></pre>\n<p>They all return an <a href=\"https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html#:%7E:text=This%20class%20is%20immutable%20and%20thread%2Dsafe.:%7E:text=This%20class%20is%20immutable%20and%20thread%2Dsafe.:%7E:text=Implementation%20Requirements%3A\" rel=\"nofollow noreferrer\">immutable <code>DateTimeFormatter</code></a> instance.</p>\n<h2>Localization</h2>\n<p>Now, it is possible to override/change some aspects of the formatter by calling the builder-like <code>.with***()</code> methods or similar on the <code>DateTimeFormatter</code> instance which create a new copy instance with that aspect changed:</p>\n<pre class=\"lang-java prettyprint-override\"><code>DateTimeFormatter\n        .ofPattern(&quot;yyyy-MM-dd&quot;)\n        .withChronology(JapaneseChronology.INSTANCE)        // New instance with this chronology\n        .withDecimalStyle(DecimalStyle.of(Locale.of(&quot;fa&quot;))) // New instance with this decimal style\n</code></pre>\n<p>But, localization (at least the numeral system) is not correct for these cases:</p>\n<ul>\n<li>When specifying no locale for the formatter (i.e. implicitly using the system/Java locale)</li>\n<li>When setting the default Java locale using <code>Locale.setDefault(myLocale);</code> and then creating a formatter instance and using it</li>\n<li>When using the locale in <code>ofPattern(&quot;...&quot;, myLocale)</code> method of <code>DateTimeFormatter</code></li>\n<li>When using the locale in <code>toFormatter(myLocale)</code> method of <code>DateTimeFormatterBuilder</code></li>\n<li>Even when explicitly using <a href=\"https://www.unicode.org/reports/tr35/#Locale_Extension_Key_and_Type_Data\" rel=\"nofollow noreferrer\">Unicode extensions</a> in the locale notation (like <code>Locale.forLanguageTag(&quot;en-u-nu-arabext&quot;)</code>), and using the resulting locale in <code>withLocale(myLocale)</code></li>\n</ul>\n<p>As for Java legacy <code>DateFormat</code>, ICU4J, and JavaScript explained below, all the above cases should produce proper digits according to the locale. But Java <code>DateTimeFormatter</code> requires an additional redundant <code>localizedBy(myLocale)</code> or <code>withDecimalStyle(DecimalStyle.of(myLocale))</code> call. Many/most people and even advanced programmers use the locale in <code>ofPattern()</code> method or in <code>withLocale()</code> instead of using <code>localizedBy()</code> and none of those correctly localize things like decimal style (digits/numbers). In my opinion, this is definitely a bug and not a feature:</p>\n<ul>\n<li><em><a href=\"https://github.com/thymeleaf/thymeleaf/issues/910\" rel=\"nofollow noreferrer\">Any DateTimeFormatter#withLocale should be replaced with DateTimeFormatter#localizedBy #910</a></em></li>\n<li><em><a href=\"https://stackoverflow.com/questions/47442317/how-to-format-a-date-by-any-locale-obtained-from-language-tag-with-java-time/47447560#47447560\">How to format a date by any locale obtained from language tag with java time?</a></em></li>\n<li>(corrected) <em><a href=\"https://stackoverflow.com/questions/39689866/how-to-format-localdate-object-to-mm-dd-yyyy-and-have-format-persist\">How to format LocalDate object to MM/dd/yyyy and have format persist</a></em></li>\n<li>(corrected) <em><a href=\"https://stackoverflow.com/questions/1661325/simpledateformat-and-locale-based-format-string/40920186#40920186\">SimpleDateFormat and locale based format string</a></em></li>\n<li>etc.</li>\n</ul>\n<p>Unlike <code>withLocale()</code>, the <code>localizedBy()</code> is not even mentioned in the top-level <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/time/format/DateTimeFormatter.html\" rel=\"nofollow noreferrer\">javadoc of <code>DateTimeFormatter</code> class</a> or, for example, <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/time/format/DateTimeFormatter.html#ofPattern(java.lang.String)\" rel=\"nofollow noreferrer\">javadoc of <code>ofPattern</code> method</a>.</p>\n<p>The legacy Java <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/text/DateFormat.html\" rel=\"nofollow noreferrer\"><code>DateFormat</code></a> and <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/text/SimpleDateFormat.html\" rel=\"nofollow noreferrer\"><code>SimpleDateFormat</code></a> classes properly localize digits:</p>\n<pre class=\"lang-java prettyprint-override\"><code>var myLocale = Locale.forLanguageTag(&quot;fa&quot;);\nvar formatter = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;, myLocale);\nvar myDate = formatter.parse(&quot;2025-06-28&quot;);\nformatter.format(myDate); // ۲۰۲۵-۰۶-۲۸\n</code></pre>\n<p><a href=\"https://unicode-org.github.io/icu/userguide/icu4j/\" rel=\"nofollow noreferrer\">ICU4J</a> also correctly formats numbers for both legacy and modern Java types:</p>\n<pre class=\"lang-java prettyprint-override\"><code>var myLocale = Locale.forLanguageTag(&quot;fa&quot;);\nvar formatter = com.ibm.icu.text.SimpleDateFormat(&quot;yyyy-MM-dd&quot;, myLocale);\nvar myDate = LocalDate.of(2025, 6, 28);\nformatter.format(myDate); // ۱۴۰۴-۰۴-۰۷\n</code></pre>\n<p>As another example, JavaScript also properly localizes everything (including numerals) when formatting the dates with its <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleString\" rel=\"nofollow noreferrer\"><code>toLocaleString()</code></a> or <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toLocaleDateString\" rel=\"nofollow noreferrer\"><code>toLocaleDateString()</code></a> methods:</p>\n<pre class=\"lang-js prettyprint-override\"><code>let myDate = new Date(2025, 5, 28);\nmyDate.toLocaleDateString(&quot;fa&quot;); // ۱۴۰۴/۴/۷\n</code></pre>\n<h2>Question</h2>\n<ul>\n<li>What exactly are the differences between <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/time/format/DateTimeFormatter.html#withLocale(java.util.Locale)\" rel=\"nofollow noreferrer\"><code>withLocale()</code></a> and <a href=\"https://docs.oracle.com/en/java/javase/24/docs/api/java.base/java/time/format/DateTimeFormatter.html#localizedBy(java.util.Locale)\" rel=\"nofollow noreferrer\"><code>localizedBy()</code></a>?</li>\n<li>If <code>localizedBy()</code> produces a more thoroughly localized result, is there a reasonable use‑case for calling <code>withLocale()</code> instead?</li>\n</ul>\n<h2>Related</h2>\n<ul>\n<li><em><a href=\"https://stackoverflow.com/questions/62445359/how-can-i-localize-numbers-with-datetimeformatter\">How can I localize numbers with DateTimeFormatter?</a></em></li>\n<li><em><a href=\"https://stackoverflow.com/questions/78698589/whats-the-point-of-locale-in-datetimeformatter\">Whats the point of Locale in DateTimeFormatter?</a></em></li>\n<li><em><a href=\"https://stackoverflow.com/questions/65514207/unicode-icu-and-not-java-time-datetimeformatter-should-be-used-for-international\">Unicode ICU and not java.time.DateTimeFormatter should be used for international dates and times</a></em></li>\n<li><em><a href=\"https://en.wikipedia.org/wiki/Eastern_Arabic_numerals\" rel=\"nofollow noreferrer\">Eastern Arabic numerals</a></em></li>\n<li><em><a href=\"https://unicode-org.atlassian.net/browse/ICU-23071?focusedCommentId=185878\" rel=\"nofollow noreferrer\">Remove Locale Service Provider (localespi)</a></em></li>\n</ul>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}