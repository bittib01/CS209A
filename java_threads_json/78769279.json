{
  "question": {
    "tags": [
      "java",
      "apache-kafka",
      "apache-kafka-streams"
    ],
    "owner": {
      "account_id": 113326,
      "reputation": 2545,
      "user_id": 298522,
      "user_type": "registered",
      "accept_rate": 71,
      "profile_image": "https://www.gravatar.com/avatar/b4ce59e3327820f4a12173483a24016f?s=256&d=identicon&r=PG",
      "display_name": "Logan",
      "link": "https://stackoverflow.com/users/298522/logan"
    },
    "is_answered": true,
    "view_count": 1344,
    "accepted_answer_id": 78769865,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1722133630,
    "creation_date": 1721390647,
    "last_edit_date": 1721397965,
    "question_id": 78769279,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78769279/kafka-streams-filter-messages-using-headers",
    "title": "Kafka-streams filter messages using headers",
    "body": "<p>We're trying to use kafka streams for our project to read data from one topic and write to another, and we have a use case to use KafkaHeaders as a mechanism to filter our certain records.</p>\n<p>Example, in input topic, you get data of all students belonging to a school. And now in output topic, you only want information about a subset of students based on their class.</p>\n<p>Record:</p>\n<pre><code>student_name | student_id | student_class\n</code></pre>\n<p>Initially we thought we will use the student object to do this, but that means that we need to deserialize the object and then do the filtering. Instead of that, what we want to do is pass headers with each record. This header will have class information of the students.</p>\n<p>Header:</p>\n<pre><code>class: v\n</code></pre>\n<p>We were wondering if there's a way to do this using kafka streams. We thought we can use the header in filter function, but filter function doesn't have header information.</p>\n<pre><code>    kstreams.filter((k,v) -&gt; {\n       howToAccessHeaders?\n})\n</code></pre>\n<p>We also tried using process function, but again, it's not clear to use how to filter out the record there.</p>\n<pre><code>kstream.process(new CustomerProcessor())\n</code></pre>\n<p>CustomProcessor:</p>\n<pre><code>class CustomProcessor implements Processor&lt;String, byte[], String, byte[]&gt; {\n\n    @Override\n    public void process(Record&lt;String, byte[]&gt; record) {\n        if(record.headers().lastHeader(&quot;class&quot;).value().toString() == &quot;v&quot;){\n            //Without return value, how does the record gets filtered? \n        }\n    }\n}\n</code></pre>\n<p>Is there something else that we can do to filter the records using the headers? Or is that not possible using kafkaStreams?</p>\n<p>PS: We tried using the tranform and transformValues functions, but they are now deprecated.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}