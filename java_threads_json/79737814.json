{
  "question": {
    "tags": [
      "java",
      "tomcat"
    ],
    "owner": {
      "account_id": 17436033,
      "reputation": 518,
      "user_id": 12639005,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD9BKI5xQp34xippuV_CnsMhoCVSn_rzQJzfqiD=k-s256",
      "display_name": "Name Null",
      "link": "https://stackoverflow.com/users/12639005/name-null"
    },
    "is_answered": true,
    "view_count": 54,
    "accepted_answer_id": 79737869,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1755443645,
    "creation_date": 1755433232,
    "question_id": 79737814,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79737814/tomcat-embed-with-juli-cannot-separate-webapps-servlet-context-logging-from-cat",
    "title": "Tomcat embed with JULI cannot separate webapp&#39;s servlet context logging from Catalina container logging",
    "body": "<p>I'm using tomcat's JULI logger and the properties file to launch a Tomcat embed server, in which there is a single webapp named <code>myapp</code> on localhost. (working directory: <code>/Users/me/TomcatEmbedTest</code>)</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Main {\n    public static void main(String[] args) {\n        Tomcat tomcat = new Tomcat();\n        tomcat.setBaseDir(new File(&quot;resource&quot;).getAbsolutePath());\n        tomcat.setPort(8080);\n        tomcat.getConnector();\n        tomcat.addWebapp(&quot;/myapp&quot;, new File(&quot;/Users/me/TomcatEmbedTest/resource/webapps/myapp&quot;).getAbsolutePath());\n        try {\n            tomcat.start();\n        } catch (LifecycleException e) {\n            throw new RuntimeException(e);\n        }\n    }\n}\n</code></pre>\n<p>In order to use JULI, I used the following arguments:</p>\n<pre class=\"lang-none prettyprint-override\"><code>-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \n-Djava.util.logging.config.file=/Users/me/TomcatEmbedTest/resource/logging.properties\n</code></pre>\n<p>In the properties file I designate <code>myapp</code>'s servlet context log to be logged using <code>3myapp.org.apache.juli.AsyncFileHandler</code>, which logs to file with prefix <code>myapp</code>:</p>\n<pre class=\"lang-none prettyprint-override\"><code>3myapp.org.apache.juli.AsyncFileHandler.prefix = myapp.\n\norg.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/myapp].level = INFO\norg.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/myapp].handlers = 3myapp.org.apache.juli.AsyncFileHandler\n</code></pre>\n<p>For readability, the full properties file is appended at the bottom of the question.</p>\n<p>The test servlet only executes the following line:</p>\n<pre class=\"lang-java prettyprint-override\"><code>req.getServletContext().log(&quot;========my web app's log=====&quot;);\n</code></pre>\n<p>For readability, the full servlet class is appended at the bottom of the question.</p>\n<p>As I've configured in the properties file, when the application launches, it creates 3 log files in the <code>log</code> directory inside my tomcat-embed application.</p>\n<pre class=\"lang-bash prettyprint-override\"><code>.\n├── catalina.2025-08-17.log\n├── localhost.2025-08-17.log\n└── myapp.2025-08-17.log\n</code></pre>\n<p>However, the <code>localhost</code> log and <code>myapp</code> log is just empty. And the <code>ServletContext#log</code> log in my servlet goes to <code>catalina</code> log.</p>\n<p>When I deploy the same webapp inside a stand-alone tomcat, and use the same properties file, <code>ServletContext#log</code> log goes to separate log files declared in <code>logging.properties</code> file (in this case it is <code>myapp.2025-08-17.log</code>.</p>\n<p>I wonder if this is a bug for tomcat-embed, or tomcat-embed inherently does not support separate logs for webapps' servlet context log?</p>\n<p>My single test-purpose servlet:</p>\n<pre class=\"lang-java prettyprint-override\"><code>@WebServlet(&quot;/test&quot;)\npublic class TestServlet extends HttpServlet {\n    @Override\n    protected void doGet(HttpServletRequest req, HttpServletResponse resp)\n            throws ServletException, IOException {\n        req.getServletContext().log(&quot;========my web app's log=====&quot;);\n        resp.getWriter().write(&quot;Hello, this is /test servlet!&quot;);\n    }\n}\n</code></pre>\n<p>my properties file:</p>\n<pre class=\"lang-none prettyprint-override\"><code>handlers = java.util.logging.ConsoleHandler, 1catalina.org.apache.juli.AsyncFileHandler, 2localhost.org.apache.juli.AsyncFileHandler, 3myapp.org.apache.juli.AsyncFileHandler\n\n.handlers = 1catalina.org.apache.juli.AsyncFileHandler, java.util.logging.ConsoleHandler\n\n1catalina.org.apache.juli.AsyncFileHandler.level = FINE\n1catalina.org.apache.juli.AsyncFileHandler.directory = logs\n1catalina.org.apache.juli.AsyncFileHandler.prefix = catalina.\n1catalina.org.apache.juli.AsyncFileHandler.maxDays = 90\n1catalina.org.apache.juli.AsyncFileHandler.encoding = UTF-8\n\n2localhost.org.apache.juli.AsyncFileHandler.level = FINE\n2localhost.org.apache.juli.AsyncFileHandler.directory = logs\n2localhost.org.apache.juli.AsyncFileHandler.prefix = localhost.\n2localhost.org.apache.juli.AsyncFileHandler.maxDays = 90\n2localhost.org.apache.juli.AsyncFileHandler.encoding = UTF-8\n\n3myapp.org.apache.juli.AsyncFileHandler.level = FINE\n3myapp.org.apache.juli.AsyncFileHandler.directory = logs\n3myapp.org.apache.juli.AsyncFileHandler.prefix = myapp.\n3myapp.org.apache.juli.AsyncFileHandler.maxDays = 90\n3myapp.org.apache.juli.AsyncFileHandler.encoding = UTF-8\n\njava.util.logging.ConsoleHandler.level = FINE\njava.util.logging.ConsoleHandler.formatter = org.apache.juli.OneLineFormatter\njava.util.logging.ConsoleHandler.encoding = UTF-8\n\norg.apache.catalina.core.ContainerBase.[Catalina].level = INFO\norg.apache.catalina.core.ContainerBase.[Catalina].handlers = 1catalina.org.apache.juli.AsyncFileHandler\n\norg.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/myapp].level = INFO\norg.apache.catalina.core.ContainerBase.[Catalina].[localhost].[/myapp].handlers = 3myapp.org.apache.juli.AsyncFileHandler\n\n</code></pre>\n<p>My dependencies:</p>\n<pre class=\"lang-bash prettyprint-override\"><code>.\n├── tomcat-annotations-api-9.0.108-sources.jar\n├── tomcat-annotations-api-9.0.108.jar\n├── tomcat-embed-core-9.0.108-sources.jar\n├── tomcat-embed-core-9.0.108.jar\n├── tomcat-embed-logging-juli-9.0.0.M6-sources.jar\n└── tomcat-embed-logging-juli-9.0.0.M6.jar\n\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}