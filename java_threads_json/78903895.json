{
  "question": {
    "tags": [
      "java",
      "ssl",
      "keystore",
      "string-matching",
      "jks"
    ],
    "owner": {
      "account_id": 15446251,
      "reputation": 3215,
      "user_id": 11143113,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/af27ad0f9741c72f9705fbed4912bb19?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Ashar",
      "link": "https://stackoverflow.com/users/11143113/ashar"
    },
    "is_answered": true,
    "view_count": 275,
    "accepted_answer_id": 78917576,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1725266508,
    "creation_date": 1724370924,
    "last_edit_date": 1724686977,
    "question_id": 78903895,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78903895/list-specific-information-of-all-leaf-certificates-from-java-store-jks",
    "title": "List specific information of all LEAF certificates from java store JKS",
    "body": "<p>I wish to list only the signed certificates for our application and not the chain signing certificate from a java store i.e <code>&lt;jdk_home&gt;/jre/lib/security/cacerts</code> or any such JKS store.</p>\n<p>The idea that comes to mind is I will grab the value of <code>CN=</code> from the <code>Owner: </code> and check if it is present under <code>Issuer: </code> anywhere in the entire store. If found then it is not the signed cert but the signer's cert.</p>\n<pre><code>keytool -v -list -keystore cacerts -storepass &quot;changeit&quot;\n</code></pre>\n<p>Output:</p>\n<pre><code>Keystore type: JKS\nKeystore provider: SUN\n\nYour keystore contains 107 entries\n\n*******************************************\n*******************************************\n\n\nAlias name: verisignuniversalrootca [jdk]\nCreation date: Aug 25, 2016\nEntry type: trustedCertEntry\n\nOwner: CN=VeriSign Universal Root Certification Authority, OU=&quot;(c) 2008 VeriSign, Inc. - For authorized use only&quot;, OU=VeriSign Trust Network, O=&quot;VeriSign, Inc.&quot;, C=US\nIssuer: CN=VeriSign Universal Root Certification Authority, OU=&quot;(c) 2008 VeriSign, Inc. - For authorized use only&quot;, OU=VeriSign Trust Network, O=&quot;VeriSign, Inc.&quot;, C=US\nSerial number: 401ac46421b31321030ebbe4121ac51d\nValid from: Tue Apr 01 19:00:00 CDT 2008 until: Tue Dec 01 17:59:59 CST 2037\nCertificate fingerprints:\n         SHA1: 36:79:CA:35:66:87:72:30:4D:30:A5:FB:87:3B:0F:A7:7B:B7:0D:54\n         SHA256: 23:99:56:11:27:A5:71:25:DE:8C:EF:EA:61:0D:DF:2F:A0:78:B5:C8:06:7F:4E:82:82:90:BF:B8:60:E8:4B:3C\nSignature algorithm name: SHA256withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 1.3.6.1.5.5.7.1.12 Criticality=false\n0000: 30 5F A1 5D A0 5B 30 59   30 57 30 55 16 09 69 6D  0_.].[0Y0W0U..im\n0010: 61 67 65 2F 67 69 66 30   21 30 1F 30 07 06 05 2B  age/gif0!0.0...+\n0020: 0E 03 02 1A 04 14 8F E5   D3 1A 86 AC 8D 8E 6B C3  ..............k.\n0030: CF 80 6A D4 48 18 2C 7B   19 2E 30 25 16 23 68 74  ..j.H.,...0%.#ht\n0040: 74 70 3A 2F 2F 6C 6F 67   6F 2E 76 65 72 69 73 69  tp://logo.verisi\n0050: 67 6E 2E 63 6F 6D 2F 76   73 6C 6F 67 6F 2E 67 69  gn.com/vslogo.gi\n0060: 66                                                 f\n\n\n#2: ObjectId: 2.5.29.19 Criticality=true\nBasicConstraints:[\n  CA:true\n  PathLen:2147483647\n]\n\n#3: ObjectId: 2.5.29.15 Criticality=true\nKeyUsage [\n  Key_CertSign\n  Crl_Sign\n]\n\n#4: ObjectId: 2.5.29.14 Criticality=false\nSubjectKeyIdentifier [\nKeyIdentifier [\n0000: B6 77 FA 69 48 47 9F 53   12 D5 C2 EA 07 32 76 07  .w.iHG.S.....2v.\n0010: D1 97 07 19                                        ....\n]\n]\n\n\n\n*******************************************\n*******************************************\n\n\nAlias name: xrampglobalca [jdk]\nCreation date: Aug 25, 2016\nEntry type: trustedCertEntry\n\nOwner: CN=XRamp Global Certification Authority, O=XRamp Security Services Inc, OU=www.xrampsecurity.com, C=US\nIssuer: CN=XRamp Global Certification Authority, O=XRamp Security Services Inc, OU=www.xrampsecurity.com, C=US\nSerial number: 50946cec18ead59c4dd597ef758fa0ad\nValid from: Mon Nov 01 11:14:04 CST 2004 until: Sun Dec 31 23:37:19 CST 2034\nCertificate fingerprints:\n         SHA1: B8:01:86:D1:EB:9C:86:A5:41:04:CF:30:54:F3:4C:52:B7:E5:58:C6\n         SHA256: CE:CD:DC:90:50:99:D8:DA:DF:C5:B1:D2:09:B7:37:CB:E2:C1:8C:FB:2C:10:C0:FF:0B:CF:0D:32:86:FC:1A:A2\nSignature algorithm name: SHA1withRSA\nSubject Public Key Algorithm: 2048-bit RSA key\nVersion: 3\n\nExtensions:\n\n#1: ObjectId: 1.3.6.1.4.1.311.20.2 Criticality=false\n</code></pre>\n<p>i need to 2 step solution ...</p>\n<p>Step 1: Identify the value of <code>Owner: CN=</code> for all <code>Alias name:</code> and consider only if that value of <code>CN=</code> which is not the value of <code>Issuer: CN=</code></p>\n<p>Step 2: Once identified the <code>Alias name</code> from Step 1, I wish to get the below details for that Alias</p>\n<pre><code>`Alias name: ` value\n`Owner: CN=` value \n`Signature algorithm name:` value\n`Subject Public Key Algorithm:` value\n`Valid from:` value\n`until:` value\n</code></pre>\n<p>Expected output:</p>\n<pre><code>verisignuniversalrootca [jdk]\nVeriSign Universal Root Certification Authority\nSHA256withRSA\n2048-bit RSA key\nTue Apr 01 19:00:00 CDT 2008\nTue Dec 01 17:59:59 CST 2037\n</code></pre>\n<p>Note: the above is just a sample data which is incomplete.</p>\n<p>You can choose <code>&lt;jdk_home&gt;/jre/lib/security/cacerts</code> on your systems for a more realistic and reproducible example.</p>\n<p>I tried the below so far but it look its growing unclean so i m asking experts.</p>\n<pre><code>keytool -v -list -keystore cacerts -storepass &quot;changeit&quot; | awk '/Alias name:/ {print $3} /Owner: CN=/ {print substr($0, index($0,$4))}' | awk -F, '{print $1}'\n</code></pre>\n<p>I tried to convert cacerts to pkcs12 format and then print all client certs using openssl but it does not display all client cert information.</p>\n<p>Convert to PKCS12:</p>\n<pre><code>keytool -importkeystore -srckeystore cacerts -srcstorepass &quot;changeit&quot; -destkeystore my_cert.p12 -deststoretype PKCS12 -deststorepass &quot;changeit&quot; -noprompt\n</code></pre>\n<p>Display Client certs:</p>\n<pre><code>openssl pkcs12 -in /home/wladmin/my_cert.p12 -passin pass:'changeit' -passout pass:'changeit' -info -nokeys -clcerts -legacy\n\nMAC: sha256, Iteration 10000\nMAC length: 32, salt length: 20\nPKCS7 Encrypted data: PBES2, PBKDF2, AES-256-CBC, Iteration 10000, PRF hmacWithSHA256\nCertificate bag\nCertificate bag\nCertificate bag\nCertificate bag\nCertificate bag\nCertificate bag\n</code></pre>\n<p>Kindly suggest.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}