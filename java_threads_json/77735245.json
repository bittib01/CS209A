{
  "question": {
    "tags": [
      "java",
      "android",
      "permissions"
    ],
    "owner": {
      "account_id": 303639,
      "reputation": 559,
      "user_id": 612697,
      "user_type": "registered",
      "accept_rate": 100,
      "profile_image": "https://www.gravatar.com/avatar/1de611dc392b0251bf52532a12a8d3ec?s=256&d=identicon&r=PG",
      "display_name": "kralvarado",
      "link": "https://stackoverflow.com/users/612697/kralvarado"
    },
    "is_answered": true,
    "view_count": 6272,
    "accepted_answer_id": 77735795,
    "answer_count": 2,
    "score": 2,
    "last_activity_date": 1725235705,
    "creation_date": 1703923414,
    "last_edit_date": 1703925440,
    "question_id": 77735245,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/77735245/android-sdk-34-appcompatactivity-requestpermissions-does-not-display-permission",
    "title": "Android SDK 34 AppCompatActivity.requestPermissions does not display permission dialog, but does with Android SDK 29",
    "body": "<p>Originally I was trying to update my already published application with targetSdkVersion 30, to be compliant with Google's targetSdkVersion 33 requirement. This just made all kinds of trouble. I had to update my IAP calls, as well as Advert calls. I managed to update to the new API methods and start testing only to find that requesting permissions are no longer working! (<em>apologies for the frustration rant</em>).</p>\n<p>I understand about the permissions flow; declare what you need in the AndroidManifest.xml, then checking if shouldShowRequestPermissionRationale(), then make a call to requestPermissions(). Finally handle the user response in onRequestPermissionsResult().</p>\n<p>On the old build, Android 29 (tablet), and Android 34 (phone) everything works as expected.  When launching the application the file permissions dialog shows as the app starts up.</p>\n<p>Now with the updated version, Android 29 (tablet), the file permission dialog shows, and the app continues.  With Android 34 (phone) the file permission dialog does not show, and while debugging the onRequestPermissionsResult() method is called immediately with <strong>PERMISSION_DENIED</strong> response.  The app is acting as if the user selected <em>Deny &amp; Don't Ask Again</em> option from the permission dialog. The user is never offered the opportunity to accept, so the application informs the user and shuts down, as saving and sharing edited photos is the main function of the application.</p>\n<p>What puzzles me is that the same build works on Android 29, but not on Android 34.  So I'm inclined to believe the issue is with Android 34, unless there are some additional steps to take with the new API that is not required on Android 29.</p>\n<p>Has anyone else come across a similar issue?  If so, how did you resolve it?</p>\n<p>EDIT: Within my AppCompatActivity I'm requesting:</p>\n<pre><code>String[] permissionList = { Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE };\nrequestPermissions( permissionList, READ_STORAGE_RESPONSE );\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}