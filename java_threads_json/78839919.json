{
  "question": {
    "tags": [
      "java",
      "spring",
      "azure",
      "maven"
    ],
    "owner": {
      "account_id": 2275558,
      "reputation": 44,
      "user_id": 26662575,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/9f72014a1e5887a95a95f50c6adb66f2?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Kendricks L Camille",
      "link": "https://stackoverflow.com/users/26662575/kendricks-l-camille"
    },
    "is_answered": true,
    "view_count": 62,
    "accepted_answer_id": 78841095,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1724948533,
    "creation_date": 1722958759,
    "last_edit_date": 1724948533,
    "question_id": 78839919,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78839919/get-maven-to-build-a-java-application-using-the-values-from-the-application-prod",
    "title": "Get maven to build a java application using the values from the application-production.properties rather than from application.properties",
    "body": "<p>I am trying to deploy a spring application in production mode. When I run the application locally with the profile <strong>production</strong> and set the -Dspring.profiles.active=production, the application will using my sql database. However, when I build with maven and deploy to azure, the application runs in <strong>deployment</strong> mode. I have confirmed that it is deployment mode as none of the work is stored on the database unlike when it is ran locally. I can also confirm there is no rollback due to having a version string which I have displayed on the login page to let me know if my code is actually being deployed.</p>\n<p>Local - Production: Java 19 with Profile set to <strong>production</strong> and spring.profiles.active set to <strong>production</strong></p>\n<p><a href=\"https://i.sstatic.net/2nWv2XM6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/2nWv2XM6.png\" alt=\"img1\" /></a></p>\n<p>Local - Dev: Java 19 with Profile set to <strong>development</strong></p>\n<p><a href=\"https://i.sstatic.net/J1BSgt2C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/J1BSgt2C.png\" alt=\"img2\" /></a></p>\n<p>Deploy-Development:</p>\n<pre><code>mvn install -Pproduction;\naz login;\naz containerapp up --resource-group rg-group -n group-app-vaadin --source .;\n</code></pre>\n<p>Deploy-Production:</p>\n<pre><code>mvn install -Pproduction -Dspring.profiles.active=production; \naz login;\naz containerapp up --resource-group rg-group -n group-app-vaadin --source .;\n</code></pre>\n<p>Docker:</p>\n<pre><code>FROM eclipse-temurin:21-jre\nCOPY target/*.jar app.jar\nEXPOSE 8080\nENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/app.jar&quot;]\n</code></pre>\n<p>application.properties:</p>\n<pre><code>server.port=${PORT:8080}\nlogging.level.org.atmosphere=warn\nspring.mustache.check-template-location=false\n\n# Launch the default browser when starting the application in development mode\nvaadin.launch-browser=true\n\n# increases max file size the server will accept\nspring.servlet.multipart.max-file-size=30MB\nspring.servlet.multipart.max-request-size=30MB\n\n# To improve the performance during development.\n# For more information https://vaadin.com/docs/latest/integrations/spring/configuration#special-configuration-parameters\nvaadin.allowed-packages=com.vaadin,org.vaadin,com.GROUP,de.f0rce.signaturepad\nspring.jpa.defer-datasource-initialization=true\nspring.jpa.show-sql=true\n</code></pre>\n<p>application-production.properties:</p>\n<pre><code>spring.jpa.defer-datasource-initialization=false\nspring.jpa.show-sql=true\nspring.jpa.hibernate.ddl-auto=update\nspring.jpa.properties.hibernate.dialect=org.hibernate.dialect.SQLServer2012Dialect\nspring.datasource.driver-class-name=com.microsoft.sqlserver.jdbc.SQLServerDriver\nspring.datasource.url=jdbc:sqlserver://GROUP.database.windows.net:1433;encrypt=true;trustServerCertificate=false;loginTimeout=30;database=GROUP-db;\nspring.datasource.username=USERNAME\nspring.datasource.password=PASSWORD\n</code></pre>\n<p>pom.xml without dependecies</p>\n<pre class=\"lang-xml prettyprint-override\"><code>    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\n         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;!-- Project from https://start.vaadin.com/project/ed548501-5760-489f-8284-368a0c13d375 --&gt;\n    &lt;groupId&gt;com.group.app&lt;/groupId&gt;\n    &lt;artifactId&gt;group-webapp&lt;/artifactId&gt;\n    &lt;name&gt;Group Web App&lt;/name&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n    &lt;packaging&gt;jar&lt;/packaging&gt;\n\n    &lt;properties&gt;\n        &lt;java.version&gt;17&lt;/java.version&gt;\n        &lt;vaadin.version&gt;24.4.6&lt;/vaadin.version&gt;\n    &lt;/properties&gt;\n\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.2.7&lt;/version&gt;\n    &lt;/parent&gt;\n\n    &lt;repositories&gt;\n        &lt;!-- The order of definitions matters. Explicitly defining central here to make sure it has the highest priority. --&gt;\n\n        &lt;!-- Main Maven repository --&gt;\n        &lt;repository&gt;\n            &lt;id&gt;central&lt;/id&gt;\n            &lt;url&gt;https://repo.maven.apache.org/maven2&lt;/url&gt;\n            &lt;snapshots&gt;\n                &lt;enabled&gt;false&lt;/enabled&gt;\n            &lt;/snapshots&gt;\n        &lt;/repository&gt;\n        &lt;repository&gt;\n            &lt;id&gt;vaadin-prereleases&lt;/id&gt;\n            &lt;url&gt;\n                https://maven.vaadin.com/vaadin-prereleases/\n            &lt;/url&gt;\n        &lt;/repository&gt;\n        &lt;!-- Repository used by many Vaadin add-ons --&gt;\n        &lt;repository&gt;\n            &lt;id&gt;Vaadin Directory&lt;/id&gt;\n            &lt;url&gt;https://maven.vaadin.com/vaadin-addons&lt;/url&gt;\n            &lt;snapshots&gt;\n                &lt;enabled&gt;false&lt;/enabled&gt;\n            &lt;/snapshots&gt;\n        &lt;/repository&gt;\n    &lt;/repositories&gt;\n\n    &lt;pluginRepositories&gt;\n        &lt;!-- The order of definitions matters. Explicitly defining central here to make sure it has the highest priority. --&gt;\n        &lt;pluginRepository&gt;\n            &lt;id&gt;central&lt;/id&gt;\n            &lt;url&gt;https://repo.maven.apache.org/maven2&lt;/url&gt;\n            &lt;snapshots&gt;\n                &lt;enabled&gt;false&lt;/enabled&gt;\n            &lt;/snapshots&gt;\n        &lt;/pluginRepository&gt;\n        &lt;pluginRepository&gt;\n            &lt;id&gt;vaadin-prereleases&lt;/id&gt;\n            &lt;url&gt;\n                https://maven.vaadin.com/vaadin-prereleases/\n            &lt;/url&gt;\n        &lt;/pluginRepository&gt;\n    &lt;/pluginRepositories&gt;\n\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;com.vaadin&lt;/groupId&gt;\n                &lt;artifactId&gt;vaadin-bom&lt;/artifactId&gt;\n                &lt;version&gt;${vaadin.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n\n\n\n    &lt;build&gt;\n        &lt;defaultGoal&gt;spring-boot:run&lt;/defaultGoal&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n\n            &lt;plugin&gt;\n                &lt;groupId&gt;com.vaadin&lt;/groupId&gt;\n                &lt;artifactId&gt;vaadin-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${vaadin.version}&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;prepare-frontend&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n    &lt;profiles&gt;\n        &lt;profile&gt;\n            &lt;!-- Production mode is activated using -Pproduction --&gt;\n            &lt;id&gt;production&lt;/id&gt;\n            &lt;dependencies&gt;\n                &lt;!-- Exclude development dependencies from production --&gt;\n                &lt;dependency&gt;\n                    &lt;groupId&gt;com.vaadin&lt;/groupId&gt;\n                    &lt;artifactId&gt;vaadin-core&lt;/artifactId&gt;\n                    &lt;exclusions&gt;\n                        &lt;exclusion&gt;\n                            &lt;groupId&gt;com.vaadin&lt;/groupId&gt;\n                            &lt;artifactId&gt;vaadin-dev&lt;/artifactId&gt;\n                        &lt;/exclusion&gt;\n                    &lt;/exclusions&gt;\n                &lt;/dependency&gt;\n            &lt;/dependencies&gt;\n            &lt;build&gt;\n                &lt;plugins&gt;\n                    &lt;plugin&gt;\n                        &lt;groupId&gt;com.vaadin&lt;/groupId&gt;\n                        &lt;artifactId&gt;vaadin-maven-plugin&lt;/artifactId&gt;\n                        &lt;version&gt;${vaadin.version}&lt;/version&gt;\n                        &lt;executions&gt;\n                            &lt;execution&gt;\n                                &lt;goals&gt;\n                                    &lt;goal&gt;build-frontend&lt;/goal&gt;\n                                &lt;/goals&gt;\n                                &lt;phase&gt;compile&lt;/phase&gt;\n                            &lt;/execution&gt;\n                        &lt;/executions&gt;\n                    &lt;/plugin&gt;\n                &lt;/plugins&gt;\n            &lt;/build&gt;\n        &lt;/profile&gt;\n\n        &lt;profile&gt;\n            &lt;id&gt;development&lt;/id&gt;\n            &lt;activation&gt;\n                &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;\n            &lt;/activation&gt;\n            &lt;properties&gt;\n                &lt;activatedProperties&gt;development&lt;/activatedProperties&gt;\n            &lt;/properties&gt;\n        &lt;/profile&gt;\n    &lt;/profiles&gt;\n&lt;/project&gt;\n</code></pre>\n<p>First, I tried to debug the build and get maven to display which properties it was loading but couldn't pull it off.</p>\n<p>Then I tried to <code>mvn clean</code> and <code>mvn clean -Pproduction</code> in case the build was failing to change the value then attempt another build.</p>\n<p>Finally, I simply changed all my application.properties to be exactly the same and made them look what I expected application-production.properties to look like. That still failed to deploy with the values that I see in Local-Production.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}