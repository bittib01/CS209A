{
  "question": {
    "tags": [
      "java",
      "sql-server",
      "sql-server-2008-r2",
      "mssql-jdbc"
    ],
    "owner": {
      "account_id": 28774663,
      "reputation": 21,
      "user_id": 22037635,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/AAcHTtdMdZdDBHenCFr9_eGHsKgh0Lf8T10yE_glJc56=k-s256",
      "display_name": "Thibault Coudert",
      "link": "https://stackoverflow.com/users/22037635/thibault-coudert"
    },
    "is_answered": true,
    "view_count": 119,
    "answer_count": 1,
    "score": 2,
    "last_activity_date": 1729673862,
    "creation_date": 1729596485,
    "last_edit_date": 1729673723,
    "question_id": 79113822,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79113822/java-1-8-sql-server-2008-r2-unable-to-run-query-when-encryption-is-activated",
    "title": "Java 1.8 / SQL Server 2008 R2 : unable to run query when encryption is activated",
    "body": "<p>I'm working in Java 1.8 and with a SQL Server 2008 R2 (I'm fully aware that it's not supported since a long time, but it's unfortunately not in my hand) which only support TLSv1.</p>\n<p>I use ms-sql jdbc to connect to the database and retrieve some data via a query. When setting the SQLServerDataSource, there is an option to enable/disable the encryption : setEncrypt(). I tried both modes with the exact same code :</p>\n<ul>\n<li><p>When encryption is disabled, the connection is successful (I can see it on SQL server side via this query : <code>SELECT * FROM sys.dm_exec_connections</code> with <code>encrypt_option = FALSE</code>) and I'm able to run the query to retrieve data.</p>\n</li>\n<li><p>When encryption is enabled, the connection is successful (I can see it on SQL server side via this query : <code>SELECT * FROM sys.dm_exec_connections</code> with <code>encrypt_option = TRUE</code>) but at the executeQuery() step I get this error : <code>com.microsoft.sqlserver.jdbc.SQLServerException: SQL Server did not return a response. The connection has been closed.</code></p>\n</li>\n</ul>\n<p>I tried several versions of mssql-jdbc : 6.2.2.jre8, 8.2.2.jre8 and 12.8.0.jre8. Same behavior.</p>\n<p>I also tried to adjust SSL protocol via JDBC (<code>dataSource.setSSLProtocol(&quot;TLSv1&quot;)</code>) or via java.security (<code>Security.setProperty(&quot;jdk.tls.disabledAlgorithms&quot;, ...)</code> and <code>Security.setProperty(&quot;jdk.certpath.disabledAlgorithms&quot;, ...)</code>) : no impact.</p>\n<p>Any idea what could explain this behavior ? As the encryption is the trigger, I guess it's related to TLS protocol, but I don't understand why it fails only at query execution step.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}