{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "mockito"
    ],
    "owner": {
      "account_id": 16866055,
      "reputation": 23,
      "user_id": 12195739,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAeLmW9XcQzHxvnxr8lzn-8SqbnNO6HxO5ydFp-5g=k-s256",
      "display_name": "Roman Gajardo Robles",
      "link": "https://stackoverflow.com/users/12195739/roman-gajardo-robles"
    },
    "is_answered": true,
    "view_count": 87,
    "accepted_answer_id": 79839217,
    "answer_count": 1,
    "score": 2,
    "last_activity_date": 1765060727,
    "creation_date": 1764951052,
    "last_edit_date": 1764957988,
    "question_id": 79839094,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79839094/classcastexception-monovoid-unit-test-java",
    "title": "ClassCastException Mono&lt;Void&gt; unit test Java",
    "body": "<p>i have the method in springboot that consume a endpoint</p>\n<pre class=\"lang-java prettyprint-override\"><code>public Mono&lt;Void&gt; mesaVisadoCalculadoraNotificar(NotificarIn in) {\n        setTimeoutErrorCode(&quot;MVC-01&quot;);\n        return Mono.fromCallable(() -&gt; {\n            WebTarget path = target.path(MesaVisadoCalculadora.NOTIFICAR.getUri());\n            \n            return restHelper.performRequest(path, in, new GenericType&lt;Void&gt;(){}, HttpAction.POST);\n        });\n    }\n}\n</code></pre>\n<p>and this test</p>\n<pre class=\"lang-java prettyprint-override\"><code>@Test\npublic void mesavisadoCalculadoraNotificaTest(){\n    when(target.path(Mockito.anyString())).thenReturn(target);\n    when(restHelper.performRequest(Mockito.any(WebTarget.class), Mockito.any(), Mockito.any(GenericType.class),Mockito.any(HttpAction.class))).thenReturn(Mono.empty());\n\n    Mono&lt;Void&gt; promise = agent.mesaVisadoCalculadoraNotificar(in);\n    promise.block()\n    Assertions.assertNotNull(promise);\n   \n\n}\n</code></pre>\n<p>but in the line promise.block() return ClassCastException, any idea what it might be,</p>\n<p>this is a error in console:</p>\n<pre class=\"lang-none prettyprint-override\"><code>MesavisadoCalculadoraAgentTest &gt; mesavisadoCalculadoraNotificaTest() FAILED\n    java.lang.ClassCastException at MesavisadoCalculadoraAgentTest.java:65\n\njava.lang.ClassCastException: reactor.core.publisher.MonoIgnorePublisher cannot be cast to java.lang.Void\n    at infrastructure.agent.apimesavisadocalculadora.MesaVisadoCalculadoraAgent.lambda$mesaVisadoCalculadoraNotificar$0(MesaVisadoCalculadoraAgent.java:45)\n    at reactor.core.publisher.MonoCallable.block(MonoCallable.java:81)\n    at reactor.core.publisher.MonoCallable.block(MonoCallable.java:74)\n    at infrastructure.agent.apimesavisadocalculadora.MesavisadoCalculadoraAgentTest.mesavisadoCalculadoraNotificaTest(MesavisadoCalculadoraAgentTest.java:65)\n    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.lang.reflect.Method.invoke(Method.java:498)\n    at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:686)\n    at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}