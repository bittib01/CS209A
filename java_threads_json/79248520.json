{
  "question": {
    "tags": [
      "java",
      "android",
      "kotlin",
      "google-gemini"
    ],
    "owner": {
      "account_id": 6409852,
      "reputation": 449,
      "user_id": 4969962,
      "user_type": "registered",
      "accept_rate": 38,
      "profile_image": "https://i.sstatic.net/KvuS1.jpg?s=256",
      "display_name": "Ayusch",
      "link": "https://stackoverflow.com/users/4969962/ayusch"
    },
    "is_answered": true,
    "view_count": 106,
    "accepted_answer_id": 79312752,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1735332093,
    "creation_date": 1733244525,
    "question_id": 79248520,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79248520/gemini-api-in-android-field-license-is-required-for-type-with-serial-name",
    "title": "Gemini Api in Android: Field &#39;license&#39; is required for type with serial name",
    "body": "<p>I'm trying out the template code for the Gemini API Starter template when creating a new project in Android Studio.</p>\n<p>The default template uses &quot;gemini-pro&quot; model which was deprecated long back (they didn't update the template), so I changed it to gemini-1.5-flash.</p>\n<p>But I've been getting a parsing error:</p>\n<pre><code>com.google.ai.client.generativeai.type.SerializationException: Something went wrong while trying to deserialize a response from the server.\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.type.GoogleGenerativeAIException$Companion.from(Exceptions.kt:39)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.GenerativeModel.generateContent(GenerativeModel.kt:88)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.GenerativeModel$generateContent$1.invokeSuspend(Unknown Source:15)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith(ContinuationImpl.kt:33)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.DispatchedTask.run(DispatchedTask.kt:106)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.internal.LimitedDispatcher$Worker.run(LimitedDispatcher.kt:115)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.scheduling.TaskImpl.run(Tasks.kt:103)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.scheduling.CoroutineScheduler.runSafely(CoroutineScheduler.kt:584)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.executeTask(CoroutineScheduler.kt:793)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.runWorker(CoroutineScheduler.kt:697)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.scheduling.CoroutineScheduler$Worker.run(CoroutineScheduler.kt:684)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W  Caused by: io.ktor.serialization.JsonConvertException: Illegal input: Field 'license' is required for type with serial name 'com.google.ai.client.generativeai.internal.api.server.CitationSources', but it was missing at path: $.candidates[0].citationMetadata.citationSources[0]\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.serialization.kotlinx.KotlinxSerializationConverter.deserialize(KotlinxSerializationConverter.kt:90)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.serialization.ContentConverterKt$deserialize$$inlined$map$1$2.emit(Emitters.kt:224)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.flow.FlowKt__BuildersKt$asFlow$$inlined$unsafeFlow$3.collect(SafeCollector.common.kt:116)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.serialization.ContentConverterKt$deserialize$$inlined$map$1.collect(SafeCollector.common.kt:113)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.flow.FlowKt__ReduceKt.firstOrNull(Reduce.kt:243)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.flow.FlowKt.firstOrNull(Unknown Source:1)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.serialization.ContentConverterKt.deserialize(ContentConverter.kt:123)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.plugins.contentnegotiation.ContentNegotiation.convertResponse$ktor_client_content_negotiation(ContentNegotiation.kt:230)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.plugins.contentnegotiation.ContentNegotiation$Plugin$install$2.invokeSuspend(ContentNegotiation.kt:262)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.plugins.contentnegotiation.ContentNegotiation$Plugin$install$2.invoke(Unknown Source:13)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.plugins.contentnegotiation.ContentNegotiation$Plugin$install$2.invoke(Unknown Source:6)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.util.pipeline.SuspendFunctionGun.loop(SuspendFunctionGun.kt:120)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.util.pipeline.SuspendFunctionGun.proceed(SuspendFunctionGun.kt:78)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.HttpClient$4.invokeSuspend(HttpClient.kt:177)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.HttpClient$4.invoke(Unknown Source:11)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.HttpClient$4.invoke(Unknown Source:6)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.util.pipeline.SuspendFunctionGun.loop(SuspendFunctionGun.kt:120)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.util.pipeline.SuspendFunctionGun.proceed(SuspendFunctionGun.kt:78)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.util.pipeline.SuspendFunctionGun.proceedWith(SuspendFunctionGun.kt:88)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.plugins.HttpCallValidator$Companion$install$2.invokeSuspend(HttpCallValidator.kt:142)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.plugins.HttpCallValidator$Companion$install$2.invoke(Unknown Source:13)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.plugins.HttpCallValidator$Companion$install$2.invoke(Unknown Source:6)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.util.pipeline.SuspendFunctionGun.loop(SuspendFunctionGun.kt:120)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.util.pipeline.SuspendFunctionGun.proceed(SuspendFunctionGun.kt:78)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.util.pipeline.SuspendFunctionGun.execute$ktor_utils(SuspendFunctionGun.kt:98)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.util.pipeline.Pipeline.execute(Pipeline.kt:77)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.client.call.HttpClientCall.bodyNullable(HttpClientCall.kt:88)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.APIController.generateContent(APIController.kt:198)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.APIController$generateContent$1.invokeSuspend(Unknown Source:15)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith(ContinuationImpl.kt:33)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.coroutines.DispatchedTask.run(DispatchedTask.kt:108)\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W      ... 6 more\n2024-12-03 22:11:32.349  7350-7395  System.err              com.ayusch.genaitest                 W  Caused by: kotlinx.serialization.MissingFieldException: Field 'license' is required for type with serial name 'com.google.ai.client.generativeai.internal.api.server.CitationSources', but it was missing at path: $.candidates[0].citationMetadata.citationSources[0]\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableValue(StreamingJsonDecoder.kt:93)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeSerializableValue(AbstractDecoder.kt:43)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeSerializableElement(AbstractDecoder.kt:70)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableElement(StreamingJsonDecoder.kt:165)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.CompositeDecoder$DefaultImpls.decodeSerializableElement$default(Decoding.kt:533)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.internal.CollectionLikeSerializer.readElement(CollectionSerializers.kt:80)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.internal.AbstractCollectionSerializer.readElement$default(CollectionSerializers.kt:51)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.internal.AbstractCollectionSerializer.merge(CollectionSerializers.kt:36)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.internal.AbstractCollectionSerializer.deserialize(CollectionSerializers.kt:43)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableValue(StreamingJsonDecoder.kt:70)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeSerializableValue(AbstractDecoder.kt:43)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeSerializableElement(AbstractDecoder.kt:70)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableElement(StreamingJsonDecoder.kt:165)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.server.CitationMetadata$$serializer.deserialize(Types.kt:59)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.server.CitationMetadata$$serializer.deserialize(Types.kt:59)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableValue(StreamingJsonDecoder.kt:70)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeSerializableValue(AbstractDecoder.kt:43)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeNullableSerializableElement(AbstractDecoder.kt:79)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.server.Candidate$$serializer.deserialize(Types.kt:51)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.server.Candidate$$serializer.deserialize(Types.kt:51)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableValue(StreamingJsonDecoder.kt:70)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeSerializableValue(AbstractDecoder.kt:43)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeSerializableElement(AbstractDecoder.kt:70)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableElement(StreamingJsonDecoder.kt:165)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.CompositeDecoder$DefaultImpls.decodeSerializableElement$default(Decoding.kt:533)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.internal.CollectionLikeSerializer.readElement(CollectionSerializers.kt:80)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.internal.AbstractCollectionSerializer.readElement$default(CollectionSerializers.kt:51)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.internal.AbstractCollectionSerializer.merge(CollectionSerializers.kt:36)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.internal.AbstractCollectionSerializer.deserialize(CollectionSerializers.kt:43)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableValue(StreamingJsonDecoder.kt:70)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeSerializableValue(AbstractDecoder.kt:43)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.encoding.AbstractDecoder.decodeNullableSerializableElement(AbstractDecoder.kt:79)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.GenerateContentResponse$$serializer.deserialize(Response.kt:26)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.GenerateContentResponse$$serializer.deserialize(Response.kt:26)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableValue(StreamingJsonDecoder.kt:70)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.Json.decodeFromString(Json.kt:107)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at io.ktor.serialization.kotlinx.KotlinxSerializationConverter.deserialize(KotlinxSerializationConverter.kt:82)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      ... 36 more\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W  Caused by: kotlinx.serialization.MissingFieldException: Field 'license' is required for type with serial name 'com.google.ai.client.generativeai.internal.api.server.CitationSources', but it was missing\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.internal.PluginExceptionsKt.throwMissingFieldException(PluginExceptions.kt:20)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.server.CitationSources.&lt;init&gt;(Types.kt:64)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.server.CitationSources$$serializer.deserialize(Types.kt:64)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at com.google.ai.client.generativeai.internal.api.server.CitationSources$$serializer.deserialize(Types.kt:64)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      at kotlinx.serialization.json.internal.StreamingJsonDecoder.decodeSerializableValue(StreamingJsonDecoder.kt:70)\n2024-12-03 22:11:32.350  7350-7395  System.err              com.ayusch.genaitest                 W      ... 72 more\n\n</code></pre>\n<p>Has someone encountered this ?</p>\n<p>Saw this similar question where the API wasn't returning the required field, but it was supposedly fixed (was another field): <a href=\"https://stackoverflow.com/questions/78424640/gemini-api-android-serializationexception-when-deserializing-response-from-serv\">Gemini Api Android: SerializationException when deserializing response from server</a></p>\n<p>Thanks in advance</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}