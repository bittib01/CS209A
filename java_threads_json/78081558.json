{
  "question": {
    "tags": [
      "java",
      "mysql",
      "hibernate",
      "mysql-connector",
      "c3p0"
    ],
    "owner": {
      "account_id": 25298506,
      "reputation": 88,
      "user_id": 19123196,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/AATXAJxHwpS2Ll2l8qMarAMtd6wdDq0a8FbDm-YePzL3=k-s256",
      "display_name": "Aziz bouchtaoui",
      "link": "https://stackoverflow.com/users/19123196/aziz-bouchtaoui"
    },
    "is_answered": true,
    "view_count": 95,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1729243462,
    "creation_date": 1709211051,
    "question_id": 78081558,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78081558/java-application-faces-database-connection-errors-after-mysql-upgrade-to-version",
    "title": "Java Application Faces Database Connection Errors After MySQL Upgrade to Version 8",
    "body": "<p>I'm encountering an issue in a complex situation. I had MySQL 5 and recently upgraded it to MySQL 8. Since then, my Java application doesn't work properly when initially running on Tomcat.</p>\n<p>However, after updating the MySQL dependency in the pom.xml file, the issue persists.\nfrom</p>\n<pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.mariadb.jdbc&lt;/groupId&gt;\n    &lt;artifactId&gt;mariadb-java-client&lt;/artifactId&gt;\n    &lt;version&gt;1.7.3&lt;/version&gt;\n&lt;/dependency&gt;\n\n&lt;dependency&gt;\n   &lt;groupId&gt;mysql&lt;/groupId&gt;\n   &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\n</code></pre>\n<p>to</p>\n<pre><code>&lt;dependency&gt;\n   &lt;groupId&gt;org.mariadb.jdbc&lt;/groupId&gt;\n   &lt;artifactId&gt;mariadb-java-client&lt;/artifactId&gt;\n   &lt;version&gt;1.8.0&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n   &lt;groupId&gt;com.mysql&lt;/groupId&gt;\n   &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt;\n   &lt;version&gt;8.0.33&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>And now it's functional, but I'm encountering an issue with the database. I'm consistently getting 'too many connection' errors. When I execute the query SHOW PROCESSLIST;, I receive the following result:\n<a href=\"https://i.sstatic.net/oJaGL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/oJaGL.png\" alt=\"enter image description here\" /></a></p>\n<p>I have around 200 lines similar to this user1 in my result. and ialready set <code>max_connexion=200</code>;</p>\n<p>When I searched for 'database1' within my codebase, I found it referenced in the persistence.xml file with the following configuration:</p>\n<pre><code>&lt;properties&gt;\n        \n            &lt;property name=&quot;hibernate.connection.driver_class&quot; value=&quot;org.mariadb.jdbc.Driver&quot; /&gt;\n            &lt;property name=&quot;hibernate.dialect&quot; value=&quot;org.hibernate.dialect.MySQLDialect&quot; /&gt;\n            &lt;property name=&quot;hibernate.cache.use_second_level_cache&quot; value=&quot;true&quot; /&gt;\n            &lt;property name=&quot;hibernate.cache.use_query_cache&quot; value=&quot;true&quot; /&gt;\n            &lt;property name=&quot;hibernate.cache.region.factory_class&quot; value=&quot;org.hibernate.cache.ehcache.EhCacheRegionFactory&quot;/&gt;\n            &lt;property name=&quot;hibernate.cache.provider_class&quot;  value=&quot;org.hibernate.cache.EhCacheProvider&quot;  /&gt;\n            &lt;property name=&quot;hibernate.show_sql&quot; value=&quot;false&quot; /&gt;\n            &lt;property name=&quot;hibernate.format_sql&quot; value=&quot;false&quot; /&gt;\n            &lt;property name=&quot;hibernate.generate_statistics&quot; value=&quot;true&quot; /&gt;\n            &lt;property name=&quot;hibernate.connection.release_mode&quot; value=&quot;auto&quot; /&gt;\n            &lt;property name=&quot;hibernate.archive.autodetection&quot; value=&quot;class, hbm&quot;/&gt;\n            &lt;property name=&quot;hibernate.bytecode.use_reflection_optimizer&quot; value=&quot;true&quot;/&gt;\n            &lt;property name=&quot;hibernate.bytecode.provider&quot; value=&quot;javassist&quot;/&gt;\n\n\n            &lt;!-- create database schema at startup --&gt;\n            &lt;!-- not for real application --&gt;\n            &lt;!-- &lt;property name=&quot;hibernate.hbm2ddl.auto&quot; value=&quot;create&quot; /&gt; --&gt;\n\n\n            &lt;property name=&quot;connection.provider_class&quot;  value=&quot;org.hibernate.connection.C3P0ConnectionProvider&quot;/&gt;\n            &lt;property name=&quot;hibernate.c3p0.min_size&quot; value=&quot;5&quot; /&gt;\n            &lt;property name=&quot;hibernate.c3p0.max_size&quot; value=&quot;20&quot; /&gt;\n            &lt;property name=&quot;hibernate.c3p0.timeout&quot; value=&quot;3600&quot; /&gt; &lt;!-- &lt;property name=&quot;hibernate.c3p0.timeout&quot; value=&quot;1800&quot; /&gt; --&gt;\n            &lt;property name=&quot;hibernate.c3p0.idle_test_period&quot; value=&quot;3600&quot;/&gt; &lt;!-- idle_test_period &lt; timeout --&gt;\n            &lt;property name=&quot;hibernate.c3p0.max_statements&quot; value=&quot;50&quot; /&gt;\n            &lt;property name=&quot;hibernate.c3p0.preferredTestQuery&quot; value=&quot;SELECT 1&quot; /&gt;\n            &lt;property name=&quot;hibernate.c3p0.testConnectionOnCheckin&quot; value=&quot;true&quot; /&gt;\n            &lt;property name=&quot;hibernate.c3p0.testConnectionOnCheckout&quot; value=&quot;false&quot; /&gt; &lt;!-- pas recommand√© : http://www.mchange.com/projects/c3p0/ --&gt;&lt;!-- &lt;property name=&quot;c3p0.testConnectionOnCheckout&quot; value=&quot;true&quot; /&gt; --&gt;\n \n             &lt;property name=&quot;hibernate.connection.url&quot; value=&quot;jdbc:mysql://${serverNameBD}:${portNumberBD}/${databaseNameBD}&quot;/&gt;\n             &lt;property name=&quot;hibernate.connection.driver_class&quot; value=&quot;org.mariadb.jdbc.Driver&quot; /&gt;\n             &lt;property name=&quot;hibernate.connection.password&quot; value=&quot;${passwordBD}&quot; /&gt;\n              &lt;property name=&quot;hibernate.connection.username&quot; value=&quot;${userBD}&quot; /&gt;\n\n\n            &lt;property name=&quot;hibernate.connection.autoReconnect&quot; value=&quot;true&quot; /&gt;\n            &lt;property name=&quot;hibernate.connection.autoReconnectForPools&quot; value=&quot;true&quot; /&gt;\n            &lt;property name=&quot;hibernate.connection.is-connection-validation-required&quot; value=&quot;true&quot; /&gt;\n\n\n</code></pre>\n<p>In addition, for further information, in my hibernate.properties file, I have the following settings:</p>\n<pre><code>hibernate.connection.driver_class=com.mysql.jdbc.Driver\nhibernate.connection.url=jdbc:mysql://ip:3306/database100(not database1)\nhibernate.connection.username=user1\nhibernate.connection.password=passwrod\nhibernate.dialect=org.hibernate.dialect.MySQLInnoDBDialect\nhibernate.show_sql=true\njpa.dialect=org.springframework.orm.jpa.vendor.HibernateJpaDialect\njpa.vendor.adapter=HibernateJpaVendorAdapter\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}