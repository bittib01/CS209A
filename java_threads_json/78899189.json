{
  "question": {
    "tags": [
      "java",
      "optimization",
      "cplex"
    ],
    "owner": {
      "account_id": 4172969,
      "reputation": 17,
      "user_id": 3420303,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/5a2853023d6a813c257aaaf3b9b46036?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "filipemb",
      "link": "https://stackoverflow.com/users/3420303/filipemb"
    },
    "is_answered": false,
    "view_count": 58,
    "answer_count": 1,
    "score": -1,
    "last_activity_date": 1740432612,
    "creation_date": 1724279236,
    "last_edit_date": 1740432612,
    "question_id": 78899189,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78899189/how-to-solve-p-median-with-java-cplex",
    "title": "How to Solve p-median with Java CPLEX?",
    "body": "<p>This is an equivalent model to the sample that ships with <code>CPLEX Studio/opl/examples/opl/pmedian</code>, but written in <code>OPL</code>. Here is the equivalent in Java:</p>\n<pre><code>import ilog.concert.IloConstraint;\nimport ilog.concert.IloException;\nimport ilog.concert.IloLinearNumExpr;\nimport ilog.concert.IloNumVar;\nimport ilog.concert.IloRange;\nimport ilog.cplex.IloCplex;\n\n\npublic class P_Median {\n\n    public static void main(String args[]) {\n        solveMe();\n    }\n\n    public static void solveMe() {\n\n        int p = 2;\n\n        int n = 4;   // customers\n        int m = 3;   // warehouses\n\n        String[] customers = { &quot;Albert&quot;, &quot;Bob&quot;, &quot;Chris&quot;, &quot;Daniel&quot; };\n        String[] warehouses = { &quot;Santa Clara&quot;, &quot;San Jose&quot;, &quot;Berkeley&quot; };\n        double[] demand = { 100.0, 80.0, 80.0, 70.0 };\n        double[][] distance = { {  2.0, 10.0, 50.0 },\n                                {  2.0, 10.0, 52.0 }, \n                                { 50.0, 60.0,  3.0 },\n                                { 40.0, 60.0,  1.0 } };\n\n        double[][]cost = new double [n][m];\n        for (int c = 0; c &lt; n; c++) {\n            for (int w = 0; w &lt; m; w++) {\n                cost[c][w] = demand[c]*distance[c][w];\n            }\n        }\n        System.out.println(&quot;cost   = [&quot;);\n        for (int c = 0; c &lt; n; c++) {\n            for (int w = 0; w &lt; m; w++) {\n                System.out.print(cost[c][w] + &quot;\\t&quot;);\n            }\n            System.out.print(&quot;\\n\\r&quot;);\n        }\n        System.out.println(&quot;]&quot;);\n\n        IloCplex cplex = null;\n\n        try {\n            // define new model\n            cplex  = new IloCplex();\n            //cplex.setParam(IloCplex.Param.Simplex.Display, 0);\n\n            //variables\n            IloNumVar[] openWarehouse = new IloNumVar[m];\n            for (int w = 0 ; w &lt; m; w++) {\n                openWarehouse[w] = cplex.boolVar(&quot;openWarehouse&quot;+&quot;_&quot;+w);\n            }\n\n            IloNumVar[][] shipToCustomer = new IloNumVar[n][m];\n            for (int c = 0; c &lt; n; c++) {\n                for (int w = 0; w &lt; m; w++) {\n                    shipToCustomer[c][w] = cplex.boolVar(&quot;shipToCustomer&quot;+&quot;_&quot;+c+&quot;_&quot;+w);\n                }\n            }\n\n            //objective\n            IloLinearNumExpr objective = cplex.linearNumExpr();\n            for (int c = 0; c &lt; n; c++) {\n                for (int w = 0; w &lt; m; w++) {\n                    objective.addTerm(cost[c][w],shipToCustomer[c][w]);\n                }\n            }\n            cplex.addMinimize(objective);\n\n            // constraints\n            IloConstraint[] shipConstraints = new IloConstraint[n];\n            IloLinearNumExpr[] shipConstraintExpression = new IloLinearNumExpr[n];\n            for (int c=0; c&lt;n; c++) {\n                shipConstraintExpression[c] = cplex.linearNumExpr();\n                for (int w=0; w&lt;m; w++) {\n                    shipConstraintExpression[c].addTerm(1.0, shipToCustomer[c][w]);\n                }\n                IloRange shipConstraint = cplex.addEq(shipConstraintExpression[c], 1);\n                shipConstraint.setName(&quot;shipConstraint&quot;+c);\n                shipConstraints[c]=shipConstraint;\n            }\n\n            IloLinearNumExpr openConstraintExpression = cplex.linearNumExpr();\n            for (int w=0; w&lt;m; w++) {\n                openConstraintExpression.addTerm(1.0, openWarehouse[w]);\n            }\n            IloRange openConstraint = cplex.addEq(openConstraintExpression, p);\n            openConstraint.setName(&quot;openConstraint&quot;);\n\n            IloConstraint[][] shipOpenConstraints = new IloConstraint[n][m];\n            IloLinearNumExpr[][] shipOpenExpression = new IloLinearNumExpr[n][m];\n            for (int c = 0; c &lt; n; c++) {\n                for (int w = 0; w &lt; m; w++) {\n                    shipOpenExpression[c][w] = cplex.linearNumExpr();\n                    shipOpenExpression[c][w].addTerm(1.0, shipToCustomer[c][w]);\n                    IloConstraint shipOpenConstraint = cplex.addLe(shipOpenExpression[c][w], openWarehouse[w]);\n                    shipOpenConstraint.setName(&quot;shipOpenConstraint&quot;+c+w);\n                    shipOpenConstraints[c][w]=shipOpenConstraint;\n                }\n            }\n\n            // solve model\n            if (cplex.solve()) {\n\n                System.out.println(&quot;\\nSolution status = &quot;+ cplex.getStatus()+&quot;\\n&quot;);\n                System.out.println(&quot;obj = &quot;+cplex.getObjValue());\n\n                System.out.println(&quot;openWarehouse   = [&quot;);\n                for (int w = 0 ; w &lt; m; w++) {\n                    System.out.print(cplex.getValue(openWarehouse[w]) + &quot;\\t&quot;);\n                }\n                System.out.println(&quot;]&quot;);\n\n\n                System.out.println(&quot;shipToCustomer   = [&quot;);\n                for (int c = 0; c &lt; n; c++) {\n                    for (int w = 0; w &lt; m; w++) {\n                        System.out.print(cplex.getValue(shipToCustomer[c][w]) + &quot;\\t&quot;);\n                    }\n                    System.out.print(&quot;\\n\\r&quot;);\n                }\n                System.out.println(&quot;]&quot;);\n\n                System.out.println(&quot;------ ship Constraints -----&quot;);\n                for (int c=0;c&lt;shipConstraints.length;c++) {\n                    System.out.print(((IloRange) shipConstraints[c])+&quot; -&gt; &quot;+&quot;\\t&quot;);\n                    System.out.print(&quot;slack constraint &quot;+(c+1)+&quot; = &quot;+cplex.getSlack((IloRange) shipConstraints[c])+&quot;\\n&quot;);\n                }\n\n                System.out.println(&quot;------ open Constraint -----&quot;);\n                System.out.print(((IloRange) openConstraint)+&quot; -&gt; &quot;+&quot;\\t&quot;);\n                System.out.print(&quot;slack constraint  = &quot;+cplex.getSlack((IloRange) openConstraint)+&quot;\\n&quot;);\n\n                System.out.println(&quot;------ ship Open Constraints -----&quot;);\n                for (int c = 0; c &lt; n; c++) {\n                    for (int w = 0; w &lt; m; w++) {\n                        System.out.print(((IloRange) shipOpenConstraints[c][w])+&quot; -&gt; &quot;+&quot;\\t&quot;);\n                        System.out.print(&quot;slack constraint &quot;+(c+1)+&quot;&quot;+(w+1)+&quot; = &quot;+cplex.getSlack((IloRange) shipOpenConstraints[c][w])+&quot;\\n&quot;);\n                    }\n                }\n\n\n            } else {\n                System.out.println(&quot;problem not solved&quot;);\n            }\n\n        } catch (IloException exc) {\n            exc.printStackTrace();\n        } finally {\n            if(cplex!=null) cplex.end();\n        }\n\n    }\n\n}\n</code></pre>\n<p>Can anyone please analyze if this solution is ok?</p>\n<p>An integer programming problem is a mathematical optimization or feasibility program in which some or all of the variables are restricted to be integers. In many settings, the term refers to integer linear programming (ILP), in which the objective function and the constraints (other than the integer constraints) are linear.</p>\n<p>Integer programming is NP-complete. In particular, the special case of 0-1 integer linear programming, in which unknowns are binary, and only the restrictions must be satisfied, is one of Karp's 21 NP-complete problems.</p>\n<p>If some decision variables are not discrete the problem is known as a mixed-integer programming problem.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}