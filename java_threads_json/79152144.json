{
  "question": {
    "tags": [
      "java",
      "firebase",
      "google-cloud-platform",
      "firebase-authentication",
      "google-cloud-functions"
    ],
    "owner": {
      "account_id": 30529587,
      "reputation": 3,
      "user_id": 23397875,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocJRt8TyTCss6dNs1JbzoNrqrvA_8TsFd0rkZImJElc3=k-s256",
      "display_name": "Parvanshu Sharma",
      "link": "https://stackoverflow.com/users/23397875/parvanshu-sharma"
    },
    "is_answered": true,
    "view_count": 366,
    "accepted_answer_id": 79154195,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1733605615,
    "creation_date": 1730614201,
    "last_edit_date": 1733605615,
    "question_id": 79152144,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79152144/firebase-phone-authentication-test-num-working-but-real-phone-num-showing-billi",
    "title": "Firebase Phone authentication test num working but real phone num showing [BILLING_NOT_ENABLED]",
    "body": "<p>I am trying to make an application that has only a mobile number login facility. I am using Firebase Auth, Firestore and Android Studio in Java to make it, I have 5 activities, Home(Splash only)&gt;LoginPhoneNumber&gt;LoginOTP&gt;EnterUsername&gt;MainScreen</p>\n<p>The user enters the mobile num with the country code picker in 2nd activity, and OTP is then sent, user enters received OTP in 3rd activity, enters username in 4th act. If otp is verified and is redirected to so called mainscreen.</p>\n<p>I have used &quot;+911234567890&quot; as test phone number with otp &quot;111111&quot;, and when I test run it with my app, everything works completely fine, all the toasts and code everything.</p>\n<p>But when I tried running my app with an actual my own phone number &quot;+919811226XXX&quot;, then in the LoginOTP activity I got toast saying, Firebase internal error occurred [BILLING_NOT_ENABLED], online I could not find any solutions, some said to activate some premium plan for more sms/day, but in free also i have a limit of 10 sms/day, I haven't used even 1 of it, then why is this error occurring, some said to enable google cloud billing account, but for that I need credit card details and all, which being a kid and student I don't have, neither the money, nor a card or any other verifiable payment option.</p>\n<p>Here's my LoginPhoneNumberActivity.java</p>\n<pre><code>package com.example.pchat;\n\npublic class LoginPhoneNumberActivity extends AppCompatActivity {\n\n    CountryCodePicker countryCodePicker;\n    EditText phoneInput;\n    Button sendOtpBtn;\n    ProgressBar progressBar;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        EdgeToEdge.enable(this);\n        setContentView(R.layout.activity_login_phone_number);\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.phone_login_screen), (v, insets) -&gt; {\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\n            return insets;\n        });\n\n        countryCodePicker = findViewById(R.id.login_countrycode);\n        phoneInput = findViewById(R.id.login_mobile_number);\n        sendOtpBtn = findViewById(R.id.send_otp_btn);\n        progressBar = findViewById(R.id.login_progress_bar);\n\n        progressBar.setVisibility(View.GONE);\n\n        countryCodePicker.registerCarrierNumberEditText(phoneInput);\n        sendOtpBtn.setOnClickListener((v)-&gt;{\n            if(!countryCodePicker.isValidFullNumber()){\n                phoneInput.setError(&quot;Phone number not valid&quot;);\n                return;\n            }\n            Intent intent = new Intent(LoginPhoneNumberActivity.this,LoginOtpActivity.class);\n            intent.putExtra(&quot;phone&quot;,countryCodePicker.getFullNumberWithPlus());\n            startActivity(intent);\n        });\n    }\n} \n</code></pre>\n<p>My LoginOtpActivity.java is given below -</p>\n<pre><code>package com.example.pchat;\n\npublic class LoginOtpActivity extends AppCompatActivity {\n\n    String phoneNumber;\n    Long timeoutSeconds = 60L;\n    String verificationCode;\n    PhoneAuthProvider.ForceResendingToken  resendingToken;\n\n    EditText otpInput;\n    Button nextBtn;\n    ProgressBar progressBar;\n    TextView resendOtpTextView;\n    FirebaseAuth mAuth = FirebaseAuth.getInstance();\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        EdgeToEdge.enable(this);\n        setContentView(R.layout.activity_login_otp);\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.login_otp_activity), (v, insets) -&gt; {\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\n            return insets;\n        });\n        otpInput = findViewById(R.id.login_otp);\n        nextBtn = findViewById(R.id.login_next_btn);\n        progressBar = findViewById(R.id.login_progress_bar);\n        resendOtpTextView = findViewById(R.id.resend_otp_textview);\n\n        phoneNumber = Objects.requireNonNull(getIntent().getExtras()).getString(&quot;phone&quot;);\n\n        sendOtp(phoneNumber,false);\n\n        nextBtn.setOnClickListener(v -&gt; {\n            String enteredOtp  = otpInput.getText().toString();\n            PhoneAuthCredential credential =  PhoneAuthProvider.getCredential(verificationCode,enteredOtp);\n            signIn(credential);\n        });\n\n        resendOtpTextView.setOnClickListener((v)-&gt;{\n            sendOtp(phoneNumber,true);\n        });\n\n    }\n\n    void sendOtp(String phoneNumber,boolean isResend){\n        startResendTimer();\n        setInProgress(true);\n        PhoneAuthOptions.Builder builder =\n                PhoneAuthOptions.newBuilder(mAuth)\n                        .setPhoneNumber(phoneNumber)\n                        .setTimeout(timeoutSeconds, TimeUnit.SECONDS)\n                        .setActivity(this)\n                        .setCallbacks(new PhoneAuthProvider.OnVerificationStateChangedCallbacks() {\n                            @Override\n                            public void onVerificationCompleted(@NonNull PhoneAuthCredential phoneAuthCredential) {\n                                AndroidUtil.showToast(getApplicationContext(), &quot;OTP verified successfully!&quot;);\n                                signIn(phoneAuthCredential);\n                                setInProgress(false);\n                            }\n\n                            @Override\n                            public void onVerificationFailed(@NonNull FirebaseException e) {\n                                String Fexceptions = e.getMessage();\n                                AndroidUtil.showToast(getApplicationContext(), Fexceptions);\n                                setInProgress(false);\n                            }\n\n                            @Override\n                            public void onCodeSent(@NonNull String s, @NonNull PhoneAuthProvider.ForceResendingToken forceResendingToken) {\n                                super.onCodeSent(s, forceResendingToken);\n                                verificationCode = s;\n                                resendingToken = forceResendingToken;\n                                AndroidUtil.showToast(getApplicationContext(),&quot;OTP sent successfully!&quot;);\n                                setInProgress(false);\n                            }\n                        });\n        if(isResend){\n            PhoneAuthProvider.verifyPhoneNumber(builder.setForceResendingToken(resendingToken).build());\n        }else{\n            PhoneAuthProvider.verifyPhoneNumber(builder.build());\n        }\n\n    }\n\n    void setInProgress(boolean inProgress){\n        if(inProgress){\n            progressBar.setVistoibility(View.VISIBLE);\n            nextBtn.setVisibility(View.GONE);\n        }else{\n            progressBar.setVisibility(View.GONE);\n            nextBtn.setVisibility(View.VISIBLE);\n        }\n    }\n\n    void signIn(PhoneAuthCredential phoneAuthCredential){\n        //login and go to next activity\n        setInProgress(true);\n        mAuth.signInWithCredential(phoneAuthCredential).addOnCompleteListener(new OnCompleteListener&lt;AuthResult&gt;() {\n            @Override\n            public void onComplete(@NonNull Task&lt;AuthResult&gt; task) {\n                setInProgress(false);\n                if(task.isSuccessful()){\n                    Intent intent = new Intent(LoginOtpActivity.this,LoginUsernameActivity.class);\n                    intent.putExtra(&quot;phone&quot;,phoneNumber);\n                    startActivity(intent);\n                    finish();\n                }else{\n                    AndroidUtil.showToast(getApplicationContext(),&quot;OTP verification failed&quot;);\n                }\n            }\n        });\n\n\n    }\n\n    void startResendTimer(){\n        resendOtpTextView.setEnabled(false);\n        Timer timer = new Timer();\n        timer.schedule(new TimerTask() {\n            @SuppressLint(&quot;DefaultLocale&quot;)\n            @Override\n            public void run() {\n                timeoutSeconds--;\n                resendOtpTextView.setText(String.format(&quot;Resend OTP after %d seconds&quot;, timeoutSeconds));\n                if(timeoutSeconds&lt;=0){\n                    timeoutSeconds =60L;\n                    timer.cancel();\n                    runOnUiThread(() -&gt; {\n                        resendOtpTextView.setEnabled(true);\n                    });\n                }\n            }\n        },0,1000);\n    }\n}\n</code></pre>\n<p>My LoginUsernameActivity.java Looks somewhat like this below.</p>\n<pre><code>package com.example.pchat;\npublic class LoginUsernameActivity extends AppCompatActivity {\n\n    EditText usernameInput;\n    Button letMeInBtn;\n    ProgressBar progressBar;\n    String phoneNumber;\n    UserModel userModel;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        EdgeToEdge.enable(this);\n        setContentView(R.layout.activity_login_username);\n        ViewCompat.setOnApplyWindowInsetsListener(findViewById(R.id.login_username_activity), (v, insets) -&gt; {\n            Insets systemBars = insets.getInsets(WindowInsetsCompat.Type.systemBars());\n            v.setPadding(systemBars.left, systemBars.top, systemBars.right, systemBars.bottom);\n            return insets;\n        });\n\n        usernameInput = findViewById(R.id.login_username);\n        letMeInBtn = findViewById(R.id.login_let_me_in_btn);\n        progressBar =findViewById(R.id.login_progress_bar);\n\n        phoneNumber = Objects.requireNonNull(getIntent().getExtras()).getString(&quot;phone&quot;);\n        getUsername();\n\n        letMeInBtn.setOnClickListener((v -&gt; {\n            setUsername();\n        }));\n    }\n\n    void setUsername(){\n\n        String username = usernameInput.getText().toString();\n        if(username.isEmpty() || username.length()&lt;3){\n            usernameInput.setError(&quot;Username length should be at least 3 chars&quot;);\n            return;\n        }\n        setInProgress(true);\n        if(userModel!=null){\n            userModel.setUsername(username);\n        }else{\n            userModel = new UserModel(phoneNumber,username, Timestamp.now(),FirebaseUtil.currentUserId());\n        }\n\n        FirebaseUtil.currentUserDetails().set(userModel).addOnCompleteListener(new OnCompleteListener&lt;Void&gt;() {\n            @Override\n            public void onComplete(@NonNull Task&lt;Void&gt; task) {\n                setInProgress(false);\n                if(task.isSuccessful()){\n                    Intent intent = new Intent(LoginUsernameActivity.this,HomeActivity.class);\n                    intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TASK );\n                    startActivity(intent);\n                    finish();\n                }\n            }\n        });\n\n    }\n\n    void getUsername(){\n        setInProgress(true);\n        FirebaseUtil.currentUserDetails().get().addOnCompleteListener(new OnCompleteListener&lt;DocumentSnapshot&gt;() {\n            @Override\n            public void onComplete(@NonNull Task&lt;DocumentSnapshot&gt; task) {\n                setInProgress(false);\n                if(task.isSuccessful()){\n                    userModel =    task.getResult().toObject(UserModel.class);\n                    if(userModel!=null){\n                        usernameInput.setText(userModel.getUsername());\n                    }\n                }\n            }\n        });\n    }\n\n    void setInProgress(boolean inProgress){\n        if(inProgress){\n            progressBar.setVisibility(View.VISIBLE);\n            letMeInBtn.setVisibility(View.GONE);\n        }else{\n            progressBar.setVisibility(View.GONE);\n            letMeInBtn.setVisibility(View.VISIBLE);\n        }\n    }\n}\n</code></pre>\n<p>I wanted to make a basic mobile phone login app using Firebase Auth. It worked perfectly fine with test phone numbers, but showing BILLING NOT ENABLED for a real phone number. What can I do? I don't have any money to put on this project. Also, earlier it used to work without any issue, same code, just 1-2 years back, everything used to be the same except this error.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}