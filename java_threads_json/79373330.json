{
  "question": {
    "tags": [
      "java",
      "android",
      "android-intent",
      "android-pendingintent",
      "android-sharing"
    ],
    "owner": {
      "account_id": 19776626,
      "reputation": 11,
      "user_id": 14482424,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/78f40c5b0d8a6ba15341ae12c3bfe85e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Arun-Khatri",
      "link": "https://stackoverflow.com/users/14482424/arun-khatri"
    },
    "is_answered": false,
    "view_count": 51,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1738671864,
    "creation_date": 1737438899,
    "last_edit_date": 1737696295,
    "question_id": 79373330,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79373330/clipboardmanager-onprimaryclipchangedlistener-not-called-after-copying-text-from",
    "title": "ClipboardManager.OnPrimaryClipChangedListener not called after copying text from share intent on some devices",
    "body": "<p>I am working on an Android app where I use a sharing intent to share text. If the user copies the text instead of sharing it through an app, I want to detect when the clipboard content changes using ClipboardManager.OnPrimaryClipChangedListener.</p>\n<p>However, on some devices, the onPrimaryClipChanged callback is not called when the text is copied from the share intent. This issue does not happen on all devices.</p>\n<p>Here is the relevant code:</p>\n<pre><code>private void setClipBoardManager() {\n    ClipboardManager clipboardManager = (ClipboardManager) getApplicationContext().getSystemService(Context.CLIPBOARD_SERVICE);\n    clipboardManager.addPrimaryClipChangedListener(new ClipboardManager.OnPrimaryClipChangedListener() {\n        @Override\n        public void onPrimaryClipChanged() {\n            try {\n                CharSequence copiedData = clipboardManager.getPrimaryClip().getItemAt(0).getText();\n                Log.d(TAG, &quot;onPrimaryClipChanged: &quot; + copiedData);\n            } catch (RuntimeException ex) {\n                Log.e(TAG, ex.getLocalizedMessage(), ex);\n                ex.printStackTrace();\n            }\n        }\n    });\n}\n</code></pre>\n<pre><code>public void share_text(String title, String subject, String text) {\n    int requestCode = 111;\n    Intent sharingIntent = new Intent(Intent.ACTION_SEND);\n    sharingIntent.setType(&quot;text/plain&quot;);\n    sharingIntent.putExtra(Intent.EXTRA_SUBJECT, subject);\n    sharingIntent.putExtra(Intent.EXTRA_TEXT, text);\n\n    PendingIntent pi = PendingIntent.getBroadcast(this, requestCode, new Intent(this, ShareBroadCast.class),\n            PendingIntent.FLAG_MUTABLE | PendingIntent.FLAG_UPDATE_CURRENT);\n    sharingIntent = Intent.createChooser(sharingIntent, title, pi.getIntentSender());\n\n    startActivity(sharingIntent);\n}\n\n</code></pre>\n<p>I verified that the clipboard manager is properly initialized.\nonPrimaryClipChanged works fine in other scenarios outside of the sharing intent.\nThe issue appears to be device-specific, but Iâ€™m not sure why.</p>\n<p>It also this error in tag:ClipboardService</p>\n<pre><code> Denying clipboard access to package.name, application is not in focus neither is a system service for user 0\n</code></pre>\n<p>I expected onPrimaryClipChanged to be triggered whenever the user copies text from the share intent on all devices.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}