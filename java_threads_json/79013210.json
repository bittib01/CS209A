{
  "question": {
    "tags": [
      "java",
      "android",
      "gradle",
      "android-gradle-plugin",
      "build.gradle"
    ],
    "owner": {
      "account_id": 1137878,
      "reputation": 746,
      "user_id": 1122549,
      "user_type": "registered",
      "accept_rate": 33,
      "profile_image": "https://www.gravatar.com/avatar/18ee8252f11d3bfa04356a1360db5898?s=256&d=identicon&r=PG",
      "display_name": "user1122549",
      "link": "https://stackoverflow.com/users/1122549/user1122549"
    },
    "is_answered": true,
    "view_count": 128,
    "accepted_answer_id": 79013256,
    "answer_count": 1,
    "score": 3,
    "last_activity_date": 1727154875,
    "creation_date": 1727067583,
    "last_edit_date": 1727154875,
    "question_id": 79013210,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79013210/android-app-throws-noclassdeffounderror-after-setting-gradle-sourcesets",
    "title": "Android app throws NoClassDefFoundError after setting Gradle SourceSets",
    "body": "<p>I am trying to understand how to set sourcesets in build.gradle.kts file. For that i have a test project. The project structure is as follows-<br />\napp<br />\n-src<br />\n<strong>--main</strong><br />\n---java<br />\n----com.example.myapplication<br />\n-----MainActivity.kt<br />\n<strong>--sample2</strong><br />\n---java<br />\n----com.example.myapp.legacy<br />\n-----LegacyFile.java<br /></p>\n<p>LegacyFile.java</p>\n<pre><code>package com.example.myapp.legacy;\n\npublic class LegacyFile {\n\n}\n</code></pre>\n<p>Here, i wan to create instance of LegacyFile inside MainActivity.kt file -</p>\n<pre><code>    override fun onCreate(savedInstanceState: Bundle?) {\n....\n        val legacyFile = LegacyFile()\n} \n</code></pre>\n<p>So, i added the following lines to app/build.gradle.kts file -</p>\n<pre><code>android {\n.....\n    sourceSets.getByName(&quot;main&quot;).apply {\n        kotlin.setSrcDirs(listOf(&quot;src/sample2/java&quot;))\n    } \n}\n</code></pre>\n<p>Now, the project compiles successfully. But, when i run the app it throws an exception -</p>\n<blockquote>\n<p>FATAL EXCEPTION: main\nProcess: com.example.myapplication, PID: 2436\njava.lang.NoClassDefFoundError: Failed resolution of:\nLcom/example/myapp/legacy/LegacyFile;\nat\ncom.example.myapplication.MainActivity.onCreate(MainActivity.kt:25)\n..... Caused by: java.lang.ClassNotFoundException: Didn't find class\n&quot;com.example.myapp.legacy.LegacyFile&quot; on path: DexPathList[[dex file\n&quot;/data/data/com.example.myapplication/code_cache/.overlay/base.apk/classes5.dex&quot;,\nzip file\n&quot;/data/app/~~5E7UPyWAZdlsGbzLHVOIJw==/com.example.myapplication-kmtHz5UXr_gzaXYqPtpKyA==/base.apk&quot;],nativeLibraryDirectories=[/data/app/~~5E7UPyWAZdlsGbzLHVOIJw==/com.example.myapplication-kmtHz5UXr_gzaXYqPtpKyA==/lib/x86_64,\n/system/lib64, /system_ext/lib64]]</p>\n</blockquote>\n<p>When i inspect the apk file, i can see LegacyFile -\n<a href=\"https://i.sstatic.net/CUp16yJr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/CUp16yJr.png\" alt=\"Android Studio apk viewer\" /></a></p>\n<p>Can someone please explain what i am doing wrong here?</p>\n<p>Thanks!</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}