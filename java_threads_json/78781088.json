{
  "question": {
    "tags": [
      "java",
      "sharepoint",
      "microsoft-graph-api",
      "azure-identity"
    ],
    "owner": {
      "account_id": 4051239,
      "reputation": 927,
      "user_id": 3330733,
      "user_type": "registered",
      "accept_rate": 38,
      "profile_image": "https://www.gravatar.com/avatar/a8c3470788c6cb43493b5d0c14c25c19?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Megan",
      "link": "https://stackoverflow.com/users/3330733/megan"
    },
    "is_answered": false,
    "view_count": 558,
    "answer_count": 1,
    "score": -1,
    "last_activity_date": 1721755286,
    "creation_date": 1721692008,
    "last_edit_date": 1721754774,
    "question_id": 78781088,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78781088/upload-large-file-to-share-point-using-graph-api-and-java",
    "title": "Upload large file to Share Point using Graph API and Java",
    "body": "<p>I am not able to use this code to upload large files to share point <a href=\"https://learn.microsoft.com/en-us/graph/sdks/large-file-upload?tabs=java\" rel=\"nofollow noreferrer\">as mentioned in the documentation</a>.\nThis returns an error as below:</p>\n<pre><code>com.microsoft.kiota.ApiException: generalException\nat com.microsoft.kiota.ApiExceptionBuilder.withMessage(ApiExceptionBuilder.java:45)\nat com.microsoft.graph.core.requests.upload.UploadResponseHandler.handleResponse(UploadResponseHandler.java:62)\nat com.microsoft.graph.core.requests.upload.UploadSliceRequestBuilder.put(UploadSliceRequestBuilder.java:69)\nat com.microsoft.graph.core.tasks.LargeFileUploadTask.uploadSlice(LargeFileUploadTask.java:207)\nat com.microsoft.graph.core.tasks.LargeFileUploadTask.upload(LargeFileUploadTask.java:131)\n</code></pre>\n<p>I am using the same code as mentioned in the documentation and the only change is the path of the file in share point. The variable <code>destinationWithDate</code> is some folder structure I need e.g. 2024/July/FolderA/FolderB/file.txt</p>\n<pre><code>UploadSession uploadSession = graphServiceClient.drives()\n            .byDriveId(drive.getId())\n            .items()\n            .byDriveItemId(&quot;root:/&quot;+destinationWithDate+&quot;:&quot;)\n            .createUploadSession()\n            .post(uploadSessionRequest);\n</code></pre>\n<p>The code fails at upload and the error returned does not tell much about it.</p>\n<pre><code>UploadResult&lt;DriveItem&gt; uploadResult = largeFileUploadTask.upload(maxAttempts, callback);\n</code></pre>\n<p>For the smaller files, this code works perfectly for me so I am assuming the <code>destinationWithDate</code> variable is not an issue:</p>\n<pre><code>graphServiceClient.drives().byDriveId(drive.getId()).items().byDriveItemId(&quot;root:/&quot; + destinationWithDate + &quot;:&quot;).content().put(fileStream);\n</code></pre>\n<p>I am using version 6.4.0 of Graph API. I tried a couple of older versions too but it did not help. Please help me with the larger file upload error. I could not find anything helpful so far related to larger file uploads using Graph API and Java.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}