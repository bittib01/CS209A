{
  "question": {
    "tags": [
      "java",
      "android",
      "qt",
      "qt6",
      "windowinsets"
    ],
    "owner": {
      "account_id": 19425263,
      "reputation": 133,
      "user_id": 14206874,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/3eb38d38433e60cc2d4c716adfe4a5ca?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Jiri Zaloudek",
      "link": "https://stackoverflow.com/users/14206874/jiri-zaloudek"
    },
    "is_answered": true,
    "view_count": 11691,
    "accepted_answer_id": 78962704,
    "answer_count": 2,
    "score": 10,
    "last_activity_date": 1739979082,
    "creation_date": 1722343605,
    "question_id": 78811818,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78811818/android-api-35-status-navigation-bar-color-height-from-java",
    "title": "Android API 35+ Status/Navigation bar color/height from Java",
    "body": "<p>So far I am using to set background color and get statusBar/navigationBar/cutout programaticaly from Java function,\nhowever its geting very old and most if its its deprecated in current Android API 35+.</p>\n<p>So I googled as much as I could, used many exmaples to rerite to new functions, however the height of statusBar, navigationBar and cutout always returns zero, which is obvioulsy wrong.</p>\n<p>In the following example I commented out by &quot;<strong>OLD</strong>&quot; how I use to use working code, by &quot;<strong>NEW</strong>&quot; which is not working new code, and by &quot;<strong>NOTE</strong>&quot; to is the open question I dont even know how to replace <strong>OLD</strong> by <strong>NEW</strong>.</p>\n<pre><code>package org.myapp.activity;\n\nimport org.qtproject.qt.android.QtNative;\nimport org.qtproject.qt.android.bindings.QtActivity;\n\nimport android.os.*;\nimport android.content.*;\nimport android.app.*;\n\nimport android.content.res.Resources;\nimport android.content.res.Configuration;\nimport android.util.DisplayMetrics;\n\nimport android.view.Display;\n\nimport android.hardware.display.DisplayManager;\nimport android.view.Surface;\nimport android.view.View;\nimport android.view.DisplayCutout;\nimport android.view.Window;\nimport android.view.WindowManager;\nimport android.view.WindowInsets;\nimport android.view.WindowInsetsController;\nimport android.graphics.Color;\n\nimport androidx.core.view.WindowInsetsCompat;\nimport androidx.core.view.WindowInsetsCompat.Type.InsetsType;\n\n\npublic class MyActivity extends QtActivity\n{\n    @Override\n    public void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setCustomStatusAndNavigationBar();\n    } // onCreate\n\n\n    void setCustomStatusAndNavigationBar() {\n\n        // First check sdk version, custom/transparent System_bars are only available after LOLLIPOP\n        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) {\n            Window window = getWindow();\n\n            // OLD: // The Window flag 'FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS' will allow us to paint the background of the status bar ourself and automatically expand the canvas\n            // OLD: // If you want to simply set a custom background color (including transparent) for the statusBar/navigationBar, use the following addFlags call\n            // OLD: window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS);\n            // NOTE: I found no mention if this is even needed when not using setStatusBarcolor() anymore, but will use WindowInsets.Type.statusBars() - my guess its not needed anymore\n\n            // OLD: // The Window flag 'FLAG_TRANSLUCENT_NAVIGATION' will allow us to paint the background of the navigation bar ourself\n            // OLD: // But we will also have to deal with orientation and OEM specifications, as the navigationBar may or may not depend on the orientation of the device\n            // OLD: window.addFlags(WindowManager.LayoutParams.FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS | WindowManager.LayoutParams.FLAG_TRANSLUCENT_NAVIGATION);     // DEPRECATED (NOTE: is this even needed as setStatusBarColor() and setNavigationBarColor() are deprecated?)\n\n            // OLD: window.getDecorView().setSystemUiVisibility(View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN);                 // DEPRECATED\n            // NOTE: Use WindowInsetsController instead (NOTE: is this even needed as setStatusBarColor() and setNavigationBarColor() are deprecated?)\n\n            // OLD: Set StatusBar Transparent\n            // OLD: window.setStatusBarColor(Color.TRANSPARENT);            // DEPRECATED\n            // NOTE: Draw proper background behind WindowInsets.Type#statusBars()} instead\n\n            // OLD: // Set NavigationBar to desired color (0xAARRGGBB) set alpha value to 0 if you want a solid color\n            // OLD: window.setNavigationBarColor(Color.TRANSPARENT);        // DEPRECATED\n            // NOTE: Draw proper background behind WindowInsets.Type#navigationBars() instead\n\n\n            // OLD: // Statusbar background is now transparent, but the icons and text are probably white and not really readable, as we have a bright background color\n            // OLD: // We set/force a light theme for the status bar to make those dark\n            // OLD: View decor = window.getDecorView();\n            // OLD: decor.setSystemUiVisibility(decor.getSystemUiVisibility() | View.SYSTEM_UI_FLAG_LIGHT_STATUS_BAR);          // DEPRECATED\n            // NOTE: Use WindowInsetsController#APPEARANCE_LIGHT_NAVIGATION_BARS instead. I guess something like:\n            window.insetsController?.setSystemBarsAppearance(WindowInsetsController.APPEARANCE_LIGHT_STATUS_BARS, WindowInsetsController.APPEARANCE_LIGHT_STATUS_BARS);     // for light mode, therefore dark foreground (text/icons)... NOTE: does it works on its own or do I need to set something specific, like addFlags() to make this work?\n            //window.insetsController?.setSystemBarsAppearance(0, WindowInsetsController.APPEARANCE_LIGHT_STATUS_BARS);     // for dark mode, therefore light foreground (text/icons)... NOTE: does it works on its own or do I need to set something specific, like addFlags() to make this work\n            \n            // NOTE: Use WindowInsetsController#APPEARANCE_LIGHT_STATUS_BARS instead. I guess something like:\n            window.insetsController?.setSystemBarsAppearance(WindowInsetsController.APPEARANCE_LIGHT_NAVIGATION_BARS, WindowInsetsController.APPEARANCE_LIGHT_NAVIGATION_BARS);     // for light mode, therefore dark foreground (text/icons)... NOTE: does it works on its own or do I need to set something specific, like addFlags() to make this work?\n            //window.insetsController?.setSystemBarsAppearance(0, WindowInsetsController.APPEARANCE_LIGHT_NAVIGATION_BARS);     // for dark mode, therefore light foreground (text/icons)... NOTE: does it works on its own or do I need to set something specific, like addFlags() to make this work\n\n        }\n    }\n\n    \n    // NOTE: used info from: outdated https://medium.com/javarevisited/how-to-get-status-bar-height-in-android-programmatically-c127ad4f8a5d / unfortunately not link to github so I cant use whole example inluding includes, which I assume is my main problem\n    public double statusBarHeight() {\n\n        // OLD: Using Resources (still working, but preferable use current API solution)\n        // double result = 0;\n        // int resourceId = getResources().getIdentifier(&quot;status_bar_height&quot;, &quot;dimen&quot;, &quot;android&quot;);\n        // if (resourceId &gt; 0) {\n        //    result = getResources().getDimension(resourceId);\n        // }\n        // return result;\n\n\n        // NEW: Using Window Insets (API 30+)\n        WindowInsets windowInsets = getWindow().getDecorView().getRootWindowInsets();\n        double statusBarHeight = windowInsets.getInsets(WindowInsets.Type.statusBars()).top;    // returns 0 all the time, why?\n    }\n\n    public int safeAreaTop() {\n\n        // OLD\n        // DisplayCutout cutout = getWindow().getDecorView().getRootWindowInsets().getDisplayCutout();\n        // if(cutout != null) {\n        //     int cutoutHeight = cutout.getSafeInsetTop();\n        //     if (cutoutHeight &gt; 0) {\n        //         return cutoutHeight;\n        //      }\n        // }\n        // return 0;\n\n        // NEW: Using Window Insets (API 30+)\n        WindowInsets windowInsets = getWindow().getDecorView().getRootWindowInsets();\n        int cutoutHeight = windowInsets.getInsets(WindowInsets.Type.displayCutout()).top;   // returns 0 all the time, but not sure if correctly as I use only Android Simualtor, but if statusBarHeight() solution is not working, I assume also this does not work\n        return cutoutHeight;\n    }\n\n    public double navigationBarHeight() {\n    \n        // OLD: Using Resources (still working, but preferable use current API solution)\n        // double result = 0;\n        // int resourceId = getResources().getIdentifier(&quot;navigation_bar_height&quot;, &quot;dimen&quot;, &quot;android&quot;);\n        // if (resourceId &gt; 0) {\n        //    result = getResources().getDimension(resourceId);\n        // }\n        // return result;\n\n\n        // New: Using Window Insets (API 30+)\n        WindowInsets windowInsets = getWindow().getDecorView().getRootWindowInsets();\n        double navigationBarHeight = windowInsets.getInsets(WindowInsets.Type.navigationBars()).bottom;     // returns 0 all the time, but not sure if correctly as I use only Android Simualtor without navigationBar, but if statusBarHeight() solution is not working, I assume also this does not work\n        return navigationBarHeight;\n    }\n\n    public int getNavigationBarPosition() {\n\n        Resources res = getResources();\n        int resourceId = res.getIdentifier(&quot;config_showNavigationBar&quot;, &quot;bool&quot;, &quot;android&quot;);\n        boolean hasMenu = false;\n        if (resourceId &gt; 0) {\n            hasMenu =  res.getBoolean(resourceId);\n        }\n        if (!hasMenu) {\n            return -1;\n        }\n\n\n        // NOTE: https://stackoverflow.com/questions/69724946/getdisplay-return-display\n        // Display display = getWindowManager().getDefaultDisplay();        // OLD: getDefaultDisplay() DEPRECATED\n        DisplayManager displayManager = (DisplayManager) getSystemService(Context.DISPLAY_SERVICE);     // NEW solution, currently untested\n        Display display = displayManager.getDisplay(Display.DEFAULT_DISPLAY);\n        int rotation = display.getRotation();\n\n        switch (rotation) {\n            case Surface.ROTATION_90:\n                return 1;\n            case Surface.ROTATION_180:\n                return 3;\n            case Surface.ROTATION_270:\n                return 2;\n            default:\n                return 0;\n        }\n    }\n}\n</code></pre>\n<p>can I kindly ask for a check and explanation what did I do wrong in here along with the correction how the proper working code shall looks like?</p>\n<p>PS: I am not an Java expert, I work in QT (so C++/QML), this is only thing needed for my app to manage from Java interface</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}