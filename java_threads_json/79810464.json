{
  "question": {
    "tags": [
      "java",
      "opensearch",
      "amazon-opensearch"
    ],
    "owner": {
      "account_id": 965625,
      "reputation": 904,
      "user_id": 1103606,
      "user_type": "registered",
      "accept_rate": 51,
      "profile_image": "https://www.gravatar.com/avatar/0d93cc650b93939ea91066fcb5aefae0?s=256&d=identicon&r=PG",
      "display_name": "Peter Penzov",
      "link": "https://stackoverflow.com/users/1103606/peter-penzov"
    },
    "is_answered": true,
    "view_count": 283,
    "closed_date": 1763110430,
    "accepted_answer_id": 79816874,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1762877624,
    "creation_date": 1762367125,
    "last_edit_date": 1762764158,
    "question_id": 79810464,
    "link": "https://stackoverflow.com/questions/79810464/migrate-elasticsearch-code-to-opensearch-multi-request-search",
    "closed_reason": "Needs more focus",
    "title": "Migrate Elasticsearch code to OpenSearch multi request search",
    "body": "<p>I have this code:</p>\n<pre><code>import org.elasticsearch.ElasticsearchException;\nimport org.elasticsearch.action.ActionListener;\nimport org.elasticsearch.action.DocWriteResponse.Result;\nimport org.elasticsearch.action.admin.indices.create.CreateIndexRequest;\nimport org.elasticsearch.action.admin.indices.create.CreateIndexResponse;\nimport org.elasticsearch.action.admin.indices.delete.DeleteIndexRequest;\nimport org.elasticsearch.action.bulk.BackoffPolicy;\nimport org.elasticsearch.action.bulk.BulkItemResponse;\nimport org.elasticsearch.action.bulk.BulkRequestBuilder;\nimport org.elasticsearch.action.bulk.BulkResponse;\nimport org.elasticsearch.action.bulk.Retry;\nimport org.elasticsearch.action.delete.DeleteResponse;\nimport org.elasticsearch.action.get.GetResponse;\nimport org.elasticsearch.action.get.MultiGetItemResponse;\nimport org.elasticsearch.action.get.MultiGetRequestBuilder;\nimport org.elasticsearch.action.get.MultiGetResponse;\nimport org.elasticsearch.action.index.IndexRequest;\nimport org.elasticsearch.action.index.IndexRequestBuilder;\nimport org.elasticsearch.action.index.IndexResponse;\nimport org.elasticsearch.action.search.ClearScrollRequest;\nimport org.elasticsearch.action.search.ClearScrollResponse;\nimport org.elasticsearch.action.search.MultiSearchRequestBuilder;\nimport org.elasticsearch.action.search.MultiSearchResponse;\nimport org.elasticsearch.action.search.SearchRequestBuilder;\nimport org.elasticsearch.action.search.SearchResponse;\nimport org.elasticsearch.action.search.SearchScrollRequestBuilder;\nimport org.elasticsearch.action.support.master.AcknowledgedResponse;\nimport org.elasticsearch.action.update.UpdateRequest;\nimport org.elasticsearch.action.update.UpdateResponse;\nimport org.elasticsearch.client.transport.TransportClient;\nimport org.elasticsearch.common.settings.Settings;\nimport org.elasticsearch.common.transport.InetSocketTransportAddress;\nimport org.elasticsearch.common.unit.TimeValue;\nimport org.elasticsearch.index.engine.DocumentMissingException;\nimport org.elasticsearch.index.reindex.BulkByScrollResponse;\nimport org.elasticsearch.index.reindex.DeleteByQueryAction;\nimport org.elasticsearch.index.reindex.DeleteByQueryRequestBuilder;\nimport org.elasticsearch.script.mustache.SearchTemplateRequestBuilder;\nimport org.elasticsearch.transport.client.PreBuiltTransportClient;\n\nprivate TransportClient client;\n\npublic List&lt;SearchResponse&gt; multiSearch(List&lt;SearchRequestBuilder&gt; requestList) {\n    try {\n      MultiSearchRequestBuilder multiBuilder = client.prepareMultiSearch();\n\n      for (SearchRequestBuilder request : requestList) {\n        multiBuilder.add(request);\n      }\n\n      MultiSearchResponse searchResponse = multiBuilder.execute().actionGet();\n\n      List&lt;SearchResponse&gt; responseList = new ArrayList&lt;&gt;();\n      for (MultiSearchResponse.Item item : searchResponse.getResponses()) {\n        responseList.add(item.getResponse());\n      }\n      return responseList;\n    } catch (Exception exception) {\n      throw new Exception();\n    }\n  }\n\n\n\nimport org.elasticsearch.ElasticsearchException;\nimport org.elasticsearch.action.ActionListener;\nimport org.elasticsearch.action.DocWriteResponse.Result;\nimport org.elasticsearch.action.admin.indices.create.CreateIndexRequest;\nimport org.elasticsearch.action.admin.indices.create.CreateIndexResponse;\nimport org.elasticsearch.action.admin.indices.delete.DeleteIndexRequest;\nimport org.elasticsearch.action.bulk.BackoffPolicy;\nimport org.elasticsearch.action.bulk.BulkItemResponse;\nimport org.elasticsearch.action.bulk.BulkRequestBuilder;\nimport org.elasticsearch.action.bulk.BulkResponse;\nimport org.elasticsearch.action.bulk.Retry;\nimport org.elasticsearch.action.delete.DeleteResponse;\nimport org.elasticsearch.action.get.GetResponse;\nimport org.elasticsearch.action.get.MultiGetItemResponse;\nimport org.elasticsearch.action.get.MultiGetRequestBuilder;\nimport org.elasticsearch.action.get.MultiGetResponse;\nimport org.elasticsearch.action.index.IndexRequest;\nimport org.elasticsearch.action.index.IndexRequestBuilder;\nimport org.elasticsearch.action.index.IndexResponse;\nimport org.elasticsearch.action.search.ClearScrollRequest;\nimport org.elasticsearch.action.search.ClearScrollResponse;\nimport org.elasticsearch.action.search.MultiSearchRequestBuilder;\nimport org.elasticsearch.action.search.MultiSearchResponse;\nimport org.elasticsearch.action.search.SearchRequestBuilder;\nimport org.elasticsearch.action.search.SearchResponse;\nimport org.elasticsearch.action.search.SearchScrollRequestBuilder;\nimport org.elasticsearch.action.support.master.AcknowledgedResponse;\nimport org.elasticsearch.action.update.UpdateRequest;\nimport org.elasticsearch.action.update.UpdateResponse;\nimport org.elasticsearch.client.transport.TransportClient;\nimport org.elasticsearch.common.settings.Settings;\nimport org.elasticsearch.common.transport.InetSocketTransportAddress;\nimport org.elasticsearch.common.unit.TimeValue;\nimport org.elasticsearch.index.engine.DocumentMissingException;\nimport org.elasticsearch.index.reindex.BulkByScrollResponse;\nimport org.elasticsearch.index.reindex.DeleteByQueryAction;\nimport org.elasticsearch.index.reindex.DeleteByQueryRequestBuilder;\nimport org.elasticsearch.script.mustache.SearchTemplateRequestBuilder;\nimport org.elasticsearch.transport.client.PreBuiltTransportClient;\n\nprivate TransportClient client\n\n\npublic class GroupSearchIndexRepository{\n\npublic SearchTemplateRequestBuilder getSearchTemplateRequestBuilder() {\n    try {\n      return new SearchTemplateRequestBuilder(client);\n    } catch (Exception exception) {\n      LOGGER.error(&quot;Search template request builder not available.&quot;, exception);\n        new Exception(&quot;error&quot;);\n    }\n      return null;\n  }\n\npublic SearchResponse searchScript(Map&lt;String, Object&gt; parameters, String scriptName) {\n        SearchTemplateRequestBuilder searchTemplateRequestBuilder = getSearchTemplateRequestBuilder();\n        SearchTemplateResponse response = searchTemplateRequestBuilder.setScript(scriptName)\n                .setScriptType(ScriptType.STORED).setScriptParams(parameters)\n                .setRequest(new SearchRequest(this.readIndex)).get();\n        return response.getResponse();\n    }\n}\n\npublic class GroupSearchIndexRepository groupSearchIndexRepository\n \n\nprivate JSONObject getGroupFromElastic(Map&lt;String, Object&gt; params, String searchTemplateName) {\n    SearchResponse response = groupSearchIndexRepository.searchScript(params, searchTemplateName);\n\n    if (response.getHits().getTotalHits() &gt; 0) {\n        try {\n            SearchHit hit = response.getHits().getAt(0);\n            String payload = hit.getSourceAsString();\n            return new JSONObject(payload);\n        } catch (Exception e) {\n            logger.info(&quot;exception - elastic response {}&quot;, response);\n            throw e;\n        }\n\n    } else {\n        return null;\n    }\n  }\n</code></pre>\n<p>how to migrate this code to aws opensearch? I can't find a proper replacement.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}