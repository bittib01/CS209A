{
  "question": {
    "tags": [
      "java",
      "single-sign-on",
      "glassfish"
    ],
    "owner": {
      "account_id": 33195885,
      "reputation": 11,
      "user_id": 25711710,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/8978776f6377a7454a8d77a91fabd03e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "herohannes",
      "link": "https://stackoverflow.com/users/25711710/herohannes"
    },
    "is_answered": false,
    "view_count": 41,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1721808964,
    "creation_date": 1719308953,
    "question_id": 78666588,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78666588/sso-for-glassfish7-software-portal",
    "title": "SSO for Glassfish7 Software Portal",
    "body": "<p>**web.xml ( Login.war ) **</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n...\n\n    &lt;display-name&gt;Login&lt;/display-name&gt;\n\n    &lt;welcome-file-list&gt;\n        &lt;welcome-file&gt;login.xhtml&lt;/welcome-file&gt;\n    &lt;/welcome-file-list&gt;\n\n    &lt;login-config&gt;\n        &lt;auth-method&gt;FORM&lt;/auth-method&gt;\n        &lt;realm-name&gt;jdbcRealm&lt;/realm-name&gt;\n        &lt;form-login-config&gt;\n            &lt;form-login-page&gt;/login.xhtml&lt;/form-login-page&gt;\n            &lt;form-error-page&gt;/login-error.xhtml&lt;/form-error-page&gt;\n        &lt;/form-login-config&gt;\n    &lt;/login-config&gt;\n\n    &lt;security-role&gt;\n        &lt;role-name&gt;USER&lt;/role-name&gt;\n    &lt;/security-role&gt;\n\n    &lt;security-role&gt;\n        &lt;role-name&gt;ADMIN&lt;/role-name&gt;\n    &lt;/security-role&gt;\n\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;jakarta.faces.webapp.FacesServlet&lt;/servlet-class&gt;\n        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n    &lt;/servlet&gt;\n\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;*.xhtml&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n\n    &lt;session-config&gt;\n        &lt;session-timeout&gt;30&lt;/session-timeout&gt;\n        &lt;cookie-config&gt;\n            &lt;name&gt;JSESSIONID&lt;/name&gt;\n            &lt;path&gt;/&lt;/path&gt;\n            &lt;http-only&gt;true&lt;/http-only&gt;\n            &lt;secure&gt;false&lt;/secure&gt; verwenden --&gt;\n        &lt;/cookie-config&gt;\n    &lt;/session-config&gt;\n\n    &lt;context-param&gt;\n        &lt;param-name&gt;org.primefaces.extensions.DELIVER_UNCOMPRESSED_RESOURCES&lt;/param-name&gt;\n        &lt;param-value&gt;false&lt;/param-value&gt;\n    &lt;/context-param&gt;\n\n    &lt;context-param&gt;\n        &lt;param-name&gt;primefaces.THEME&lt;/param-name&gt;\n        &lt;param-value&gt;nova-light&lt;/param-value&gt;\n    &lt;/context-param&gt;\n&lt;/web-app&gt;\n\n</code></pre>\n<p>**web.xml (Start.war) **</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n...\n\n    &lt;display-name&gt;Startleiste&lt;/display-name&gt;\n\n    &lt;welcome-file-list&gt;\n        &lt;welcome-file&gt;index.xhtml&lt;/welcome-file&gt;\n    &lt;/welcome-file-list&gt;\n\n    &lt;login-config&gt;\n        &lt;auth-method&gt;FORM&lt;/auth-method&gt;\n        &lt;realm-name&gt;jdbcRealm&lt;/realm-name&gt;\n        &lt;form-login-config&gt;\n            &lt;form-login-page&gt;/login/login.xhtml&lt;/form-login-page&gt;\n            &lt;form-error-page&gt;/login/login-error.xhtml&lt;/form-error-page&gt;\n        &lt;/form-login-config&gt;\n    &lt;/login-config&gt;\n\n    &lt;security-constraint&gt;\n        &lt;web-resource-collection&gt;\n            &lt;web-resource-name&gt;Protected Area&lt;/web-resource-name&gt;\n            &lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n        &lt;/web-resource-collection&gt;\n        &lt;auth-constraint&gt;\n            &lt;role-name&gt;ADMIN&lt;/role-name&gt;\n            &lt;role-name&gt;USER&lt;/role-name&gt;\n        &lt;/auth-constraint&gt;\n    &lt;/security-constraint&gt;\n\n    &lt;security-role&gt;\n        &lt;role-name&gt;USER&lt;/role-name&gt;\n    &lt;/security-role&gt;\n\n    &lt;security-role&gt;\n        &lt;role-name&gt;ADMIN&lt;/role-name&gt;\n    &lt;/security-role&gt;\n\n    &lt;servlet&gt;\n        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n        &lt;servlet-class&gt;jakarta.faces.webapp.FacesServlet&lt;/servlet-class&gt;\n        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;\n    &lt;/servlet&gt;\n\n    &lt;servlet-mapping&gt;\n        &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;\n        &lt;url-pattern&gt;*.xhtml&lt;/url-pattern&gt;\n    &lt;/servlet-mapping&gt;\n\n    &lt;session-config&gt;\n        &lt;session-timeout&gt;30&lt;/session-timeout&gt; &lt;!-- Timeout in Minuten --&gt;\n        &lt;cookie-config&gt;\n            &lt;name&gt;JSESSIONID&lt;/name&gt;\n            &lt;path&gt;/&lt;/path&gt;\n            &lt;http-only&gt;true&lt;/http-only&gt;\n            &lt;secure&gt;false&lt;/secure&gt; &lt;!-- Ã„ndern Sie dies zu true, wenn Sie HTTPS verwenden --&gt;\n        &lt;/cookie-config&gt;\n    &lt;/session-config&gt;\n\n    &lt;context-param&gt;\n        &lt;param-name&gt;org.primefaces.extensions.DELIVER_UNCOMPRESSED_RESOURCES&lt;/param-name&gt;\n        &lt;param-value&gt;false&lt;/param-value&gt;\n    &lt;/context-param&gt;\n\n    &lt;context-param&gt;\n        &lt;param-name&gt;primefaces.THEME&lt;/param-name&gt;\n        &lt;param-value&gt;nova-light&lt;/param-value&gt;\n    &lt;/context-param&gt;\n&lt;/web-app&gt;\n\n</code></pre>\n<p><strong>LoginController.java</strong> (Login.war)</p>\n<pre><code>package login.web;\n\nimport java.io.IOException;\nimport java.io.Serializable;\n\nimport jakarta.enterprise.context.RequestScoped;\nimport jakarta.faces.application.FacesMessage;\nimport jakarta.faces.context.FacesContext;\nimport jakarta.inject.Inject;\nimport jakarta.inject.Named;\nimport login.util.LoginService;\nimport login.util.entities.User;\n\n@RequestScoped\n@Named\npublic class LoginController implements Serializable {\n\n    private static final long serialVersionUID = -5346634778960677989L;\n\n    private static final String URL = &quot;myServerURL:8080&quot;;\n\n   \n    @Inject\n    private LoginService loginService;\n\n    private String username;\n    private String password;\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public String getPassword() {\n        return password;\n    }\n\n    public void setPassword(String password) {\n        this.password = password;\n    }\n\n    public void login() {\n        FacesContext context = FacesContext.getCurrentInstance();\n        User user = loginService.findUserByUsername(username);\n\n        if (user != null &amp;&amp; user.getPassword().equals(SHA256Util.hashPassword(password))) {\n            context.getExternalContext().getSessionMap().put(&quot;user&quot;, user);\n            try {\n                System.out.println(&quot;Login successful, redirecting to start page.&quot;);\n                context.getExternalContext().redirect(URL + &quot;/Start&quot;);\n            } catch (IOException e) {\n                System.out.println(&quot;Redirect failed: &quot; + e.getMessage());\n                e.printStackTrace();\n            }\n        } else {\n            System.out.println(&quot;Invalid username or password.&quot;);\n            context.addMessage(null,\n                    new FacesMessage(FacesMessage.SEVERITY_ERROR, &quot;Invalid username or password&quot;, null));\n        }\n    }\n\n    public void logout() {\n        FacesContext.getCurrentInstance().getExternalContext().invalidateSession();\n        try {\n            FacesContext.getCurrentInstance().getExternalContext().redirect(&quot;login.xhtml&quot;);\n        } catch (IOException e) {\n            System.out.println(&quot;Logout redirect failed: &quot; + e.getMessage());\n            e.printStackTrace();\n        }\n    }\n}\n\n</code></pre>\n<p>RedirektBean.java (Start.war)</p>\n<pre><code>package startleiste.glassfish;\n\nimport java.io.IOException;\nimport java.security.Principal;\n\nimport jakarta.enterprise.context.RequestScoped;\nimport jakarta.faces.context.ExternalContext;\nimport jakarta.faces.context.FacesContext;\nimport jakarta.inject.Named;\n\n@Named\n@RequestScoped\npublic class LoginRedirectBean {\n\n    public void redirectToLogin() {\n        ExternalContext externalContext = FacesContext.getCurrentInstance().getExternalContext();\n        try {\n            Principal userPrincipal = externalContext.getUserPrincipal();\n            if (userPrincipal == null) {\n                System.out.println(&quot;User ist nicht authentifiziert, Umleitung zur Login-Seite&quot;); \n                externalContext.redirect(&quot;myServerURL/Login&quot;);\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\n\n</code></pre>\n<p>Hello Everybody. I have a huge problem konfiguring SSO for my Glassfish7 application Server. I Want to develope a Software Portal with JSF, primefaces and Glassfish7 as a Application Server.</p>\n<p>The plan was to konfigure a central Login-page - &gt; after login User goes to the Navigationpage. If u access the navigation page without a login before, the application redirects you to login page.</p>\n<p>I did that in to different WARs\nLogin.war\nStart.war</p>\n<p>If i successfully logged in - the Application redirects me instantly to Login.war\nwhy is that ?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}