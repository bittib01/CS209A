{
  "question": {
    "tags": [
      "java",
      "maven",
      "apache-poi",
      "docx"
    ],
    "owner": {
      "account_id": 1171454,
      "reputation": 456,
      "user_id": 1148552,
      "user_type": "registered",
      "accept_rate": 67,
      "profile_image": "https://i.sstatic.net/yQ58B.jpg?s=256",
      "display_name": "Gehan",
      "link": "https://stackoverflow.com/users/1148552/gehan"
    },
    "is_answered": true,
    "view_count": 72,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1739153540,
    "creation_date": 1733219198,
    "question_id": 79247045,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79247045/how-can-i-merge-table-column-cells-in-a-docx-table-created-using-apache-poi",
    "title": "How can I merge table column cells in a .docx table created using Apache POI",
    "body": "<p>I am trying to merge cells in a generated table to have the effect displayed in the image.</p>\n<p><a href=\"https://i.sstatic.net/nStJHMrP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/nStJHMrP.png\" alt=\"enter image description here\" /></a></p>\n<p>How can I merge cells for this purpose in a Java application that uses Apache POI to generate a .docx file? Tried different combinations but did not obtain the expected effect.</p>\n<p>Once the cells are merged when a a lengthy text is added it should span all the merged cells' lengths not use one cell area.</p>\n<p><strong>Current output</strong></p>\n<p><a href=\"https://i.sstatic.net/ICXCllWk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/ICXCllWk.png\" alt=\"enter image description here\" /></a></p>\n<p><strong>Source Block</strong></p>\n<pre><code>// Add Reservation Details Header\n            XWPFParagraph reservationDetailsHeader = document.createParagraph();\n            XWPFRun reservationDetailsRun = reservationDetailsHeader.createRun();\n            reservationDetailsRun.setText(&quot;Reservation Details&quot;);\n            reservationDetailsRun.setFontFamily(&quot;DejaVu Serif&quot;);\n            reservationDetailsRun.setFontSize(12);\n            reservationDetailsRun.setBold(true);\n\n         // Add a line space below the header\n            addLineSpace(document);\n\n         // Create a new table for Reservation Details\n            XWPFTable reservationDetailsTable = document.createTable();\n\n         // First row with four columns\n            XWPFTableRow reservationRow1 = reservationDetailsTable.getRow(0);\n            reservationRow1.getCell(0).setText(&quot;Check-In Date:&quot;);\n            reservationRow1.getCell(1).setText(&quot;2024-12-20&quot;); // Sample date\n            reservationRow1.getCell(2).setText(&quot;No Of Nights :&quot;);\n            reservationRow1.getCell(3).setText(&quot;1&quot;);\n\n         // Second row with four columns\n            XWPFTableRow reservationRow2 = reservationDetailsTable.createRow();\n            reservationRow2.getCell(0).setText(&quot;Check-Out Date:&quot;);\n            reservationRow2.getCell(1).setText(&quot;2024-12-22&quot;); // Sample date\n            reservationRow2.getCell(2).setText(&quot;No Of Rooms :&quot;);\n            reservationRow2.getCell(3).setText(&quot;1&quot;);\n            \n         // Third row with 2 columns\n            XWPFTableRow reservationRow3 = reservationDetailsTable.createRow();\n            reservationRow3.getCell(0).setText(&quot;Room Type Per Rate:&quot;);\n            \n            reservationRow3.getCell(4).getCTTc().addNewTcPr().addNewGridSpan().setVal(BigInteger.valueOf(5));\n            reservationRow3.getCell(3).getCTTc().addNewTcPr().addNewGridSpan().setVal(BigInteger.valueOf(4));\n            reservationRow3.getCell(2).getCTTc().addNewTcPr().addNewGridSpan().setVal(BigInteger.valueOf(3));\n            reservationRow3.getCell(1).getCTTc().addNewTcPr().addNewGridSpan().setVal(BigInteger.valueOf(2));\n            reservationRow3.getCell(1).setText(&quot;Traditional Room (max occ. 2) - 1 King/Static&quot;);\n</code></pre>\n<p><strong>Dependencies</strong></p>\n<pre><code>  &lt;dependencies&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;\n  &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;\n  &lt;version&gt;5.2.5&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;\n    &lt;artifactId&gt;poi-ooxml-schemas&lt;/artifactId&gt;\n    &lt;version&gt;4.1.2&lt;/version&gt; &lt;!-- Compatible version for POI 5.2.3 --&gt;\n&lt;/dependency&gt;\n &lt;dependency&gt;\n    &lt;groupId&gt;org.apache.xmlbeans&lt;/groupId&gt;\n    &lt;artifactId&gt;xmlbeans&lt;/artifactId&gt;\n    &lt;version&gt;5.1.1&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n&lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n&lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n&lt;version&gt;2.20.0&lt;/version&gt; &lt;!-- Replace with your required version --&gt;\n&lt;/dependency&gt;\n</code></pre>\n  \n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}