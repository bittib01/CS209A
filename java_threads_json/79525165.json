{
  "question": {
    "tags": [
      "java",
      "eclipse",
      "maven",
      "jdbc",
      "jlink"
    ],
    "owner": {
      "account_id": 18719675,
      "reputation": 5,
      "user_id": 13647862,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/ee494cabb7d79d705d95efff5e02a357?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "DeRRoN",
      "link": "https://stackoverflow.com/users/13647862/derron"
    },
    "is_answered": true,
    "view_count": 167,
    "accepted_answer_id": 79535619,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1742971963,
    "creation_date": 1742552410,
    "last_edit_date": 1742824725,
    "question_id": 79525165,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79525165/how-do-i-add-a-missing-dependency-jdbc-drivermanager-to-custom-jre-that-gives",
    "title": "How do I add a missing dependency (JDBC DriverManager?) to custom JRE that gives SQLException?",
    "body": "<p>I am using <strong>Maven</strong> inside <strong>Eclipse</strong> to build a modular <strong>JavaFX</strong>-App plus custom <strong>JRE</strong> from Red Hats <strong>JDK 17</strong>. I achieved this by following multiple <a href=\"https://www.baeldung.com/jlink\" rel=\"nofollow noreferrer\">online</a> <a href=\"https://github.com/Oliver-Loeffler/JavaFXModularSpiDemo\" rel=\"nofollow noreferrer\">tutorials</a> as well as the <a href=\"https://maven.apache.org/plugins/maven-jlink-plugin/jlink-mojo.html\" rel=\"nofollow noreferrer\">Maven</a> and <a href=\"https://docs.oracle.com/javase/9/tools/jlink.htm\" rel=\"nofollow noreferrer\">jlink</a> documentation.\nEverything seems to be in order except the custom JRE is missing the JDBC DriverManager. At least that is my assumption because when I use the standard JRE the app works as intended.</p>\n<p>I tried fiddling with the pom.xml and the module-info to no avail and after more than a day of trial-and-error I am at my wits end.</p>\n<p><strong>What do I have to do in order to be able to use the app with the custom JRE?</strong></p>\n<p>I'd appreciate it if someone has one or more useful tips or at least can nudge me in the right direction.</p>\n<p>Using the standard JRE with the following command works fine:</p>\n<pre><code>java -jar myApp.jar\n</code></pre>\n<p>However, using the custom JRE with the following command...:</p>\n<pre><code>target\\myapp_jre\\bin\\java.exe -jar myApp.jar\n</code></pre>\n<p>...leads to this error:</p>\n<blockquote>\n<p>java.sql.SQLException: No suitable driver found for jdbc:oracle:thin:@ldap[...]</p>\n</blockquote>\n<p>The Java-JRE versions are identical:</p>\n<pre><code>c:\\dev\\myApp&gt;java -version\nopenjdk version &quot;17.0.13&quot; 2024-10-15 LTS\nOpenJDK Runtime Environment (Red_Hat-17.0.13.0+11-1) (build 17.0.13+11-LTS)\nOpenJDK 64-Bit Server VM (Red_Hat-17.0.13.0+11-1) (build 17.0.13+11-LTS, mixed mode, sharing)\n\nc:\\dev\\myApp&gt;target\\myapp_jre\\bin\\java.exe -version\nopenjdk version &quot;17.0.13&quot; 2024-10-15 LTS\nOpenJDK Runtime Environment (Red_Hat-17.0.13.0+11-1) (build 17.0.13+11-LTS)\nOpenJDK 64-Bit Server VM (Red_Hat-17.0.13.0+11-1) (build 17.0.13+11-LTS, mixed mode)\n</code></pre>\n<p>I use this command to build the app and custom JRE in Eclipse:</p>\n<pre><code>clean package javafx:jlink\n</code></pre>\n<p>This is my <strong>module-info.java</strong>:</p>\n<pre><code>module MYAPP {\n    exports de.ron.application;\n    exports de.ron.csv_import_export;\n    exports de.ron.databaseutils;\n    exports de.ron.gui;\n    exports de.ron.gui.dialogs;\n    exports de.ron.tools;\n\n    opens de.ron.application to javafx.fxml;\n    opens de.ron.gui to javafx.fxml;\n    opens de.ron.gui.dialogs to javafx.fxml;\n\n    requires com.fasterxml.jackson.core;\n    requires com.fasterxml.jackson.databind;\n\n    requires java.desktop;\n    requires java.base;\n    requires transitive java.sql;\n\n    requires javafx.fxml;\n    requires transitive javafx.controls;\n    requires transitive javafx.graphics;\n\n    requires org.apache.commons.lang3;\n    requires org.apache.logging.log4j;\n\n    uses java.sql.Driver;\n}\n</code></pre>\n<p>This is my <strong>pom.xml</strong>:</p>\n<pre><code>    &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;!DOCTYPE xml&gt;\n&lt;project xmlns=&quot;https://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;https://www.w3.org/2001/XMLSchema-instance&quot;\n         xsi:schemaLocation=&quot;https://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;groupId&gt;de.ron&lt;/groupId&gt;\n    &lt;artifactId&gt;myApp&lt;/artifactId&gt;\n    &lt;version&gt;0.9.1&lt;/version&gt;\n    &lt;properties&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;java.compiler&gt;17&lt;/java.compiler&gt;\n        &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n        &lt;javaFxVersion&gt;17.0.14&lt;/javaFxVersion&gt;\n        &lt;jacksonXmlVersion&gt;2.18.3&lt;/jacksonXmlVersion&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openjfx&lt;/groupId&gt;\n            &lt;artifactId&gt;javafx-controls&lt;/artifactId&gt;\n            &lt;version&gt;${javaFxVersion}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.openjfx&lt;/groupId&gt;\n            &lt;artifactId&gt;javafx-fxml&lt;/artifactId&gt;\n            &lt;version&gt;${javaFxVersion}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.oracle.database.jdbc&lt;/groupId&gt;\n            &lt;artifactId&gt;ojdbc11&lt;/artifactId&gt;\n            &lt;version&gt;23.7.0.25.01&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;\n            &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;\n            &lt;version&gt;3.17.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n            &lt;artifactId&gt;jackson-core&lt;/artifactId&gt;\n            &lt;version&gt;${jacksonXmlVersion}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n            &lt;version&gt;${jacksonXmlVersion}&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt;\n            &lt;artifactId&gt;log4j-core&lt;/artifactId&gt;\n            &lt;version&gt;2.24.3&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.14.0&lt;/version&gt;\n                    &lt;configuration&gt;\n                        &lt;release&gt;17&lt;/release&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.8.1&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;id&gt;copy-dependencies&lt;/id&gt;\n                        &lt;phase&gt;prepare-package&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;copy-dependencies&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;outputDirectory&gt;${project.build.directory}/libs&lt;/outputDirectory&gt;\n                            &lt;overWriteReleases&gt;false&lt;/overWriteReleases&gt;\n                            &lt;overWriteSnapshots&gt;false&lt;/overWriteSnapshots&gt;\n                            &lt;overWriteIfNewer&gt;true&lt;/overWriteIfNewer&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;\n                &lt;version&gt;3.7.1&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;phase&gt;package&lt;/phase&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;single&lt;/goal&gt;\n                        &lt;/goals&gt;\n                        &lt;configuration&gt;\n                            &lt;outputDirectory&gt;${project.basedir}&lt;/outputDirectory&gt;\n                            &lt;archive&gt;\n                                &lt;manifest&gt;\n                                    &lt;mainClass&gt;de.ron.application.Main&lt;/mainClass&gt;\n                                &lt;/manifest&gt;\n                            &lt;/archive&gt;\n                            &lt;descriptorRefs&gt;\n                                &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt;\n                            &lt;/descriptorRefs&gt;\n                            &lt;finalName&gt;myApp&lt;/finalName&gt;\n                            &lt;appendAssemblyId&gt;false&lt;/appendAssemblyId&gt;\n                        &lt;/configuration&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.openjfx&lt;/groupId&gt;\n                &lt;artifactId&gt;javafx-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;0.0.8&lt;/version&gt;\n                &lt;configuration&gt;\n                    &lt;stripDebug&gt;true&lt;/stripDebug&gt;\n                    &lt;compress&gt;2&lt;/compress&gt;\n                    &lt;noHeaderFiles&gt;true&lt;/noHeaderFiles&gt;\n                    &lt;noManPages&gt;true&lt;/noManPages&gt;\n                    &lt;launcher&gt;myapp&lt;/launcher&gt;\n                    &lt;jlinkImageName&gt;myapp_jre&lt;/jlinkImageName&gt;\n                    &lt;mainClass&gt;MYAPP/de.ron.application.Main&lt;/mainClass&gt;\n                    &lt;runtimePathOption&gt;MODULEPATH&lt;/runtimePathOption&gt;\n                    &lt;options&gt;\n                        &lt;option&gt;--module-path&lt;/option&gt;\n                        &lt;option&gt;${project.build.directory}/libs&lt;/option&gt;\n                    &lt;/options&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n<p>Finally, all libraries seem to be where they're supposed to be. At least on file system level. See the following images for reference.</p>\n<p><a href=\"https://i.sstatic.net/robRuLkZ.jpg\" rel=\"nofollow noreferrer\">assambly_libs_folder</a></p>\n<p><a href=\"https://i.sstatic.net/LRl5zOmd.jpg\" rel=\"nofollow noreferrer\">jar_contents</a></p>\n<p><a href=\"https://i.sstatic.net/mXkjviDs.jpg\" rel=\"nofollow noreferrer\">custom_jre_legal_folder_content</a></p>\n<p><strong>--------UPDATE--------</strong></p>\n<p>First, I switched to ojdbc17. However, as with ojdbc11, when I try to load the DriverManager manually as suggested by @MarkRotteveel in the comments with this line</p>\n<pre><code>Class.forName(&quot;oracle.jdbc.OracleDriver&quot;);\n</code></pre>\n<p>I get the following ClassNotFoundException.</p>\n<blockquote>\n<p>Exception in Application constructor Exception in thread &quot;main&quot;\njava.lang.RuntimeException: Unable to construct Application instance:\nclass de.ron.application.MainGuiStarter\nat javafx.graphics/com.sun.javafx.application.LauncherImpl.launchApplication1(Unknown\nSource)\nat javafx.graphics/com.sun.javafx.application.LauncherImpl.lambda$launchApplication$2(Unknown\nSource)\nat java.base/java.lang.Thread.run(Unknown Source) Caused by: java.lang.reflect.InvocationTargetException\nat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native\nMethod)\nat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(Unknown\nSource)\nat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown\nSource)\nat java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown\nSource)\nat java.base/java.lang.reflect.Constructor.newInstance(Unknown Source)\nat javafx.graphics/com.sun.javafx.application.LauncherImpl.lambda$launchApplication1$8(Unknown\nSource)\nat javafx.graphics/com.sun.javafx.application.PlatformImpl.lambda$runAndWait$12(Unknown\nSource)\nat javafx.graphics/com.sun.javafx.application.PlatformImpl.lambda$runLater$10(Unknown\nSource)\nat java.base/java.security.AccessController.doPrivileged(Unknown Source)\nat javafx.graphics/com.sun.javafx.application.PlatformImpl.lambda$runLater$11(Unknown\nSource)\nat javafx.graphics/com.sun.glass.ui.InvokeLaterDispatcher$Future.run(Unknown\nSource)\nat javafx.graphics/com.sun.glass.ui.win.WinApplication._runLoop(Native\nMethod)\nat javafx.graphics/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(Unknown\nSource)\n... 1 more Caused by: java.lang.NoClassDefFoundError: javax/management/InstanceAlreadyExistsException\nat java.base/java.lang.Class.forName0(Native Method)\nat java.base/java.lang.Class.forName(Unknown Source)\nat MYAPP@0.9.1/de.ron.databaseutils.DatabaseUtils.loadJdbcDriver(Unknown\nSource)\nat MYAPP@0.9.1/de.ron.application.MainAppController.updateDatabaseLibraryMainGui(Unknown\nSource)\nat MYAPP@0.9.1/de.ron.gui.MainGuiController.updateDatabase(Unknown\nSource)\nat MYAPP@0.9.1/de.ron.gui.MainGuiController.(Unknown Source)\nat MYAPP@0.9.1/de.ron.application.MainGuiStarter.(Unknown Source)\n... 14 more Caused by: java.lang.ClassNotFoundException: javax.management.InstanceAlreadyExistsException\nat java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(Unknown\nSource)\nat java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(Unknown\nSource)\nat java.base/java.lang.ClassLoader.loadClass(Unknown Source)\n... 21 more</p>\n</blockquote>\n<p>The class is present in the JAR at the given location. Nevertheless, it does not work and I also did not find any suitable solution to that problem online.\nAdding to my confusion is the fact that either @MarkRotteveel or @BasilBourque wrote in one of thier multiple contributions to similar problems that using Class.forName() should not be used. And to be honest, I didn't like the idea either when I first read it, because manually loading classes at runtime seems a bit &quot;dirty&quot; to me. ^_^Â° (I write that knowing that it is the legacy way of loading the driver.)</p>\n<p><strong>Anyway, are there any other tipps concerning the ClassNotFoundException, how to get the DriverManager to work, or should I switch to a different way of connecting to the database altogether in order to be able to use my custom JRE?</strong></p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}