{
  "question": {
    "tags": [
      "java",
      "angular",
      "spring",
      "spring-boot",
      "jwt"
    ],
    "owner": {
      "account_id": 41616869,
      "reputation": 1,
      "user_id": 30373557,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/da0fce62942452c0faa85f4d61544002?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Sergey Bazhukov",
      "link": "https://stackoverflow.com/users/30373557/sergey-bazhukov"
    },
    "is_answered": false,
    "view_count": 144,
    "answer_count": 2,
    "score": -1,
    "last_activity_date": 1764607196,
    "creation_date": 1746953967,
    "last_edit_date": 1747032730,
    "question_id": 79616321,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79616321/403-forbidden-on-login-via-browser-when-spring-boot-app-runs-from-jar-but-works",
    "title": "403 Forbidden on login via browser when Spring Boot app runs from JAR, but works in IDE and API clients",
    "body": "<p>I'm facing an issue with my Spring Boot application. When I run the app directly from my IDE, everything works fine â€” I can log in from my Angular frontend (via POST /login) without any problems.</p>\n<p>However, after I've packaged the app into a JAR file using <code>mvn clean install</code> and run it with <code>java -jar my-app.jar</code>, I get the following behavior:</p>\n<ul>\n<li><p>Logging in via Postman or Insomnia still works (POST request to /login returns token as expected).</p>\n</li>\n<li><p>Logging in via the Angular frontend (in the browser) fails with a 403 Forbidden error.</p>\n</li>\n</ul>\n<p>Backend logs show:</p>\n<blockquote>\n<p>HttpRequestMethodNotSupportedException: Request method 'GET' is not supported</p>\n</blockquote>\n<p>What I've checked:</p>\n<ul>\n<li>CORS configuration in SecurityConfiguration allows <code>http://localhost:4200</code> and includes POST method.</li>\n</ul>\n<pre class=\"lang-java prettyprint-override\"><code>public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        http.csrf(AbstractHttpConfigurer::disable)\n                .cors(cors -&gt; cors.configurationSource(request -&gt; {\n                    var corsConfiguration = new CorsConfiguration();\n                    corsConfiguration.setAllowedOriginPatterns(List.of(&quot;http://localhost:4200&quot;));\n                    corsConfiguration.setAllowedMethods(List.of(&quot;GET&quot;,&quot;PATCH&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, &quot;OPTIONS&quot;));\n                    corsConfiguration.setAllowedHeaders(List.of(&quot;Authorization&quot;, &quot;Content-Type&quot;));\n                    \n                    corsConfiguration.setAllowCredentials(true);\n                    return corsConfiguration;\n                }))\n                .authorizeHttpRequests(request -&gt; request\n                        .requestMatchers(&quot;/&quot;,&quot;/login&quot;,&quot;/join&quot;).permitAll()\n                        .requestMatchers(&quot;/users&quot;).hasRole(&quot;ADMIN&quot;)\n                        .requestMatchers(&quot;/uploads/**&quot;).permitAll()\n                        .anyRequest().authenticated())\n                .sessionManagement(manager -&gt; manager.sessionCreationPolicy(STATELESS))\n                .authenticationProvider(authenticationProvider())\n                .addFilterBefore(jwtAuthenticationFilter, UsernamePasswordAuthenticationFilter.class);\n        return http.build();\n    }\n</code></pre>\n<ul>\n<li>Angular is sending a POST request to <code>/login</code>.</li>\n</ul>\n<pre class=\"lang-js prettyprint-override\"><code>login(loginRequest: LoginRequest): Observable&lt;any&gt; {\n    this.dataService.log(true);\n    return this.http.post&lt;AuthResponse&gt;(`${environment.baseURL}/login`, loginRequest\n)\n    .pipe(\n      tap((response: AuthResponse) =&gt; {\n        if (response.token) {\n          localStorage.setItem('jwtToken', response.token);\n        }\n      }),\n      catchError(error =&gt; {\n        console.error('Login error:', error);\n        return throwError(() =&gt; new Error(error.error?.message || 'Login failed. Please try again.'));\n      })\n    );\n  }\n</code></pre>\n<ul>\n<li>Angular interceptor:</li>\n</ul>\n<pre class=\"lang-js prettyprint-override\"><code>export const headerInterceptor: HttpInterceptorFn = (req: HttpRequest&lt;unknown&gt;,\n  next: HttpHandlerFn\n): Observable&lt;HttpEvent&lt;unknown&gt;&gt; =&gt; {\n  const Authorization = localStorage.getItem('jwtToken') ? `Bearer ${localStorage.getItem('jwtToken')}` : '';\n  if(!req.url.includes('login') &amp;&amp; !req.url.includes('join'))\n    return next(req.clone({ setHeaders: { Authorization } }));\n  else \n  return next(req);\n};\n</code></pre>\n<ul>\n<li>environment.prod.ts:</li>\n</ul>\n<pre class=\"lang-js prettyprint-override\"><code>export const environment = {\n    production: true,\n    baseURL: &quot;http://localhost:8080&quot;,\n    eventsURL: &quot;http://localhost:8080/events&quot;,\n    homeURL: &quot;http://localhost:8080/home&quot;,\n    citiesURL: &quot;http://localhost:8080/cities&quot;,\n    commentsURL: &quot;http://localhost:8080/comments&quot;,\n    usersURL: &quot;http://localhost:8080/users&quot;\n};\n</code></pre>\n<ul>\n<li>and in angular.json:</li>\n</ul>\n<pre class=\"lang-json prettyprint-override\"><code>&quot;fileReplacements&quot;: [\n                {\n                  &quot;replace&quot;: &quot;src/environments/environment.ts&quot;,\n                  &quot;with&quot;: &quot;src/environments/environment.prod.ts&quot;\n                }\n              ]\n</code></pre>\n<ul>\n<li>in application.yml:</li>\n</ul>\n<pre class=\"lang-yaml prettyprint-override\"><code>profiles:\n  active: prod\n</code></pre>\n<ul>\n<li>start .jar with</li>\n</ul>\n<pre class=\"lang-none prettyprint-override\"><code>java -jar my-app.jar --spring.profiles.active=prod\n</code></pre>\n<ul>\n<li><p>Works perfectly in IDE.</p>\n</li>\n<li><p>Fails only after running from the JAR.</p>\n</li>\n</ul>\n<p>No apparent difference in logs or stack traces that explain why only browser requests fail.</p>\n<p>Question:</p>\n<p>What could cause Spring Boot to behave differently (especially for browser-based login requests) when running from a JAR versus running from the IDE?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}