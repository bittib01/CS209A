{
  "question": {
    "tags": [
      "java",
      "database",
      "scheduler"
    ],
    "owner": {
      "account_id": 1215703,
      "reputation": 1187,
      "user_id": 1183348,
      "user_type": "registered",
      "accept_rate": 47,
      "profile_image": "https://www.gravatar.com/avatar/6d1825740544384f1055739e09707689?s=256&d=identicon&r=PG",
      "display_name": "Thunfische",
      "link": "https://stackoverflow.com/users/1183348/thunfische"
    },
    "is_answered": false,
    "view_count": 119,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1763981489,
    "creation_date": 1744621991,
    "last_edit_date": 1744630831,
    "question_id": 79572763,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79572763/rescheduling-a-task-within-the-handler-with-db-scheduler-java",
    "title": "Rescheduling a task within the handler with db-scheduler java",
    "body": "<pre><code>class TaskData {\n    int id;\n    String status;\n}\n\nclass TaskDbScheduler() {\n     private final SchedulerClient schedulerClient;\n    private final OneTimeTask&lt;TaskData&gt; oenTimeTask;\n    public TaskInstance&lt;TaskData&gt; schedule(TaskData taskData) {\n        Instant nextExecutionTime = taskData.getNextAttempt();\n        TaskInstance&lt;TaskData&gt; instance =\n                oenTimeTask.instance(taskData.getId()(), taskData);\n        boolean scheduled = schedulerClient.scheduleIfNotExists(instance, nextExecutionTime);\n        return instance;\n    }\n}\n\nclass TaskHandler{\n    TaskDbScheduler scheduler; // causes circular dependency\n\n    void handle(TaskInstance&lt;TaskData&gt; taskInstance, ExecutionContext executionContext) {\n        var read = xyzservice.run(taskInstance.getData());\n\n        if(read == fail) {\n            // reschedule it after two seconds, with taskdata.toBuilder().status(&quot;delayed&quot;).build();\n        \n        }\n    }\n}\n</code></pre>\n<p>I am using <a href=\"https://github.com/kagkarlsson/db-scheduler\" rel=\"nofollow noreferrer\">db-scheduler</a> 15.3.0.</p>\n<p>I am trying to reschedule a task within the handler on some conditions but it always end up in a circular dependency error. Using SchedulerClient directly in the handler also does not provide the functionality to alter taskdata. Is there a way to reschdule a task this way?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}