{
  "question": {
    "tags": [
      "java",
      "elasticsearch",
      "elasticsearch-java-api",
      "elasticsearch-java-api-client"
    ],
    "owner": {
      "account_id": 14277436,
      "reputation": 163,
      "user_id": 10313064,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/uzsbu.jpg?s=256",
      "display_name": "Xwin",
      "link": "https://stackoverflow.com/users/10313064/xwin"
    },
    "is_answered": true,
    "view_count": 2296,
    "accepted_answer_id": 78617259,
    "answer_count": 2,
    "score": 1,
    "last_activity_date": 1718274009,
    "creation_date": 1714735936,
    "last_edit_date": 1714801321,
    "question_id": 78424441,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78424441/elasticsearch-migrating-from-java-high-level-rest-client-to-new-java-api-clien",
    "title": "Elasticsearch - Migrating from Java High Level Rest Client to New Java API Client of Version 8.x",
    "body": "<p>I am using the new version 8.13 of Elasticsearch for a new search app and trying to imitate the below kind of logic using the new <a href=\"https://www.elastic.co/guide/en/elasticsearch/client/java-api-client/current/searching.html\" rel=\"nofollow noreferrer\">Java API client</a> instead of using Java High Level Rest client which was deprecated now. I have to perform search from multiple indices including below queries-</p>\n<p>1.<strong>multiple matchPhrasePrefixQuery like below</strong></p>\n<pre><code>BoolQueryBuilder searchTheseFields = QueryBuilders.boolQuery();\nfor (String searchFields : searchTheseFieldsArray) {\n        searchTheseFields .should(QueryBuilders.matchPhrasePrefixQuery(searchFields, **SearchText**));\n            }\n</code></pre>\n<p>2.<strong>multiple term queries with fileds and values</strong></p>\n<pre><code>BoolQueryBuilder filterFields = QueryBuilders.boolQuery();\nfor (Map.Entry&lt;String, Object&gt; entry : filterTheseFields.entrySet()) {\n                filterFields.must(QueryBuilders.termQuery(entry.getKey(), entry.getValue()));\n            }\n</code></pre>\n<p>3.<strong>multiple range queries</strong></p>\n<pre><code>BoolQueryBuilder rangeFilter1 = QueryBuilders.boolQuery();\nBoolQueryBuilder rangeFilter2 = QueryBuilders.boolQuery();\n\nrangeFilter1.should(QueryBuilders.rangeQuery(key).gte(&quot;gteVal&quot;).lte(&quot;lteVal&quot;))\n                               .should(QueryBuilders.boolQuery().mustNot(QueryBuilders.existsQuery(key)));\n</code></pre>\n<p>And finally add all these queries to a single Query Builder like below and call using client.</p>\n<pre><code>BoolQueryBuilder queryBuilder = QueryBuilders.boolQuery()\n                .must(searchTheseFields)\n                .must(filterFields)\n                .filter(rangeFilter1);\n\nSearchSourceBuilder searchSourceBuilder = new SearchSourceBuilder();\n        searchSourceBuilder.query(queryBuilder);\n        searchSourceBuilder.from(data.getFrom());\n        searchSourceBuilder.size(data.getSize());\n        \nSearchRequest searchRequest = new SearchRequest();\n        searchRequest.indices(passing indices here);\n        searchRequest.source(searchSourceBuilder);\n        \nSearchResponse response = client.search(searchRequest);\n</code></pre>\n<p>Issues I am facing while trying it using new Java Client -\n<strong>BoolQueryBuilder</strong> is not there which was used earlier to create different type of queries and aggregate all of them.\nAs @Murat mentioned <strong>SearchSourceBuilder</strong> is also not there</p>\n<p>So,can anyone help me to imitate the above code using new Java API Client of Elasticsearch new version 8 or above, like how We can create multiple different type queries and add all of them to a single query and call it using the client.</p>\n<p>Thanks</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}