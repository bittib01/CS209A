{
  "question": {
    "tags": [
      "java",
      "bytecode",
      "java-bytecode-asm"
    ],
    "owner": {
      "account_id": 14429973,
      "reputation": 3626,
      "user_id": 10423604,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/W6A8i.jpg?s=256",
      "display_name": "Volodya Lombrozo",
      "link": "https://stackoverflow.com/users/10423604/volodya-lombrozo"
    },
    "is_answered": true,
    "view_count": 164,
    "accepted_answer_id": 78268585,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1718698776,
    "creation_date": 1712074456,
    "question_id": 78262674,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78262674/how-to-mix-manual-and-automatic-calculation-of-max-locals-max-stack-and-frames",
    "title": "How to Mix Manual and Automatic Calculation of Max Locals, Max Stack, and Frames in ASM per Method Basis?",
    "body": "<p>I'm currently working on a project where I generate Java bytecode from my own intermediate representation using the ASM library. For some methods in my code, I already have pre-calculated values for the maximum stack size, local variables, and frame information. However, for other methods, I lack this information and would prefer ASM to automatically compute these values for me.</p>\n<p>The challenge arises because ASM's <code>ClassWriter</code> allows specifying computation options (<code>COMPUTE_MAXS</code> and <code>COMPUTE_FRAMES</code>) only at the class level, affecting all methods in the class. I'm looking for a way to selectively apply ASM's automatic computation on a per-method basis, such that:</p>\n<ul>\n<li>For methods where I have pre-calculated max locals and stack sizes, I manually set these values.</li>\n<li>For the rest, ASM computes the max locals, stack sizes, and frames automatically.</li>\n</ul>\n<p>I attempted to extend <code>ClassWriter</code> but have not found a way to return a different implementation of <code>MethodWriter</code>. Moreover, <code>MethodWriter</code> is declared as a final class, preventing it from being extended.</p>\n<p>If I set <code>COMPUTE_FRAMES</code>, ASM simply ignores the values that I specify using <code>visitMaxs</code> and calculates them from the beginning.</p>\n<p>I appreciate any insights or alternative strategies.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}