{
  "question": {
    "tags": [
      "java",
      "apache-flink",
      "flink-streaming",
      "pojo"
    ],
    "owner": {
      "account_id": 11057209,
      "reputation": 39,
      "user_id": 11791225,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/bf9f6646ef108f84595e349307dc4da8?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "K.M",
      "link": "https://stackoverflow.com/users/11791225/k-m"
    },
    "is_answered": true,
    "view_count": 180,
    "accepted_answer_id": 79286743,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1734411926,
    "creation_date": 1731489860,
    "last_edit_date": 1731578234,
    "question_id": 79184192,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79184192/apache-flink-type-information-error-for-pojo-containing-list-of-tuples",
    "title": "Apache Flink type information error for POJO containing List of Tuples",
    "body": "<p>[Edit 1: added the correct error log this time]</p>\n<p>[Edit 2: reduced fields from class and the TypeInfoFactory]</p>\n<p>I am unable to create a POJO type class that contains a data type that is a list of tuples. Perhaps I am not providing it's type information correctly?</p>\n<p>[Edited] Here is the class and the TypeInfo:</p>\n<pre><code>@TypeInfo(NodeTestSerializer.class)\npublic class NodeTest implements Serializable {\n    public List&lt;Tuple3&lt;Integer,Integer, String&gt;&gt; msgDestinationList = new ArrayList&lt;&gt;();\n\n    public NodeTest() {\n        msgDestinationList.add(Tuple3.of(1,2,&quot;abc&quot;));\n    };\n}\n</code></pre>\n<p>and I have defined its type information as follows:</p>\n<pre><code>public class NodeTestSerializer extends TypeInfoFactory&lt;NodeTest&gt; {\n    @Override\n    public TypeInformation&lt;NodeTest&gt; createTypeInfo(Type t, Map&lt;String, TypeInformation&lt;?&gt;&gt; genericParameters) {\n\n        TypeInformation&lt;Tuple3&lt;Integer,Integer, String&gt;&gt; tupleTypeInfo =\n                TypeInformation.of(new TypeHint&lt;Tuple3&lt;Integer, Integer, String&gt;&gt;() {});\n\n        ImmutableMap nMap = ImmutableMap.builder()\n                .put(&quot;msgDestinationList&quot;, Types.LIST(Types.TUPLE(tupleTypeInfo)))\n                .build();\n\n        final TypeInformation&lt;NodeTest&gt; nodeInfo = Types.POJO(NodeTest.class,nMap);\n        return nodeInfo;\n    }\n}\n    \n</code></pre>\n<p>However it gives the following error if I try to run a simple map operation on a DataStream that contains objects of the above class. It runs fine if I disable generics <code>env.getConfig().disableGenericTypes();</code> so the problem is related to POJO serialization.</p>\n<pre><code>java.io.UncheckedIOException: java.io.IOException: Serializing the source elements failed: class java.lang.Integer cannot be cast to class org.apache.flink.api.java.tuple.Tuple (java.lang.Integer is in module java.base of loader 'bootstrap'; org.apache.flink.api.java.tuple.Tuple is in unnamed module of loader 'app')\n    at org.apache.flink.streaming.api.functions.source.FromElementsFunction.setOutputType(FromElementsFunction.java:158)\n    at org.apache.flink.streaming.util.functions.StreamingFunctionUtils.trySetOutputType(StreamingFunctionUtils.java:84)\n    at org.apache.flink.streaming.util.functions.StreamingFunctionUtils.setOutputType(StreamingFunctionUtils.java:60)\n    at org.apache.flink.streaming.api.operators.AbstractUdfStreamOperator.setOutputType(AbstractUdfStreamOperator.java:145)\n    at org.apache.flink.streaming.api.operators.SimpleOperatorFactory.setOutputType(SimpleOperatorFactory.java:112)\n    at org.apache.flink.streaming.api.graph.StreamGraph.addOperator(StreamGraph.java:430)\n    at org.apache.flink.streaming.api.graph.StreamGraph.addOperator(StreamGraph.java:398)\n    at org.apache.flink.streaming.api.graph.StreamGraph.addLegacySource(StreamGraph.java:342)\n    at org.apache.flink.streaming.runtime.translators.LegacySourceTransformationTranslator.translateInternal(LegacySourceTransformationTranslator.java:66)\n    at org.apache.flink.streaming.runtime.translators.LegacySourceTransformationTranslator.translateForStreamingInternal(LegacySourceTransformationTranslator.java:53)\n    at org.apache.flink.streaming.runtime.translators.LegacySourceTransformationTranslator.translateForStreamingInternal(LegacySourceTransformationTranslator.java:40)\n    at org.apache.flink.streaming.api.graph.SimpleTransformationTranslator.translateForStreaming(SimpleTransformationTranslator.java:62)\n    at org.apache.flink.streaming.api.graph.StreamGraphGenerator.translate(StreamGraphGenerator.java:832)\n    at org.apache.flink.streaming.api.graph.StreamGraphGenerator.transform(StreamGraphGenerator.java:562)\n    at org.apache.flink.streaming.api.graph.StreamGraphGenerator.getParentInputIds(StreamGraphGenerator.java:853)\n    at org.apache.flink.streaming.api.graph.StreamGraphGenerator.translate(StreamGraphGenerator.java:811)\n    at org.apache.flink.streaming.api.graph.StreamGraphGenerator.transform(StreamGraphGenerator.java:562)\n    at org.apache.flink.streaming.api.graph.StreamGraphGenerator.generate(StreamGraphGenerator.java:319)\n    at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:2239)\n    at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:2230)\n    at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.getStreamGraph(StreamExecutionEnvironment.java:2216)\n    at org.apache.flink.streaming.api.environment.StreamExecutionEnvironment.execute(StreamExecutionEnvironment.java:2043)\n    at test.NodeTestMain.main(NodeTestMain.java:39)\nCaused by: java.io.IOException: Serializing the source elements failed: class java.lang.Integer cannot be cast to class org.apache.flink.api.java.tuple.Tuple (java.lang.Integer is in module java.base of loader 'bootstrap'; org.apache.flink.api.java.tuple.Tuple is in unnamed module of loader 'app')\n    at org.apache.flink.streaming.api.functions.source.FromElementsFunction.serializeElements(FromElementsFunction.java:135)\n    at org.apache.flink.streaming.api.functions.source.FromElementsFunction.setOutputType(FromElementsFunction.java:156)\n    ... 22 more\nCaused by: java.lang.ClassCastException: class java.lang.Integer cannot be cast to class org.apache.flink.api.java.tuple.Tuple (java.lang.Integer is in module java.base of loader 'bootstrap'; org.apache.flink.api.java.tuple.Tuple is in unnamed module of loader 'app')\n    at org.apache.flink.api.java.typeutils.runtime.TupleSerializer.serialize(TupleSerializer.java:37)\n    at org.apache.flink.api.java.typeutils.runtime.TupleSerializer.serialize(TupleSerializer.java:140)\n    at org.apache.flink.api.java.typeutils.runtime.TupleSerializer.serialize(TupleSerializer.java:37)\n    at org.apache.flink.api.common.typeutils.base.ListSerializer.serialize(ListSerializer.java:126)\n    at org.apache.flink.api.common.typeutils.base.ListSerializer.serialize(ListSerializer.java:42)\n    at org.apache.flink.api.java.typeutils.runtime.PojoSerializer.serialize(PojoSerializer.java:365)\n    at org.apache.flink.streaming.api.functions.source.FromElementsFunction.serializeElements(FromElementsFunction.java:132)\n    ... 23 more\n\n</code></pre>\n<p>I have tried other ways to provide the type information however I am all out of ideas on how to fix this error. Any help will be greatly appreciated!</p>\n<p>NodeTestMain.java:</p>\n<pre><code>public class NodeTestMain {\n\n    public static void main(final String[] args) throws IOException {\n        try {\n\n            final StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();\n            env.getConfig().disableGenericTypes();   // disable generic types (Kryo)\n\n            DataStream&lt;NodeTest&gt; nodeStream = env.fromElements(new NodeTest());\n            nodeStream.map(i -&gt; i.msgDestinationList.get(0).f0).print();\n\n            env.execute(&quot;Flink Node Test&quot;);\n        }\n        catch (Exception e) {\n            e.printStackTrace();\n            System.exit(1);\n        }\n    }\n\n}\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}