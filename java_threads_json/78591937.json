{
  "question": {
    "tags": [
      "java",
      "hibernate-tools"
    ],
    "owner": {
      "account_id": 16232337,
      "reputation": 51,
      "user_id": 11720740,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/159c605fd5e4beb4413ff268a6a93498?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Yury Shafran",
      "link": "https://stackoverflow.com/users/11720740/yury-shafran"
    },
    "is_answered": true,
    "view_count": 459,
    "answer_count": 3,
    "score": 3,
    "last_activity_date": 1732867974,
    "creation_date": 1717763324,
    "last_edit_date": 1717765814,
    "question_id": 78591937,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78591937/hibernate-jpamodelgen-6-5-2-final-throws-nullpointerexception-at-java-module",
    "title": "hibernate-jpamodelgen 6.5.2.Final throws NullPointerException at Java module",
    "body": "<p>After upgrading <code>org.hibernate.orm:hibernate-jpamodelgen</code> from <code>6.3.1.Final</code> to <code>6.5.2.Final</code> (by migrating to <code>Spring Boot 3.3.0</code>) I get the following <code>NullPointerException</code> during annotation processing.</p>\n<pre><code>[ERROR] Error running Hibernate processor: Cannot invoke &quot;javax.lang.model.element.Element.getAnnotationMirrors()&quot; because &quot;element&quot; is null\n[ERROR] java.lang.NullPointerException: Cannot invoke &quot;javax.lang.model.element.Element.getAnnotationMirrors()&quot; because &quot;element&quot; is null\n    at org.hibernate.processor.util.TypeUtils.getAnnotationMirror(TypeUtils.java:251)\n    at org.hibernate.processor.util.TypeUtils.hasAnnotation(TypeUtils.java:260)\n    at org.hibernate.processor.HibernateProcessor.processClasses(HibernateProcessor.java:297)\n    at org.hibernate.processor.HibernateProcessor.process(HibernateProcessor.java:261)\n    at jdk.compiler/com.sun.tools.javac.processing.JavacProcessingEnvironment.callProcessor(JavacProcessingEnvironment.java:1023)\n    at jdk.compiler/com.sun.tools.javac.processing.JavacProcessingEnvironment.discoverAndRunProcs(JavacProcessingEnvironment.java:939)\n    at jdk.compiler/com.sun.tools.javac.processing.JavacProcessingEnvironment$Round.run(JavacProcessingEnvironment.java:1267)\n    at jdk.compiler/com.sun.tools.javac.processing.JavacProcessingEnvironment.doProcessing(JavacProcessingEnvironment.java:1382)\n    at jdk.compiler/com.sun.tools.javac.main.JavaCompiler.processAnnotations(JavaCompiler.java:1234)\n    at jdk.compiler/com.sun.tools.javac.main.JavaCompiler.compile(JavaCompiler.java:916)\n    at jdk.compiler/com.sun.tools.javac.api.JavacTaskImpl.lambda$doCall$0(JavacTaskImpl.java:104)\n    at jdk.compiler/com.sun.tools.javac.api.JavacTaskImpl.invocationHelper(JavacTaskImpl.java:152)\n    at jdk.compiler/com.sun.tools.javac.api.JavacTaskImpl.doCall(JavacTaskImpl.java:100)\n    at jdk.compiler/com.sun.tools.javac.api.JavacTaskImpl.call(JavacTaskImpl.java:94)\n    at org.codehaus.plexus.compiler.javac.JavaxToolsCompiler.compileInProcess(JavaxToolsCompiler.java:126)\n    at org.codehaus.plexus.compiler.javac.JavacCompiler.performCompile(JavacCompiler.java:214)\n    at org.apache.maven.plugin.compiler.AbstractCompilerMojo.execute(AbstractCompilerMojo.java:1228)\n    at org.apache.maven.plugin.compiler.CompilerMojo.execute(CompilerMojo.java:215)\n    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:137)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:210)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:156)\n    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:148)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:117)\n    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:81)\n    at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:56)\n    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:128)\n    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:305)\n    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:192)\n    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:105)\n    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:972)\n    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:293)\n    at org.apache.maven.cli.MavenCli.main(MavenCli.java:196)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n    at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\n    at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n    at java.base/java.lang.reflect.Method.invoke(Method.java:568)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:282)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:225)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:406)\n    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:347)\n</code></pre>\n<p>Debugging shows that the problematic element is a Java module (an instance of <code>com.sun.tools.javac.code.Symbol.ModuleSymbol</code>). So the call <code>context.getElementUtils().getPackageOf(element)</code> (<code>org.hibernate.processor.HibernateProcessor.processClasses(RoundEnvironment roundEnvironment):297)</code> gives <code>null</code>. The code of <code>com.sun.tools.javac.model.JavacElements</code> is straightforward.</p>\n<pre><code>    @DefinedBy(Api.LANGUAGE_MODEL)\n    public PackageElement getPackageOf(Element e) {\n        if (e.getKind() == ElementKind.MODULE)\n            return null;\n        else\n            return cast(Symbol.class, e).packge();\n    }\n</code></pre>\n<p>I use <code>Apache Maven 3.8.4</code> and <code>maven-compiler-plugin 3.13.0</code>. My <code>JDK</code> is the following.</p>\n<pre><code>$ java --version\nopenjdk 17 2021-09-14\nOpenJDK Runtime Environment Temurin-17+35 (build 17+35)\nOpenJDK 64-Bit Server VM Temurin-17+35 (build 17+35, mixed mode, sharing)\n</code></pre>\n<p>Is it a bug in <code>hibernate-jpamodelgen</code> or <code>JDK</code>? Is there any setting to avoid such a problem?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}