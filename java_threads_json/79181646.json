{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-boot",
      "spring-aop",
      "spring-micrometer"
    ],
    "owner": {
      "account_id": 8056033,
      "reputation": 3395,
      "user_id": 6073148,
      "user_type": "registered",
      "accept_rate": 75,
      "profile_image": "https://i.sstatic.net/6LMP5.jpg?s=256",
      "display_name": "Zahid Khan",
      "link": "https://stackoverflow.com/users/6073148/zahid-khan"
    },
    "is_answered": true,
    "view_count": 303,
    "accepted_answer_id": 79557273,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1744380435,
    "creation_date": 1731423640,
    "last_edit_date": 1743870013,
    "question_id": 79181646,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79181646/declareprecedence-not-presently-supported-in-spring-aop",
    "title": "DeclarePrecedence not presently supported in Spring AOP",
    "body": "<h3>Context:</h3>\n<p>I'm facing an error while deploying the shade jar on lambda. The jar was is working on Spring Boot 2.6.8 but not on Spring Boot 2.7.18.</p>\n<p>Error:</p>\n<pre class=\"lang-none prettyprint-override\"><code>Error creating bean with name 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration': BeanPostProcessor before instantiation of bean failed; nested exception is java.lang.IllegalArgumentException: DeclarePrecedence not presently supported in Spring AOP\n</code></pre>\n<p>Stacktrace:</p>\n<pre class=\"lang-none prettyprint-override\"><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'meterRegistryPostProcessor' defined in class path resource [org/springframework/boot/actuate/autoconfigure/metrics/MetricsAutoConfiguration.class]: BeanPostProcessor before instantiation of bean failed; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration': BeanPostProcessor before instantiation of bean failed; nested exception is java.lang.IllegalArgumentException: DeclarePrecedence not presently supported in Spring AOP\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:537)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\n  at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:213)\n  at org.springframework.context.support.PostProcessorRegistrationDelegate.registerBeanPostProcessors(PostProcessorRegistrationDelegate.java:270)\n  at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:773)\n  at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:575)\n  at org.springframework.boot.web.reactive.context.ReactiveWebServerApplicationContext.refresh(ReactiveWebServerApplicationContext.java:66)\n  at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:732)\n  at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:409)\n  at org.springframework.boot.SpringApplication.run(SpringApplication.java:308)\n  at org.springframework.boot.builder.SpringApplicationBuilder.run(SpringApplicationBuilder.java:164)\n  at com.amazonaws.serverless.proxy.spring.SpringBootLambdaContainerHandler.initialize(SpringBootLambdaContainerHandler.java:195)\n  at com.amazonaws.serverless.proxy.AsyncInitializationWrapper$AsyncInitializer.run(AsyncInitializationWrapper.java:118)\n  at java.base/java.lang.Thread.run(Thread.java:840)\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration': BeanPostProcessor before instantiation of bean failed; nested exception is java.lang.IllegalArgumentException: DeclarePrecedence not presently supported in Spring AOP\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:537)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\n  at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\n  at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:405)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\n  at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\n  at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:213)\n  at org.springframework.aop.framework.autoproxy.BeanFactoryAdvisorRetrievalHelper.findAdvisorBeans(BeanFactoryAdvisorRetrievalHelper.java:91)\n  at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findCandidateAdvisors(AbstractAdvisorAutoProxyCreator.java:111)\n  at org.springframework.aop.aspectj.annotation.AnnotationAwareAspectJAutoProxyCreator.findCandidateAdvisors(AnnotationAwareAspectJAutoProxyCreator.java:92)\n  at org.springframework.aop.aspectj.autoproxy.AspectJAwareAdvisorAutoProxyCreator.shouldSkip(AspectJAwareAdvisorAutoProxyCreator.java:101)\n  at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessBeforeInstantiation(AbstractAutoProxyCreator.java:255)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInstantiation(AbstractAutowireCapableBeanFactory.java:1160)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.resolveBeforeInstantiation(AbstractAutowireCapableBeanFactory.java:1135)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:531)\n  ... 15 common frames omitted\nCaused by: java.lang.IllegalArgumentException: DeclarePrecedence not presently supported in Spring AOP\n  at org.springframework.aop.aspectj.annotation.AspectMetadata.&lt;init&gt;(AspectMetadata.java:98)\n  at org.springframework.aop.aspectj.annotation.BeanFactoryAspectJAdvisorsBuilder.buildAspectJAdvisors(BeanFactoryAspectJAdvisorsBuilder.java:106)\n  at org.springframework.aop.aspectj.annotation.AnnotationAwareAspectJAutoProxyCreator.findCandidateAdvisors(AnnotationAwareAspectJAutoProxyCreator.java:95)\n  at org.springframework.aop.aspectj.autoproxy.AspectJAwareAdvisorAutoProxyCreator.shouldSkip(AspectJAwareAdvisorAutoProxyCreator.java:101)\n  at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessBeforeInstantiation(AbstractAutoProxyCreator.java:255)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInstantiation(AbstractAutowireCapableBeanFactory.java:1160)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.resolveBeforeInstantiation(AbstractAutowireCapableBeanFactory.java:1135)\n  at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:531)\n  ... 36 common frames omitted\n</code></pre>\n<p>pom.xml</p>\n<p>My pom.xml is too large that I can't paste all here, however some of the important dependencies are:</p>\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;properties&gt;\n     &lt;datadog.version&gt;1.9.17&lt;/datadog.version&gt;\n&lt;properties&gt;\n\n&lt;!-- ... --&gt;\n\n&lt;dependency&gt;\n    &lt;groupId&gt;io.micrometer&lt;/groupId&gt;\n    &lt;artifactId&gt;micrometer-registry-datadog&lt;/artifactId&gt;\n    &lt;version&gt;${datadog.version}&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-aop&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre>\n<p>I've read below answers but none of them were useful for me:</p>\n<ol>\n<li><a href=\"https://stackoverflow.com/questions/63891056/spring-boot-deploy-fail-error-creating-bean-with-name-meterregistrypostproces\">Spring Boot deploy fail - Error creating bean with name &#39;meterRegistryPostProcessor&#39;</a></li>\n<li><a href=\"https://stackoverflow.com/questions/77358743/org-springframework-beans-factory-beancreationexception-error-creating-bean-wit\">org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;simpleMeterRegistry&#39; defined in class path resource</a></li>\n<li><a href=\"https://stackoverflow.com/questions/61884617/beancreationexception-error-creating-bean-with-name-simplemeterregistry-is-th\">BeanCreationException: Error creating bean with name &#39;simpleMeterRegistry&#39; is thrown on adding eureka server to spring boot Applicatio</a></li>\n<li><a href=\"https://stackoverflow.com/questions/63282476/error-creating-bean-with-name-org-springframework-boot-actuate-autoconfigure-me\">Error creating bean with name &#39;org.springframework.boot.actuate.autoconfigure.metrics.orm.jpa.HibernateMetricsAutoConfiguration</a></li>\n</ol>\n<p>Any help would be really appreciable!</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}