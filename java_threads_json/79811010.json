{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-security",
      "authorization",
      "abac"
    ],
    "owner": {
      "account_id": 27554485,
      "reputation": 25,
      "user_id": 21028962,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/b0baf0a40e835452b13581ff247ef4a6?s=256&d=identicon&r=PG",
      "display_name": "0xRelu",
      "link": "https://stackoverflow.com/users/21028962/0xrelu"
    },
    "is_answered": false,
    "view_count": 160,
    "answer_count": 2,
    "score": 5,
    "last_activity_date": 1763564981,
    "creation_date": 1762418392,
    "question_id": 79811010,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79811010/how-did-you-implement-attribute-based-access-control-abac-in-spring-boot",
    "title": "How did you implement Attribute-based Access Control (ABAC) in Spring Boot?",
    "body": "<p>Iâ€™ve been working on an issue in our Spring Boot application for some time now: <strong>authorization</strong>. Because we have a more complex permission model â€” permissions depend not only on roles, but also on user-specific attributes (e.g., department) â€” we require <strong>Attribute-based Access Control (ABAC)</strong> instead of the typical <strong>Role-based Access Control (RBAC)</strong> used in Spring Security (see <a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/method-security.html\" rel=\"nofollow noreferrer\">Spring Docs - Method-based Security</a>).</p>\n<p>At the moment, we have a custom implementation that roughly follows the ABAC reference model (PEP, PDP, ...). However, it is neither particularly efficient nor easily scalable or maintainable. Therefore, Iâ€™d like to hear what solutions you have used and what has worked well in your projects.</p>\n<p>Below are some approaches I have explored or tested, but none of them seem to be a perfect fit so far:</p>\n<ol>\n<li><p><strong><a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/method-security.html#authorization-expressions\" rel=\"nofollow noreferrer\">SpEL</a></strong> <strong>(Method-based Security: @PreAuthorize / @PostAuthorize)</strong><br />\nSpring allows you to define authorization logic directly in annotations using SpEL. However, this is recommended only for simple logic (see <a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/method-security.html#favor-granting-authorities\" rel=\"nofollow noreferrer\">Spring Docs - Favor Granting Authorities</a>). Since our use case is more complex, this approach does not seem suitable.</p>\n</li>\n<li><p><strong><a href=\"https://docs.spring.io/spring-security/reference/servlet/authorization/method-security.html#use-programmatic-authorization\" rel=\"nofollow noreferrer\">SpEL - Programmatic Authorization</a></strong><br />\nInstead of writing logic directly in SpEL, one can reference a separate service from SpEL, which then performs the authorization checks. This seems more promising, but it raises questions like:<br />\n<em>Does it scale well?</em><br />\nAnd does it lead to a large number of AuthorizationService classes â€” potentially one for every business service â€” increasing code complexity?</p>\n</li>\n<li><p>External Policy Decision Point (e.g., <a href=\"https://www.cerbos.dev/ecosystem/spring-boot\" rel=\"nofollow noreferrer\">Cerbos</a> , OPA)<br />\nUsing an external PDP allows you to separate authorization logic from the application. I tested Cerbos in particular, since its SDK aligns better with our needs (as far as I know, OPA SDK does not easily support passing additional resource attributes specifiy for a method).<br />\nThis approach works in principle, but it introduces operational overhead: Cerbos would need to be deployed as a sidecar, which would complicate deployment, testing, and the general workflow. It is technically possible, but currently difficult to implement in our environment. So ideally, we would prefer a <strong>native Spring/Java solution.</strong></p>\n</li>\n</ol>\n<p><strong>How have you implemented ABAC efficiently and in a scalable way in your Spring Boot/Java applications?</strong><br />\nI would really appreciate your insights or examples of architectures that worked well for you.</p>\n<p>Thanks in advance! ðŸ˜Š</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}