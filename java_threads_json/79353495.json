{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "spring-webflux",
      "reactive-programming",
      "spring-webclient"
    ],
    "owner": {
      "account_id": 16678269,
      "reputation": 1,
      "user_id": 12054116,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/fedaa423253fe3ae0552c41fd6442f37?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Asi Skarp",
      "link": "https://stackoverflow.com/users/12054116/asi-skarp"
    },
    "is_answered": false,
    "view_count": 67,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1740285153,
    "creation_date": 1736804268,
    "question_id": 79353495,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79353495/how-to-persist-the-response-body-of-a-http-request-asynchronously-in-spring-webc",
    "title": "How to persist the response body of a HTTP request asynchronously in Spring WebClient",
    "body": "<p>I am working on a Java Spring Boot application, which implements a <code>WebClient</code> for handling rest HTTP request. GET requests are called to an endpoint and the response is received and mapped to a Mono, and then further processed in the application. A stripped down version of the original method looks similar to this:</p>\n<pre><code>Optional&lt;Mono&lt;MyEntity&gt;&gt; result = client.get()\n        .uri(&quot;/entities/{id}&quot;, id).accept(MediaType.APPLICATION_JSON)\n        .retrieve()\n        .bodyToMono(MyEntity.class)\n        .blockOptional();\n</code></pre>\n<p>Now, I want to 'intercept' the raw json response body and persist it with an asynchronous (or non-blocking) I/O operation, without blocking or hindering the flow of responses through the endpoint.\nI have created a method to persist, and marked it with the <code>@Async</code> annotation. The body is first persisted to a string, passed to the method, and then the body is mapped to the <code>MyEntity</code> class. A modified method, which successfully persists and converts the String body back to <code>MyEntity</code> looks similar to this:</p>\n<pre><code>Optional&lt;Mono&lt;MyEntity&gt;&gt; result = client.get()\n        .uri(&quot;/entities/{id}&quot;, id).accept(MediaType.APPLICATION_JSON)\n        .retrieve()\n        .bodyToMono(String.class)\n        .doOnNext(responseBody -&gt; persistResponse(responseBody))\n        .doOnNext(savedResponse -&gt; mapToMyEntity(savedResponse))\n        .blockOptional();\n</code></pre>\n<p>I am unsure that this is actually the correct way to implement the functionality, and would like some guidance on correctly handling the JSON response body asynchronously without hindering the existing flow.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}