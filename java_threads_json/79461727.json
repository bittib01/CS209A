{
  "question": {
    "tags": [
      "java",
      "docker",
      "macos"
    ],
    "owner": {
      "account_id": 34478187,
      "reputation": 21,
      "user_id": 26591690,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/c81a175c42ca888229e23bf46b214040?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Hut Pizza",
      "link": "https://stackoverflow.com/users/26591690/hut-pizza"
    },
    "is_answered": true,
    "view_count": 3797,
    "accepted_answer_id": 79461774,
    "answer_count": 3,
    "score": 0,
    "last_activity_date": 1743432722,
    "creation_date": 1740333846,
    "question_id": 79461727,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79461727/i-cant-run-the-docker-image-on-the-m4-based-macbook-pro-processor-which-is-bui",
    "title": "I can&#39;t run the docker image on the m4-based macbook pro processor, which is build for jdk21",
    "body": "<p>I tried to build a docker image, i write a Dockerfile to build it, the content below：</p>\n<pre class=\"lang-bash prettyprint-override\"><code>\nFROM  debian:latest\n\nENV DEBIAN_FRONTEND=noninteractive\n\nWORKDIR /jdk\n\nRUN apt-get update &amp;&amp; \\\n    apt-get upgrade -y &amp;&amp; \\\n    apt-get install -y wget ca-certificates\n\nRUN wget -O jdk-21_linux_bin.tar.gz https://download.oracle.com/java/21/latest/jdk-21_linux-aarch64_bin.tar.gz &amp;&amp; \\\n    tar -xzf jdk-21_linux_bin.tar.gz &amp;&amp; \\\n    folder_name=$(find . -maxdepth 1 -type d -name &quot;*&quot; ! -name &quot;.&quot; | head -n 1) &amp;&amp; \\\n    mv $folder_name jdk21 &amp;&amp; \\\n    rm -f jdk-21_linux_bin.tar.gz\n\nENV JAVA_HOME=/jdk/jdk21\nENV PATH=&quot;${JAVA_HOME}/bin:${PATH}&quot;\n\nCMD [&quot;java&quot;,&quot;-version&quot;]\n\n</code></pre>\n<p>the build command is :</p>\n<p>docker build -t debian-jdk21 .</p>\n<p>But i got the error during building :</p>\n<pre class=\"lang-none prettyprint-override\"><code>#\n# A fatal error has been detected by the Java Runtime Environment:\n#\n#  SIGILL (0x4) at pc=0x0000ffff97f3fc5c, pid=15, tid=16\n#\n# JRE version:  (21.0.6+8) (build )\n# Java VM: Java HotSpot(TM) 64-Bit Server VM (21.0.6+8-LTS-188, mixed mode, sharing, tiered, compressed oops, compressed class ptrs, g1 gc, linux-aarch64)\n# Problematic frame:\n# j  java.lang.System.registerNatives()V+0 java.base@21.0.6\n#\n# No core dump will be written. Core dumps have been disabled. To enable core dumping, try &quot;ulimit -c unlimited&quot; before starting Java again\n#\n# An error report file with more information is saved as:\n# /jdk/hs_err_pid15.log\n[0.025s][warning][os] Loading hsdis library failed\n#\n# The crash happened outside the Java Virtual Machine in native code.\n# See problematic frame for where to report the bug.\n#\nAborted\n</code></pre>\n<p>i don't know how to fix it,</p>\n<p>the follow is hs_err_pid15.log（Due to word limit, only part of it can be intercepted）</p>\n<pre><code>---------------  S U M M A R Y ------------\n\nCommand Line: \n\nHost: AArch64, 12 cores, 7G, Debian GNU/Linux 12 (bookworm)\nTime: Sun Feb 23 13:58:48 2025 UTC elapsed time: 0.020505 seconds (0d 0h 0m 0s)\n\n---------------  T H R E A D  ---------------\n\nCurrent thread (0x0000ffffa8027620):  JavaThread &quot;Unknown thread&quot; [_thread_in_native, id=16, stack(0x0000ffffacd62000,0x0000ffffacf60000) (2040K)]\n\nStack: [0x0000ffffacd62000,0x0000ffffacf60000],  sp=0x0000ffffacf5e060,  free space=2032k\nNative frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)\nj  java.lang.System.registerNatives()V+0 java.base@21.0.6\nj  java.lang.System.&lt;clinit&gt;()V+0 java.base@21.0.6\nv  ~StubRoutines::call_stub 0x0000ffff97f37158\nV  [libjvm.so+0x800db8]  JavaCalls::call_helper(JavaValue*, methodHandle const&amp;, JavaCallArguments*, JavaThread*)+0x218\nV  [libjvm.so+0x7dceb0]  InstanceKlass::call_class_initializer(JavaThread*)+0x27c\nV  [libjvm.so+0x7ddb54]  InstanceKlass::initialize_impl(JavaThread*)+0x404\nV  [libjvm.so+0xd104f8]  Threads::initialize_java_lang_classes(JavaThread*, JavaThread*)+0xe8\nV  [libjvm.so+0xd1264c]  Threads::create_vm(JavaVMInitArgs*, bool*)+0x3ec\nV  [libjvm.so+0x88fe1c]  JNI_CreateJavaVM+0x7c\nC  [libjli.so+0x438c]  JavaMain+0x7c\nC  [libjli.so+0x79ec]  ThreadJavaMain+0xc\nC  [libc.so.6+0x7ee90]\nJava frames: (J=compiled Java code, j=interpreted, Vv=VM code)\nj  java.lang.System.registerNatives()V+0 java.base@21.0.6\nj  java.lang.System.&lt;clinit&gt;()V+0 java.base@21.0.6\nv  ~StubRoutines::call_stub 0x0000ffff97f37158\n\n\nVM Arguments:\njava_command: &lt;unknown&gt;\njava_class_path (initial): &lt;not set&gt;\nLauncher Type: SUN_STANDARD\n\n[Global flags]\n     intx CICompilerCount                          = 4                                         {product} {ergonomic}\n     uint ConcGCThreads                            = 3                                         {product} {ergonomic}\n     uint G1ConcRefinementThreads                  = 10                                        {product} {ergonomic}\n   size_t G1HeapRegionSize                         = 1048576                                   {product} {ergonomic}\n    uintx GCDrainStackTargetSize                   = 64                                        {product} {ergonomic}\n   size_t InitialHeapSize                          = 130023424                                 {product} {ergonomic}\n   size_t MarkStackSize                            = 4194304                                   {product} {ergonomic}\n   size_t MaxHeapSize                              = 2055208960                                {product} {ergonomic}\n   size_t MaxNewSize                               = 1233125376                                {product} {ergonomic}\n   size_t MinHeapDeltaBytes                        = 1048576                                   {product} {ergonomic}\n   size_t MinHeapSize                              = 8388608                                   {product} {ergonomic}\n    uintx NonNMethodCodeHeapSize                   = 5839564                                {pd product} {ergonomic}\n    uintx NonProfiledCodeHeapSize                  = 122909338                              {pd product} {ergonomic}\n    uintx ProfiledCodeHeapSize                     = 122909338                              {pd product} {ergonomic}\n    uintx ReservedCodeCacheSize                    = 251658240                              {pd product} {ergonomic}\n     bool SegmentedCodeCache                       = true                                      {product} {ergonomic}\n   size_t SoftMaxHeapSize                          = 2055208960                             {manageable} {ergonomic}\n     bool UseCompressedOops                        = true                           {product lp64_product} {ergonomic}\n     bool UseG1GC                                  = true                                      {product} {ergonomic}\n\nLogging:\nLog output configuration:\n #0: stdout all=warning uptime,level,tags foldmultilines=false\n #1: stderr all=off uptime,level,tags foldmultilines=false\n\nEnvironment Variables:\nJAVA_HOME=/jdk/jdk21\nPATH=/jdk/jdk21/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nTERM=xterm\n\nActive Locale:\nLC_ALL=C\nLC_COLLATE=C\nLC_CTYPE=C\nLC_MESSAGES=C\nLC_MONETARY=C\nLC_NUMERIC=C\nLC_TIME=C\n\nSignal Handlers:\n   SIGSEGV: crash_handler in libjvm.so, mask=11100100010111111101111111111110, flags=SA_RESTART|SA_SIGINFO, unblocked\n    SIGBUS: crash_handler in libjvm.so, mask=11100100010111111101111111111110, flags=SA_RESTART|SA_SIGINFO, unblocked\n    SIGFPE: crash_handler in libjvm.so, mask=11100100010111111101111111111110, flags=SA_RESTART|SA_SIGINFO, unblocked\n   SIGPIPE: javaSignalHandler in libjvm.so, mask=11100100010111111101111111111110, flags=SA_RESTART|SA_SIGINFO, blocked\n   SIGXFSZ: javaSignalHandler in libjvm.so, mask=11100100010111111101111111111110, flags=SA_RESTART|SA_SIGINFO, blocked\n    SIGILL: crash_handler in libjvm.so, mask=11100100010111111101111111111110, flags=SA_RESTART|SA_SIGINFO, unblocked\n   SIGUSR2: SR_handler in libjvm.so, mask=00000000000000000000000000000000, flags=SA_RESTART|SA_SIGINFO, blocked\n    SIGHUP: SIG_DFL, mask=00000000000000000000000000000000, flags=none, blocked\n    SIGINT: SIG_DFL, mask=00000000000000000000000000000000, flags=none, blocked\n   SIGTERM: SIG_DFL, mask=00000000000000000000000000000000, flags=none, blocked\n   SIGQUIT: UserHandler in libjvm.so, mask=11100100010111111101111111111110, flags=SA_RESTART|SA_SIGINFO, blocked\n   SIGTRAP: crash_handler in libjvm.so, mask=11100100010111111101111111111110, flags=SA_RESTART|SA_SIGINFO, unblocked\n\n\nPeriodic native trim disabled\n\n---------------  S Y S T E M  ---------------\n\nOS:\nPRETTY_NAME=&quot;Debian GNU/Linux 12 (bookworm)&quot;\nNAME=&quot;Debian GNU/Linux&quot;\nVERSION_ID=&quot;12&quot;\nVERSION=&quot;12 (bookworm)&quot;\nVERSION_CODENAME=bookworm\nID=debian\nHOME_URL=&quot;https://www.debian.org/&quot;\nSUPPORT_URL=&quot;https://www.debian.org/support&quot;\nBUG_REPORT_URL=&quot;https://bugs.debian.org/&quot;\nuname: Linux 6.12.5-linuxkit #1 SMP Tue Jan 21 10:23:32 UTC 2025 aarch64\nOS uptime: 0 days 12:49 hours\nlibc: glibc 2.36 NPTL 2.36 \nrlimit (soft/hard): STACK 8192k/infinity , CORE 0k/infinity , NPROC infinity/infinity , NOFILE 1048576/1048576 , AS infinity/infinity , CPU infinity/infinity , DATA infinity/infinity , FSIZE infinity/infinity , MEMLOCK infinity/infinity\nload average: 1.79 2.09 1.98\n\n/proc/meminfo:\nMemTotal:        8024700 kB\nMemFree:          137476 kB\nMemAvailable:    6283572 kB\nBuffers:          732112 kB\nCached:          5133836 kB\nSwapCached:            0 kB\nActive:          2086932 kB\nInactive:        5060412 kB\nActive(anon):    1253352 kB\nInactive(anon):    28748 kB\nActive(file):     833580 kB\nInactive(file):  5031664 kB\nUnevictable:           0 kB\nMlocked:               0 kB\nSwapTotal:       1048572 kB\nSwapFree:        1048572 kB\nZswap:                 0 kB\nZswapped:              0 kB\nDirty:               244 kB\nWriteback:             0 kB\nAnonPages:       1162264 kB\nMapped:           215872 kB\nShmem:               696 kB\nKReclaimable:     483820 kB\nSlab:             571456 kB\nSReclaimable:     483820 kB\nSUnreclaim:        87636 kB\nKernelStack:        6960 kB\nPageTables:         5716 kB\nSecPageTables:         0 kB\nNFS_Unstable:          0 kB\nBounce:                0 kB\nWritebackTmp:          0 kB\nCommitLimit:     5060920 kB\nCommitted_AS:    2766672 kB\nVmallocTotal:   135288315904 kB\nVmallocUsed:        5600 kB\nVmallocChunk:          0 kB\nPercpu:             4512 kB\nAnonHugePages:    888832 kB\nShmemHugePages:        0 kB\nShmemPmdMapped:        0 kB\nFileHugePages:         0 kB\nFilePmdMapped:         0 kB\nHugePages_Total:       0\nHugePages_Free:        0\nHugePages_Rsvd:        0\nHugePages_Surp:        0\nHugepagesize:       2048 kB\nHugetlb:               0 kB\n\n/sys/kernel/mm/transparent_hugepage/enabled: [always] madvise never\n/sys/kernel/mm/transparent_hugepage/defrag (defrag/compaction efforts parameter): always defer defer+madvise [madvise] never\n\nProcess Memory:\nVirtual Size: 4185044K (peak: 4245924K)\nResident Set Size: 36088K (peak: 36088K) (anon: 20096K, file: 15992K, shmem: 0K)\nSwapped out: 0K\nC-Heap outstanding allocations: 27880K, retained: 1035K\nglibc malloc tunables: (default)\n\n/proc/sys/kernel/threads-max (system-wide limit on the number of threads): 62643\n/proc/sys/vm/max_map_count (maximum number of memory map areas a process may have): 262144\n/proc/sys/kernel/pid_max (system-wide limit on number of process identifiers): 99999\n\ncontainer information not found.\nSteal ticks since vm start: 0\nSteal ticks percentage since vm start:  0.000\n\nCPU: total 12 (initial active 12) 0x61:0x0:0x000:0, fp, asimd, evtstrm, aes, pmull, sha1, sha256, crc32, lse, dcpop, sha3, sha512, paca, sve2\n/proc/cpuinfo:\nprocessor   : 0\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 1\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 2\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 3\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 4\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 5\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 6\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 7\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 8\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 9\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 10\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\nprocessor   : 11\nBogoMIPS    : 48.00\nFeatures    : fp asimd evtstrm aes pmull sha1 sha2 crc32 atomics fphp asimdhp cpuid asimdrdm jscvt fcma lrcpc dcpop sha3 asimddp sha512 asimdfhm dit uscat ilrcpc flagm sb paca pacg dcpodp sve2 flagm2 frint svei8mm svebf16 bf16 afp\nCPU implementer : 0x61\nCPU architecture: 8\nCPU variant : 0x0\nCPU part    : 0x000\nCPU revision    : 0\n\n\nOnline cpus: 0-11\nOffline cpus: \n\nMemory: 4k page, physical 8024700k(6283572k free), swap 1048572k(1048572k free)\nPage Sizes: 4k\n\nvm_info: Java HotSpot(TM) 64-Bit Server VM (21.0.6+8-LTS-188) for linux-aarch64 JRE (21.0.6+8-LTS-188), built on 2024-12-03T10:50:54Z by &quot;mach5one&quot; with gcc 11.2.0\n\nEND.\n\n</code></pre>\n<p>My macos enviroment info :\nOS: macOS Sequoia 15.3.1 (24D70)\nCPU: Apple M4 Pro 12 cores\nGPU: Apple M4 Pro 16 cores</p>\n<p>I tried someone else's jdk21 mirror image, and the same error was still reported</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}