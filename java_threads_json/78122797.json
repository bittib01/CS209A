{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "trace",
      "micrometer"
    ],
    "owner": {
      "account_id": 28194601,
      "reputation": 81,
      "user_id": 21549461,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/AGNmyxY8ht7R5AsqG-1A6XCRsPRtCsp2zhXDIs5vsawC=k-s256",
      "display_name": "Pinkman",
      "link": "https://stackoverflow.com/users/21549461/pinkman"
    },
    "is_answered": true,
    "view_count": 2679,
    "answer_count": 2,
    "score": 8,
    "last_activity_date": 1740068094,
    "creation_date": 1709827520,
    "last_edit_date": 1739198942,
    "question_id": 78122797,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78122797/how-to-propagate-traceid-to-other-threads-in-one-transaction-for-spring-boot-3-x",
    "title": "How to propagate traceId to other threads in one transaction for Spring Boot 3.x along with Micrometer",
    "body": "<p>I am learning to use Micrometer to tag <code>traceId</code> and <code>spanId</code> in my log. But I have a problem with one scenario: in one method, I wrote some multi-threading code. When I use Micrometer, it looks like only main thread has <code>traceId</code> and <code>spanId</code>, while <code>traceId</code> of other threads in that same method is null.</p>\n<p>Some dummy code to show this:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public void doSomething() {\n  log.info(&quot;here is main thread&quot;);\n  executor.submit(() -&gt; log.info(&quot;here is thread1&quot;));\n}\n</code></pre>\n<p>and the result would be: only the main thread log has <code>traceId</code>.</p>\n<p>I know I could add some codes to start a new span and pass to threads. But ideally there could be implemented through by some configuration instead of inserting too much non-related code in my business method.</p>\n<p>Is this supported, or just I need to manually create new span and pass it?</p>\n<p>I am expecting to propagate same <code>traceId</code> to other threads in one transaction/method.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}