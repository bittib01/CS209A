{
  "question": {
    "tags": [
      "java",
      "swing",
      "gnome"
    ],
    "owner": {
      "account_id": 19422668,
      "reputation": 49,
      "user_id": 14204857,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/wSz4U.png?s=256",
      "display_name": "Just a Developer",
      "link": "https://stackoverflow.com/users/14204857/just-a-developer"
    },
    "is_answered": false,
    "view_count": 184,
    "answer_count": 1,
    "score": 2,
    "last_activity_date": 1754418596,
    "creation_date": 1753900478,
    "last_edit_date": 1754242834,
    "question_id": 79720389,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79720389/undecorated-jframe-freezes-when-setting-background-to-transparent-at-runtime-in",
    "title": "Undecorated JFrame freezes when setting background to transparent at runtime in java swing, gnome desktop",
    "body": "<p>I'm basically trying to build my own custom undecorated <code>JFrame</code> where when I press the title <code>JLabel</code>, I show a custom matte border around the <code>JFrame</code> and make everything else on the <code>JFrame</code> transparent and invisible until the dragging is done.</p>\n<p>Here is the normal screenshot with  the gtk effects still shown without setting background of <code>this</code> to <code>new Color(0,0,0,0)</code> in Main:</p>\n<p><a href=\"https://i.sstatic.net/g4OOERIz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/g4OOERIz.png\" alt=\"custom aero jframe wit gtk shaddow\" /></a></p>\n<p>this is the result when i add it in main:\n<a href=\"https://i.sstatic.net/82HrhF9T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/82HrhF9T.png\" alt=\"enter image description here\" /></a>\nthe GTK aniamtion and shadow is gone and glitch artifacts apear appon hovering the X and min buttons</p>\n<p>In Title dragging I was expecting this:\n<a href=\"https://i.sstatic.net/TpGGQvwJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/TpGGQvwJ.png\" alt=\"enter image description here\" /></a>\n(with the Main code)</p>\n<p>But got</p>\n<p><a href=\"https://i.sstatic.net/oTk14bMA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/oTk14bMA.png\" alt=\"enter image description here\" /></a>\n(Without that Main code)</p>\n<p>As you can see with the main code the gtk effects break and i get visual artifacts but the dragging border works fine. So I want to be able to retain the gtk shaddow and animation while still be able to get this transparent dragging border without mouse drag stopping or black background</p>\n<p>Can anyone help me?</p>\n<p>here is my minimal reproducable example:</p>\n<pre><code>package javaaeroglassproject;\n\nimport java.awt.*;\nimport javax.swing.*;\nimport javax.swing.border.LineBorder;\n\npublic class mcve extends JFrame {\n\nprivate boolean isDragging = false;\nprivate int pressX = 0, pressY = 0;\n\npublic mcve() {\n    setUndecorated(true);\n    setSize(400, 180);\n    setLocationRelativeTo(null);\n    setLayout(null);\n    setDefaultCloseOperation(EXIT_ON_CLOSE);\n\n    // Frame border (background panel)\n    JLabel frameBorder = new JLabel();\n    frameBorder.setOpaque(false);\n    frameBorder.setBackground(new Color(230, 230, 230));\n    frameBorder.setLayout(null);\n    frameBorder.setLocation(0, 0);\n    frameBorder.setSize(400, 180);\n    add(frameBorder);\n\n    // Title label\n    JLabel title = new JLabel(&quot;Window Title&quot;);\n    title.setFont(new Font(&quot;Segoe UI&quot;, Font.BOLD, 14));\n    title.setForeground(Color.DARK_GRAY);\n    title.setLocation(10, 0);\n    title.setSize(330, 36);\n    frameBorder.add(title);\n    JButton closeButton = new JButton(&quot;X&quot;);\n    closeButton.setForeground(Color.WHITE);\n    closeButton.setBackground(new Color(200, 0, 0));\n    closeButton.setBorder(new LineBorder(Color.DARK_GRAY));\n    closeButton.setFocusable(false);\n    closeButton.setLocation(371, 6);\n    closeButton.setSize(23, 23);\n    frameBorder.add(closeButton);\n\n    closeButton.addActionListener(e -&gt; System.exit(0));\n    closeButton.addMouseListener(new java.awt.event.MouseAdapter() {\n        public void mouseEntered(java.awt.event.MouseEvent e) {\n            closeButton.setBackground(new Color(255, 50, 50));\n        }\n\n        public void mouseExited(java.awt.event.MouseEvent e) {\n            closeButton.setBackground(new Color(200, 0, 0));\n        }\n\n        public void mousePressed(java.awt.event.MouseEvent e) {\n            closeButton.setBackground(new Color(160, 0, 0));\n        }\n    });\n\n    // Minimize button\n    JButton minButton = new JButton(&quot;-&quot;);\n    minButton.setForeground(Color.WHITE);\n    minButton.setBackground(new Color(130, 130, 130));\n    minButton.setBorder(new LineBorder(Color.DARK_GRAY));\n    minButton.setFocusable(false);\n    minButton.setLocation(345, 6);\n    minButton.setSize(23, 23);\n    frameBorder.add(minButton);\n\n    minButton.addActionListener(e -&gt; setState(Frame.ICONIFIED));\n    minButton.addMouseListener(new java.awt.event.MouseAdapter() {\n        public void mouseEntered(java.awt.event.MouseEvent e) {\n            minButton.setBackground(new Color(160, 160, 160));\n        }\n\n        public void mouseExited(java.awt.event.MouseEvent e) {\n            minButton.setBackground(new Color(130, 130, 130));\n        }\n\n        public void mousePressed(java.awt.event.MouseEvent e) {\n            minButton.setBackground(new Color(100, 100, 100));\n        }\n    });\n\n    // Inner content\n    JPanel appInner = new JPanel();\n    appInner.setLayout(null);\n    appInner.setBackground(Color.WHITE);\n    appInner.setBorder(new LineBorder(Color.GRAY));\n    appInner.setLocation(5, 35);\n    appInner.setSize(390, 140);\n    frameBorder.add(appInner);\n\n    JLabel message = new JLabel(&quot;&lt;html&gt;This is a dialog text. The quick brown fox jumps over the lazy dog.&lt;/html&gt;&quot;);\n    message.setLocation(20, 20);\n    message.setSize(350, 80);\n    appInner.add(message);\n    title.addMouseListener(new java.awt.event.MouseAdapter() {\n        public void mousePressed(java.awt.event.MouseEvent e) {\n            isDragging = true;\n            pressX = e.getX();\n            pressY = e.getY();\n            closeButton.setVisible(false);\n            appInner.setVisible(false);\n            minButton.setVisible(false);\n            title.setVisible(false);\n            frameBorder.setBorder(new LineBorder(Color.GRAY, 2));\n            frameBorder.setBackground(new Color(0,0,0,0));\n            frameBorder.setCursor(Cursor.getPredefinedCursor(Cursor.MOVE_CURSOR));\n            setBackground(new Color(0, 0, 0, 0));\n            getRootPane().setBackground(new Color(0,0,0,0));\n            getContentPane().setBackground(new Color(0, 0, 0, 0));\n        }\n\n        public void mouseReleased(java.awt.event.MouseEvent e) {\n            isDragging = false;\n            frameBorder.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));\n            frameBorder.setBorder(new LineBorder(Color.GRAY, 0));\n        }\n    });\n\n    title.addMouseMotionListener(new java.awt.event.MouseMotionAdapter() {\n        public void mouseDragged(java.awt.event.MouseEvent e) {\n            if (isDragging) {\n                setLocation(e.getXOnScreen() - pressX, e.getYOnScreen() - pressY);\n            }\n        }\n    });\n\n    // Close button\n   \n}\n\npublic static void main(String[] args) {\n    SwingUtilities.invokeLater(() -&gt; new mcve().setVisible(true));\n}\n}\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}