{
  "question": {
    "tags": [
      "java",
      "apache-poi"
    ],
    "owner": {
      "account_id": 21526706,
      "reputation": 1,
      "user_id": 15866858,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/AATXAJyqtETk3UH3OVMAjDF8P7oOPtmm6-UnqlX6fZnJ=k-s256",
      "display_name": "Fly Dragon",
      "link": "https://stackoverflow.com/users/15866858/fly-dragon"
    },
    "is_answered": false,
    "view_count": 153,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1741280215,
    "creation_date": 1715075785,
    "last_edit_date": 1715075838,
    "question_id": 78441630,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78441630/apache-poi-read-word-then-throw-unsupportedzipfeatureexception-unsupported-featu",
    "title": "Apache POI read Word，then throw UnsupportedZipFeatureException：Unsupported feature data descriptor used in entry word/media/image2.jpeg",
    "body": "<p>I try to parse the document with <code>XWPFDocument document = new XWPFDocument(inputStream);</code></p>\n<p>the while error is that:</p>\n<pre><code>java\norg.apache.commons.compress.archivers.zip.UnsupportedZipFeatureException: Unsupported feature data descriptor used in entry word/media/image2.jpeg\n    at org.apache.commons.compress.archivers.zip.ZipArchiveInputStream.read(ZipArchiveInputStream.java:447)\n    at java.base/java.io.FilterInputStream.read(FilterInputStream.java:132)\n    at org.apache.poi.openxml4j.util.ZipArchiveThresholdInputStream.read(ZipArchiveThresholdInputStream.java:80)\n    at org.apache.poi.util.IOUtils.toByteArray(IOUtils.java:182)\n    at org.apache.poi.util.IOUtils.toByteArray(IOUtils.java:149)\n    at org.apache.poi.util.IOUtils.toByteArray(IOUtils.java:136)\n    at org.apache.poi.openxml4j.util.ZipArchiveFakeEntry.&lt;init&gt;(ZipArchiveFakeEntry.java:47)\n    at org.apache.poi.openxml4j.util.ZipInputStreamZipEntrySource.&lt;init&gt;(ZipInputStreamZipEntrySource.java:53)\n    at org.apache.poi.openxml4j.opc.ZipPackage.&lt;init&gt;(ZipPackage.java:106)\n    at org.apache.poi.openxml4j.opc.OPCPackage.open(OPCPackage.java:307)\n    at org.apache.poi.ooxml.util.PackageHelper.open(PackageHelper.java:47)\n    at org.apache.poi.xwpf.usermodel.XWPFDocument.&lt;init&gt;(XWPFDocument.java:142)\n</code></pre>\n<p>I know the root reason is about <code>ZipArchiveInputStream</code>, it do work when i use <code>new ZipArchiveInputStream(inputStream, CharsetUtil.defaultCharset().name(),false, true)</code>,\nbut in XWPFDocument<code>s constructor method, it use ZipArchiveInputStream</code>s default constructor, arg <code>allowStoredEntriesWithDataDescriptor</code> is default <code>false</code>.</p>\n<p>How can i deal with XWPFDocument about this problem to parse document correctly</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}