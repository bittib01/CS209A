{
  "question": {
    "tags": [
      "java",
      "java-17",
      "apache-commons-fileupload"
    ],
    "owner": {
      "account_id": 16766539,
      "reputation": 29,
      "user_id": 17070576,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/f6804751883c278d20511efb6840c340?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Zimeon",
      "link": "https://stackoverflow.com/users/17070576/zimeon"
    },
    "is_answered": true,
    "view_count": 350,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1740178223,
    "creation_date": 1740133224,
    "question_id": 79457040,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79457040/how-do-i-set-repository-and-file-threshold-when-migrating-to-apache-commons-file",
    "title": "How do I set repository and file threshold when migrating to Apache Commons Fileupload 2.x?",
    "body": "<p>I am upgrading an old Java 11 project to work with Java 17.\nThe old version used javax.servlet.* and I am thus upgrading this to jakarta.servlet.*</p>\n<p>The problem I cannot find the solution to regards the DiskFileItemFactory</p>\n<p>Old code:</p>\n<p><code>ServletFileUpload = new ServletFileUpload(new DiskFileItemFactory(DiskFileItemFactory.DEFAULT_SIZE_THRESHOLD, dir));</code></p>\n<p>In version 2.x, the constructor is private, so instead I use</p>\n<p><code>ServletFileUpload = new JakartaServletFileUpload(DiskFileItemFactory.builder().get());</code></p>\n<p>However, the Builder for DiskFileItemFactory does not have any setRepository and setThreshold. I know that this repository is just a folder for temporary files, and in the API for 2.x DiskFileItemFactory.Builder.get(), I read:</p>\n<blockquote>\n<p>Constructs a new instance. This builder use the aspects Path and buffer size. You must provide an origin that can be converted to a Reader by this builder, otherwise, this call will throw an UnsupportedOperationException.</p>\n</blockquote>\n<p>So, the Builder uses the Path and buffer size of the <em>aspect</em>. What is the ASPECT, then? Well, this may all be fine, as this path is just for temporary files, but I am still miffed, partly because the DiskFileItemFactory itself has .getRepository() and .getThreshold(), so I would like to set them anyway (and the old code does, and it might be important)</p>\n<p>The DiskFileItemFactory.Builder DOES inherit a the method .setPath() from org.apache.commons.io.build.AbstractOriginSupplier, and methods .setBufferSize() and .setBufferSizeMax() from org.apache.commons.io.build.AbstractStreamBuilder, but it's unclear whether these correspond to setRepository() and setThreshold, as the API of these very general and abstract classes divulge next to nothing. The .setPath() method says only that it &quot;sets a new origin&quot; and nothing else.</p>\n<p>So, my questions are:</p>\n<ol>\n<li>What is the &quot;ASPECT&quot; from which DiskFileItemFactory.Builder.get() takes the path and buffer size from?</li>\n<li>Is the Path and BufferSize equivalent to the previous Respository and Threshold?</li>\n</ol>\n<p>Ayone knows?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}