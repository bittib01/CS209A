{
  "question": {
    "tags": [
      "java",
      "grpc",
      "grpc-java"
    ],
    "owner": {
      "account_id": 1979154,
      "reputation": 751,
      "user_id": 1776171,
      "user_type": "registered",
      "accept_rate": 25,
      "profile_image": "https://www.gravatar.com/avatar/8fcefa54cedda10ce98312baeee39df3?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "nawK",
      "link": "https://stackoverflow.com/users/1776171/nawk"
    },
    "is_answered": false,
    "view_count": 436,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1734894862,
    "creation_date": 1709772446,
    "last_edit_date": 1709786423,
    "question_id": 78118181,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78118181/the-proper-way-to-setting-grpc-java-logs-programmatically",
    "title": "The proper way to setting gRPC java logs programmatically",
    "body": "<p>Perhaps the title of this question should be:\nHow to disable/set gRPC java logs programmatically in 2024?</p>\n<p>Several credible sources from a few years ago say that:</p>\n<blockquote>\n<p>gRPC uses java.util.Logging\n(<a href=\"https://groups.google.com/g/grpc-io/c/CwfnBqDeFrQ\" rel=\"nofollow noreferrer\">grpc-io mailing list</a>)</p>\n</blockquote>\n<blockquote>\n<p>At runtime you can do something like\n<code>Logger.getLogger(&quot;io.grpc&quot;).setLevel(Level.INFO)</code> (typing from memory). (<a href=\"https://github.com/grpc/grpc-java/issues/2994\" rel=\"nofollow noreferrer\">grpc-java issue #2994</a>)</p>\n</blockquote>\n<p>The following is my attempt at finding out the registered loggers and then disabling them one by one:</p>\n<pre><code>java.util.logging.Logger logger;\nEnumeration&lt;String&gt; iter = java.util.logging\n                                    .LogManager\n                                    .getLogManager()\n                                    .getLoggerNames();\nwhile (iter.hasMoreElements())\n{\n      String loggerName = iter.nextElement();\n      System.out.println(loggerName); // whois logging?\n      logger = java.util.logging.Logger.getLogger(loggerName);\n              logger.setLevel(Level.OFF);\n      for (Handler h : logger.getHandlers()) {\n          h.setLevel(Level.OFF);\n      }   \n}\n</code></pre>\n<p>and we've found the following loggers registered with JDK's logging facility (see the end of the output). But, the above code did not disable them:</p>\n<pre><code>2024-03-06 19:16:50,460 DEBUG [main] io.netty.util.internal.logging.InternalLoggerFactory: Using Log4J as the default logging framework\n2024-03-06 19:16:50,461 DEBUG [main] io.netty.util.internal.PlatformDependent0: -Dio.netty.noUnsafe: false\nv2024-03-06 19:16:50,462 DEBUG [main] io.netty.util.internal.PlatformDependent0: Java version: 19\n...\n2024-03-06 19:16:50,569 DEBUG [main] io.netty.buffer.PooledByteBufAllocator: -Dio.netty.allocator.maxCachedBufferCapacity: 32768\n2024-03-06 19:16:50,569 DEBUG [main] io.netty.buffer.PooledByteBufAllocator: -Dio.netty.allocator.maxCachedBufferCapacity: 32768\n2024-03-06 19:16:50,569 DEBUG [main] io.netty.buffer.PooledByteBufAllocator: -Dio.netty.allocator.cacheTrimInterval: 8192\n2024-03-06 19:16:50,569 DEBUG [main] io.netty.buffer.PooledByteBufAllocator: -Dio.netty.allocator.cacheTrimIntervalMillis: 0\n2024-03-06 19:16:50,569 DEBUG [main] io.netty.buffer.PooledByteBufAllocator: -Dio.netty.allocator.useCacheForAllThreads: false\n2024-03-06 19:16:50,569 DEBUG [main] io.netty.buffer.PooledByteBufAllocator: -Dio.netty.allocator.maxCachedByteBuffersPerChunk: 1023\n2024-03-06 19:16:50,591 DEBUG [grpc-nio-boss-ELG-1-1] io.netty.channel.DefaultChannelId: -Dio.netty.processId: 22423 (auto-detected)\n2024-03-06 19:16:50,592 DEBUG [grpc-nio-boss-ELG-1-1] io.netty.util.NetUtil: -Djava.net.preferIPv4Stack: false\n2024-03-06 19:16:50,592 DEBUG [grpc-nio-boss-ELG-1-1] io.netty.util.NetUtil: -Djava.net.preferIPv6Addresses: false\n2024-03-06 19:16:50,593 DEBUG [grpc-nio-boss-ELG-1-1] io.netty.util.NetUtilInitializations: Loopback interface: lo (lo, 0:0:0:0:0:0:0:1%lo)\n2024-03-06 19:16:50,594 DEBUG [grpc-nio-boss-ELG-1-1] io.netty.util.NetUtil: /proc/sys/net/core/somaxconn: 4096\n2024-03-06 19:16:50,595 DEBUG [grpc-nio-boss-ELG-1-1] io.netty.channel.DefaultChannelId: -Dio.netty.machineId: 48:5b:39:ff:fe:7f:9d:15 (auto-detected)\n2024-03-06 19:16:50,606 DEBUG [grpc-nio-boss-ELG-1-1] io.netty.buffer.ByteBufUtil: -Dio.netty.allocator.type: pooled\n2024-03-06 19:16:50,606 DEBUG [grpc-nio-boss-ELG-1-1] io.netty.buffer.ByteBufUtil: -Dio.netty.threadLocalDirectBufferSize: 0\n2024-03-06 19:16:50,606 DEBUG [grpc-nio-boss-ELG-1-1] io.netty.buffer.ByteBufUtil: -Dio.netty.maxThreadLocalCharBufferSize: 16384\n2024-03-06 19:16:50,621 INFO  [main] root: Server listening on host /[0:0:0:0:0:0:0:0]:12345:12345\n\n&lt;From my System.out.println()s&gt;\nio.grpc.Context\nio.grpc.internal.ReflectionLongAdderCounter\nio.grpc.internal.ServerImplBuilder\nglobal\nio.grpc.internal.InternalServer\nio.grpc.netty.ProtocolNegotiators\nio.grpc.netty.Utils\nio.grpc.internal.ProxyDetectorImpl\nio.grpc.internal.ServerImpl\nio.grpc.internal.GrpcUtil\nio.grpc.Metadata\nio.grpc.InternalChannelz\njava.io.serialization\n</code></pre>\n<p>Clearly, there are some gRPC elements using JDK's standard logging facility, but I guess there aren't any log messages from <em>those loggers</em> in the above output. I am just not sure, as I am not too familiar with logging.  At least I am not sure which log messages are coming from which loggers/services.</p>\n<p>Finally, I was able to turn off all logs we earlier saw (above) by\ndisablinig l4j2's root logger: <code>this.logger.getRootLogger().setLevel(Level.OFF);</code></p>\n<p>Q1) Is gRPC now using l4j2 as their logger (instead of JDK's standard logging facility)?</p>\n<p>Q2) What is the proper way to set/disable log messages from grpc-java programmatically?</p>\n<p><em>FYI: I definitely would like to turn off the io.netty stuff among the many others</em></p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}