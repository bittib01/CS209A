{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "soap",
      "jax-rs",
      "webservice-client"
    ],
    "owner": {
      "account_id": 12261495,
      "reputation": 390,
      "user_id": 8949066,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/da46c64c9b2e7f38b8bc3e8539bcacfa?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Thalys Menezes",
      "link": "https://stackoverflow.com/users/8949066/thalys-menezes"
    },
    "is_answered": true,
    "view_count": 173,
    "accepted_answer_id": 79284945,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1735044131,
    "creation_date": 1734034780,
    "last_edit_date": 1734035739,
    "question_id": 79276481,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79276481/how-to-properly-add-http-header-in-webservice-client-spring-web-services",
    "title": "How to properly add HTTP header in WebService Client (Spring Web Services)",
    "body": "<p>Does anyone know how to properly add <strong>HTTP headers</strong> in a Soap Web Service client generated by <strong>jaxws</strong> from a <strong>wsdl</strong> file?</p>\n<p>I can access the services from <strong>SoapUI</strong>, but when I try to access them from my Spring project, I keep getting 403 response.</p>\n<p>Below is the request details from SoapUI interface:</p>\n<pre><code>POST https://WEB_SERVICE_URL HTTP/1.1\nAccept-Encoding: gzip,deflate\nContent-Type: text/xml;charset=UTF-8\nSOAPAction: &quot;&quot;\nAUTH_HEADER: AUTH_HEADER_VALUE\nContent-Length: 224\nHost: WEB_SERVICE_HOST\nConnection: Keep-Alive\nUser-Agent: Apache-HttpClient/4.5.5 (Java/16.0.2)\n</code></pre>\n<p>SoapUI raw response:</p>\n<pre><code>HTTP/1.1 200 OK\nContent-Type: text/xml;charset=UTF-8\nTransfer-Encoding: chunked\nConnection: keep-alive\nserver: Apache-Coyote/1.1\naccess-control-allow-origin: https://pje.trt13.jus.br\naccess-control-allow-headers: Authorization, Content-Type, x-xsrf-token\naccess-control-allow-credentials: true\nset-cookie: JSESSIONID=08a467eac8b5a940~3Gv3nJT+VOBPIT-lNSphT3lO; Path=/primeirograu; Secure\ndate: Thu, 12 Dec 2024 19:22:03 GMT\nstrict-transport-security: max-age=15768000; includeSubDomains; preload\ncache-control: public, no-transform\ncontent-security-policy: frame-ancestors 'self' jte.csjt.jus.br jte.trt5.jus.br *.jte.trt5.jus.br\nx-content-type-options: nosniff\nreferrer-policy: no-referrer-when-downgrade\nfeature-policy: camera 'none'; microphone 'none'\naccess-control-expose-headers: Date\nvary: Accept-Encoding\nX-Cache: Miss from cloudfront\nVia: 1.1 f9bea17c7a13cd7f1b28e1a7cb598810.cloudfront.net (CloudFront)\nX-Amz-Cf-Pop: FOR50-P3\nX-Amz-Cf-Id: bXKBzXIxFnWPmG2Fa3U5GMQ9TquiYguIJyGRCBzTiMt0Sih2pl6TvQ==\n\n&lt;soap:Envelope xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;\n    &lt;soap:Body&gt;\n        &lt;ns2:consultarJurisdicoesResponse xmlns:ns2=&quot;http://ws.pje.cnj.jus.br/&quot;&gt;\n            &lt;return&gt;&lt;descricao&gt;Santa Rita&lt;/descricao&gt;&lt;id&gt;41&lt;/id&gt;&lt;/return&gt;\n            &lt;return&gt;&lt;descricao&gt;Itaporanga&lt;/descricao&gt;&lt;id&gt;46&lt;/id&gt;&lt;/return&gt;\n            &lt;return&gt;&lt;descricao&gt;Guarabira&lt;/descricao&gt;&lt;id&gt;48&lt;/id&gt;&lt;/return&gt;\n            &lt;return&gt;&lt;descricao&gt;Catolé do Rocha&lt;/descricao&gt;&lt;id&gt;49&lt;/id&gt;&lt;/return&gt;\n            &lt;return&gt;&lt;descricao&gt;Patos&lt;/descricao&gt;&lt;id&gt;50&lt;/id&gt;&lt;/return&gt;\n            &lt;return&gt;&lt;descricao&gt;Sousa&lt;/descricao&gt;&lt;id&gt;51&lt;/id&gt;&lt;/return&gt;\n            &lt;return&gt;&lt;descricao&gt;Campina Grande&lt;/descricao&gt;&lt;id&gt;55&lt;/id&gt;&lt;/return&gt;\n            &lt;return&gt;&lt;descricao&gt;João Pessoa&lt;/descricao&gt;&lt;id&gt;44&lt;/id&gt;&lt;/return&gt;\n        &lt;/ns2:consultarJurisdicoesResponse&gt;\n    &lt;/soap:Body&gt;\n&lt;/soap:Envelope&gt;\n</code></pre>\n<p>Here is my <strong>client factory</strong>:</p>\n<pre><code>@Component\npublic class TRT13Client {\n\n    private ConsultaPJeService222 consultaPJeTrtService = new ConsultaPJeService222();\n\n    public ConsultaPJe222 getConsultaPJeTrtService() {\n        ConsultaPJe222 consultaPJeTRT = consultaPJeTrtService.getConsultaPJePort();\n\n        Map&lt;String, List&lt;String&gt;&gt; requestHeaders = new HashMap&lt;&gt;();\n        requestHeaders.put(AUTH_HEADER, List.of(AUTH_HEADER_VALUE));\n\n        BindingProvider bindingProvider = (BindingProvider) consultaPJeTRT;\n        bindingProvider.getRequestContext().put(MessageContext.HTTP_REQUEST_HEADERS, requestHeaders);\n\n        return consultaPJeTRT;\n    }\n}\n</code></pre>\n<p>And here is the Controller where I inject the client:</p>\n<pre><code>@RestController\n@RequestMapping(&quot;trt13/jurisdicao&quot;)\n@RequiredArgsConstructor\npublic class JurisdicaoTRT13Controller {\n\n    private final TRT13Client trt13Client;\n\n    @GetMapping\n    public ResponseEntity&lt;List&lt;Jurisdicao&gt;&gt; buscarJurisdicoes() {\n        return ResponseEntity.ok(trt13Client.getConsultaPJeTrtService().consultarJurisdicoes());\n    }\n</code></pre>\n<p>}</p>\n<p>I found this solution in this SO post: <a href=\"https://stackoverflow.com/questions/6666060/java-web-service-client-adding-http-headers\">java web service client, adding http headers</a> but for some reason it seems not to be working. I've also tried a couple of solutions similar to this one, but had success in none of them.</p>\n<p>All types, including <strong>ConsultaPJeService222</strong> were generated by jaxws wsimport task.</p>\n<p>Does anyone know what am I doing wrong?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}