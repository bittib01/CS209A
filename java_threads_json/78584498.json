{
  "question": {
    "tags": [
      "java",
      "ssl",
      "xmpp",
      "tls1.2",
      "openfire"
    ],
    "owner": {
      "account_id": 11076154,
      "reputation": 41,
      "user_id": 8132824,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/78d53fa9c7dc42ea2dfc1515e39eac5b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "lamar8080",
      "link": "https://stackoverflow.com/users/8132824/lamar8080"
    },
    "is_answered": false,
    "view_count": 110,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1724846096,
    "creation_date": 1717648331,
    "last_edit_date": 1724845990,
    "question_id": 78584498,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78584498/client-connections-to-openfire-fails-with-caused-by-javax-net-ssl-sslexception",
    "title": "Client connections to openfire fails with: Caused by: javax.net.ssl.SSLException",
    "body": "<p>I am using Openfire version: 4.7.5 with iOS clients.</p>\n<p>When iOS clients attempt to connect to openfire, we are running into ssl exceptions. As per out current openfire configuration, STARTTLS policy was set to ‘Required’ with TLSv1.2 as the encryption protocol.</p>\n<pre><code>Closing connection due to exception in session: (0x00052A54: nio socket, server, null =&gt; 0.0.0.0/0.0.0.0:5222) org.apache.mina.core.filterchain.IoFilterLifeCycleException: clear(): tls in (0x00052A54: nio socket, server, null =&gt; 0.0.0.0/0.0.0.0:5222)     \n     at org.apache.mina.core.filterchain.DefaultIoFilterChain.clear(DefaultIoFilterChain.java:449) [mina-core-2.1.6.jar:?]\n     at org.apache.mina.core.filterchain.DefaultIoFilterChain$TailFilter.sessionClosed(DefaultIoFilterChain.java:966) ~[mina-core-2.1.6.jar:?]     \n     at org.apache.mina.core.filterchain.DefaultIoFilterChain.callNextSessionClosed(DefaultIoFilterChain.java:606) [mina-core-2.1.6.jar:?]\nCaused by: org.apache.mina.core.filterchain.IoFilterLifeCycleException: onPreRemove(): tls:SslFilter in (0x00052A54: nio socket, server, null =&gt; 0.0.0.0/0.0.0.0:5222)\n     at org.apache.mina.core.filterchain.DefaultIoFilterChain.deregister(DefaultIoFilterChain.java:487) ~[mina-core-2.1.6.jar:?]\n     at org.apache.mina.core.filterchain.DefaultIoFilterChain.clear(DefaultIoFilterChain.java:447) [mina-core-2.1.6.jar:?]\n     ... 18 more\nCaused by: javax.net.ssl.SSLException: Improper close state: Status = OK HandshakeStatus = NEED_WRAP bytesConsumed = 0 bytesProduced = 7\n     at org.apache.mina.filter.ssl.SslHandler.closeOutbound(SslHandler.java:496) ~[mina-core-2.1.6.jar:?]\n     at org.apache.mina.filter.ssl.SslFilter.initiateClosure(SslFilter.java:773) ~[mina-core-2.1.6.jar:?]\n     at org.apache.mina.filter.ssl.SslFilter.stopSsl(SslFilter.java:325) ~[mina-core-2.1.6.jar:?]\n</code></pre>\n<p>Once we updated the STARTTLS policy to ‘optional’, the clients are able to connect to openfire, but then the traffic is not encrypted.Trying to figure out the root cause in this case, and also what needs to be done to get it working with STARTTLS policy= required.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}