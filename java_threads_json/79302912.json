{
  "question": {
    "tags": [
      "java",
      "image"
    ],
    "owner": {
      "account_id": 34046759,
      "reputation": 53,
      "user_id": 26358326,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/c330330260b4ab83aa2c743cbca76778?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Spongerooski",
      "link": "https://stackoverflow.com/users/26358326/spongerooski"
    },
    "is_answered": false,
    "view_count": 95,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1734956331,
    "creation_date": 1734952847,
    "question_id": 79302912,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79302912/how-can-i-upload-an-image-to-the-imagebb-api-in-android",
    "title": "How can I upload an image to the ImageBB API in Android?",
    "body": "<p>I want to utilize <code>https://api.imgbb.com/1/upload</code> in order to upload Bitmaps onto ImageBB using HttpURLConnection as follows:</p>\n<p>Upload an image:</p>\n<pre class=\"lang-java prettyprint-override\"><code>  public JsonObject uploadImage(Bitmap bitmap) throws IOException, ExecutionException, InterruptedException {\n    JsonObject JSONInput = new JsonObject();\n    JSONInput.addProperty(\n      &quot;image&quot;, BASE_64_IMAGE_STRING\n    );\n    JsonObject response = new Requests().execute(JSONInput).get();\n    return response;\n  }\n</code></pre>\n<p>Requests Class:</p>\n<pre class=\"lang-java prettyprint-override\"><code>public class Requests extends AsyncTask&lt;JsonObject, JsonObject, JsonObject&gt; {\n  @Override\n  protected JsonObject doInBackground(JsonObject... jsonObjects) {\n    URL url = null;\n    url = new URL(&quot;https://api.imgbb.com/1/upload?key=API_KEY&amp;expiration=300&quot;);\n    HttpURLConnection connection = null;\n    \n    connection = (HttpURLConnection) url.openConnection();\n    \n    connection.setRequestMethod(&quot;POST&quot;)\n    connection.setRequestProperty(&quot;Content-Type&quot;, &quot;application/json&quot;);\n    connection.setDoOutput(true);\n\n    OutputStream os = connection.getOutputStream()\n      OutputStreamWriter osw = new OutputStreamWriter(os, StandardCharsets.UTF_8);\n      osw.write(jsonObjects[0].toString());\n      osw.flush();\n      osw.close();\n\n    connection.connect()\n    String result = new BufferedReader(new InputStreamReader(connection.getErrorStream()))\n      .lines().collect(Collectors.joining(&quot;\\n&quot;));\n    StringBuilder response = new StringBuilder();\n    BufferedReader br = new BufferedReader(\n      new InputStreamReader(connection.getInputStream(), StandardCharsets.UTF_8))\n      String responseLine = null;\n      while ((responseLine = br.readLine()) != null) {\n        response.append(responseLine.trim());\n     \n\n    Gson gson = new GsonBuilder().setPrettyPrinting().create();\n    JsonElement jelem = gson.fromJson(response.toString(), JsonElement.class);\n    return jelem.getAsJsonObject();\n  }\n\n  @Override\n  protected void onPostExecute(JsonObject jsonObject) {\n    super.onPostExecute(jsonObject);\n  }\n}\n</code></pre>\n<p>The <code>jsonObjects</code> consists of a single element which is of the form {&quot;image&quot;: base64_representation_of_image&quot;}</p>\n<p>However, I keep getting <code>{&quot;status_code&quot;:400,&quot;error&quot;:{&quot;message&quot;:&quot;Empty upload source.&quot;,&quot;code&quot;:130},&quot;status_txt&quot;:&quot;Bad Request&quot;}</code> back from the API. I can't seem to figure out what I am doing wrong.</p>\n<p>I can't find out any resources which use similar APIs in Android. Any direction would be appreciated.</p>\n<p>I am trying to use the HttpURLConnection class in order to make API requests to ImageBB. However, it does not seem to recognise the base64 image string I am passing</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}