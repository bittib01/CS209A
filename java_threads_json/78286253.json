{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "maven",
      "graalvm",
      "byte-buddy"
    ],
    "owner": {
      "account_id": 31260477,
      "reputation": 61,
      "user_id": 24068400,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/d59632dfa1c1ac5596067631a90be7b8?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "khrabar",
      "link": "https://stackoverflow.com/users/24068400/khrabar"
    },
    "is_answered": true,
    "view_count": 2630,
    "answer_count": 2,
    "score": 5,
    "last_activity_date": 1749579134,
    "creation_date": 1712448618,
    "last_edit_date": 1712491376,
    "question_id": 78286253,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78286253/caused-by-java-lang-nosuchmethodexception-org-hibernate-bytecode-internal-byte",
    "title": "Caused by: java.lang.NoSuchMethodException: org.hibernate.bytecode.internal.bytebuddy.BytecodeProviderImpl.&lt;init&gt;()",
    "body": "<p>Trying to create a native image using GraalVM and Spring Boot. The app itself works when i use the mvn spring-boot:run command, but when I build my native image and try to run it, I get this exception:</p>\n<pre><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory': org.hibernate.bytecode.spi.BytecodeProvider: org.hibernate.bytecode.internal.bytebuddy.BytecodeProviderImpl Unable to get public no-arg constructor\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1786) ~[app:6.1.5]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:600) ~[app:6.1.5]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:522) ~[app:6.1.5]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:326) ~[app:6.1.5]\n    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234) ~[app:6.1.5]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:324) ~[app:6.1.5]\n    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:200) ~[app:6.1.5]\n    at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1234) ~[app:6.1.5]\n    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:952) ~[app:6.1.5]\n    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:624) ~[app:6.1.5]\n    at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146) ~[na:na]\n    at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:754) ~[app:3.2.4]\n    at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:456) ~[app:3.2.4]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:334) ~[app:3.2.4]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1354) ~[app:3.2.4]\n    at org.springframework.boot.SpringApplication.run(SpringApplication.java:1343) ~[app:3.2.4]\n    at com.library.app.AppApplication.main(AppApplication.java:10) ~[app:na]\n    at java.base@22/java.lang.invoke.LambdaForm$DMH/sa346b79c.invokeStaticInit(LambdaForm$DMH) ~[na:na]\nCaused by: java.util.ServiceConfigurationError: org.hibernate.bytecode.spi.BytecodeProvider: org.hibernate.bytecode.internal.bytebuddy.BytecodeProviderImpl Unable to get public no-arg constructor\n    at java.base@22/java.util.ServiceLoader.fail(ServiceLoader.java:582) ~[app:na]\n    at java.base@22/java.util.ServiceLoader.getConstructor(ServiceLoader.java:675) ~[app:na]\n    at java.base@22/java.util.ServiceLoader$LazyClassPathLookupIterator.hasNextService(ServiceLoader.java:1236) ~[na:na]\n    at java.base@22/java.util.ServiceLoader$LazyClassPathLookupIterator.hasNext(ServiceLoader.java:1269) ~[na:na]\n    at java.base@22/java.util.ServiceLoader$2.hasNext(ServiceLoader.java:1305) ~[na:na]\n    at java.base@22/java.util.ServiceLoader$ProviderSpliterator.tryAdvance(ServiceLoader.java:1485) ~[na:na]\n    at java.base@22/java.util.Spliterators$1Adapter.hasNext(Spliterators.java:681) ~[na:na]\n    at org.hibernate.boot.registry.classloading.internal.AggregatedServiceLoader$ClassPathAndModulePathAggregatedServiceLoader.loadAll(AggregatedServiceLoader.java:123) ~[na:na]\n    at org.hibernate.boot.registry.classloading.internal.AggregatedServiceLoader$ClassPathAndModulePathAggregatedServiceLoader.getAll(AggregatedServiceLoader.java:112) ~[na:na]\n    at org.hibernate.boot.registry.classloading.internal.ClassLoaderServiceImpl.loadJavaServices(ClassLoaderServiceImpl.java:241) ~[na:na]\n    at org.hibernate.bytecode.internal.BytecodeProviderInitiator.initiateService(BytecodeProviderInitiator.java:50) ~[na:na]\n    at org.hibernate.bytecode.internal.BytecodeProviderInitiator.initiateService(BytecodeProviderInitiator.java:22) ~[na:na]\n    at org.hibernate.boot.registry.internal.StandardServiceRegistryImpl.initiateService(StandardServiceRegistryImpl.java:130) ~[na:na]\n    at org.hibernate.service.internal.AbstractServiceRegistryImpl.createService(AbstractServiceRegistryImpl.java:263) ~[app:6.4.4.Final]\n    at org.hibernate.service.internal.AbstractServiceRegistryImpl.initializeService(AbstractServiceRegistryImpl.java:238) ~[app:6.4.4.Final]\n    at org.hibernate.service.internal.AbstractServiceRegistryImpl.getService(AbstractServiceRegistryImpl.java:215) ~[app:6.4.4.Final]\n    at org.hibernate.boot.internal.SessionFactoryBuilderImpl.&lt;init&gt;(SessionFactoryBuilderImpl.java:69) ~[na:na]\n    at org.hibernate.boot.internal.SessionFactoryBuilderImpl.&lt;init&gt;(SessionFactoryBuilderImpl.java:46) ~[na:na]\n    at org.hibernate.boot.internal.DefaultSessionFactoryBuilderService.createSessionFactoryBuilder(DefaultSessionFactoryBuilderService.java:26) ~[app:6.4.4.Final]\n    at org.hibernate.boot.internal.MetadataImpl.getSessionFactoryBuilder(MetadataImpl.java:170) ~[app:6.4.4.Final]\n    at org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1503) ~[na:na]\n    at org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:75) ~[na:na]\n    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:390) ~[app:6.1.5]\n    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409) ~[app:6.1.5]\n    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396) ~[app:6.1.5]\n    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:366) ~[app:6.1.5]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1833) ~[app:6.1.5]\n    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1782) ~[app:6.1.5]\n    ... 17 common frames omitted\nCaused by: java.lang.NoSuchMethodException: org.hibernate.bytecode.internal.bytebuddy.BytecodeProviderImpl.&lt;init&gt;()\n    at java.base@22/java.lang.Class.checkExecutable(DynamicHub.java:1101) ~[app:na]\n    at java.base@22/java.lang.Class.checkConstructor(DynamicHub.java:1082) ~[app:na]\n    at java.base@22/java.lang.Class.getConstructor0(DynamicHub.java:1272) ~[app:na]\n    at java.base@22/java.lang.Class.getConstructor(DynamicHub.java:2452) ~[app:na]\n    at java.base@22/java.util.ServiceLoader$1.run(ServiceLoader.java:662) ~[na:na]\n    at java.base@22/java.util.ServiceLoader$1.run(ServiceLoader.java:659) ~[na:na]\n    at java.base@22/java.security.AccessController.executePrivileged(AccessController.java:113) ~[app:na]\n    at java.base@22/java.security.AccessController.doPrivileged(AccessController.java:571) ~[app:na]\n    at java.base@22/java.util.ServiceLoader.getConstructor(ServiceLoader.java:670) ~[app:na]\n    ... 43 common frames omitted\n\n\n\n</code></pre>\n<p>I've tried to mess with the pom file, use different plugins and dependencies, but of no avail.</p>\n<p>The command I use to build the image is:</p>\n<p>mvn -Pnative native:compile</p>\n<p>This is my pom.xml:</p>\n<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\n    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;3.2.4&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.library&lt;/groupId&gt;\n    &lt;artifactId&gt;app&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;app&lt;/name&gt;\n    &lt;description&gt;GraalVM Student Project&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;22&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jdbc&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;\n            &lt;exclusions&gt;\n                &lt;exclusion&gt;\n                    &lt;groupId&gt;net.bytebuddy&lt;/groupId&gt;\n                    &lt;artifactId&gt;byte-buddy&lt;/artifactId&gt;\n                &lt;/exclusion&gt;\n            &lt;/exclusions&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;\n            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;junit&lt;/groupId&gt;\n            &lt;artifactId&gt;junit&lt;/artifactId&gt;\n            &lt;version&gt;4.13.2&lt;/version&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;net.bytebuddy&lt;/groupId&gt;\n            &lt;artifactId&gt;byte-buddy&lt;/artifactId&gt;\n            &lt;version&gt;1.14.13&lt;/version&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.hibernate.orm.tooling&lt;/groupId&gt;\n                &lt;artifactId&gt;hibernate-enhance-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;6.4.4.Final&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;configuration&gt;\n                            &lt;enableDirtyTracking&gt;true&lt;/enableDirtyTracking&gt;\n                        &lt;/configuration&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;enhance&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.graalvm.buildtools&lt;/groupId&gt;\n                &lt;artifactId&gt;native-maven-plugin&lt;/artifactId&gt;\n            &lt;/plugin&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;configuration&gt;\n                    &lt;excludes&gt;\n                        &lt;exclude&gt;\n                            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n                            &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n                        &lt;/exclude&gt;\n                    &lt;/excludes&gt;\n                &lt;/configuration&gt;\n            &lt;/plugin&gt;\n\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}