{
  "question": {
    "tags": [
      "java",
      "http",
      "redpitaya"
    ],
    "owner": {
      "account_id": 3294730,
      "reputation": 17,
      "user_id": 2772255,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/b0b98dd7629020ad3cfa86f0387fc2d0?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Simon",
      "link": "https://stackoverflow.com/users/2772255/simon"
    },
    "is_answered": true,
    "view_count": 63,
    "accepted_answer_id": 79236536,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1732873233,
    "creation_date": 1731068543,
    "last_edit_date": 1731076990,
    "question_id": 79170023,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79170023/connecting-to-red-pitaya-application-from-java",
    "title": "Connecting to Red Pitaya application from Java",
    "body": "<p>I am about to write a Java Program that connects to a redpitaya and recieves data from the websocket. I successfully can connect to the redpitaya using a HttpClient. However the connection to the websocket fails. When I start the application in a browser, the connection to the websocket succeeds. It looks like when I connect to the RP, the requested application does not start. (tested with scopegenpro and streaming_manager). Has anyone an idea what I must send to the RP so that the application starts?</p>\n<pre><code>package redpitaya;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.net.URI;\nimport java.net.URISyntaxException;\nimport java.net.http.HttpClient;\nimport java.net.http.HttpRequest;\nimport java.net.http.HttpResponse;\nimport java.net.http.HttpResponse.BodyHandlers;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.zip.GZIPInputStream;\n\n\nimport jakarta.websocket.ContainerProvider;\nimport jakarta.websocket.Endpoint;\nimport jakarta.websocket.EndpointConfig;\nimport jakarta.websocket.MessageHandler;\nimport jakarta.websocket.Session;\nimport jakarta.websocket.WebSocketContainer;\nimport jakarta.websocket.RemoteEndpoint.Basic;\n\npublic class RPClient {\n\n\n    final static String hostName=&quot;192.168.1.1&quot;;\n    final static int port = 9002;\n    static RPClient clientEndPoint;\n    Session session;\n    final static String ApplicationId = &quot;scopegenpro&quot;;\n    final static String type = &quot;run&quot;;\n\n    public RPClient(URI uri) throws InterruptedException {\n\n        HttpClient client = HttpClient.newHttpClient();\n        try {\n            HttpRequest request = HttpRequest.newBuilder()\n                    .uri(new URI(&quot;http://&quot; + hostName + &quot;/&quot; + ApplicationId + &quot;/&quot;))\n                    .GET()\n                    .header(&quot;start&quot;, ApplicationId)\n                    .header(&quot;type&quot;, type)\n                    .build();\n            System.out.println(request.uri().getPath());\n            HttpResponse&lt;String&gt; response = client.send(request, BodyHandlers.ofString());\n            List&lt;String&gt; locations = response.headers().allValues(&quot;location&quot;);\n            HttpRequest req = response.request();\n            System.out.println(req);\n            Iterator&lt;String&gt; locationIterator = locations.iterator();\n            while (locationIterator.hasNext()) {\n                System.out.println(locationIterator.next());\n            }\n            System.out.println(response.body());\n            WebSocketContainer container = ContainerProvider.getWebSocketContainer();  \n            Endpoint endpoint = new SocketEndpoint();\n            session = container.connectToServer(endpoint, uri);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        while(true) {\n            Thread.sleep(1000);\n        }\n    }\n\n    public static void main(String[] args) throws URISyntaxException, InterruptedException {\n        URI uri = new URI(&quot;ws://&quot; + hostName + &quot;:&quot; + port + &quot;/&quot;);\n\n\n        clientEndPoint = new RPClient(uri);\n    }\n\n    public class SocketEndpoint extends Endpoint{\n\n        @Override\n        public void onOpen(Session session, EndpointConfig config) {\n\n            final Basic remote = session.getBasicRemote();\n            session.addMessageHandler(InputStream.class, new MessageHandler.Whole&lt;InputStream&gt;() {\n                public void onMessage(InputStream stream) {\n                    try {\n                        while (stream.available() &gt; 0) {\n                            GZIPInputStream is = new GZIPInputStream(stream);\n                            byte[] gzip = is.readAllBytes();\n                            System.out.println(&quot;received: &quot; + new String(gzip));\n                        }\n                        System.out.println();\n                    } catch (IOException e) {\n                        e.printStackTrace();\n                    }\n                }\n            }); \n\n\n        }\n\n        @Override\n        public void onError(Session session, Throwable t) {\n            System.out.println(session.getQueryString());\n            System.out.println(t.getMessage());\n        }\n\n    }\n\n}\n</code></pre>\n<p>and the maven pom.xml for libraries:</p>\n<pre><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;\nxmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;\nxsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;\n&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n&lt;groupId&gt;redpitaya&lt;/groupId&gt;\n&lt;artifactId&gt;client&lt;/artifactId&gt;\n&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n\n\n&lt;properties&gt;\n    &lt;maven.compiler.source&gt;17&lt;/maven.compiler.source&gt;\n    &lt;maven.compiler.target&gt;17&lt;/maven.compiler.target&gt;\n    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n    &lt;jakartaee&gt;9.0.0-RC3&lt;/jakartaee&gt;\n&lt;/properties&gt;\n\n&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;jakarta.platform&lt;/groupId&gt;\n        &lt;artifactId&gt;jakarta.jakartaee-api&lt;/artifactId&gt;\n        &lt;version&gt;${jakartaee}&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.glassfish.tyrus.bundles&lt;/groupId&gt;\n        &lt;artifactId&gt;tyrus-standalone-client&lt;/artifactId&gt;\n        &lt;version&gt;2.0.0-M3&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;javax.websocket&lt;/groupId&gt;\n        &lt;artifactId&gt;javax.websocket-api&lt;/artifactId&gt;\n        &lt;version&gt;1.1&lt;/version&gt;\n    &lt;/dependency&gt;\n\n&lt;/dependencies&gt;\n\n&lt;build&gt;\n    &lt;plugins&gt;\n        &lt;plugin&gt;\n            &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n            &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n            &lt;version&gt;3.1&lt;/version&gt;\n            &lt;configuration&gt;\n                &lt;source&gt;17&lt;/source&gt;\n                &lt;target&gt;17&lt;/target&gt;\n            &lt;/configuration&gt;\n        &lt;/plugin&gt;\n\n    &lt;/plugins&gt;\n&lt;/build&gt;\n&lt;/project&gt;\n</code></pre>\n<p>and the stack trace:</p>\n<pre><code>jakarta.websocket.DeploymentException: Connection failed.\n    at  org.glassfish.tyrus.container.grizzly.client.GrizzlyClientSocket._connect(GrizzlyClientSocket.java:413)\n    at org.glassfish.tyrus.container.grizzly.client.GrizzlyClientSocket.access$000(GrizzlyClientSocket.java:81)\n    at org.glassfish.tyrus.container.grizzly.client.GrizzlyClientSocket$1.call(GrizzlyClientSocket.java:212)\n    at org.glassfish.tyrus.container.grizzly.client.GrizzlyClientSocket$1.call(GrizzlyClientSocket.java:208)\n    at org.glassfish.tyrus.container.grizzly.client.GrizzlyClientSocket.connect(GrizzlyClientSocket.java:226)\n    at org.glassfish.tyrus.container.grizzly.client.GrizzlyClientContainer.openClientSocket(GrizzlyClientContainer.java:72)\n    at org.glassfish.tyrus.client.ClientManager$3$1.run(ClientManager.java:647)\n    at org.glassfish.tyrus.client.ClientManager$3.run(ClientManager.java:696)\n    at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)\n    at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n    at org.glassfish.tyrus.client.ClientManager$SameThreadExecutorService.execute(ClientManager.java:849)\n    at java.base/java.util.concurrent.AbstractExecutorService.submit(AbstractExecutorService.java:123)\n    at org.glassfish.tyrus.client.ClientManager.connectToServer(ClientManager.java:493)\n    at org.glassfish.tyrus.client.ClientManager.connectToServer(ClientManager.java:355)\n    at redpitaya.RPClient.&lt;init&gt;(RPClient.java:57)\n    at redpitaya.RPClient.main(RPClient.java:70)\nCaused by: java.net.ConnectException: Connection refused: getsockopt\nat java.base/sun.nio.ch.Net.pollConnect(Native Method)\nat java.base/sun.nio.ch.Net.pollConnectNow(Net.java:672)\nat java.base/sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:946)\nat org.glassfish.grizzly.nio.transport.TCPNIOConnectorHandler.onConnectedAsync(TCPNIOConnectorHandler.java:175)\nat org.glassfish.grizzly.nio.transport.TCPNIOConnectorHandler$1.connected(TCPNIOConnectorHandler.java:132)\nat org.glassfish.grizzly.nio.transport.TCPNIOConnection.onConnect(TCPNIOConnection.java:220)\nat org.glassfish.grizzly.nio.transport.TCPNIOTransport.fireIOEvent(TCPNIOTransport.java:502)\nat org.glassfish.grizzly.strategies.AbstractIOStrategy.fireIOEvent(AbstractIOStrategy.java:82)\nat org.glassfish.grizzly.strategies.WorkerThreadIOStrategy.run0(WorkerThreadIOStrategy.java:83)\nat org.glassfish.grizzly.strategies.WorkerThreadIOStrategy.executeIoEvent(WorkerThreadIOStrategy.java:73)\nat org.glassfish.grizzly.strategies.AbstractIOStrategy.executeIoEvent(AbstractIOStrategy.java:66)\nat org.glassfish.grizzly.nio.SelectorRunner.iterateKeyEvents(SelectorRunner.java:381)\nat org.glassfish.grizzly.nio.SelectorRunner.iterateKeys(SelectorRunner.java:353)\nat org.glassfish.grizzly.nio.SelectorRunner.doSelect(SelectorRunner.java:319)\nat org.glassfish.grizzly.nio.SelectorRunner.run(SelectorRunner.java:248)\nat org.glassfish.grizzly.threadpool.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:535)\nat org.glassfish.grizzly.threadpool.AbstractThreadPool$Worker.run(AbstractThreadPool.java:515)\nat java.base/java.lang.Thread.run(Thread.java:840)\n</code></pre>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}