{
  "question": {
    "tags": [
      "java",
      "hibernate",
      "jpa",
      "hibernate-mapping"
    ],
    "owner": {
      "account_id": 7004681,
      "reputation": 940,
      "user_id": 5369519,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/dru6k.jpg?s=256",
      "display_name": "flauschtrud",
      "link": "https://stackoverflow.com/users/5369519/flauschtrud"
    },
    "is_answered": true,
    "view_count": 131,
    "accepted_answer_id": 79458649,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1740172965,
    "creation_date": 1739453007,
    "last_edit_date": 1739789972,
    "question_id": 79436313,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79436313/duplicatemappingexception-after-extending-entity-with-inheritance",
    "title": "DuplicateMappingException after extending @Entity with @Inheritance",
    "body": "<p>I have a table <code>my_entity</code> that is referenced by multiple <code>@Entity</code> annotated classes like so:</p>\n<pre><code>@Immutable\n@Entity\n@Table(name = &quot;my_entity&quot;)\npublic class EntityA { ... }\n</code></pre>\n<pre><code>@Entity\n@Table(name = &quot;my_entity&quot;)\npublic class EntityB { ... }\n</code></pre>\n<p>This works perfectly fine.</p>\n<p>I now have to change one of these entities to extend an <code>@Inheritance</code> annotated class to allow for polymorphic queries:</p>\n<pre><code>@Immutable\n@Entity\n@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)\npublic abstract class Parent { ... }\n</code></pre>\n<pre><code>@Immutable\n@Entity\n@Table(name = &quot;my_entity&quot;)\npublic class EntityA extends Parent { ... }\n</code></pre>\n<pre><code>@Entity\n@Table(name = &quot;my_entity&quot;)\npublic class EntityB { ... }\n</code></pre>\n<p>I then get a <code>org.hibernate.DuplicateMappingException: Duplicate table my_entity</code></p>\n<pre><code>Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.orm.jpa.SharedEntityManagerCreator#0': Cannot resolve reference to bean 'entityManagerFactory' while setting constructor argument; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: Invocation of init method failed; nested exception is org.hibernate.DuplicateMappingException: Duplicate table mapping my_entity\n    at app//org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:342)\n    at app//org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveValueIfNecessary(BeanDefinitionValueResolver.java:113)\n    at app//org.springframework.beans.factory.support.ConstructorResolver.resolveConstructorArguments(ConstructorResolver.java:688)\n    at app//org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:505)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1352)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1195)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:582)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\n    at app//org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\n    at app//org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:276)\n    at app//org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1391)\n    at app//org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1311)\n    at app//org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:911)\n    at app//org.springframework.beans.factory.support.ConstructorResolver.createArgumentArray(ConstructorResolver.java:788)\n    ... 193 more\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: Invocation of init method failed; nested exception is org.hibernate.DuplicateMappingException: Duplicate table mapping my_entity\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1804)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:620)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:542)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:335)\n    at app//org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:234)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:333)\n    at app//org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:208)\n    at app//org.springframework.beans.factory.support.BeanDefinitionValueResolver.resolveReference(BeanDefinitionValueResolver.java:330)\n    ... 209 more\nCaused by: org.hibernate.DuplicateMappingException: Duplicate table mapping my_entity\n    at app//org.hibernate.boot.internal.InFlightMetadataCollectorImpl.addDenormalizedTable(InFlightMetadataCollectorImpl.java:799)\n    at app//org.hibernate.cfg.annotations.TableBinder.buildAndFillTable(TableBinder.java:488)\n    at app//org.hibernate.cfg.annotations.EntityBinder.bindTable(EntityBinder.java:849)\n    at app//org.hibernate.cfg.AnnotationBinder.bindClass(AnnotationBinder.java:642)\n    at app//org.hibernate.boot.model.source.internal.annotations.AnnotationMetadataSourceProcessorImpl.processEntityHierarchies(AnnotationMetadataSourceProcessorImpl.java:225)\n    at app//org.hibernate.boot.model.process.spi.MetadataBuildingProcess$1.processEntityHierarchies(MetadataBuildingProcess.java:239)\n    at app//org.hibernate.boot.model.process.spi.MetadataBuildingProcess.complete(MetadataBuildingProcess.java:282)\n    at app//org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.metadata(EntityManagerFactoryBuilderImpl.java:1460)\n    at app//org.hibernate.jpa.boot.internal.EntityManagerFactoryBuilderImpl.build(EntityManagerFactoryBuilderImpl.java:1494)\n    at app//org.springframework.orm.jpa.vendor.SpringHibernateJpaPersistenceProvider.createContainerEntityManagerFactory(SpringHibernateJpaPersistenceProvider.java:58)\n    at app//org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:365)\n    at app//org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.buildNativeEntityManagerFactory(AbstractEntityManagerFactoryBean.java:409)\n    at app//org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:396)\n    at app//org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.afterPropertiesSet(LocalContainerEntityManagerFactoryBean.java:341)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1863)\n    at app//org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1800)\n    ... 216 more\n</code></pre>\n<p>Is there a way to still reference the same table in an inheritance hierarchy?</p>\n<p>My workaround would be to create a view based on the <code>my_entity</code> table and use this for the mapping of <code>EntityA</code>, but I would prefer a solution based on the entity definition if there exists one.</p>\n<p>I also don't understand why using <code>@Inheritance</code> would create this issue while it was working fine before.</p>\n<p>I'm using Hibernate 5.6.15.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}