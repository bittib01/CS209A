{
  "question": {
    "tags": [
      "python",
      "java",
      "opc-ua",
      "opcua-client"
    ],
    "owner": {
      "account_id": 35780628,
      "reputation": 23,
      "user_id": 27397742,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/fe52d5f453d8fe49fa236a0163ba5ef0?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Jacob Griffin",
      "link": "https://stackoverflow.com/users/27397742/jacob-griffin"
    },
    "is_answered": true,
    "view_count": 94,
    "accepted_answer_id": 79008675,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1726915877,
    "creation_date": 1726885247,
    "last_edit_date": 1726915877,
    "question_id": 79008661,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79008661/ocp-ua-status-bad-connectionclosed-using-digital-petri",
    "title": "OCP UA status=Bad_ConnectionClosed using digital petri",
    "body": "<p>My work has an existing python script for connecting to an OPC UA Server.\nI'm all very basic and I'm trying to make a better system in java. However, I keep getting an exception with the message <code>status=Bad_ConnectionClosed</code>\nanytime i try and do anything with the server. The existing python script involved with establishing a connection and retrieving a value goes as follows:</p>\n<pre><code>from opcua import Client, ua\n\nopcClient = Client(&quot;opc.tcp://localhost:54321&quot;)\n\nopcClient.connect;\n\nvalueNode = opcClient.get_node(&quot;ns=1;s=measure.value&quot;)\n</code></pre>\n<p>I'm not kidding that is all that is done here. The best open source library I could find for java was Digital Petri through maven, com.digitalpetri.opcua:ua-client:1.0.4 (also tried 1.1.1)</p>\n<p>My attempt to connect goes as follows:</p>\n<pre><code>OpcUaClient opcUaClient = new OpcUaClient(OpcUaClientConfig.builder().setEndpointUrl(&quot;opc.tcp://localhost:54321&quot;).build()).connect().get();\n</code></pre>\n<p>This line throws the exception mentioned, and I cannot then retrieve a node or anything else:</p>\n<p>Apon further research i found a client example on digital petris github page,\n<a href=\"https://github.com/kevinherron/ua-client-sdk/blob/master/ua-client-tests/src/test/java/com/digitalpetri/opcua/sdk/client/OpcUaClientIT.java\" rel=\"nofollow noreferrer\">https://github.com/kevinherron/ua-client-sdk/blob/master/ua-client-tests/src/test/java/com/digitalpetri/opcua/sdk/client/OpcUaClientIT.java</a></p>\n<p>After pulling the required config values using the Python script, I was able to replicate the part relevant to connecting the client to a server:</p>\n<pre><code> EndpointDescription[] endpoints = UaTcpStackClient.getEndpoints(&quot;opc.tcp://localhost:54321&quot;).get();\n\n        EndpointDescription endpoint = Arrays.stream(endpoints)\n                .filter(e -&gt; e.getSecurityPolicyUri().equals(SecurityPolicy.None.getSecurityPolicyUri()))\n                .findFirst().orElseThrow(() -&gt; new Exception(&quot;no desired endpoints returned&quot;));\n\n        OpcUaClientConfig clientConfig = OpcUaClientConfig.builder()\n                .setApplicationName(LocalizedText.english(&quot;Pure Python Client&quot;))\n                .setApplicationUri(&quot;urn:freeopcua:client&quot;)\n                .setEndpoint(endpoint)\n                .setRequestTimeout(uint(60000))\n                .build();\n\n        OpcUaClient client = new OpcUaClient(clientConfig);\n</code></pre>\n<p>However, once again at the very first line  EndpointDescription[] endpoints = UaTcpStackClient.getEndpoints(&quot;opc.tcp://localhost:54321&quot;).get(); i get the same exception.:</p>\n<p>I have tried adding /discovery at the end of the URL (as reccommended).</p>\n<p>There is no certificate system in place and an anonymous login is expected.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}