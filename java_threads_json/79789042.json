{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-boot",
      "jpa"
    ],
    "owner": {
      "account_id": 14878684,
      "reputation": 873,
      "user_id": 10744028,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/-XAzkrkEpit0/AAAAAAAAAAI/AAAAAAAAAEg/AWErc7qYyNI/s256-rj/photo.jpg",
      "display_name": "Fizik26",
      "link": "https://stackoverflow.com/users/10744028/fizik26"
    },
    "is_answered": true,
    "view_count": 234,
    "accepted_answer_id": 79791590,
    "answer_count": 2,
    "score": 5,
    "last_activity_date": 1760612343,
    "creation_date": 1760342662,
    "last_edit_date": 1760561351,
    "question_id": 79789042,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79789042/embeddedid-and-mapsid-used-with-foreign-key-partially-appearing-in-primary-key",
    "title": "@EmbeddedId and @MapsId used with foreign key partially appearing in primary key",
    "body": "<p>I'm running a Spring Boot app.</p>\n<p>I have these two tables in my database. I fill an example of data that contains these tables.</p>\n<p>Table <code>user</code></p>\n<p>Here columns <code>id</code> and <code>century</code> are PKs, and column <code>state_id</code> is a FK from table <code>state</code> with a reference of column <code>id</code> and <code>century</code> is also a FK from table <code>state</code>. So the <code>century</code> column is a FK and a PK at the same time.</p>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th style=\"text-align: center;\">id</th>\n<th style=\"text-align: center;\">century</th>\n<th style=\"text-align: center;\">name</th>\n<th style=\"text-align: center;\">state_id</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: center;\">33</td>\n<td style=\"text-align: center;\">21</td>\n<td style=\"text-align: center;\">John Doe</td>\n<td style=\"text-align: center;\">1</td>\n</tr>\n</tbody>\n</table></div>\n<p>Table <code>state</code></p>\n<p>Here, columns <code>id</code> and <code>century</code> are both primary keys of the table</p>\n<div class=\"s-table-container\"><table class=\"s-table\">\n<thead>\n<tr>\n<th style=\"text-align: center;\">id</th>\n<th style=\"text-align: center;\">century</th>\n<th style=\"text-align: center;\">label</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: center;\">1</td>\n<td style=\"text-align: center;\">21</td>\n<td style=\"text-align: center;\">cold</td>\n</tr>\n</tbody>\n</table></div>\n<p>I want to model these two tables as JPA entities, so I did it like this:</p>\n<p>StatePK.java:</p>\n<pre><code>@Embeddable\npublic class StatePK implements Serializable {\n     private Long id;\n     private Integer century;\n}\n</code></pre>\n<p>State.java:</p>\n<pre><code>@Entity\n@Table(name = &quot;state&quot;)\npublic class State {\n\n       @EmbeddedId\n       private StatePK id;\n\n       private String label;\n}\n</code></pre>\n<p>UserPK.java:</p>\n<pre><code>@Embeddable\npublic class UserPK implements Serializable {\n     private Long id;\n     private Integer century;\n}\n</code></pre>\n<p>User.java:</p>\n<pre><code>@Entity\n@Table(name = &quot;user&quot;)\npublic class User implements Serializable {\n\n       @EmbeddedId\n       private UserPK id;\n\n       private String name;\n\n       @MapsId(&quot;century&quot;)\n       @ManyToOne(optional = false)\n       @JoinColumns(value = {\n           @JoinColumn(name = &quot;century&quot;, referencedColumnName = &quot;century&quot;),\n           @JoinColumn(name = &quot;state_id&quot;, referencedColumnName = &quot;id&quot;)})\n       private State state;\n}\n</code></pre>\n<p>When I launch the application, I have the following error:</p>\n<blockquote>\n<p>Error creating bean with name 'entityManagerFactory' defined in class\npath resource\n[org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]:\n[PersistenceUnit: default] Unable to build Hibernate SessionFactory;\nnested exception is java.lang.IllegalStateException: PostInitCallback\nqueue could not be processed...\\r\\n        - PostInitCallbackEntry -\nEmbeddableMappingType(fr.xxx.User#{id})#finishInitialization</p>\n</blockquote>\n<p>How can I resolve this error?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}