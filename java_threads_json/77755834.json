{
  "question": {
    "tags": [
      "java",
      "android",
      "accessibility",
      "whatsapp",
      "popupwindow"
    ],
    "owner": {
      "account_id": 29755489,
      "reputation": 371,
      "user_id": 22804287,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/p7M4J.png?s=256",
      "display_name": "Maria",
      "link": "https://stackoverflow.com/users/22804287/maria"
    },
    "is_answered": true,
    "view_count": 495,
    "accepted_answer_id": 77798651,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1708067485,
    "creation_date": 1704341218,
    "last_edit_date": 1708067485,
    "question_id": 77755834,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/77755834/how-using-androids-accessibility-feature-to-auto-click-and-close-whats-app-pop",
    "title": "How Using Android&#39;s accessibility feature to auto-click and close Whats App pop-up notifications and then return to the main app",
    "body": "<p>This is a part of my college project which I have to complete.In this project app i am sending whats app message automatically by using Accessibility feature of android through following java code.</p>\n<pre><code>    numberlist.setOnItemClickListener(new AdapterView.OnItemClickListener() {\n    @Override\n    public void onItemClick(AdapterView&lt;?&gt; adapterView, View view, int i, long l) {\n\n        try {\n            Toast.makeText(getBaseContext(), (String) numberlist.getItemAtPosition(i), Toast.LENGTH_SHORT).show();\n            txtnumber.setText(numberlist.getItemAtPosition(i).toString());\n           \n\n            PackageManager packageManager = MainActivity.this.getPackageManager();\n            Intent saif = new Intent(Intent.ACTION_VIEW);\n            String message;\n            message = txtmessage.getText().toString() + suffix.toString();\n           \n          \n            saif.setData(Uri.parse(url));\n            if (saif.resolveActivity(packageManager) != null) {\n                MainActivity.this.startActivityForResult(saif, 1);\n            }\n        } catch (Exception e) {\n            Log.e(&quot;ERROR WHATSAPP&quot;,e.toString());\n            Toast.makeText(getApplicationContext(),\n                    &quot;Contact not found&quot;,\n                    Toast.LENGTH_LONG).show();\n\n        }\n    }\n\n});\n</code></pre>\n<p>If the user's mobile number is created in the WhatsApp app, the message goes easily. If there is a mobile number on which WhatsApp is not created, then the following message appears.\n<a href=\"https://i.sstatic.net/y8uen.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.sstatic.net/y8uen.png\" alt=\"enter image description here\" /></a></p>\n<p>I have using following Accessibility node info ....</p>\n<pre><code>    List&lt;AccessibilityNodeInfoCompat&gt; sendMessageNodeInfoList = rootInActiveWindow.findAccessibilityNodeInfosByViewId(&quot;com.whatsapp:id/send&quot;);\n    String actname = event.getClassName().toString();\n    switch (actname) {\n        case &quot;com.whatsapp.Conversation&quot;:\n            sendMessageNodeInfoList = rootInActiveWindow.findAccessibilityNodeInfosByViewId(&quot;com.whatsapp:id/send&quot;);\n            if (sendMessageNodeInfoList.size() &gt; 0) {\n                sendMessageNodeInfoList.get(0).performAction(ACTION_CLICK);\n            }\n            break;\n        case &quot;com.whatsapp.HomeActivity&quot;:\n            sendNext();\n            break;\n        case &quot;com.whatsapp.contact.picker.ContactPicker&quot;:\n            Toast.makeText(this, &quot;Unable to find contacts in your list! Skipping!!!&quot;, Toast.LENGTH_SHORT).show();\n            performGlobalAction(GLOBAL_ACTION_BACK);\n            break;\n    }\n    assert sendMessageNodeInfoList != null;\n    AccessibilityNodeInfoCompat sendMessageButton = sendMessageNodeInfoList.get(0);\n    if (!sendMessageButton.isVisibleToUser()) {\n\n        return;\n    }\n    sendMessageButton.performAction(ACTION_CLICK);\n</code></pre>\n<p>My question is, how can we close this notification by auto clicking on the OK or Cancel button using the accessibility feature of Android? I want that when a Whats App message is sent to a user's mobile number, it should first be checked whether his mobile number is available on Whats App or not. If Whats App is created on the mobile number, then a message should be sent to him and if Whats App is not created on his mobile number, then auto-click on this pop-up notification to close it and return to the main screen. This is the last project of my college which I have to complete please help me to complete it. Thanks</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}