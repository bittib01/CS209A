{
  "question": {
    "tags": [
      "java",
      "apache-kafka-streams"
    ],
    "owner": {
      "account_id": 6816150,
      "reputation": 1,
      "user_id": 5244772,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/70c83e957208e314a3ae0ae7302a9125?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Max",
      "link": "https://stackoverflow.com/users/5244772/max"
    },
    "is_answered": false,
    "view_count": 31,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1742665265,
    "creation_date": 1742664442,
    "question_id": 79527820,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79527820/instanceof-not-working-in-kafkastreams-filter",
    "title": "instanceof not working in KafkaStreams filter",
    "body": "<p>In the code below:</p>\n<p><code>       var processed = builder.stream(topics.getRateLimitProcessorTopic(), Consumed.with(SerdesFactory.bucketKeySerdes(), SerdesFactory.bucketOperationSerdes())) .process(() -&gt; new BucketProcessor(rateLimitService), Named.as(BUCKET_PROCESSOR)); processed .filter((key, value) -&gt; { return ( value instanceof DictBlockListMsg );}) .mapValues(value -&gt; (DictBlockListMsg) value) .to(topics.getBlockListTopic(), Produced.valueSerde(SerdesFactory.dictBlockListMsgSerdes()));</code></p>\n<p>an ClassCastException is bein raised in the .mapValues operation. The filter shouldn't be an assertion that value is indeed a DictBlockListMsg?</p>\n<p>I expected the code snippet to be able to send the Kafka record to the appropriate topic, depending on the type of that record.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}