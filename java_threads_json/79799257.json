{
  "question": {
    "tags": [
      "java",
      "unit-testing",
      "static",
      "mockito"
    ],
    "owner": {
      "account_id": 13508220,
      "reputation": 428,
      "user_id": 9745488,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/FHcmY.jpg?s=256",
      "display_name": "Oxnard",
      "link": "https://stackoverflow.com/users/9745488/oxnard"
    },
    "is_answered": true,
    "view_count": 91,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1764190278,
    "creation_date": 1761352100,
    "last_edit_date": 1761639971,
    "question_id": 79799257,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79799257/mockito-spying-on-a-class-which-contains-a-static-method-which-calls-another-sta",
    "title": "Mockito spying on a class which contains a static method which calls another static method",
    "body": "<p>I am trying to get a unit test to work using Mockito 5.14.2. The method I am trying to unit test is a static method (<code>m1</code>). Within the same class <code>Myclass1</code> there is another static method (<code>m2</code>) which returns a string and is called by <code>m1</code>. This seems like the case for using a spy. However, it does not work as I expect.</p>\n<pre class=\"lang-java prettyprint-override\"><code>class Myclass1 {\n    public static String m1() {\n        // do stuff\n        return m2();\n    }\n\n    public static String m2() {\n        // do stuff\n        return &quot;a string&quot;;\n    }\n}\n</code></pre>\n<p>tried:</p>\n<pre class=\"lang-java prettyprint-override\"><code>class Myclass1Test {\n    @Test \n    void testM1() {\n        try (MockedStatic&lt;Myclass1) myclass1Mock = mockStatic(Myclass1.class)) {\n            myclass1Mock.when(Myclass1::m2).thenReturn(&quot;a result&quot;);\n            String result = Myclass1.m1();\n            assertEquals(&quot;a result&quot;, result);\n        }\n    }\n}\n</code></pre>\n<p>the return of <code>Myclass1.m1()</code> is always <code>null</code>.</p>\n<p>also tried</p>\n<pre class=\"lang-java prettyprint-override\"><code>class Myclass1Test {\n    @Spy    \n    Myclass1 ut;\n\n    @Test \n    void testM1() {\n        doReturn(&quot;a result&quot;).when(ut).m2();\n        String result = ut.m1();\n    }\n}\n</code></pre>\n<p>but this would not even compile.</p>\n<p>My question is how to spy on a class that has a static method that calls another static method within the same class? Or what do I need to do to unit test method <code>Myclass1.m1</code>?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}