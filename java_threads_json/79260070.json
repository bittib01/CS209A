{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "jdbctemplate"
    ],
    "owner": {
      "account_id": 14812191,
      "reputation": 399,
      "user_id": 10697466,
      "user_type": "registered",
      "profile_image": "https://lh4.googleusercontent.com/-XS52jO6xn20/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-iTPJxSS0jgW21gVSZcO0x5UU2iWg/mo/s256-rj/photo.jpg",
      "display_name": "Ramses Kouam",
      "link": "https://stackoverflow.com/users/10697466/ramses-kouam"
    },
    "is_answered": false,
    "view_count": 45,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1761512582,
    "creation_date": 1733552721,
    "question_id": 79260070,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79260070/how-to-insert-in-batch-mode-2-tables-with-manytomany-relationship-with-springboo",
    "title": "how to insert in batch mode 2 tables with manytomany relationship with springboot?",
    "body": "<p>I Have 2 tables with a manytomany relationship.\nWhat is done so far, i use jpa (repositories) to insert list of this A,B and A_B tables.\nThe problem is that using jpa for a huge set of data is not optimized, so i had the idea to use jdbcTemplate.batchUpdate like this :</p>\n<pre><code>int [][] insertAResults = jdbcTemplate.batchUpdate(\n         sqlQueryA,\n         List&lt;A&gt;,\n         List&lt;A&gt;.size(),\n        (PreparedStatement ps, A a) -&gt;{\n            ps.setInt(1,a.getId());\n            ...\n         }\n     );\nint [][] insertBResults = jdbcTemplate.batchUpdate(\n         sqlQueryB,\n         List&lt;B&gt;,\n         List&lt;B&gt;.size(),\n        (PreparedStatement ps, B b) -&gt;{\n            ps.setInt(1,b.getId());\n            ...\n         }\n     );\nint [][] insertA_BResults = jdbcTemplate.batchUpdate(\n         sqlQueryA_B,\n         List&lt;Map&lt;IdA,IdB&gt;&gt;,\n         List&lt;Map&lt;IdA,IdB&gt;&gt;.size(),\n        (PreparedStatement ps, Map&lt;IdA,IdB&gt; ids) -&gt;{\n            ps.setInt(1,ids.keySet().stream().findFirst().get());\n            ps.setInt(1,ids.values().stream().findFirst().get());\n         }\n     );\n</code></pre>\n<p>Then, i have to match A'id and B'id to insert in a batchUpdate.\nthe problem is to use a direct relationship between the both tables (i use another table to find relashionship to match them and it's inside a 3 nested for loops, so i think the potentially earned time optimization could be lost).</p>\n<p>So how can i optimize the insertion of the 2 two tables and their common table ?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}