{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-boot",
      "graalvm",
      "graalvm-native-image"
    ],
    "owner": {
      "account_id": 6899347,
      "reputation": 293,
      "user_id": 5299452,
      "user_type": "registered",
      "accept_rate": 67,
      "profile_image": "https://www.gravatar.com/avatar/776fb59e1b14e5a61f2fc8fd3cdb2255?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Vibhor Verma",
      "link": "https://stackoverflow.com/users/5299452/vibhor-verma"
    },
    "is_answered": true,
    "view_count": 243,
    "accepted_answer_id": 79522842,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1742471555,
    "creation_date": 1741632902,
    "last_edit_date": 1741635385,
    "question_id": 79498913,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79498913/exception-encountered-during-context-initialization-on-start-spring-native-appli",
    "title": "Exception encountered during context initialization on Start spring native application",
    "body": "<p>I am trying to setup my existing Springboot v3.4.1 project running on Java 17 to work with GraalVM 23.0.7.r17-nik</p>\n<p>After efforts, I am able to build the project executable, but on executing,</p>\n<pre><code>./target/fcr\n</code></pre>\n<p>It fails with exception: <code>w.s.c.ServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'meterRegistryPostProcessor': BeanPostProcessor before instantiation of bean failed Application run failed</code></p>\n<p>The exact trace is as follows:</p>\n<pre><code> w.s.c.ServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'meterRegistryPostProcessor': BeanPostProcessor before instantiation of bean failed\nApplication run failed\norg.springframework.beans.factory.BeanCreationException: Error creating bean with name 'meterRegistryPostProcessor': BeanPostProcessor before instantiation of bean failed\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:518)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:336)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:289)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:334)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:204)\n        at org.springframework.context.support.PostProcessorRegistrationDelegate.registerBeanPostProcessors(PostProcessorRegistrationDelegate.java:277)\n        at org.springframework.context.support.AbstractApplicationContext.registerBeanPostProcessors(AbstractApplicationContext.java:808)\n        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:611)\n        at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:146)\n        at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:752)\n        at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:439)\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:318)\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1361)\n        at org.springframework.boot.SpringApplication.run(SpringApplication.java:1350)\n        at com.xxxxxx.yyy.CompanyConfigApplication.main(CompanyConfigApplication.java:14)\nCaused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'org.springframework.transaction.config.internalTransactionAdvisor': Unsatisfied dependency expressed through method 'transactionAdvisor' parameter 0: Error creating bean with name 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration': Class org.springframework.core.annotation.TypeMappedAnnotation[] is instantiated reflectively but was never registered.Register the class by adding &quot;unsafeAllocated&quot; for the class in reflect-config.json.\n        at org.springframework.beans.factory.aot.BeanInstanceSupplier.resolveAutowiredArgument(BeanInstanceSupplier.java:369)\n        at org.springframework.beans.factory.aot.BeanInstanceSupplier.resolveArguments(BeanInstanceSupplier.java:289)\n        at org.springframework.beans.factory.aot.BeanInstanceSupplier.get(BeanInstanceSupplier.java:223)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.obtainInstanceFromSupplier(DefaultListableBeanFactory.java:979)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1239)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1182)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:336)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:289)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:334)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:204)\n        at org.springframework.aop.framework.autoproxy.BeanFactoryAdvisorRetrievalHelper.findAdvisorBeans(BeanFactoryAdvisorRetrievalHelper.java:91)\n        at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findCandidateAdvisors(AbstractAdvisorAutoProxyCreator.java:119)\n        at org.springframework.aop.aspectj.annotation.AnnotationAwareAspectJAutoProxyCreator.findCandidateAdvisors(AnnotationAwareAspectJAutoProxyCreator.java:92)\n        at org.springframework.aop.aspectj.autoproxy.AspectJAwareAdvisorAutoProxyCreator.shouldSkip(AspectJAwareAdvisorAutoProxyCreator.java:105)\n        at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessBeforeInstantiation(AbstractAutoProxyCreator.java:280)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInstantiation(AbstractAutowireCapableBeanFactory.java:1150)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.resolveBeforeInstantiation(AbstractAutowireCapableBeanFactory.java:1125)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:512)\n        ... 14 more\nCaused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration': Class org.springframework.core.annotation.TypeMappedAnnotation[] is instantiated reflectively but was never registered.Register the class by adding &quot;unsafeAllocated&quot; for the class in reflect-config.json.\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:608)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:336)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:289)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:334)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:204)\n        at org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration__BeanDefinitions.lambda$getTransactionAttributeSourceInstanceSupplier$2(ProxyTransactionManagementConfiguration__BeanDefinitions.java:75)\n        at org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:63)\n        at org.springframework.util.function.ThrowingFunction.apply(ThrowingFunction.java:51)\n        at org.springframework.beans.factory.aot.BeanInstanceSupplier.lambda$get$1(BeanInstanceSupplier.java:219)\n        at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:58)\n        at org.springframework.util.function.ThrowingSupplier.get(ThrowingSupplier.java:46)\n        at org.springframework.beans.factory.aot.BeanInstanceSupplier.invokeBeanSupplier(BeanInstanceSupplier.java:258)\n        at org.springframework.beans.factory.aot.BeanInstanceSupplier.get(BeanInstanceSupplier.java:219)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.obtainInstanceFromSupplier(DefaultListableBeanFactory.java:979)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.obtainFromSupplier(AbstractAutowireCapableBeanFactory.java:1239)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1182)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:563)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:523)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:336)\n        at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:289)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:334)\n        at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1573)\n        at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1519)\n        at org.springframework.beans.factory.support.ConstructorResolver.resolveAutowiredArgument(ConstructorResolver.java:913)\n        at org.springframework.beans.factory.support.RegisteredBean.resolveAutowiredArgument(RegisteredBean.java:253)\n        at org.springframework.beans.factory.aot.BeanInstanceSupplier.resolveAutowiredArgument(BeanInstanceSupplier.java:366)\n        ... 33 more\nCaused by: java.lang.IllegalArgumentException: Class org.springframework.core.annotation.TypeMappedAnnotation[] is instantiated reflectively but was never registered.Register the class by adding &quot;unsafeAllocated&quot; for the class in reflect-config.json.\n        at org.graalvm.nativeimage.builder/com.oracle.svm.core.graal.snippets.SubstrateAllocationSnippets.arrayHubErrorStub(SubstrateAllocationSnippets.java:351)\n        at org.springframework.core.type.classreading.MergedAnnotationReadingVisitor$ArrayVisitor.visitEnd(MergedAnnotationReadingVisitor.java:183)\n        at org.springframework.asm.ClassReader.readElementValues(ClassReader.java:3023)\n        at org.springframework.asm.ClassReader.readElementValue(ClassReader.java:3193)\n        at org.springframework.asm.ClassReader.readElementValues(ClassReader.java:3013)\n        at org.springframework.asm.ClassReader.accept(ClassReader.java:611)\n        at org.springframework.asm.ClassReader.accept(ClassReader.java:427)\n        at org.springframework.core.type.classreading.SimpleMetadataReader.&lt;init&gt;(SimpleMetadataReader.java:48)\n        at org.springframework.core.type.classreading.SimpleMetadataReaderFactory.getMetadataReader(SimpleMetadataReaderFactory.java:103)\n        at org.springframework.core.type.classreading.CachingMetadataReaderFactory.getMetadataReader(CachingMetadataReaderFactory.java:131)\n        at org.springframework.core.type.classreading.SimpleMetadataReaderFactory.getMetadataReader(SimpleMetadataReaderFactory.java:81)\n        at org.springframework.context.annotation.ImportAwareAotBeanPostProcessor.setAnnotationMetadata(ImportAwareAotBeanPostProcessor.java:70)\n        at org.springframework.context.annotation.ImportAwareAotBeanPostProcessor.postProcessBeforeInitialization(ImportAwareAotBeanPostProcessor.java:54)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:423)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1800)\n        at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:601)\n        ... 60 more\n</code></pre>\n<p>I tried setting TypeMappedAnnotation as buildArg, but it didn't work.</p>\n<pre><code>&lt;buildArg&gt;--initialize-at-build-time=org.springframework.core.annotation.TypeMappedAnnotation&lt;/buildArg&gt;\n</code></pre>\n<p>I have also tried setting <code>src/main/resources/META-INF/native-image/reflect-config.json</code> with mentioned json as suggested in stacktrace, but it is still failing with same exception.</p>\n<pre><code>[\n  {\n    &quot;name&quot;: &quot;org.springframework.core.annotation.TypeMappedAnnotation&quot;,\n    &quot;unsafeAllocated&quot;: true\n  }\n]\n</code></pre>\n<p>Any suggestions, how I can fix this?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}