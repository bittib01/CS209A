{
  "question": {
    "tags": [
      "java",
      "spring",
      "spring-boot",
      "hibernate",
      "multi-tenant"
    ],
    "owner": {
      "account_id": 29663004,
      "reputation": 9,
      "user_id": 22734173,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocIccX16uE2luo2hQBd07Vnues5vMcmF9LvrjvIRMNn3=k-s256",
      "display_name": "Igor Milovanovic",
      "link": "https://stackoverflow.com/users/22734173/igor-milovanovic"
    },
    "is_answered": false,
    "view_count": 135,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1766269088,
    "creation_date": 1706864847,
    "question_id": 77925799,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/77925799/spring-hibernate-multitenancy",
    "title": "Spring Hibernate Multitenancy",
    "body": "<p>I have implemented multitenancy feature into my spring boot app (3.2.1).</p>\n<p>I have TenantFilter that sets TenantContexts currentTennat to either:</p>\n<ol>\n<li>ALL (default tenant that i set when user has role of superadmin)</li>\n<li>XYZ (XYZ representing value of header that i pass) if user is admin / regular user</li>\n</ol>\n<p>There are 2 entites of iteres here:</p>\n<ol>\n<li>User entity that has field annotated with @TenantId (tenantCode)</li>\n<li>Article entity that i am trying to create also annotated with @TenantId (tenantCode) and additionaly has field User createBy (auditing field resolved from AuditorAware - getCurrentAuditor)</li>\n</ol>\n<p>So, Superadmin wants to create article for some tenant. In order to pass authorization it needs to send DEFAULT TENANT CODE in request (so that he could be found in db). But when i try to save article into DB it is stored with DEFAULT TENANT CODE. Therefor, no regular user / admin user from desired tenant would be able to find it (because they need to send tenant code representing their tenant with request).</p>\n<p>If, on the other hand, i send TENANT_CODE of desired tenant with that request for creating artical that comes from superadmin then superadmin user cannot be found in DB and createdBy field (that is NotNull) is nulland entity cannot be saved.</p>\n<p>My question is can i if my user is superadmin have DEFAULT_TENANT_CODE for read operations and specific TENANT_CODE for write (create / update / delete) operations.</p>\n<p>All suggestions and following questions are welcome!</p>\n<p>P.S. Im using Shared Database and Shared Schema (so that tenant_code is discriminator column for me)</p>\n<p>Ive looked at definitions of CurrentTenantIdentifierResolver and AvailableSettings used for HibernatePropertiesCustomizer.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}