{
  "question": {
    "tags": [
      "java",
      "mongodb",
      "apache-flink",
      "flink-streaming"
    ],
    "owner": {
      "account_id": 12466473,
      "reputation": 1,
      "user_id": 9076227,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/cd910677c74e598a407598b84907a66b?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "Domix",
      "link": "https://stackoverflow.com/users/9076227/domix"
    },
    "is_answered": false,
    "view_count": 142,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1723634291,
    "creation_date": 1708110718,
    "last_edit_date": 1708124455,
    "question_id": 78009537,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78009537/flink-java-mongosink-set-dynamic-collection-name",
    "title": "Flink Java MongoSink set Dynamic collection name",
    "body": "<p>I'm new to Apache Flink. I wrote, in Java, with the help of the documentation, the following code that reads data in json from a Kafka topic.</p>\n<p>I'm able with the following code to put the data in a MongoDb's collection if I set a static collection name. Now, I have a field called collectionName in my ObjectFromKafka object. How i could set the collection name getting it from the mentioned aboved field of my ObjectFromKafka?</p>\n<pre><code>        KafkaSource&lt;ObjectFromKafka&gt; kafkaSource = KafkaSource.&lt;ObjectFromKafka&gt;builder() //\n                .setTopics(properties.getProperty(TOPIC_READ)) //\n                .setProperties(properties) //\n                .setStartingOffsets(OffsetsInitializer.committedOffsets(OffsetResetStrategy.EARLIEST)) //\n                .setValueOnlyDeserializer(new JsonDeserializationSchema&lt;&gt;(ObjectFromKafka.class)) //\n                .build();\n\n        DataStream&lt;ObjectFromKafka&gt; stream = env.fromSource(kafkaSource, WatermarkStrategy.forMonotonousTimestamps(),\n                &quot;kafka_source&quot;);\n\n        MongoSerializationSchema&lt;ObjectFromKafka&gt; serializationSchema = (input,\n                context) -&gt; new InsertOneModel&lt;&gt;(BsonDocument.parse(convertToJsonString(input)));\n\n        MongoSink&lt;ObjectFromKafka&gt; sink1 = MongoSink.&lt;ObjectFromKafka&gt;builder() //\n                .setUri(&quot;mongodb://username:password@mongo:27017/&quot;) //\n                .setDatabase(&quot;admin&quot;) //\n                .setCollection(&quot;myCollection&quot;) //\n                .setBatchSize(1000) //\n                .setBatchIntervalMs(1000) //\n                .setMaxRetries(3) //\n                .setDeliveryGuarantee(DeliveryGuarantee.AT_LEAST_ONCE) //\n                .setSerializationSchema(serializationSchema) //\n                .build();\n\n        stream.sinkTo(sink1).name(&quot;mongoDb Sink&quot;);\n\n</code></pre>\n<p>I'm unable to find a solution for now.</p>\n<p>Thanks in advance.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}