{
  "question": {
    "tags": [
      "java",
      "http",
      "httpclient",
      "connection-reset"
    ],
    "owner": {
      "account_id": 7802956,
      "reputation": 71,
      "user_id": 5901693,
      "user_type": "registered",
      "accept_rate": 0,
      "profile_image": "https://www.gravatar.com/avatar/4bce62c253519f26b38c01a0cf486fc8?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "ankur garg",
      "link": "https://stackoverflow.com/users/5901693/ankur-garg"
    },
    "is_answered": false,
    "view_count": 150,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1746151914,
    "creation_date": 1744290648,
    "last_edit_date": 1744294099,
    "question_id": 79566743,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79566743/java-http-client-java-io-ioexception-connection-reset",
    "title": "Java Http client: java.io.IOException: Connection reset",
    "body": "<p>We have a service which is calling a service over Http using <code>java.net.http.HttpClient</code></p>\n<p>We are getting below errors for 1-2% of the requests while calling that service , which mostly gets resolved if we <strong>retry</strong> requests. We have low QPS i.e 20 QPS.</p>\n<pre class=\"lang-none prettyprint-override\"><code>\njava.io.IOException: Connection reset\n    at platform/java.net.http@21.0.6/jdk.internal.net.http.HttpClientImpl.send(Unknown Source)\n    at platform/java.net.http@21.0.6/jdk.internal.net.http.HttpClientFacade.send(Unknown Source)\n</code></pre>\n<p>This is how our client build looks like</p>\n<pre><code>HttpClient.newBuilder()\n      .version(HttpClient.Version.HTTP_2)\n      .connectTimeout(Duration.ofSeconds(HTTP_CLIENT_CONNECT_TIMEOUT_SECONDS))\n      .build()\n</code></pre>\n<ul>\n<li><p>What is the reason of these errors ? Is the case that Connection was closed by server and Java HttpClient ConnectionPool is reusing that connection and failing?</p>\n</li>\n<li><p>Why does it get succeeded on Retry? Does it recreate new connection?</p>\n</li>\n<li><p>What is the recommended solution to avoid these errors altogether? I believe Java Http Client does not pre validate a connection before using it.</p>\n</li>\n</ul>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}