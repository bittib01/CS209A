{
  "question": {
    "tags": [
      "java",
      "clojure",
      "java-module",
      "java-platform-module-system",
      "async-profiler"
    ],
    "owner": {
      "account_id": 2994486,
      "reputation": 10587,
      "user_id": 2541276,
      "user_type": "registered",
      "accept_rate": 55,
      "profile_image": "https://graph.facebook.com/100001587714573/picture?type=large",
      "display_name": "user51",
      "link": "https://stackoverflow.com/users/2541276/user51"
    },
    "is_answered": false,
    "view_count": 420,
    "answer_count": 1,
    "score": 2,
    "last_activity_date": 1732093647,
    "creation_date": 1720043143,
    "last_edit_date": 1720044417,
    "question_id": 78704309,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78704309/how-to-fix-java-lang-classnotfoundexception-com-sun-tools-attach-virtualmachine",
    "title": "How to fix java.lang.ClassNotFoundException: com.sun.tools.attach.VirtualMachine in java 21",
    "body": "<p>I've a clojure project with <code>deps.edn</code> which uses the library <a href=\"https://github.com/clojure-goes-fast/clj-async-profiler\" rel=\"nofollow noreferrer\">clj-async-profiler</a></p>\n<p>My main function in the project contains the below code -</p>\n<pre class=\"lang-clj prettyprint-override\"><code>(ns com.myns.cli\n  (:gen-class)\n  (:require\n   [clj-async-profiler.core :as profiler]\n   [clj-async-profiler.ui :as profiler.ui]))\n\n(set! *warn-on-reflection* true)\n\n(defn -main [&amp; args]\n      (profiler/serve-ui 8074)\n      (.addShutdownHook (Runtime/getRuntime) (Thread. ^Runnable profiler.ui/stop-server))\n  ;;(run config-file))\n</code></pre>\n<p>The java application is started with the command <code>java -XX:+UnlockDiagnosticVMOptions -XX:+DebugNonSafepoints --add-opens java.base/jdk.internal.misc=ALL-UNNAMED --add-opens java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.nio=ALL-UNNAMED --add-opens=java.base/sun.nio.ch=ALL-UNNAMED --add-opens=java.base/jdk.attach=ALL-UNNAMED -Djdk.attach.allowAttachSelf -cp myapp.jar </code></p>\n<blockquote>\n<pre><code>  WARNING: package jdk.attach not in java.base\n  Exception in thread &quot;main&quot; java.lang.ExceptionInInitializerError\n      at java.base/java.lang.Class.forName0(Native Method)\n      at java.base/java.lang.Class.forName(Unknown Source)\n      at java.base/java.lang.Class.forName(Unknown Source)\n      at clojure.lang.RT.classForName(RT.java:2209)\n      at clojure.lang.RT.classForName(RT.java:2218)\n      at clojure.lang.RT.loadClassForName(RT.java:2237)\n      at clojure.lang.RT.load(RT.java:449)\n      at clojure.lang.RT.load(RT.java:424)\n      at clojure.core$load$fn__6908.invoke(core.clj:6162)\n      at clojure.core$load.invokeStatic(core.clj:6161)\n      at clojure.core$load.doInvoke(core.clj:6145)\n      at clojure.lang.RestFn.invoke(RestFn.java:408)\n      at clj_async_profiler.core__init.load(Unknown Source)\n      at clj_async_profiler.core__init.&lt;clinit&gt;(Unknown Source)\n      at java.base/java.lang.Class.forName0(Native Method)\n      at java.base/java.lang.Class.forName(Unknown Source)\n      at java.base/java.lang.Class.forName(Unknown Source)\n      at clojure.lang.RT.classForName(RT.java:2209)\n      at clojure.lang.RT.classForName(RT.java:2218)\n      at clojure.lang.RT.loadClassForName(RT.java:2237)\n      at clojure.lang.RT.load(RT.java:449)\n      at clojure.lang.RT.load(RT.java:424)\n      at clojure.core$load$fn__6908.invoke(core.clj:6162)\n      at clojure.core$load.invokeStatic(core.clj:6161)\n      at clojure.core$load.doInvoke(core.clj:6145)\n      at clojure.lang.RestFn.invoke(RestFn.java:408)\n      at clojure.core$load_one.invokeStatic(core.clj:5934)\n      at clojure.core$load_one.invoke(core.clj:5929)\n      at clojure.core$load_lib$fn__6850.invoke(core.clj:5976)\n      at clojure.core$load_lib.invokeStatic(core.clj:5975)\n      at clojure.core$load_lib.doInvoke(core.clj:5954)\n      at clojure.lang.RestFn.applyTo(RestFn.java:142)\n      at clojure.core$apply.invokeStatic(core.clj:669)\n      at clojure.core$load_libs.invokeStatic(core.clj:6017)\n      at clojure.core$load_libs.doInvoke(core.clj:6001)\n      at clojure.lang.RestFn.applyTo(RestFn.java:137)\n      at clojure.core$apply.invokeStatic(core.clj:669)\n      at clojure.core$require.invokeStatic(core.clj:6039)\n      at identity_check.cli$loading__6789__auto____149.invoke(cli.clj:1)\n      at identity_check.cli__init.load(Unknown Source)\n      at identity_check.cli__init.&lt;clinit&gt;(Unknown Source)\n      at java.base/java.lang.Class.forName0(Native Method)\n      at java.base/java.lang.Class.forName(Unknown Source)\n      at java.base/java.lang.Class.forName(Unknown Source)\n      at clojure.lang.RT.classForName(RT.java:2209)\n      at clojure.lang.RT.classForName(RT.java:2218)\n      at clojure.lang.RT.loadClassForName(RT.java:2237)\n      at clojure.lang.RT.load(RT.java:449)\n      at clojure.lang.RT.load(RT.java:424)\n      at clojure.core$load$fn__6908.invoke(core.clj:6162)\n      at clojure.core$load.invokeStatic(core.clj:6161)\n      at clojure.core$load.doInvoke(core.clj:6145)\n      at clojure.lang.RestFn.invoke(RestFn.java:408)\n      at clojure.lang.Var.invoke(Var.java:384)\n      at clojure.lang.Util.loadWithClass(Util.java:251)\n      at com.myns.cli.&lt;clinit&gt;(Unknown Source)\n  Caused by: java.lang.ClassNotFoundException: com.sun.tools.attach.VirtualMachine\n      at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(Unknown Source)\n      at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(Unknown Source)\n      at java.base/java.lang.ClassLoader.loadClass(Unknown Source)\n      at java.base/java.lang.Class.forName0(Native Method)\n      at java.base/java.lang.Class.forName(Unknown Source)\n      at java.base/java.lang.Class.forName(Unknown Source)\n      at clojure.lang.RT.classForName(RT.java:2209)\n      at clojure.lang.RT.classForNameNonLoading(RT.java:2222)\n      at clj_async_profiler.util.jdk11__init.load(Unknown Source)\n      at clj_async_profiler.util.jdk11__init.&lt;clinit&gt;(Unknown Source)\n      ... 56 more\n  \n</code></pre>\n</blockquote>\n<p>How can I fix this error?\nI can see jdk.attach module belongs to java.base in java <a href=\"https://docs.oracle.com/en/java/javase/11/docs/api/jdk.attach/module-summary.html\" rel=\"nofollow noreferrer\">documentation</a>. Why I get the warning <code>WARNING: package jdk.attach not in java.base</code> in the console ?</p>\n<p>Note:</p>\n<p>Below are the java version details -</p>\n<pre class=\"lang-bash prettyprint-override\"><code>java --version\nopenjdk 21.0.3 2024-04-16 LTS\nOpenJDK Runtime Environment Temurin-21.0.3+9 (build 21.0.3+9-LTS)\nOpenJDK 64-Bit Server VM Temurin-21.0.3+9 (build 21.0.3+9-LTS, mixed mode, sharing)\n</code></pre>\n<p>Also <code>--list-modules</code> commands returns -</p>\n<pre class=\"lang-bash prettyprint-override\"><code>$java --list-modules\njava.base@21.0.3\njava.compiler@21.0.3\njava.datatransfer@21.0.3\njava.desktop@21.0.3\njava.instrument@21.0.3\njava.logging@21.0.3\njava.management@21.0.3\njava.management.rmi@21.0.3\njava.naming@21.0.3\njava.net.http@21.0.3\njava.prefs@21.0.3\njava.rmi@21.0.3\njava.scripting@21.0.3\njava.se@21.0.3\njava.security.jgss@21.0.3\njava.security.sasl@21.0.3\njava.smartcardio@21.0.3\njava.sql@21.0.3\njava.sql.rowset@21.0.3\njava.transaction.xa@21.0.3\njava.xml@21.0.3\njava.xml.crypto@21.0.3\njdk.accessibility@21.0.3\njdk.charsets@21.0.3\njdk.crypto.cryptoki@21.0.3\njdk.crypto.ec@21.0.3\njdk.dynalink@21.0.3\njdk.httpserver@21.0.3\njdk.incubator.vector@21.0.3\njdk.internal.vm.ci@21.0.3\njdk.internal.vm.compiler@21.0.3\njdk.internal.vm.compiler.management@21.0.3\njdk.jdwp.agent@21.0.3\njdk.jfr@21.0.3\njdk.jsobject@21.0.3\njdk.localedata@21.0.3\njdk.management@21.0.3\njdk.management.agent@21.0.3\njdk.management.jfr@21.0.3\njdk.naming.dns@21.0.3\njdk.naming.rmi@21.0.3\njdk.net@21.0.3\njdk.nio.mapmode@21.0.3\njdk.sctp@21.0.3\njdk.security.auth@21.0.3\njdk.security.jgss@21.0.3\njdk.unsupported@21.0.3\njdk.xml.dom@21.0.3\njdk.zipfs@21.0.3\n</code></pre>\n<p>Also, I use docker image <code>eclipse-temurin:21-jre-jammy</code> if it helps</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}