{
  "question": {
    "tags": [
      "java",
      "spring-boot",
      "microsoft-graph-api"
    ],
    "owner": {
      "account_id": 13238275,
      "reputation": 15,
      "user_id": 10099115,
      "user_type": "registered",
      "profile_image": "https://graph.facebook.com/1895229080518871/picture?type=large",
      "display_name": "Андрей Алексеев",
      "link": "https://stackoverflow.com/users/10099115/%d0%90%d0%bd%d0%b4%d1%80%d0%b5%d0%b9-%d0%90%d0%bb%d0%b5%d0%ba%d1%81%d0%b5%d0%b5%d0%b2"
    },
    "is_answered": true,
    "view_count": 539,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1724927677,
    "creation_date": 1719396859,
    "question_id": 78671765,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78671765/how-to-retrieve-the-content-of-an-itemattachment-message-rfc822-using-microsof",
    "title": "How to retrieve the content of an ItemAttachment (message/rfc822) using Microsoft Graph SDK for Java?",
    "body": "<p>Hello Stack Overflow community,</p>\n<p>I am working on a Java project using Microsoft Graph SDK and I am encountering an issue while trying to retrieve the content of an attachment of type message/rfc822. I am able to get other attachments (like FileAttachment) without any issues, but I am struggling to load the content of ItemAttachment.</p>\n<p>Here is a snippet of my code:</p>\n<pre><code>AttachmentCollectionPage attachments = graphClient.users(request.getUser())\n                .messages(request.getId())\n                .attachments()\n                .buildRequest()\n                .get();\n\nfor (Attachment attachment : attachments.getCurrentPage()) {\n    if (attachment instanceof FileAttachment) {\n        FileAttachment fileAttachment = (FileAttachment) attachment;\n        byte[] contentBytes = fileAttachment.contentBytes;\n        // Handle file content\n    } else if (attachment instanceof ItemAttachment) {\n        ItemAttachment itemAttachment = (ItemAttachment) attachment;\n        // Handle item attachment\n        // The item field is always null\n    }\n}\n</code></pre>\n<p>The ItemAttachment has the following properties:</p>\n<pre><code>item = null\ncontentType = &quot;message/rfc822&quot;\nid = &quot;some-id&quot;\n</code></pre>\n<p>I have already looked at this post <a href=\"https://stackoverflow.com/questions/34944174/how-to-retrieve-contents-of-an-itemattachment-via-the-microsoft-graph-api\">How to retrieve contents of an itemAttachment via the Microsoft Graph API</a>, but I still don't understand how to achieve this using the SDK.</p>\n<p>After further research, I found that to retrieve the content of an ItemAttachment, I need to append /$value to the URI.</p>\n<p>However, I am not sure how to implement this using Microsoft Graph SDK for Java. I have not tried using <strong>customRequest</strong> because I am looking for a cleaner solution within the SDK itself.</p>\n<p>Is there a more straightforward way to retrieve the content of an ItemAttachment using Microsoft Graph SDK for Java? Any help or guidance would be greatly appreciated.</p>\n<p>Thank you!</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}