{
  "question": {
    "tags": [
      "java",
      "intellij-idea",
      "micronaut",
      "microstream",
      "eclipse-store"
    ],
    "owner": {
      "account_id": 1189122,
      "reputation": 17456,
      "user_id": 1162409,
      "user_type": "registered",
      "accept_rate": 40,
      "profile_image": "https://i.sstatic.net/YSzYR.jpg?s=256",
      "display_name": "San Jaisy",
      "link": "https://stackoverflow.com/users/1162409/san-jaisy"
    },
    "is_answered": true,
    "view_count": 682,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1720789607,
    "creation_date": 1714261653,
    "last_edit_date": 1714263330,
    "question_id": 78396683,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78396683/could-not-obtain-access-to-jdk-internal-misc-unsafe-please-start-the-vm-with",
    "title": "Could not obtain access to &quot;jdk.internal.misc.Unsafe&quot;, please start the VM with --add-exports java.base/jdk.internal.misc=ALL-UNNAMED",
    "body": "<p>Using Ecllipse store with micrornaut application facing an issue as <code>Could not obtain access to &quot;jdk.internal.misc.Unsafe&quot;, please start the VM with --add-exports java.base/jdk.internal.misc=ALL-UNNAMED</code></p>\n<p>As per the microstream FAQ - <a href=\"https://docs.microstream.one/manual/storage/faq/java-features.html\" rel=\"nofollow noreferrer\">https://docs.microstream.one/manual/storage/faq/java-features.html</a> this is a known issue</p>\n<p><strong>Can MicroStream handle Records?</strong></p>\n<p>Yes, but due to reflection restrictions of records introduced in Java 15 an export has to be added to the VM parameters:</p>\n<pre><code>--add-exports java.base/jdk.internal.misc=ALL-UNNAMED\n</code></pre>\n<p>This issue is related to the java record, I do have a record in the root as below</p>\n<pre><code>public record Country(UUID id,\n                      String name,\n                      String flagUrl,\n                      Optional&lt;Integer&gt; matchPlayed,\n                      Optional&lt;Integer&gt; win,\n                      Optional&lt;Integer&gt; draw,\n                      Optional&lt;Integer&gt; lost,\n                      Optional&lt;Integer&gt; points) {\n}\n</code></pre>\n<p>I am using the Kotlin version of build.gradle, as per the suggestion I need to add the JVM variable, however I did as below</p>\n<pre><code>application {\n    mainClass = &quot;fete.bird.EuroApi&quot;\n    \n    applicationDefaultJvmArgs = listOf(\n        &quot;--add-exports&quot;, &quot;java.base/jdk.internal.misc=ALL-UNNAMED&quot;\n    )\n}\n</code></pre>\n<p>Still facing the same issue, but during the JUnit test I have set the below argument and everything is working as expected</p>\n<pre><code>tasks.test {\n    jvmArgs(&quot;--add-exports=java.base/jdk.internal.misc=ALL-UNNAMED&quot;)\n}\n</code></pre>\n<p><strong>Update</strong></p>\n<p>Adding this works fine with <code>./gradlew run</code></p>\n<pre><code> tasks.withType&lt;JavaExec&gt; {\n    jvmArgs(&quot;--add-exports=java.base/jdk.internal.misc=ALL-UNNAMED&quot;)\n}\n</code></pre>\n<p>However not with IntellJ, how to set argument in intellj ?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}