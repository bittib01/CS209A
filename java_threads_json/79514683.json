{
  "question": {
    "tags": [
      "java",
      "unit-testing",
      "transactions",
      "quarkus",
      "quarkus-panache"
    ],
    "owner": {
      "account_id": 1853553,
      "reputation": 71,
      "user_id": 1679581,
      "user_type": "registered",
      "profile_image": "https://i.sstatic.net/AHMKK.jpg?s=256",
      "display_name": "Jan Peremsk&#253;",
      "link": "https://stackoverflow.com/users/1679581/jan-peremsk%c3%bd"
    },
    "is_answered": true,
    "view_count": 124,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1742473370,
    "creation_date": 1742216994,
    "question_id": 79514683,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79514683/testing-quarkus-methods-annotated-by-withtransaction",
    "title": "Testing Quarkus methods annotated by @WithTransaction",
    "body": "<p>In my project based on Quarkus and reactive Panache (HibernateReactive) on the service layer there are business methods annotated with <code>@WithTransaction</code> or <code>@WithSession</code>.\nThey usually combine several calls to the underlying persistence layer (repositories).\nI'd like to write unit test of the business logic which mocks all the real DB access.\nI'm however unable to call the tested service method annotated with <code>@WithTransaction</code> even thou it does not query/change any DB data.</p>\n<p>The usual complaints are:</p>\n<ul>\n<li>there is no vertx context or you cannot block the vertx event loop thread\nI've tried to mark the the method with <code>@ActivateRequestContext</code> and <code>@RunOnVertxContext</code>. No success.</li>\n</ul>\n<p>The only feasible way is to rewrite the test using <code>@TestReactiveTransaction</code>.\nThis has one substantial drawback however - it requires active DB connection to call ROLLBACK at the end of the method execution.</p>\n<p>So the question:</p>\n<p>Is there a way to tell the Quarkus to ignore the <code>@WithTransaction</code> when called from the unit test ??</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}