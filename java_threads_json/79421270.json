{
  "question": {
    "tags": [
      "java",
      "tomcat",
      "java-8",
      "connection-pooling",
      "dbcp"
    ],
    "owner": {
      "account_id": 13412339,
      "reputation": 57,
      "user_id": 9678253,
      "user_type": "registered",
      "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/s256-rj/photo.jpg",
      "display_name": "Thomas Campos",
      "link": "https://stackoverflow.com/users/9678253/thomas-campos"
    },
    "is_answered": false,
    "view_count": 137,
    "answer_count": 0,
    "score": 0,
    "last_activity_date": 1741340087,
    "creation_date": 1738939579,
    "last_edit_date": 1741340087,
    "question_id": 79421270,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79421270/error-pooled-object-has-not-been-returned-properly-occurs-sometimes-when-i-ask-a",
    "title": "Error Pooled object has not been returned properly occurs sometimes when I ask a connection from the DBCP pool",
    "body": "<p>I have to correct an existing Java Backend application implemented in Java 8 with no Framework, and deployed on Tomcat server under Linux Virtual Machine.\nThis application is connected to an Oracle Database and access it via JDBC, with no ORM, no JPA, only with JDBC.</p>\n<p>I have a very strange error that occurs, where it indicates a message very different than the context where this exception occurs.</p>\n<p>For some cases (hopefully not all cases, a minority of cases),</p>\n<p>when in the code i try to get a connection from the JDBC pool</p>\n<p><code>connection = datasource.getConnection()</code></p>\n<p>In the logs I obtain this error:</p>\n<pre><code>  Pooled object created 2025-02-06 22:04:02 +0100 by the following code has not been returned to the pool:\norg.apache.tomcat.dbcp.pool2.impl.ThrowableCallStack$Snapshot\n        at org.apache.tomcat.dbcp.pool2.impl.ThrowableCallStack.fillInStackTrace(ThrowableCallStack.java:71)\n        at org.apache.tomcat.dbcp.pool2.impl.DefaultPooledObject.allocate(DefaultPooledObject.java:193)\n        at org.apache.tomcat.dbcp.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:439)\n        at org.apache.tomcat.dbcp.pool2.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:345)\n        at org.apache.tomcat.dbcp.dbcp2.PoolingDataSource.getConnection(PoolingDataSource.java:134)\n        at org.apache.tomcat.dbcp.dbcp2.BasicDataSource.getConnection(BasicDataSource.java:794)\n        at com.company.ws.utils.DBUtility.getConnection(DBUtility.java:43)\n</code></pre>\n<p>And at the line 43 of the <code>getConnection</code> of the class <code>DBUtility</code>,\nI have this instruction:</p>\n<p><code>connection = datasource.getConnection();</code></p>\n<p>What it can cause such problem?</p>\n<p>Can it be a problem of code?\nAll the connections taken from the pool are closed in a finally block, all the connections.</p>\n<p>Could it be a problem of Tomcat configuration in <code>server.xml</code> file?</p>\n<p>Have you encounter already such a problem and what have you done to fix it?</p>\n<p>Thanks a lot.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}