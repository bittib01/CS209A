{
  "question": {
    "tags": [
      "java",
      "apache-kafka",
      "spring-kafka"
    ],
    "owner": {
      "account_id": 14651915,
      "reputation": 47,
      "user_id": 10581692,
      "user_type": "registered",
      "profile_image": "https://www.gravatar.com/avatar/038d7deca75007112d120b83edcc700e?s=256&d=identicon&r=PG&f=y&so-version=2",
      "display_name": "TechUk",
      "link": "https://stackoverflow.com/users/10581692/techuk"
    },
    "is_answered": false,
    "view_count": 92,
    "answer_count": 1,
    "score": 1,
    "last_activity_date": 1752183132,
    "creation_date": 1750927819,
    "last_edit_date": 1750946778,
    "question_id": 79680183,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79680183/org-apache-kafka-common-errors-timeoutexception-timeout-of-60000ms-expired-befo",
    "title": "org.apache.kafka.common.errors.TimeoutException: Timeout of 60000ms expired before successfully committing offsets with kafkaTransactionManager",
    "body": "<p>I am using kafka @KafkaListener with @Transactional(&quot;kafkaTransactionManager&quot;).My flow will be something read/process/commit using transaction consumer.</p>\n<pre><code> public void listen(List&lt;ConsumerRecord&gt; records) {    \n  \n    // do some database activities           \n    final Object result = kafkaTemplate.send(producerRecord).get(); \n    //I am sending data and waiting for response to capture offset and store in DB\n    long offset = ((SendResult) result).getRecordMetadata().offset();\n    int partition = ((SendResult) result).getRecordMetadata().partition();\n    log.info(offset ,partition  );\n}\n</code></pre>\n<p>When anything happen before or at sender then transaction rolled back and it read from same offset happy path flow.</p>\n<p><strong>Issue</strong> - Say data is published and after consumer is going to commit the offset and i get error\n<strong>org.apache.kafka.common.errors.TimeoutException: Timeout of 60000ms expired before successfully committing offsets</strong>\nIn this case consumer  will read the same offset again ( i think so since transaction is NOT successfully completed)?</p>\n<p>If <strong>yes</strong> - this will cause the duplicate since message already sent?<br />\nIf <strong>No</strong> - then how the message will be removed from target topic ( where producer sent the message)</p>\n<p>I am using acks = -1 and idempotence = true.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}