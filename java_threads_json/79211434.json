{
  "question": {
    "tags": [
      "java",
      "microsoft-graph-api",
      "microsoft-graph-sdks"
    ],
    "owner": {
      "account_id": 2715546,
      "reputation": 8228,
      "user_id": 2343011,
      "user_type": "registered",
      "accept_rate": 64,
      "profile_image": "https://i.sstatic.net/hCKTA.jpg?s=256",
      "display_name": "flavio.donze",
      "link": "https://stackoverflow.com/users/2343011/flavio-donze"
    },
    "is_answered": false,
    "view_count": 63,
    "answer_count": 2,
    "score": 0,
    "last_activity_date": 1732541496,
    "creation_date": 1732196715,
    "last_edit_date": 1732198016,
    "question_id": 79211434,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/79211434/how-to-configure-a-displaytemplate-for-externalconnection-in-microsoft-graph-api",
    "title": "how to configure a DisplayTemplate for ExternalConnection in microsoft Graph API?",
    "body": "<p>I'm building a <a href=\"https://learn.microsoft.com/en-us/graph/connecting-external-content-connectors-overview\" rel=\"nofollow noreferrer\">Graph-Connector</a> using <a href=\"https://github.com/microsoftgraph/msgraph-sdk-java\" rel=\"nofollow noreferrer\">msgraph-sdk-java</a> to create connection/schema.\n<br>\nAccording to documentation an <a href=\"https://learn.microsoft.com/en-us/graph/api/resources/externalconnectors-externalconnection?view=graph-rest-1.0#properties\" rel=\"nofollow noreferrer\">ExternalConnection</a> has a <a href=\"https://learn.microsoft.com/en-us/graph/api/resources/externalconnectors-searchsettings?view=graph-rest-1.0\" rel=\"nofollow noreferrer\">SearchSettings</a> property which then holds a collection of <a href=\"https://learn.microsoft.com/en-us/graph/api/resources/externalconnectors-displaytemplate?view=graph-rest-1.0\" rel=\"nofollow noreferrer\">DisplayTemplate</a> as search result templates.<br>\nI'm struggling to pass such an <code>DisplayTemplate</code> to the <code>ExternalConnection</code>.</p>\n<p>The following approach throws an error (<code>com.microsoft.graph.models.odataerrors.ODataError: The request is malformed or incorrect.</code>):</p>\n<pre><code>ExternalConnection externalConnection = new ExternalConnection();\nexternalConnection.setId(connectionId);\nexternalConnection.setName(connectionName);\n\nDisplayTemplate template = new DisplayTemplate();\ntemplate.setId(&quot;testTemplate&quot;);\ntemplate.setLayout(new UntypedString(&quot;{\\&quot;type\\&quot;: \\&quot;AdaptiveCard\\&quot;,\\&quot;version\\&quot;: \\&quot;1.0\\&quot;,\\&quot;body\\&quot;: [{\\&quot;type\\&quot;: \\&quot;TextBlock\\&quot;,\\&quot;text\\&quot;: \\&quot;A contoso ticket.\\&quot;}]}&quot;));\nSearchSettings settings = new SearchSettings();\nsettings.setSearchResultTemplates(List.of(template));\nexternalConnection.setSearchSettings(settings);\n\ngraphClient.external().connections().post(externalConnection);\n</code></pre>\n<p>For the <code>Schema</code> there is a separated API call, but I didn't find anything accordingly for the DisplayTemplate:</p>\n<pre><code>graphClient.external().connections().byExternalConnectionId(connectionId).schema().patch(schema);\n</code></pre>\n<p>There is a <a href=\"https://learn.microsoft.com/en-us/graph/search-concept-display-layout\" rel=\"nofollow noreferrer\">Manage search results layout</a> in the documentation but it only shows how to read data.</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}