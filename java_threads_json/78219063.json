{
  "question": {
    "tags": [
      "java",
      "microsoft-graph-api",
      "microsoft-graph-sdks"
    ],
    "owner": {
      "account_id": 1203915,
      "reputation": 10731,
      "user_id": 1174024,
      "user_type": "registered",
      "accept_rate": 85,
      "profile_image": "https://i.sstatic.net/9zaVE.jpg?s=256",
      "display_name": "Nicholas DiPiazza",
      "link": "https://stackoverflow.com/users/1174024/nicholas-dipiazza"
    },
    "is_answered": true,
    "view_count": 345,
    "accepted_answer_id": 78691869,
    "answer_count": 1,
    "score": 0,
    "last_activity_date": 1719832012,
    "creation_date": 1711369569,
    "last_edit_date": 1711372036,
    "question_id": 78219063,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/78219063/in-microsoft-graph-sdk-6-4-0-using-new-pageiterator-what-is-the-proper-way-to",
    "title": "In Microsoft graph sdk 6.4.0 using new PageIterator - what is the proper way to use processPageItemCallback?",
    "body": "<p>There is a new PageIterator in 6.4.0 version of Microsoft Graph Java SDK.</p>\n<p><a href=\"https://github.com/microsoftgraph/msgraph-sdk-java/blob/dev/docs/upgrade-to-v6.md#pageiterator\" rel=\"nofollow noreferrer\">https://github.com/microsoftgraph/msgraph-sdk-java/blob/dev/docs/upgrade-to-v6.md#pageiterator</a></p>\n<p>Let's say you have a page iterator and you want to read some bytes from several list items.</p>\n<pre><code>PageIterator&lt;ListItem, ListItemCollectionResponse&gt; pageIterator = new PageIterator.Builder&lt;ListItem, ListItemCollectionResponse&gt;()\n    .client(graphClient)\n    // The first page of the collection is passed to the collectionPage method\n    .collectionPage(response)\n    // CollectionPageFactory is called to create a new collection page from the nextLink\n    .collectionPageFactory(ListItemCollectionResponse::createFromDiscriminatorValue)\n    // ProcessPageItemCallback is called for each item in the collection\n    .processPageItemCallback(li -&gt; {\n        String driveItemId = li.getDriveItem().getId();\n        InputStream is = graphClient.drives().byDriveId(siteDriveId)\n                .items()\n                .byDriveItemId(driveItemId)\n                .content()\n                .get();\n        try {\n            byte[] bytes = IOUtils.toByteArray(is);\n            LOGGER.info(&quot;Read {} bytes&quot;, bytes.length);\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n        return true; // why does this return true? What if i returned false?\n    }).build();\npageIterator.iterate();\n</code></pre>\n<p>Am I appropriately using the <code>processPageItemCallback</code> by doing work inside there? Or should I be storing it in a List and using the list afterwards. Why does it return true/false?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}