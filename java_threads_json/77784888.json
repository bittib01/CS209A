{
  "question": {
    "tags": [
      "java",
      "credentials",
      "apache-httpclient-5.x",
      "ntlm-authentication"
    ],
    "owner": {
      "account_id": 12296207,
      "reputation": 2560,
      "user_id": 8971773,
      "user_type": "registered",
      "accept_rate": 25,
      "profile_image": "https://i.sstatic.net/tFcJU.png?s=256",
      "display_name": "Kira Resari",
      "link": "https://stackoverflow.com/users/8971773/kira-resari"
    },
    "is_answered": true,
    "view_count": 4755,
    "accepted_answer_id": 78119402,
    "answer_count": 2,
    "score": 4,
    "last_activity_date": 1723994093,
    "creation_date": 1704784127,
    "last_edit_date": 1717950874,
    "question_id": 77784888,
    "content_license": "CC BY-SA 4.0",
    "link": "https://stackoverflow.com/questions/77784888/apache-http-client-5-3-ntcredentials-no-longer-working",
    "title": "Apache HTTP Client 5.3 ~ NTCredentials no longer working",
    "body": "<p>I have a project that uses <code>org.apache.httpcomponents.client5:httpclient5</code>. I recently tried upgrading from version 5.2.3 to version 5.3, only to realize that the authentication was no longer working in the new version.</p>\n<p>Here is how the relevant code looks:</p>\n<pre><code>        BasicCredentialsProvider credentialsProvider =\n            new BasicCredentialsProvider();\n        credentialsProvider.setCredentials(\n            new AuthScope(host, port),\n            new NTCredentials(username, password.toCharArray(), &quot;&quot;, &quot;&quot;)\n        );\n        httpclient = HttpClients.custom()\n            .setDefaultCredentialsProvider(credentialsProvider)\n            .build();\n[...]\n            final HttpGet httpget = new HttpGet(targetUrl);\n\n            CloseableHttpResponse response = httpclient.execute(httpget);\n\n</code></pre>\n<p>Before the update from 5.2.3 to 5.3 this worked fine. However, when I use 5.3, I now get a 401 UNAUTHORIZED response.</p>\n<p>I also tried the following variations to above code to pass the credentials along, but they all also return only 401 UNAUTHORIZED:</p>\n<pre><code>        httpclient = HttpClients.custom()\n            .setDefaultCredentialsProvider(CredentialsProviderBuilder.create()\n                .add(new HttpHost(host, port), username, password.toCharArray())\n                .build())\n            .build();\n</code></pre>\n<pre><code>        credentialsProvider.setCredentials(\n            new AuthScope(host, port),\n            new UsernamePasswordCredentials(username, password.toCharArray())\n        );\n</code></pre>\n<pre><code>        SystemDefaultCredentialsProvider credentialsProvider =\n            new SystemDefaultCredentialsProvider();\n        credentialsProvider.setCredentials(\n            new AuthScope(host, port),\n            new NTCredentials(username, password.toCharArray(), &quot;&quot;, &quot;&quot;)\n        );\n</code></pre>\n<p>Now I am stumped. Could this be a bug in 5.3? Or did something change to the way that the NTCredentialsProvider works? I could not find any release notes indicating so, and since this is only a minor version update that would surprise me.</p>\n<p>Nonetheless, the fact it that it works with the old version but not with the new one. Does anyone has any suggestions as to what I can do about that?</p>\n"
  },
  "answers": [],
  "question_comments": [],
  "answer_comments": {}
}